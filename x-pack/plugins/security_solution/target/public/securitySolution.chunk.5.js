/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window["securitySolution_bundle_jsonpfunction"]=window["securitySolution_bundle_jsonpfunction"]||[]).push([[5],{121:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return MANAGEMENT_APP_ID}));__webpack_require__.d(__webpack_exports__,"i",(function(){return MANAGEMENT_ROUTING_ROOT_PATH}));__webpack_require__.d(__webpack_exports__,"f",(function(){return MANAGEMENT_ROUTING_ENDPOINTS_PATH}));__webpack_require__.d(__webpack_exports__,"g",(function(){return MANAGEMENT_ROUTING_POLICIES_PATH}));__webpack_require__.d(__webpack_exports__,"h",(function(){return MANAGEMENT_ROUTING_POLICY_DETAILS_PATH}));__webpack_require__.d(__webpack_exports__,"j",(function(){return MANAGEMENT_ROUTING_TRUSTED_APPS_PATH}));__webpack_require__.d(__webpack_exports__,"l",(function(){return MANAGEMENT_STORE_GLOBAL_NAMESPACE}));__webpack_require__.d(__webpack_exports__,"m",(function(){return MANAGEMENT_STORE_POLICY_DETAILS_NAMESPACE}));__webpack_require__.d(__webpack_exports__,"k",(function(){return MANAGEMENT_STORE_ENDPOINTS_NAMESPACE}));__webpack_require__.d(__webpack_exports__,"n",(function(){return MANAGEMENT_STORE_TRUSTED_APPS_NAMESPACE}));__webpack_require__.d(__webpack_exports__,"e",(function(){return MANAGEMENT_PAGE_SIZE_OPTIONS}));__webpack_require__.d(__webpack_exports__,"c",(function(){return MANAGEMENT_DEFAULT_PAGE}));__webpack_require__.d(__webpack_exports__,"d",(function(){return MANAGEMENT_DEFAULT_PAGE_SIZE}));__webpack_require__.d(__webpack_exports__,"a",(function(){return DEFAULT_POLL_INTERVAL}));var _types__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(195);var _common_constants__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2);var _app_types__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(3);const MANAGEMENT_APP_ID=`${_common_constants__WEBPACK_IMPORTED_MODULE_1__["f"]}:${_app_types__WEBPACK_IMPORTED_MODULE_2__["a"].administration}`;const MANAGEMENT_ROUTING_ROOT_PATH="";const MANAGEMENT_ROUTING_ENDPOINTS_PATH=`${MANAGEMENT_ROUTING_ROOT_PATH}/:tabName(${_types__WEBPACK_IMPORTED_MODULE_0__["a"].endpoints})`;const MANAGEMENT_ROUTING_POLICIES_PATH=`${MANAGEMENT_ROUTING_ROOT_PATH}/:tabName(${_types__WEBPACK_IMPORTED_MODULE_0__["a"].policies})`;const MANAGEMENT_ROUTING_POLICY_DETAILS_PATH=`${MANAGEMENT_ROUTING_ROOT_PATH}/:tabName(${_types__WEBPACK_IMPORTED_MODULE_0__["a"].policies})/:policyId`;const MANAGEMENT_ROUTING_TRUSTED_APPS_PATH=`${MANAGEMENT_ROUTING_ROOT_PATH}/:tabName(${_types__WEBPACK_IMPORTED_MODULE_0__["a"].trustedApps})`;const MANAGEMENT_STORE_GLOBAL_NAMESPACE="management";const MANAGEMENT_STORE_POLICY_DETAILS_NAMESPACE="policyDetails";const MANAGEMENT_STORE_ENDPOINTS_NAMESPACE="endpoints";const MANAGEMENT_STORE_TRUSTED_APPS_NAMESPACE="trustedApps";const MANAGEMENT_PAGE_SIZE_OPTIONS=[10,20,50];const MANAGEMENT_DEFAULT_PAGE=0;const MANAGEMENT_DEFAULT_PAGE_SIZE=10;const DEFAULT_POLL_INTERVAL=1e4},148:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"d",(function(){return getEndpointListPath}));__webpack_require__.d(__webpack_exports__,"c",(function(){return getEndpointDetailsPath}));__webpack_require__.d(__webpack_exports__,"e",(function(){return getPolicyDetailPath}));__webpack_require__.d(__webpack_exports__,"a",(function(){return extractListPaginationParams}));__webpack_require__.d(__webpack_exports__,"b",(function(){return extractTrustedAppsListPageLocation}));__webpack_require__.d(__webpack_exports__,"f",(function(){return getTrustedAppsListPath}));var lodash_fp__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7);var lodash_fp__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash_fp__WEBPACK_IMPORTED_MODULE_0__);var react_router_dom__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(75);var react_router_dom__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react_router_dom__WEBPACK_IMPORTED_MODULE_1__);var querystring__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(214);var querystring__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(querystring__WEBPACK_IMPORTED_MODULE_2__);var _constants__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(121);var _types__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(195);var _common_components_link_to_helpers__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(169);const querystringStringify=params=>querystring__WEBPACK_IMPORTED_MODULE_2___default.a.stringify(params);const getEndpointListPath=(props,search)=>{const{name:name,...queryParams}=props;const urlQueryParams=querystringStringify(queryParams);const urlSearch=`${urlQueryParams&&!Object(lodash_fp__WEBPACK_IMPORTED_MODULE_0__["isEmpty"])(search)?"&":""}${search!==null&&search!==void 0?search:""}`;if(name==="endpointList"){return`${Object(react_router_dom__WEBPACK_IMPORTED_MODULE_1__["generatePath"])(_constants__WEBPACK_IMPORTED_MODULE_3__["f"],{tabName:_types__WEBPACK_IMPORTED_MODULE_4__["a"].endpoints})}${Object(_common_components_link_to_helpers__WEBPACK_IMPORTED_MODULE_5__["a"])(`${urlQueryParams?`${urlQueryParams}${urlSearch}`:urlSearch}`)}`}return`${Object(_common_components_link_to_helpers__WEBPACK_IMPORTED_MODULE_5__["a"])(`${urlQueryParams?`${urlQueryParams}${urlSearch}`:urlSearch}`)}`};const getEndpointDetailsPath=(props,search)=>{const{name:name,...queryParams}=props;queryParams.show=props.name==="endpointPolicyResponse"?"policy_response":"";const urlQueryParams=querystringStringify(queryParams);const urlSearch=`${urlQueryParams&&!Object(lodash_fp__WEBPACK_IMPORTED_MODULE_0__["isEmpty"])(search)?"&":""}${search!==null&&search!==void 0?search:""}`;return`${Object(react_router_dom__WEBPACK_IMPORTED_MODULE_1__["generatePath"])(_constants__WEBPACK_IMPORTED_MODULE_3__["f"],{tabName:_types__WEBPACK_IMPORTED_MODULE_4__["a"].endpoints})}${Object(_common_components_link_to_helpers__WEBPACK_IMPORTED_MODULE_5__["a"])(`${urlQueryParams?`${urlQueryParams}${urlSearch}`:urlSearch}`)}`};const getPoliciesPath=search=>`${Object(react_router_dom__WEBPACK_IMPORTED_MODULE_1__["generatePath"])(_constants__WEBPACK_IMPORTED_MODULE_3__["g"],{tabName:_types__WEBPACK_IMPORTED_MODULE_4__["a"].policies})}${Object(_common_components_link_to_helpers__WEBPACK_IMPORTED_MODULE_5__["a"])(search)}`;const getPolicyDetailPath=(policyId,search)=>`${Object(react_router_dom__WEBPACK_IMPORTED_MODULE_1__["generatePath"])(_constants__WEBPACK_IMPORTED_MODULE_3__["h"],{tabName:_types__WEBPACK_IMPORTED_MODULE_4__["a"].policies,policyId:policyId})}${Object(_common_components_link_to_helpers__WEBPACK_IMPORTED_MODULE_5__["a"])(search)}`;const isDefaultOrMissing=(value,defaultValue)=>value===undefined||value===defaultValue;const normalizeTrustedAppsPageLocation=location=>{if(location){return{...!isDefaultOrMissing(location.page_index,_constants__WEBPACK_IMPORTED_MODULE_3__["c"])?{page_index:location.page_index}:{},...!isDefaultOrMissing(location.page_size,_constants__WEBPACK_IMPORTED_MODULE_3__["d"])?{page_size:location.page_size}:{},...!isDefaultOrMissing(location.view_type,"grid")?{view_type:location.view_type}:{},...!isDefaultOrMissing(location.show,undefined)?{show:location.show}:{}}}else{return{}}};const extractFirstParamValue=(query,key)=>{const value=query[key];return Array.isArray(value)?value[value.length-1]:value};const extractPageIndex=query=>{const pageIndex=Number(extractFirstParamValue(query,"page_index"));return!Number.isFinite(pageIndex)||pageIndex<0?_constants__WEBPACK_IMPORTED_MODULE_3__["c"]:pageIndex};const extractPageSize=query=>{const pageSize=Number(extractFirstParamValue(query,"page_size"));return _constants__WEBPACK_IMPORTED_MODULE_3__["e"].includes(pageSize)?pageSize:_constants__WEBPACK_IMPORTED_MODULE_3__["d"]};const extractListPaginationParams=query=>({page_index:extractPageIndex(query),page_size:extractPageSize(query)});const extractTrustedAppsListPageLocation=query=>({...extractListPaginationParams(query),view_type:extractFirstParamValue(query,"view_type")==="list"?"list":"grid",show:extractFirstParamValue(query,"show")==="create"?"create":undefined});const getTrustedAppsListPath=location=>{const path=Object(react_router_dom__WEBPACK_IMPORTED_MODULE_1__["generatePath"])(_constants__WEBPACK_IMPORTED_MODULE_3__["j"],{tabName:_types__WEBPACK_IMPORTED_MODULE_4__["a"].trustedApps});return`${path}${Object(_common_components_link_to_helpers__WEBPACK_IMPORTED_MODULE_5__["a"])(querystring__WEBPACK_IMPORTED_MODULE_2___default.a.stringify(normalizeTrustedAppsPageLocation(location)))}`}},172:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"j",(function(){return policyDetails}));__webpack_require__.d(__webpack_exports__,"d",(function(){return getPolicyDataForUpdate}));__webpack_require__.d(__webpack_exports__,"k",(function(){return policyDetailsForUpdate}));__webpack_require__.d(__webpack_exports__,"g",(function(){return isOnPolicyDetailsPage}));__webpack_require__.d(__webpack_exports__,"h",(function(){return selectors_license}));__webpack_require__.d(__webpack_exports__,"l",(function(){return policyIdFromParams}));__webpack_require__.d(__webpack_exports__,"c",(function(){return fullPolicy}));__webpack_require__.d(__webpack_exports__,"i",(function(){return policyConfig}));__webpack_require__.d(__webpack_exports__,"e",(function(){return isAntivirusRegistrationEnabled}));__webpack_require__.d(__webpack_exports__,"f",(function(){return isLoading}));__webpack_require__.d(__webpack_exports__,"b",(function(){return apiError}));__webpack_require__.d(__webpack_exports__,"a",(function(){return agentStatusSummary}));__webpack_require__.d(__webpack_exports__,"m",(function(){return updateStatus}));var lib=__webpack_require__(123);var external_kbnSharedDeps_ReactRouterDom_=__webpack_require__(75);var license_license=__webpack_require__(49);var policy_config=__webpack_require__(277);const isEndpointPolicyValidForLicense=(policy,license)=>{if(Object(license_license["b"])(license,"platinum")){return true}const defaults=Object(policy_config["c"])();if(policy.windows.popup.malware.enabled!==defaults.windows.popup.malware.enabled||policy.mac.popup.malware.enabled!==defaults.mac.popup.malware.enabled){return false}if([policy.windows,policy.mac].some(p=>p.popup.malware.message!==""&&p.popup.malware.message!==policy_config["a"])){return false}if(policy.windows.ransomware.mode!==defaults.windows.ransomware.mode){return false}if(policy.windows.popup.ransomware.enabled!==defaults.windows.popup.ransomware.enabled){return false}if(policy.windows.popup.ransomware.message!==""&&policy.windows.popup.ransomware.message!==policy_config["a"]){return false}return true};const unsetPolicyFeaturesAboveLicenseLevel=(policy,license)=>{if(Object(license_license["b"])(license,"platinum")){return policy}return Object(policy_config["c"])(policy)};var constants=__webpack_require__(121);const policyDetails=state=>state.policyItem;const licenseState=state=>state.license;const licensedPolicy=Object(lib["createSelector"])(policyDetails,licenseState,(policyData,license)=>{if(policyData){const policyValue=unsetPolicyFeaturesAboveLicenseLevel(policyData.inputs[0].config.policy.value,license);const newPolicyData={...policyData,inputs:[{...policyData.inputs[0],config:{...policyData.inputs[0].config,policy:{...policyData.inputs[0].config.policy,value:policyValue}}}]};return newPolicyData}return policyData});const getPolicyDataForUpdate=policy=>{const{id:id,revision:revision,created_by:created_by,created_at:created_at,updated_by:updated_by,updated_at:updated_at,...newPolicy}=policy;return{...newPolicy,inputs:newPolicy.inputs.map(input=>({...input,config:input.config&&{...input.config,policy:{...input.config.policy,value:{...input.config.policy.value,windows:{...input.config.policy.value.windows,popup:{...input.config.policy.value.windows.popup,malware:{...input.config.policy.value.windows.popup.malware,message:input.config.policy.value.windows.popup.malware.message.trim()}}},mac:{...input.config.policy.value.mac,popup:{...input.config.policy.value.mac.popup,malware:{...input.config.policy.value.mac.popup.malware,message:input.config.policy.value.mac.popup.malware.message.trim()}}}}}}}))}};const policyDetailsForUpdate=Object(lib["createSelector"])(licensedPolicy,policy=>{if(policy){return getPolicyDataForUpdate(policy)}});const isOnPolicyDetailsPage=state=>{var _state$location$pathn,_state$location;return Object(external_kbnSharedDeps_ReactRouterDom_["matchPath"])((_state$location$pathn=(_state$location=state.location)===null||_state$location===void 0?void 0:_state$location.pathname)!==null&&_state$location$pathn!==void 0?_state$location$pathn:"",{path:constants["h"],exact:true})!==null};const selectors_license=state=>state.license;const policyIdFromParams=Object(lib["createSelector"])(state=>state.location,location=>{var _matchPath$params$pol,_matchPath,_matchPath$params,_location$pathname;return(_matchPath$params$pol=(_matchPath=Object(external_kbnSharedDeps_ReactRouterDom_["matchPath"])((_location$pathname=location===null||location===void 0?void 0:location.pathname)!==null&&_location$pathname!==void 0?_location$pathname:"",{path:constants["h"],exact:true}))===null||_matchPath===void 0?void 0:(_matchPath$params=_matchPath.params)===null||_matchPath$params===void 0?void 0:_matchPath$params.policyId)!==null&&_matchPath$params$pol!==void 0?_matchPath$params$pol:""});const defaultFullPolicy=Object(policy_config["b"])();const fullPolicy=Object(lib["createSelector"])(licensedPolicy,policyData=>{var _policyData$inputs$0$,_policyData$inputs$,_policyData$inputs$$c,_policyData$inputs$$c2;return(_policyData$inputs$0$=policyData===null||policyData===void 0?void 0:(_policyData$inputs$=policyData.inputs[0])===null||_policyData$inputs$===void 0?void 0:(_policyData$inputs$$c=_policyData$inputs$.config)===null||_policyData$inputs$$c===void 0?void 0:(_policyData$inputs$$c2=_policyData$inputs$$c.policy)===null||_policyData$inputs$$c2===void 0?void 0:_policyData$inputs$$c2.value)!==null&&_policyData$inputs$0$!==void 0?_policyData$inputs$0$:defaultFullPolicy});const fullWindowsPolicySettings=Object(lib["createSelector"])(fullPolicy,policy=>policy===null||policy===void 0?void 0:policy.windows);const fullMacPolicySettings=Object(lib["createSelector"])(fullPolicy,policy=>policy===null||policy===void 0?void 0:policy.mac);const fullLinuxPolicySettings=Object(lib["createSelector"])(fullPolicy,policy=>policy===null||policy===void 0?void 0:policy.linux);const policyConfig=Object(lib["createSelector"])(fullWindowsPolicySettings,fullMacPolicySettings,fullLinuxPolicySettings,(windows,mac,linux)=>({windows:{advanced:windows.advanced,events:windows.events,malware:windows.malware,ransomware:windows.ransomware,popup:windows.popup,antivirus_registration:windows.antivirus_registration},mac:{advanced:mac.advanced,events:mac.events,malware:mac.malware,popup:mac.popup},linux:{advanced:linux.advanced,events:linux.events}}));const isAntivirusRegistrationEnabled=Object(lib["createSelector"])(policyConfig,uiPolicyConfig=>uiPolicyConfig.windows.antivirus_registration.enabled);const totalWindowsEvents=state=>{const config=policyConfig(state);if(config){return Object.keys(config.windows.events).length}return 0};const selectedWindowsEvents=state=>{const config=policyConfig(state);if(config){return Object.values(config.windows.events).reduce((count,event)=>event===true?count+1:count,0)}return 0};const totalMacEvents=state=>{const config=policyConfig(state);if(config){return Object.keys(config.mac.events).length}return 0};const selectedMacEvents=state=>{const config=policyConfig(state);if(config){return Object.values(config.mac.events).reduce((count,event)=>event===true?count+1:count,0)}return 0};const totalLinuxEvents=state=>{const config=policyConfig(state);if(config){return Object.keys(config.linux.events).length}return 0};const selectedLinuxEvents=state=>{const config=policyConfig(state);if(config){return Object.values(config.linux.events).reduce((count,event)=>event===true?count+1:count,0)}return 0};const isLoading=state=>state.isLoading;const apiError=state=>state.apiError;const agentStatusSummary=state=>state.agentStatusSummary;const updateStatus=state=>state.updateStatus},195:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return AdministrationSubTab}));let AdministrationSubTab;(function(AdministrationSubTab){AdministrationSubTab["endpoints"]="endpoints";AdministrationSubTab["policies"]="policy";AdministrationSubTab["trustedApps"]="trusted_apps"})(AdministrationSubTab||(AdministrationSubTab={}))},212:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useNavigateToAppEventHandler}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var _lib_kibana__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(104);const useNavigateToAppEventHandler=(appId,options)=>{const{services:services}=Object(_lib_kibana__WEBPACK_IMPORTED_MODULE_1__["h"])();const{path:path,state:state,onClick:onClick}=options||{};return Object(react__WEBPACK_IMPORTED_MODULE_0__["useCallback"])(ev=>{try{if(onClick){onClick(ev)}}catch(error){ev.preventDefault();throw error}if(ev.defaultPrevented){return}if(ev.button!==0){return}if(ev.currentTarget instanceof HTMLAnchorElement&&ev.currentTarget.target!==""&&ev.currentTarget.target!=="_self"){return}if(ev.metaKey||ev.altKey||ev.ctrlKey||ev.shiftKey){return}ev.preventDefault();services.application.navigateToApp(appId,{path:path,state:state})},[appId,onClick,path,services.application,state])}},214:function(module,exports,__webpack_require__){"use strict";exports.decode=exports.parse=__webpack_require__(314);exports.encode=exports.stringify=__webpack_require__(315)},215:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return usePolicyDetailsSelector}));var react_redux__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(105);var react_redux__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react_redux__WEBPACK_IMPORTED_MODULE_0__);var _common_constants__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(121);function usePolicyDetailsSelector(selector){return Object(react_redux__WEBPACK_IMPORTED_MODULE_0__["useSelector"])(state=>selector(state[_common_constants__WEBPACK_IMPORTED_MODULE_1__["l"]][_common_constants__WEBPACK_IMPORTED_MODULE_1__["m"]]))}},276:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return LinkToApp}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var _elastic_eui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(72);var _elastic_eui__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__);var _hooks_endpoint_use_navigate_to_app_event_handler__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(212);function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}const LinkToApp=Object(react__WEBPACK_IMPORTED_MODULE_0__["memo"])(({appId:appId,appPath:path,appState:state,onClick:onClick,asButton:asButton,children:children,...otherProps})=>{const handleOnClick=Object(_hooks_endpoint_use_navigate_to_app_event_handler__WEBPACK_IMPORTED_MODULE_2__["a"])(appId,{path:path,state:state,onClick:onClick});return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,asButton&&asButton===true?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiButton"],_extends({},otherProps,{onClick:handleOnClick}),children):react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiLink"],_extends({},otherProps,{onClick:handleOnClick}),children))})},277:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return policyFactory}));__webpack_require__.d(__webpack_exports__,"c",(function(){return policyFactoryWithoutPaidFeatures}));__webpack_require__.d(__webpack_exports__,"a",(function(){return DefaultMalwareMessage}));var _types__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(39);const policyFactory=()=>({windows:{events:{dll_and_driver_load:true,dns:true,file:true,network:true,process:true,registry:true,security:true},malware:{mode:_types__WEBPACK_IMPORTED_MODULE_0__["f"].prevent},ransomware:{mode:_types__WEBPACK_IMPORTED_MODULE_0__["f"].prevent},popup:{malware:{message:"",enabled:true},ransomware:{message:"",enabled:true}},logging:{file:"info"},antivirus_registration:{enabled:false}},mac:{events:{process:true,file:true,network:true},malware:{mode:_types__WEBPACK_IMPORTED_MODULE_0__["f"].prevent},popup:{malware:{message:"",enabled:true}},logging:{file:"info"}},linux:{events:{process:true,file:true,network:true},logging:{file:"info"}}});const policyFactoryWithoutPaidFeatures=(policy=policyFactory())=>({...policy,windows:{...policy.windows,ransomware:{mode:_types__WEBPACK_IMPORTED_MODULE_0__["f"].off},popup:{...policy.windows.popup,malware:{message:"",enabled:true},ransomware:{message:"",enabled:false}}},mac:{...policy.mac,popup:{...policy.mac.popup,malware:{message:"",enabled:true}}}});const DefaultMalwareMessage="Elastic Security {action} {filename}"},314:function(module,exports,__webpack_require__){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&";eq=eq||"=";var obj={};if(typeof qs!=="string"||qs.length===0){return obj}var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;if(options&&typeof options.maxKeys==="number"){maxKeys=options.maxKeys}var len=qs.length;if(maxKeys>0&&len>maxKeys){len=maxKeys}for(var i=0;i<len;++i){var x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq),kstr,vstr,k,v;if(idx>=0){kstr=x.substr(0,idx);vstr=x.substr(idx+1)}else{kstr=x;vstr=""}k=decodeURIComponent(kstr);v=decodeURIComponent(vstr);if(!hasOwnProperty(obj,k)){obj[k]=v}else if(isArray(obj[k])){obj[k].push(v)}else{obj[k]=[obj[k],v]}}return obj};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"}},315:function(module,exports,__webpack_require__){"use strict";var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){sep=sep||"&";eq=eq||"=";if(obj===null){obj=undefined}if(typeof obj==="object"){return map(objectKeys(obj),(function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;if(isArray(obj[k])){return map(obj[k],(function(v){return ks+encodeURIComponent(stringifyPrimitive(v))})).join(sep)}else{return ks+encodeURIComponent(stringifyPrimitive(obj[k]))}})).join(sep)}if(!name)return"";return encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj))};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"};function map(xs,f){if(xs.map)return xs.map(f);var res=[];for(var i=0;i<xs.length;i++){res.push(f(xs[i],i))}return res}var objectKeys=Object.keys||function(obj){var res=[];for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))res.push(key)}return res}},316:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return ENDPOINTS_TAB}));__webpack_require__.d(__webpack_exports__,"d",(function(){return POLICIES_TAB}));__webpack_require__.d(__webpack_exports__,"e",(function(){return TRUSTED_APPS_TAB}));__webpack_require__.d(__webpack_exports__,"a",(function(){return BETA_BADGE_LABEL}));__webpack_require__.d(__webpack_exports__,"c",(function(){return OS_TITLES}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__);var _common_endpoint_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(39);const ENDPOINTS_TAB=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.endpointsTab",{defaultMessage:"Endpoints"});const POLICIES_TAB=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.policiesTab",{defaultMessage:"Policies"});const TRUSTED_APPS_TAB=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.trustedAppsTab",{defaultMessage:"Trusted applications"});const BETA_BADGE_LABEL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.administration.list.beta",{defaultMessage:"Beta"});const OS_TITLES={[_common_endpoint_types__WEBPACK_IMPORTED_MODULE_1__["e"].WINDOWS]:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.administration.os.windows",{defaultMessage:"Windows"}),[_common_endpoint_types__WEBPACK_IMPORTED_MODULE_1__["e"].MAC]:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.administration.os.macos",{defaultMessage:"Mac"}),[_common_endpoint_types__WEBPACK_IMPORTED_MODULE_1__["e"].LINUX]:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.administration.os.linux",{defaultMessage:"Linux"})}},515:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return AdvancedPolicyForms}));var external_kbnSharedDeps_React_=__webpack_require__(6);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var lib=__webpack_require__(105);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(72);var external_kbnSharedDeps_Lodash_=__webpack_require__(19);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(74);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);var selectors=__webpack_require__(172);var policy_hooks=__webpack_require__(215);const AdvancedPolicySchema=[{key:"linux.advanced.agent.connection_delay",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.agent.connection_delay",{defaultMessage:"How long to wait for agent connectivity before sending first policy reply, in seconds. Default: 60."})},{key:"linux.advanced.artifacts.global.base_url",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.base_url",{defaultMessage:"Base URL from which to download global artifact manifests. Default: https://artifacts.security.elastic.co."})},{key:"linux.advanced.artifacts.global.manifest_relative_url",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.manifest_relative_url",{defaultMessage:"Relative URL from which to download global artifact manifests. Default: /downloads/endpoint/manifest/artifacts-<version>.zip."})},{key:"linux.advanced.artifacts.global.public_key",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.public_key",{defaultMessage:"PEM-encoded public key used to verify the global artifact manifest signature."})},{key:"linux.advanced.artifacts.global.interval",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.interval",{defaultMessage:"Interval between global artifact manifest download attempts, in seconds. Default: 3600."})},{key:"linux.advanced.artifacts.user.public_key",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.user.public_key",{defaultMessage:"PEM-encoded public key used to verify the user artifact manifest signature."})},{key:"linux.advanced.elasticsearch.delay",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.delay",{defaultMessage:"Delay for sending events to Elasticsearch, in seconds. Default: 120."})},{key:"linux.advanced.elasticsearch.tls.verify_peer",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.tls.verify_peer",{defaultMessage:"Whether to verify the certificates presented by the peer. Default: true."})},{key:"linux.advanced.elasticsearch.tls.verify_hostname",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.tls.verify_hostname",{defaultMessage:"Whether to verify the hostname of the peer is what's in the certificate. Default: true."})},{key:"linux.advanced.elasticsearch.tls.ca_cert",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.tls.ca_cert",{defaultMessage:"PEM-encoded certificate for Elasticsearch certificate authority."})},{key:"linux.advanced.logging.file",first_supported_version:"7.11",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.logging.file",{defaultMessage:"A supplied value will override the log level configured for logs that are saved to disk and streamed to Elasticsearch. It is recommended Fleet be used to change this logging in most circumstances. Allowed values are error, warning, info, debug, and trace."})},{key:"linux.advanced.logging.syslog",first_supported_version:"7.11",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.logging.syslog",{defaultMessage:"A supplied value will configure logging to syslog. Allowed values are error, warning, info, debug, and trace."})},{key:"mac.advanced.agent.connection_delay",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.agent.connection_delay",{defaultMessage:"How long to wait for agent connectivity before sending first policy reply, in seconds. Default: 60."})},{key:"mac.advanced.artifacts.global.base_url",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.base_url",{defaultMessage:"URL from which to download global artifact manifests."})},{key:"mac.advanced.artifacts.global.manifest_relative_url",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.manifest_relative_url",{defaultMessage:"Relative URL from which to download global artifact manifests. Default: /downloads/endpoint/manifest/artifacts-<version>.zip."})},{key:"mac.advanced.artifacts.global.public_key",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.public_key",{defaultMessage:"PEM-encoded public key used to verify the global artifact manifest signature."})},{key:"mac.advanced.artifacts.global.interval",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.interval",{defaultMessage:"Interval between global artifact manifest download attempts, in seconds. Default: 3600."})},{key:"mac.advanced.artifacts.user.public_key",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.user.public_key",{defaultMessage:"PEM-encoded public key used to verify the user artifact manifest signature."})},{key:"mac.advanced.elasticsearch.delay",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.delay",{defaultMessage:"Delay for sending events to Elasticsearch, in seconds. Default: 120."})},{key:"mac.advanced.elasticsearch.tls.verify_peer",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.tls.verify_peer",{defaultMessage:"Whether to verify the certificates presented by the peer. Default: true."})},{key:"mac.advanced.elasticsearch.tls.verify_hostname",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.tls.verify_hostname",{defaultMessage:"Whether to verify the hostname of the peer is what's in the certificate. Default: true."})},{key:"mac.advanced.elasticsearch.tls.ca_cert",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.tls.ca_cert",{defaultMessage:"PEM-encoded certificate for Elasticsearch certificate authority."})},{key:"mac.advanced.logging.file",first_supported_version:"7.11",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.logging.file",{defaultMessage:"A supplied value will override the log level configured for logs that are saved to disk and streamed to Elasticsearch. It is recommended Fleet be used to change this logging in most circumstances. Allowed values are error, warning, info, debug, and trace."})},{key:"mac.advanced.logging.syslog",first_supported_version:"7.11",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.logging.syslog",{defaultMessage:"A supplied value will configure logging to syslog. Allowed values are error, warning, info, debug, and trace."})},{key:"mac.advanced.malware.quarantine",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.malware.quarantine",{defaultMessage:"Whether quarantine should be enabled when malware prevention is enabled. Default: true."})},{key:"mac.advanced.malware.threshold",first_supported_version:"7.11",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.malware.threshold",{defaultMessage:"The threshold that should be used for evaluating malware. Allowed values are normal, conservative, and aggressive. Default: normal."})},{key:"mac.advanced.kernel.connect",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.connect",{defaultMessage:"Whether to connect to the kernel driver. Default: true."})},{key:"mac.advanced.kernel.process",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.process",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel process events. Default: true."})},{key:"mac.advanced.kernel.filewrite",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.filewrite",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel file write events. Default: true."})},{key:"mac.advanced.kernel.network",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.network",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel network events. Default: true."})},{key:"mac.advanced.harden.self_protect",first_supported_version:"7.11",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.harden.self_protect",{defaultMessage:"Enables self-protection on macOS. Default: true."})},{key:"windows.advanced.agent.connection_delay",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.agent.connection_delay",{defaultMessage:"How long to wait for agent connectivity before sending first policy reply, in seconds. Default: 60."})},{key:"windows.advanced.artifacts.global.base_url",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.base_url",{defaultMessage:"URL from which to download global artifact manifests."})},{key:"windows.advanced.artifacts.global.manifest_relative_url",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.manifest_relative_url",{defaultMessage:"Relative URL from which to download global artifact manifests. Default: /downloads/endpoint/manifest/artifacts-<version>.zip."})},{key:"windows.advanced.artifacts.global.public_key",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.public_key",{defaultMessage:"PEM-encoded public key used to verify the global artifact manifest signature."})},{key:"windows.advanced.artifacts.global.interval",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.interval",{defaultMessage:"Interval between global artifact manifest download attempts, in seconds. Default: 3600."})},{key:"windows.advanced.artifacts.user.public_key",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.user.public_key",{defaultMessage:"PEM-encoded public key used to verify the user artifact manifest signature."})},{key:"windows.advanced.elasticsearch.delay",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.delay",{defaultMessage:"Delay for sending events to Elasticsearch, in seconds. Default: 120."})},{key:"windows.advanced.elasticsearch.tls.verify_peer",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.tls.verify_peer",{defaultMessage:"Whether to verify the certificates presented by the peer. Default: true."})},{key:"windows.advanced.elasticsearch.tls.verify_hostname",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.tls.verify_hostname",{defaultMessage:"Whether to verify the hostname of the peer is what's in the certificate. Default: true."})},{key:"windows.advanced.elasticsearch.tls.ca_cert",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.tls.ca_cert",{defaultMessage:"PEM-encoded certificate for Elasticsearch certificate authority."})},{key:"windows.advanced.logging.file",first_supported_version:"7.11",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.logging.file",{defaultMessage:"A supplied value will override the log level configured for logs that are saved to disk and streamed to Elasticsearch. It is recommended Fleet be used to change this logging in most circumstances. Allowed values are error, warning, info, debug, and trace."})},{key:"windows.advanced.logging.debugview",first_supported_version:"7.11",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.logging.debugview",{defaultMessage:"A supplied value will configure logging to Debugview (a Sysinternals tool). Allowed values are error, warning, info, debug, and trace."})},{key:"windows.advanced.malware.quarantine",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.malware.quarantine",{defaultMessage:"Whether quarantine should be enabled when malware prevention is enabled. Default: true."})},{key:"windows.advanced.malware.threshold",first_supported_version:"7.11",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.malware.threshold",{defaultMessage:"The threshold that should be used for evaluating malware. Allowed values are normal, conservative, and aggressive. Default: normal."})},{key:"windows.advanced.kernel.connect",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.connect",{defaultMessage:"Whether to connect to the kernel driver. Default: true."})},{key:"windows.advanced.kernel.process",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.process",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel process events. Default: true."})},{key:"windows.advanced.kernel.filewrite",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.filewrite",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel file write events. Default: true."})},{key:"windows.advanced.kernel.network",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.network",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel network events. Default: true."})},{key:"windows.advanced.kernel.fileopen",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.fileopen",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel file open events. Default: true."})},{key:"windows.advanced.kernel.asyncimageload",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.asyncimageload",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel async image load events. Default: true."})},{key:"windows.advanced.kernel.syncimageload",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.syncimageload",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel sync image load events. Default: true."})},{key:"windows.advanced.kernel.registry",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.registry",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel registry events. Default: true."})},{key:"windows.advanced.diagnostic.enabled",first_supported_version:"7.11",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.diagnostic.enabled",{defaultMessage:"A value of 'false' disables running diagnostic features on Endpoint. Default: true."})},{key:"linux.advanced.diagnostic.enabled",first_supported_version:"7.12",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.diagnostic.enabled",{defaultMessage:"A value of 'false' disables running diagnostic features on Endpoint. Default: true."})},{key:"mac.advanced.diagnostic.enabled",first_supported_version:"7.12",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.diagnostic.enabled",{defaultMessage:"A value of 'false' disables running diagnostic features on Endpoint. Default: true."})},{key:"windows.advanced.alerts.cloud_lookup",first_supported_version:"7.12",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.alerts.cloud_lookup",{defaultMessage:"A value of 'false' disables cloud lookup for Windows alerts. Default: true."})},{key:"mac.advanced.alerts.cloud_lookup",first_supported_version:"7.12",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.alerts.cloud_lookup",{defaultMessage:"A value of 'false' disables cloud lookup for Mac alerts. Default: true."})},{key:"windows.advanced.ransomware.mbr",first_supported_version:"7.12",documentation:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.ransomware.mbr",{defaultMessage:"A value of 'false' disables Ransomware MBR protection. Default: true."})}];function setValue(obj,value,path){let newPolicyConfig=obj;for(let i=0;i<path.length-1;i++){if(!newPolicyConfig[path[i]]){newPolicyConfig[path[i]]={}}newPolicyConfig=newPolicyConfig[path[i]]}newPolicyConfig[path[path.length-1]]=value;if(value===""||value===undefined){newPolicyConfig=obj;for(let k=path.length;k>=0;k--){const nextPath=path.slice(0,k);for(let i=0;i<nextPath.length-1;i++){newPolicyConfig=newPolicyConfig[nextPath[i]]}if(newPolicyConfig[nextPath[nextPath.length-1]]===undefined||newPolicyConfig[nextPath[nextPath.length-1]]===""||Object.keys(newPolicyConfig[nextPath[nextPath.length-1]]).length===0){if(nextPath[nextPath.length-1]==="advanced"){newPolicyConfig[nextPath[nextPath.length-1]]=undefined}else{delete newPolicyConfig[nextPath[nextPath.length-1]]}newPolicyConfig=obj}else{break}}}}function getValue(obj,path){let currentPolicyConfig=obj;for(let i=0;i<path.length-1;i++){if(currentPolicyConfig[path[i]]){currentPolicyConfig=currentPolicyConfig[path[i]]}else{return undefined}}return currentPolicyConfig[path[path.length-1]]}const calloutTitle=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.calloutTitle",{defaultMessage:"Proceed with caution!"});const warningMessage=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.advanced.warningMessage",{defaultMessage:`This section contains policy values that support advanced use cases. If not configured\n    properly, these values can cause unpredictable behavior. Please consult documentation\n    carefully or contact support before editing these values.`});const AdvancedPolicyForms=external_kbnSharedDeps_React_default.a.memo(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:calloutTitle,color:"warning",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("p",null,warningMessage)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policy.advanced",defaultMessage:"Advanced settings"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],{"data-test-subj":"advancedPolicyPanel",paddingSize:"s"},AdvancedPolicySchema.map((advancedField,index)=>{const configPath=advancedField.key.split(".");return external_kbnSharedDeps_React_default.a.createElement(PolicyAdvanced,{key:index,configPath:configPath,firstSupportedVersion:advancedField.first_supported_version,lastSupportedVersion:advancedField.last_supported_version,documentation:advancedField.documentation})}))));AdvancedPolicyForms.displayName="AdvancedPolicyForms";const PolicyAdvanced=external_kbnSharedDeps_React_default.a.memo(({configPath:configPath,firstSupportedVersion:firstSupportedVersion,lastSupportedVersion:lastSupportedVersion,documentation:documentation})=>{const dispatch=Object(lib["useDispatch"])();const policyDetailsConfig=Object(policy_hooks["a"])(selectors["i"]);const onChange=Object(external_kbnSharedDeps_React_["useCallback"])(event=>{if(policyDetailsConfig){const newPayload=Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(policyDetailsConfig);setValue(newPayload,event.target.value,configPath);dispatch({type:"userChangedPolicyConfig",payload:{policyConfig:newPayload}})}},[dispatch,policyDetailsConfig,configPath]);const value=policyDetailsConfig&&getValue(policyDetailsConfig,configPath);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,configPath.join(".")),documentation&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{content:documentation,position:"right"}))),labelAppend:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},lastSupportedVersion?`${firstSupportedVersion}-${lastSupportedVersion}`:`${firstSupportedVersion}+`)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{"data-test-subj":configPath.join("."),fullWidth:true,value:value,onChange:onChange})))});PolicyAdvanced.displayName="PolicyAdvanced"},748:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return PolicyDetailsForm}));var external_kbnSharedDeps_ElasticEui_=__webpack_require__(72);var external_kbnSharedDeps_React_=__webpack_require__(6);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(74);var lib=__webpack_require__(105);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);var external_kbnSharedDeps_Lodash_=__webpack_require__(19);var external_kbnSharedDeps_StyledComponents_=__webpack_require__(73);var external_kbnSharedDeps_StyledComponents_default=__webpack_require__.n(external_kbnSharedDeps_StyledComponents_);var constants=__webpack_require__(2);var types=__webpack_require__(3);var endpoint_types=__webpack_require__(39);let OS;(function(OS){OS["windows"]="windows";OS["mac"]="mac";OS["linux"]="linux"})(OS||(OS={}));var translations=__webpack_require__(316);const TITLES={type:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policyDetailType",{defaultMessage:"Type"}),os:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policyDetailOS",{defaultMessage:"Operating System"})};const ConfigFormHeading=Object(external_kbnSharedDeps_React_["memo"])(({children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xxs"},external_kbnSharedDeps_React_default.a.createElement("h5",null,children)));ConfigFormHeading.displayName="ConfigFormHeading";const ConfigForm=Object(external_kbnSharedDeps_React_["memo"])(({type:type,supportedOss:supportedOss,osRestriction:osRestriction,dataTestSubj:dataTestSubj,rightCorner:rightCorner,children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],{"data-test-subj":dataTestSubj},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"row",gutterSize:"none",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:2},external_kbnSharedDeps_React_default.a.createElement(ConfigFormHeading,null,TITLES.type),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"m"},type)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:2},external_kbnSharedDeps_React_default.a.createElement(ConfigFormHeading,null,TITLES.os),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"row",gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,supportedOss.map(os=>translations["c"][os]).join(", ")," ")),osRestriction&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"row",gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTextColor"],{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policy.details.antivirusRegistration.osRestriction",defaultMessage:"Restrictions"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{type:"iInCircle",color:"subdued",content:osRestriction})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiShowFor"],{sizes:["m","l","xl"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:3},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"row",gutterSize:"none",justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},rightCorner)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiShowFor"],{sizes:rightCorner?["s","xs"]:[]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,rightCorner))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"m"}),children));ConfigForm.displayName="ConfigForm";var selectors=__webpack_require__(172);var policy_hooks=__webpack_require__(215);var link_to_app=__webpack_require__(276);var use_license=__webpack_require__(33);const popupVersions=[["malware","7.11+"],["ransomware","7.12+"]];const popupVersionsMap=new Map(popupVersions);const SupportedVersionNotice=({optionName:optionName})=>{const version=popupVersionsMap.get(optionName);if(!version){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"xs"},external_kbnSharedDeps_React_default.a.createElement("i",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policyDetails.supportedVersion",defaultMessage:"Agent version {version}",values:{version:version}})))};const RadioFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"RadioFlexGroup",componentId:"sc-1mldcfa-0"})([".no-right-margin-radio{margin-right:0;}.no-horizontal-margin-radio{margin:"," 0;}"],props=>props.theme.eui.ruleMargins.marginSmall);const OSes=[OS.windows,OS.mac];const protection="malware";const ProtectionRadio=external_kbnSharedDeps_React_default.a.memo(({protectionMode:protectionMode,label:label})=>{const policyDetailsConfig=Object(policy_hooks["a"])(selectors["i"]);const dispatch=Object(lib["useDispatch"])();const radioButtonId=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])()(),[]);const selected=policyDetailsConfig&&policyDetailsConfig.windows.malware.mode;const isPlatinumPlus=Object(use_license["b"])().isPlatinumPlus();const handleRadioChange=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(policyDetailsConfig){const newPayload=Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(policyDetailsConfig);for(const os of OSes){newPayload[os][protection].mode=protectionMode;if(isPlatinumPlus){if(protectionMode===endpoint_types["f"].prevent){newPayload[os].popup[protection].enabled=true}else{newPayload[os].popup[protection].enabled=false}}}dispatch({type:"userChangedPolicyConfig",payload:{policyConfig:newPayload}})}},[dispatch,protectionMode,policyDetailsConfig,isPlatinumPlus]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiRadio"],{className:"policyDetailsProtectionRadio",label:label,id:radioButtonId,checked:selected===protectionMode,onChange:handleRadioChange,disabled:selected===endpoint_types["f"].off})});ProtectionRadio.displayName="ProtectionRadio";const MalwareProtections=external_kbnSharedDeps_React_default.a.memo(()=>{const policyDetailsConfig=Object(policy_hooks["a"])(selectors["i"]);const dispatch=Object(lib["useDispatch"])();const selected=policyDetailsConfig&&policyDetailsConfig.windows.malware.mode;const userNotificationSelected=policyDetailsConfig&&policyDetailsConfig.windows.popup.malware.enabled;const userNotificationMessage=policyDetailsConfig&&policyDetailsConfig.windows.popup.malware.message;const isPlatinumPlus=Object(use_license["b"])().isPlatinumPlus();const radios=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[{id:endpoint_types["f"].detect,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.details.detect",{defaultMessage:"Detect"}),protection:"malware"},{id:endpoint_types["f"].prevent,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.details.prevent",{defaultMessage:"Prevent"}),protection:"malware"}],[]);const handleSwitchChange=Object(external_kbnSharedDeps_React_["useCallback"])(event=>{if(policyDetailsConfig){const newPayload=Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(policyDetailsConfig);if(event.target.checked===false){for(const os of OSes){newPayload[os][protection].mode=endpoint_types["f"].off;if(isPlatinumPlus){newPayload[os].popup[protection].enabled=event.target.checked}}}else{for(const os of OSes){newPayload[os][protection].mode=endpoint_types["f"].prevent;if(isPlatinumPlus){newPayload[os].popup[protection].enabled=event.target.checked}}}dispatch({type:"userChangedPolicyConfig",payload:{policyConfig:newPayload}})}},[dispatch,policyDetailsConfig,isPlatinumPlus]);const handleUserNotificationCheckbox=Object(external_kbnSharedDeps_React_["useCallback"])(event=>{if(policyDetailsConfig){const newPayload=Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(policyDetailsConfig);for(const os of OSes){newPayload[os].popup[protection].enabled=event.target.checked}dispatch({type:"userChangedPolicyConfig",payload:{policyConfig:newPayload}})}},[policyDetailsConfig,dispatch]);const handleCustomUserNotification=Object(external_kbnSharedDeps_React_["useCallback"])(event=>{if(policyDetailsConfig){const newPayload=Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(policyDetailsConfig);for(const os of OSes){newPayload[os].popup[protection].message=event.target.value}dispatch({type:"userChangedPolicyConfig",payload:{policyConfig:newPayload}})}},[policyDetailsConfig,dispatch]);const radioButtons=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ConfigFormHeading,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policyDetailsConfig.protectionLevel",defaultMessage:"Protection Level"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(RadioFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{className:"no-right-margin-radio",grow:2},external_kbnSharedDeps_React_default.a.createElement(ProtectionRadio,{protectionMode:radios[0].id,key:radios[0].protection+radios[0].id,label:radios[0].label})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{className:"no-horizontal-margin-radio",grow:5},external_kbnSharedDeps_React_default.a.createElement(ProtectionRadio,{protectionMode:radios[1].id,key:radios[1].protection+radios[1].id,label:radios[1].label}))),isPlatinumPlus&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(ConfigFormHeading,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policyDetailsConfig.userNotification",defaultMessage:"User Notification"})),external_kbnSharedDeps_React_default.a.createElement(SupportedVersionNotice,{optionName:"malware"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCheckbox"],{"data-test-subj":"malwareUserNotificationCheckbox",id:"xpack.securitySolution.endpoint.policyDetail.malware.userNotification",onChange:handleUserNotificationCheckbox,checked:userNotificationSelected,disabled:selected===endpoint_types["f"].off,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policyDetail.malware.notifyUser",{defaultMessage:"Notify User"})})),isPlatinumPlus&&userNotificationSelected&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policyDetailsConfig.customizeUserNotification",defaultMessage:"Customize notification message"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{position:"right","data-test-subj":"malwareTooltip",content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policyDetailsConfig.malware.notifyUserTooltip.a",defaultMessage:"Selecting the user notification option will display a notification to the host user when malware is prevented or detected."}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policyDetailsConfig.malware.notifyUserTooltip.b",defaultMessage:" The user notification can be customized in the text box below. Bracketed tags can be used to dynamically populate the applicable action (such as prevented or detected) and the filename."}))}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTextArea"],{placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policyDetails.malware.userNotification.placeholder",{defaultMessage:"Input your custom notification message"}),value:userNotificationMessage,onChange:handleCustomUserNotification,fullWidth:true,"data-test-subj":"malwareUserNotificationCustomMessage"}))),[radios,selected,isPlatinumPlus,handleUserNotificationCheckbox,userNotificationSelected,userNotificationMessage,handleCustomUserNotification]);const protectionSwitch=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.details.malwareProtectionsEnabled",{defaultMessage:"Malware protections {mode, select, true {enabled} false {disabled}}",values:{mode:selected!==endpoint_types["f"].off}}),checked:selected!==endpoint_types["f"].off,onChange:handleSwitchChange}),[handleSwitchChange,selected]);return external_kbnSharedDeps_React_default.a.createElement(ConfigForm,{type:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.details.malware",{defaultMessage:"Malware"}),supportedOss:[endpoint_types["e"].WINDOWS,endpoint_types["e"].MAC],dataTestSubj:"malwareProtectionsForm",rightCorner:protectionSwitch},radioButtons,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{iconType:"iInCircle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesMessage",defaultMessage:"View {detectionRulesLink}. Prebuilt rules are tagged “Elastic” on the Detection Rules page.",values:{detectionRulesLink:external_kbnSharedDeps_React_default.a.createElement(link_to_app["a"],{appId:`${constants["f"]}:${types["a"].detections}`,appPath:`/rules`},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesLink",defaultMessage:"related detection rules"}))}})))});MalwareProtections.displayName="MalwareProtections";const getIn=a=>key=>subKey=>leafKey=>a[key][subKey][leafKey];const setIn=a=>key=>subKey=>leafKey=>v=>{const c=Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(a);c[key][subKey][leafKey]=v;return c};const OPERATING_SYSTEM_TO_TEST_SUBJ={[endpoint_types["e"].WINDOWS]:"Windows",[endpoint_types["e"].LINUX]:"Linux",[endpoint_types["e"].MAC]:"Mac"};const countSelected=selection=>Object.values(selection).filter(value=>value).length;const EventsForm=({os:os,options:options,selection:selection,onValueSelection:onValueSelection})=>external_kbnSharedDeps_React_default.a.createElement(ConfigForm,{type:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.details.eventCollection",{defaultMessage:"Event Collection"}),supportedOss:[os],rightCorner:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s",color:"subdued"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.details.eventCollectionsEnabled",{defaultMessage:"{selected} / {total} event collections enabled",values:{selected:countSelected(selection),total:options.length}}))},external_kbnSharedDeps_React_default.a.createElement(ConfigFormHeading,null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policyDetailsConfig.eventingEvents",{defaultMessage:"Events"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),options.map(({name:name,protectionField:protectionField})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCheckbox"],{key:String(protectionField),id:Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])()(),label:name,"data-test-subj":`policy${OPERATING_SYSTEM_TO_TEST_SUBJ[os]}Event_${protectionField}`,checked:selection[protectionField],onChange:event=>onValueSelection(protectionField,event.target.checked)})));EventsForm.displayName="EventsForm";const OPTIONS=[{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.dllDriverLoad",{defaultMessage:"DLL and Driver Load"}),protectionField:"dll_and_driver_load"},{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.dns",{defaultMessage:"DNS"}),protectionField:"dns"},{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.file",{defaultMessage:"File"}),protectionField:"file"},{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.network",{defaultMessage:"Network"}),protectionField:"network"},{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.process",{defaultMessage:"Process"}),protectionField:"process"},{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.registry",{defaultMessage:"Registry"}),protectionField:"registry"},{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.security",{defaultMessage:"Security"}),protectionField:"security"}];const WindowsEvents=Object(external_kbnSharedDeps_React_["memo"])(()=>{const policyDetailsConfig=Object(policy_hooks["a"])(selectors["i"]);const dispatch=Object(lib["useDispatch"])();return external_kbnSharedDeps_React_default.a.createElement(EventsForm,{os:endpoint_types["e"].WINDOWS,selection:policyDetailsConfig.windows.events,options:OPTIONS,onValueSelection:(value,selected)=>dispatch({type:"userChangedPolicyConfig",payload:{policyConfig:setIn(policyDetailsConfig)("windows")("events")(value)(selected)}})})});WindowsEvents.displayName="WindowsEvents";const mac_OPTIONS=[{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policyDetailsConfig.mac.events.file",{defaultMessage:"File"}),protectionField:"file"},{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policyDetailsConfig.mac.events.process",{defaultMessage:"Process"}),protectionField:"process"},{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policyDetailsConfig.mac.events.network",{defaultMessage:"Network"}),protectionField:"network"}];const MacEvents=Object(external_kbnSharedDeps_React_["memo"])(()=>{const policyDetailsConfig=Object(policy_hooks["a"])(selectors["i"]);const dispatch=Object(lib["useDispatch"])();return external_kbnSharedDeps_React_default.a.createElement(EventsForm,{os:endpoint_types["e"].MAC,selection:policyDetailsConfig.mac.events,options:mac_OPTIONS,onValueSelection:(value,selected)=>dispatch({type:"userChangedPolicyConfig",payload:{policyConfig:setIn(policyDetailsConfig)("mac")("events")(value)(selected)}})})});MacEvents.displayName="MacEvents";const linux_OPTIONS=[{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.file",{defaultMessage:"File"}),protectionField:"file"},{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.process",{defaultMessage:"Process"}),protectionField:"process"},{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.network",{defaultMessage:"Network"}),protectionField:"network"}];const LinuxEvents=Object(external_kbnSharedDeps_React_["memo"])(()=>{const policyDetailsConfig=Object(policy_hooks["a"])(selectors["i"]);const dispatch=Object(lib["useDispatch"])();return external_kbnSharedDeps_React_default.a.createElement(EventsForm,{os:endpoint_types["e"].LINUX,selection:policyDetailsConfig.linux.events,options:linux_OPTIONS,onValueSelection:(value,selected)=>dispatch({type:"userChangedPolicyConfig",payload:{policyConfig:setIn(policyDetailsConfig)("linux")("events")(value)(selected)}})})});LinuxEvents.displayName="LinuxEvents";var policy_advanced=__webpack_require__(515);const TRANSLATIONS={title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.type",{defaultMessage:"Register as antivirus"}),description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.explanation",{defaultMessage:"Toggle on to register Elastic as an official Antivirus solution for Windows OS. "+"This will also disable Windows Defender."}),label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.toggle",{defaultMessage:"Register as antivirus"})};const AntivirusRegistrationForm=Object(external_kbnSharedDeps_React_["memo"])(()=>{const antivirusRegistrationEnabled=Object(policy_hooks["a"])(selectors["e"]);const dispatch=Object(lib["useDispatch"])();const handleSwitchChange=Object(external_kbnSharedDeps_React_["useCallback"])(event=>dispatch({type:"userChangedAntivirusRegistration",payload:{enabled:event.target.checked}}),[dispatch]);return external_kbnSharedDeps_React_default.a.createElement(ConfigForm,{type:TRANSLATIONS.title,supportedOss:[endpoint_types["e"].WINDOWS],osRestriction:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.details.av.windowsServerNotSupported",{defaultMessage:"Windows Server operating systems unsupported"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},TRANSLATIONS.description),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{label:TRANSLATIONS.label,checked:antivirusRegistrationEnabled,onChange:handleSwitchChange}))});AntivirusRegistrationForm.displayName="AntivirusRegistrationForm";const ransomware_OSes=[OS.windows];const ransomware_protection="ransomware";const ransomware_ProtectionRadio=external_kbnSharedDeps_React_default.a.memo(({protectionMode:protectionMode,label:label})=>{const policyDetailsConfig=Object(policy_hooks["a"])(selectors["i"]);const dispatch=Object(lib["useDispatch"])();const radioButtonId=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])()(),[]);const selected=policyDetailsConfig&&policyDetailsConfig.windows.ransomware.mode;const handleRadioChange=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(policyDetailsConfig){const newPayload=Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(policyDetailsConfig);for(const os of ransomware_OSes){newPayload[os][ransomware_protection].mode=protectionMode;if(protectionMode===endpoint_types["f"].prevent){newPayload[os].popup[ransomware_protection].enabled=true}else{newPayload[os].popup[ransomware_protection].enabled=false}}dispatch({type:"userChangedPolicyConfig",payload:{policyConfig:newPayload}})}},[dispatch,protectionMode,policyDetailsConfig]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiRadio"],{className:"policyDetailsProtectionRadio",label:label,id:radioButtonId,checked:selected===protectionMode,onChange:handleRadioChange,disabled:selected===endpoint_types["f"].off})});ransomware_ProtectionRadio.displayName="ProtectionRadio";const Ransomware=external_kbnSharedDeps_React_default.a.memo(()=>{const policyDetailsConfig=Object(policy_hooks["a"])(selectors["i"]);const dispatch=Object(lib["useDispatch"])();const selected=policyDetailsConfig&&policyDetailsConfig.windows.ransomware.mode;const userNotificationSelected=policyDetailsConfig&&policyDetailsConfig.windows.popup.ransomware.enabled;const userNotificationMessage=policyDetailsConfig&&policyDetailsConfig.windows.popup.ransomware.message;const radios=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[{id:endpoint_types["f"].detect,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.details.detect",{defaultMessage:"Detect"}),protection:"ransomware"},{id:endpoint_types["f"].prevent,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.details.prevent",{defaultMessage:"Prevent"}),protection:"ransomware"}],[]);const handleSwitchChange=Object(external_kbnSharedDeps_React_["useCallback"])(event=>{if(policyDetailsConfig){const newPayload=Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(policyDetailsConfig);if(event.target.checked===false){for(const os of ransomware_OSes){newPayload[os][ransomware_protection].mode=endpoint_types["f"].off;newPayload[os].popup[ransomware_protection].enabled=event.target.checked}}else{for(const os of ransomware_OSes){newPayload[os][ransomware_protection].mode=endpoint_types["f"].prevent;newPayload[os].popup[ransomware_protection].enabled=event.target.checked}}dispatch({type:"userChangedPolicyConfig",payload:{policyConfig:newPayload}})}},[dispatch,policyDetailsConfig]);const handleUserNotificationCheckbox=Object(external_kbnSharedDeps_React_["useCallback"])(event=>{if(policyDetailsConfig){const newPayload=Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(policyDetailsConfig);for(const os of ransomware_OSes){newPayload[os].popup[ransomware_protection].enabled=event.target.checked}dispatch({type:"userChangedPolicyConfig",payload:{policyConfig:newPayload}})}},[policyDetailsConfig,dispatch]);const handleCustomUserNotification=Object(external_kbnSharedDeps_React_["useCallback"])(event=>{if(policyDetailsConfig){const newPayload=Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(policyDetailsConfig);for(const os of ransomware_OSes){newPayload[os].popup[ransomware_protection].message=event.target.value}dispatch({type:"userChangedPolicyConfig",payload:{policyConfig:newPayload}})}},[policyDetailsConfig,dispatch]);const radioButtons=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ConfigFormHeading,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policyDetailsConfig.protectionLevel",defaultMessage:"Protection Level"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(RadioFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{className:"no-right-margin-radio",grow:2},external_kbnSharedDeps_React_default.a.createElement(ransomware_ProtectionRadio,{protectionMode:radios[0].id,key:radios[0].protection+radios[0].id,label:radios[0].label})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{className:"no-horizontal-margin-radio",grow:5},external_kbnSharedDeps_React_default.a.createElement(ransomware_ProtectionRadio,{protectionMode:radios[1].id,key:radios[1].protection+radios[1].id,label:radios[1].label}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(ConfigFormHeading,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policyDetailsConfig.userNotification",defaultMessage:"User Notification"})),external_kbnSharedDeps_React_default.a.createElement(SupportedVersionNotice,{optionName:"ransomware"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCheckbox"],{"data-test-subj":"ransomwareUserNotificationCheckbox",id:"xpack.securitySolution.endpoint.policyDetail.ransomware.userNotification",onChange:handleUserNotificationCheckbox,checked:userNotificationSelected,disabled:selected===endpoint_types["f"].off,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policyDetail.ransomware.notifyUser",{defaultMessage:"Notify User"})}),userNotificationSelected&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policyDetailsConfig.customizeUserNotification",defaultMessage:"Customize notification message"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{position:"right","data-test-subj":"ransomwareTooltip",content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policyDetailsConfig.ransomware.notifyUserTooltip.a",defaultMessage:"Selecting the user notification option will display a notification to the host user when ransomware is prevented or detected."}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policyDetailsConfig.ransomware.notifyUserTooltip.b",defaultMessage:" The user notification can be customized in the text box below. Bracketed tags can be used to dynamically populate the applicable action (such as prevented or detected) and the filename."}))}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTextArea"],{placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policyDetails.ransomware.userNotification.placeholder",{defaultMessage:"Input your custom notification message"}),value:userNotificationMessage,onChange:handleCustomUserNotification,fullWidth:true,"data-test-subj":"ransomwareUserNotificationCustomMessage"}))),[radios,selected,handleUserNotificationCheckbox,userNotificationSelected,userNotificationMessage,handleCustomUserNotification]);const protectionSwitch=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.details.ransomwareProtectionsEnabled",{defaultMessage:"Ransomware protections {mode, select, true {enabled} false {disabled}}",values:{mode:selected!==endpoint_types["f"].off}}),checked:selected!==endpoint_types["f"].off,onChange:handleSwitchChange}),[handleSwitchChange,selected]);return external_kbnSharedDeps_React_default.a.createElement(ConfigForm,{type:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.details.ransomware",{defaultMessage:"Ransomware"}),supportedOss:[endpoint_types["e"].WINDOWS],dataTestSubj:"ransomwareProtectionsForm",rightCorner:protectionSwitch},radioButtons,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{iconType:"iInCircle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesMessage",defaultMessage:"View {detectionRulesLink}. Prebuilt rules are tagged “Elastic” on the Detection Rules page.",values:{detectionRulesLink:external_kbnSharedDeps_React_default.a.createElement(link_to_app["a"],{appId:`${constants["f"]}:${types["a"].detections}`,appPath:`/rules`},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesLink",defaultMessage:"related detection rules"}))}})))});Ransomware.displayName="RansomwareProtections";const LockedPolicyDiv=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"LockedPolicyDiv",componentId:"pvk7p4-0"})([".euiCard__betaBadgeWrapper{.euiCard__betaBadge{width:auto;}}.lockedCardDescription{padding:0 ",";}"],props=>props.theme.eui.fractions.thirds.percentage);const LockedPolicyCard=Object(external_kbnSharedDeps_React_["memo"])(()=>external_kbnSharedDeps_React_default.a.createElement(LockedPolicyDiv,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCard"],{"data-test-subj":"lockedPolicyCard",betaBadgeLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.endpoint.policy.details.platinum",{defaultMessage:"Platinum"}),isDisabled:true,icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"xl",type:"lock"}),title:external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policy.details.ransomware",defaultMessage:"Ransomware"}))),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{className:"lockedCardDescription",direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTextColor"],{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policy.details.upgradeToPlatinum",defaultMessage:"Upgrade to Elastic Platinum"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policy.details.lockedCard",defaultMessage:"To turn on Ransomware protection, you must upgrade your license to Platinum, start a free 30-day trial, or spin up a {cloudDeploymentLink} on AWS, GCP, or Azure.",values:{cloudDeploymentLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:"https://www.elastic.co/cloud/",target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policy.details.cloudDeploymentLInk",defaultMessage:"cloud deployment"}))}}))))})));LockedPolicyCard.displayName="LockedPolicyCard";const PolicyDetailsForm=Object(external_kbnSharedDeps_React_["memo"])(()=>{const[showAdvancedPolicy,setShowAdvancedPolicy]=Object(external_kbnSharedDeps_React_["useState"])(false);const handleAdvancedPolicyClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setShowAdvancedPolicy(!showAdvancedPolicy)},[showAdvancedPolicy]);const isPlatinumPlus=Object(use_license["b"])().isPlatinumPlus();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policy.details.protections",defaultMessage:"Protections"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(MalwareProtections,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),isPlatinumPlus?external_kbnSharedDeps_React_default.a.createElement(Ransomware,null):external_kbnSharedDeps_React_default.a.createElement(LockedPolicyCard,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policy.details.settings",defaultMessage:"Settings"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(WindowsEvents,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(MacEvents,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(LinuxEvents,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(AntivirusRegistrationForm,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"advancedPolicyButton",onClick:handleAdvancedPolicyClick},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.endpoint.policy.advanced.show",defaultMessage:"{action} advanced settings",values:{action:showAdvancedPolicy?"Hide":"Show"}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),showAdvancedPolicy&&external_kbnSharedDeps_React_default.a.createElement(policy_advanced["a"],null))});PolicyDetailsForm.displayName="PolicyDetailsForm"}}]);