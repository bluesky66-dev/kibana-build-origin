(window["data_bundle_jsonpfunction"]=window["data_bundle_jsonpfunction"]||[]).push([[8],{243:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",(function(){return IndexPatternSelect}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2);var lodash__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__);var react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3);var react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);var _elastic_eui__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(13);var _elastic_eui__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_elastic_eui__WEBPACK_IMPORTED_MODULE_2__);function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class IndexPatternSelect extends react__WEBPACK_IMPORTED_MODULE_1__["Component"]{constructor(props){super(props);_defineProperty(this,"isMounted",false);_defineProperty(this,"state",void 0);_defineProperty(this,"fetchSelectedIndexPattern",async indexPatternId=>{if(!indexPatternId){this.setState({selectedIndexPattern:undefined});return}let indexPatternTitle;try{const indexPattern=await this.props.indexPatternService.get(indexPatternId);indexPatternTitle=indexPattern.title}catch(err){return}if(!this.isMounted){return}this.setState({selectedIndexPattern:{value:indexPatternId,label:indexPatternTitle}})});_defineProperty(this,"debouncedFetch",lodash__WEBPACK_IMPORTED_MODULE_0___default.a.debounce(async searchValue=>{const isCurrentSearch=()=>this.isMounted&&searchValue===this.state.searchValue;const idsAndTitles=await this.props.indexPatternService.getIdsWithTitle();if(!isCurrentSearch()){return}const options=[];for(let i=0;i<idsAndTitles.length;i++){if(!idsAndTitles[i].title.toLowerCase().includes(searchValue.toLowerCase())){continue}if(this.props.fieldTypes){try{const indexPattern=await this.props.indexPatternService.get(idsAndTitles[i].id);if(!isCurrentSearch()){return}const hasRequiredFieldTypes=indexPattern.fields.some(field=>this.props.fieldTypes.includes(field.type));if(!hasRequiredFieldTypes){continue}}catch(err){continue}}options.push({label:idsAndTitles[i].title,value:idsAndTitles[i].id});if(options.length>15){break}}this.setState({isLoading:false,options:options});if(this.props.onNoIndexPatterns&&searchValue===""&&options.length===0){this.props.onNoIndexPatterns()}},300));_defineProperty(this,"fetchOptions",(searchValue="")=>{this.setState({isLoading:true,searchValue:searchValue},this.debouncedFetch.bind(null,searchValue))});_defineProperty(this,"onChange",selectedOptions=>{this.props.onChange(lodash__WEBPACK_IMPORTED_MODULE_0___default.a.get(selectedOptions,"0.value"))});this.state={isLoading:false,options:[],selectedIndexPattern:undefined,searchValue:undefined}}componentWillUnmount(){this.isMounted=false;this.debouncedFetch.cancel()}componentDidMount(){this.isMounted=true;this.fetchOptions("");this.fetchSelectedIndexPattern(this.props.indexPatternId)}UNSAFE_componentWillReceiveProps(nextProps){if(nextProps.indexPatternId!==this.props.indexPatternId){this.fetchSelectedIndexPattern(nextProps.indexPatternId)}}render(){const{fieldTypes:fieldTypes,onChange:onChange,indexPatternId:indexPatternId,placeholder:placeholder,onNoIndexPatterns:onNoIndexPatterns,indexPatternService:indexPatternService,...rest}=this.props;return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_2__["EuiComboBox"],_extends({},rest,{placeholder:placeholder,singleSelection:true,isLoading:this.state.isLoading,onSearchChange:this.fetchOptions,options:this.state.options,selectedOptions:this.state.selectedIndexPattern?[this.state.selectedIndexPattern]:[],onChange:this.onChange}))}}}}]);