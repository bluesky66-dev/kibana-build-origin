(window["inputControlVis_bundle_jsonpfunction"]=window["inputControlVis_bundle_jsonpfunction"]||[]).push([[2],[,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";var isOldIE=function isOldIE(){var memo;return function memorize(){if(typeof memo==="undefined"){memo=Boolean(window&&document&&document.all&&!window.atob)}return memo}}();var getTarget=function getTarget(){var memo={};return function memorize(target){if(typeof memo[target]==="undefined"){var styleTarget=document.querySelector(target);if(window.HTMLIFrameElement&&styleTarget instanceof window.HTMLIFrameElement){try{styleTarget=styleTarget.contentDocument.head}catch(e){styleTarget=null}}memo[target]=styleTarget}return memo[target]}}();var stylesInDom=[];function getIndexByIdentifier(identifier){var result=-1;for(var i=0;i<stylesInDom.length;i++){if(stylesInDom[i].identifier===identifier){result=i;break}}return result}function modulesToDom(list,options){var idCountMap={};var identifiers=[];for(var i=0;i<list.length;i++){var item=list[i];var id=options.base?item[0]+options.base:item[0];var count=idCountMap[id]||0;var identifier="".concat(id," ").concat(count);idCountMap[id]=count+1;var index=getIndexByIdentifier(identifier);var obj={css:item[1],media:item[2],sourceMap:item[3]};if(index!==-1){stylesInDom[index].references++;stylesInDom[index].updater(obj)}else{stylesInDom.push({identifier:identifier,updater:addStyle(obj,options),references:1})}identifiers.push(identifier)}return identifiers}function insertStyleElement(options){var style=document.createElement("style");var attributes=options.attributes||{};if(typeof attributes.nonce==="undefined"){var nonce=true?__webpack_require__.nc:undefined;if(nonce){attributes.nonce=nonce}}Object.keys(attributes).forEach((function(key){style.setAttribute(key,attributes[key])}));if(typeof options.insert==="function"){options.insert(style)}else{var target=getTarget(options.insert||"head");if(!target){throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.")}target.appendChild(style)}return style}function removeStyleElement(style){if(style.parentNode===null){return false}style.parentNode.removeChild(style)}var replaceText=function replaceText(){var textStore=[];return function replace(index,replacement){textStore[index]=replacement;return textStore.filter(Boolean).join("\n")}}();function applyToSingletonTag(style,index,remove,obj){var css=remove?"":obj.media?"@media ".concat(obj.media," {").concat(obj.css,"}"):obj.css;if(style.styleSheet){style.styleSheet.cssText=replaceText(index,css)}else{var cssNode=document.createTextNode(css);var childNodes=style.childNodes;if(childNodes[index]){style.removeChild(childNodes[index])}if(childNodes.length){style.insertBefore(cssNode,childNodes[index])}else{style.appendChild(cssNode)}}}function applyToTag(style,options,obj){var css=obj.css;var media=obj.media;var sourceMap=obj.sourceMap;if(media){style.setAttribute("media",media)}else{style.removeAttribute("media")}if(sourceMap&&btoa){css+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))," */")}if(style.styleSheet){style.styleSheet.cssText=css}else{while(style.firstChild){style.removeChild(style.firstChild)}style.appendChild(document.createTextNode(css))}}var singleton=null;var singletonCounter=0;function addStyle(obj,options){var style;var update;var remove;if(options.singleton){var styleIndex=singletonCounter++;style=singleton||(singleton=insertStyleElement(options));update=applyToSingletonTag.bind(null,style,styleIndex,false);remove=applyToSingletonTag.bind(null,style,styleIndex,true)}else{style=insertStyleElement(options);update=applyToTag.bind(null,style,options);remove=function remove(){removeStyleElement(style)}}update(obj);return function updateStyle(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap){return}update(obj=newObj)}else{remove()}}}module.exports=function(list,options){options=options||{};if(!options.singleton&&typeof options.singleton!=="boolean"){options.singleton=isOldIE()}list=list||[];var lastIdentifiers=modulesToDom(list,options);return function update(newList){newList=newList||[];if(Object.prototype.toString.call(newList)!=="[object Array]"){return}for(var i=0;i<lastIdentifiers.length;i++){var identifier=lastIdentifiers[i];var index=getIndexByIdentifier(identifier);stylesInDom[index].references--}var newLastIdentifiers=modulesToDom(newList,options);for(var _i=0;_i<lastIdentifiers.length;_i++){var _identifier=lastIdentifiers[_i];var _index=getIndexByIdentifier(_identifier);if(stylesInDom[_index].references===0){stylesInDom[_index].updater();stylesInDom.splice(_index,1)}}lastIdentifiers=newLastIdentifiers}}},function(module,exports,__webpack_require__){"use strict";module.exports=function(useSourceMap){var list=[];list.toString=function toString(){return this.map((function(item){var content=cssWithMappingToString(item,useSourceMap);if(item[2]){return"@media ".concat(item[2]," {").concat(content,"}")}return content})).join("")};list.i=function(modules,mediaQuery,dedupe){if(typeof modules==="string"){modules=[[null,modules,""]]}var alreadyImportedModules={};if(dedupe){for(var i=0;i<this.length;i++){var id=this[i][0];if(id!=null){alreadyImportedModules[id]=true}}}for(var _i=0;_i<modules.length;_i++){var item=[].concat(modules[_i]);if(dedupe&&alreadyImportedModules[item[0]]){continue}if(mediaQuery){if(!item[2]){item[2]=mediaQuery}else{item[2]="".concat(mediaQuery," and ").concat(item[2])}}list.push(item)}};return list};function cssWithMappingToString(item,useSourceMap){var content=item[1]||"";var cssMapping=item[3];if(!cssMapping){return content}if(useSourceMap&&typeof btoa==="function"){var sourceMapping=toComment(cssMapping);var sourceURLs=cssMapping.sources.map((function(source){return"/*# sourceURL=".concat(cssMapping.sourceRoot||"").concat(source," */")}));return[content].concat(sourceURLs).concat([sourceMapping]).join("\n")}return[content].join("\n")}function toComment(sourceMap){var base64=btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));var data="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(base64);return"/*# ".concat(data," */")}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return CONTROL_TYPES}));__webpack_require__.d(__webpack_exports__,"g",(function(){return setControl}));__webpack_require__.d(__webpack_exports__,"b",(function(){return addControl}));__webpack_require__.d(__webpack_exports__,"d",(function(){return moveControl}));__webpack_require__.d(__webpack_exports__,"f",(function(){return removeControl}));__webpack_require__.d(__webpack_exports__,"e",(function(){return newControl}));__webpack_require__.d(__webpack_exports__,"c",(function(){return getTitle}));const CONTROL_TYPES={LIST:"list",RANGE:"range"};const setControl=(controls,controlIndex,control)=>[...controls.slice(0,controlIndex),control,...controls.slice(controlIndex+1)];const addControl=(controls,control)=>[...controls,control];const moveControl=(controls,controlIndex,direction)=>{let newIndex;if(direction>=0){newIndex=controlIndex+1}else{newIndex=controlIndex-1}if(newIndex<0){return[...controls.slice(1),controls[0]]}else if(newIndex>=controls.length){const lastItemIndex=controls.length-1;return[controls[lastItemIndex],...controls.slice(0,lastItemIndex)]}else{const swapped=controls.slice();const temp=swapped[newIndex];swapped[newIndex]=swapped[controlIndex];swapped[controlIndex]=temp;return swapped}};const removeControl=(controls,controlIndex)=>[...controls.slice(0,controlIndex),...controls.slice(controlIndex+1)];const getDefaultOptions=type=>{const defaultOptions={};switch(type){case CONTROL_TYPES.RANGE:defaultOptions.decimalPlaces=0;defaultOptions.step=1;break;case CONTROL_TYPES.LIST:defaultOptions.type="terms";defaultOptions.multiselect=true;defaultOptions.dynamicOptions=true;defaultOptions.size=5;defaultOptions.order="desc";break}return defaultOptions};const newControl=type=>({id:(new Date).getTime().toString(),indexPattern:"",fieldName:"",parent:"",label:"",type:type,options:getDefaultOptions(type)});const getTitle=(controlParams,controlIndex)=>{let title=`${controlParams.type}: ${controlIndex}`;if(controlParams.label){title=`${controlParams.label}`}else if(controlParams.fieldName){title=`${controlParams.fieldName}`}return title}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getLineageMap}));__webpack_require__.d(__webpack_exports__,"b",(function(){return getParentCandidates}));var external_kbnSharedDeps_Lodash_=__webpack_require__(7);var external_kbnSharedDeps_Lodash_default=__webpack_require__.n(external_kbnSharedDeps_Lodash_);function getLineageMap(controlParamsList){function getControlParamsById(controlId){return controlParamsList.find(controlParams=>controlParams.id===controlId)}const lineageMap=new Map;controlParamsList.forEach(rootControlParams=>{const lineage=[rootControlParams.id];const getLineage=controlParams=>{if(external_kbnSharedDeps_Lodash_default.a.has(controlParams,"parent")&&controlParams.parent!==""&&!lineage.includes(controlParams.parent)){lineage.push(controlParams.parent);const parent=getControlParamsById(controlParams.parent);if(parent){getLineage(parent)}}};getLineage(rootControlParams);lineageMap.set(rootControlParams.id,lineage)});return lineageMap}var editor_utils=__webpack_require__(15);function getParentCandidates(controlParamsList,controlId,lineageMap){return controlParamsList.filter(controlParams=>{if(!controlParams.indexPattern||!controlParams.fieldName){return false}const lineage=lineageMap.get(controlParams.id);if(lineage!==null&&lineage!==void 0&&lineage.includes(controlId)){return false}return true}).map((controlParams,controlIndex)=>({value:controlParams.id,text:Object(editor_utils["c"])(controlParams,controlIndex)}))}},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(18);case"v7light":return __webpack_require__(20);case"v8dark":return __webpack_require__(22);case"v8light":return __webpack_require__(24)}},function(module,exports,__webpack_require__){var api=__webpack_require__(13);var content=__webpack_require__(19);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(14);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".icvContainer__wrapper {\n  scrollbar-width: thin;\n  min-height: 0;\n  flex: 1 1 0;\n  display: flex;\n  overflow: auto; }\n  .icvContainer__wrapper::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .icvContainer__wrapper::-webkit-scrollbar-thumb {\n    background-color: rgba(152, 162, 179, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .icvContainer__wrapper::-webkit-scrollbar-corner, .icvContainer__wrapper::-webkit-scrollbar-track {\n    background-color: transparent; }\n\n.icvContainer {\n  width: 100%;\n  margin: 0 4px;\n  padding: 8px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(13);var content=__webpack_require__(21);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(14);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".icvContainer__wrapper {\n  scrollbar-width: thin;\n  min-height: 0;\n  flex: 1 1 0;\n  display: flex;\n  overflow: auto; }\n  .icvContainer__wrapper::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .icvContainer__wrapper::-webkit-scrollbar-thumb {\n    background-color: rgba(105, 112, 125, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .icvContainer__wrapper::-webkit-scrollbar-corner, .icvContainer__wrapper::-webkit-scrollbar-track {\n    background-color: transparent; }\n\n.icvContainer {\n  width: 100%;\n  margin: 0 4px;\n  padding: 8px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(13);var content=__webpack_require__(23);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(14);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".icvContainer__wrapper {\n  scrollbar-width: thin;\n  min-height: 0;\n  flex: 1 1 0;\n  display: flex;\n  overflow: auto; }\n  .icvContainer__wrapper::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .icvContainer__wrapper::-webkit-scrollbar-thumb {\n    background-color: rgba(152, 162, 179, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .icvContainer__wrapper::-webkit-scrollbar-corner, .icvContainer__wrapper::-webkit-scrollbar-track {\n    background-color: transparent; }\n\n.icvContainer {\n  width: 100%;\n  margin: 0 4px;\n  padding: 8px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(13);var content=__webpack_require__(25);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(14);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".icvContainer__wrapper {\n  scrollbar-width: thin;\n  min-height: 0;\n  flex: 1 1 0;\n  display: flex;\n  overflow: auto; }\n  .icvContainer__wrapper::-webkit-scrollbar {\n    width: 16px;\n    height: 16px; }\n  .icvContainer__wrapper::-webkit-scrollbar-thumb {\n    background-color: rgba(105, 112, 125, 0.5);\n    border: 6px solid transparent;\n    background-clip: content-box; }\n  .icvContainer__wrapper::-webkit-scrollbar-corner, .icvContainer__wrapper::-webkit-scrollbar-track {\n    background-color: transparent; }\n\n.icvContainer {\n  width: 100%;\n  margin: 0 4px;\n  padding: 8px; }\n",""]);module.exports=exports},,,,,,,,,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"createInputControlVisController",(function(){return createInputControlVisController}));var external_kbnSharedDeps_React_=__webpack_require__(1);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_Lodash_=__webpack_require__(7);var external_kbnSharedDeps_Lodash_default=__webpack_require__.n(external_kbnSharedDeps_Lodash_);var external_kbnSharedDeps_ReactDom_=__webpack_require__(11);var public_=__webpack_require__(3);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(8);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(9);var editor_utils=__webpack_require__(15);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(0);function FormRow(props){let control=props.children;if(props.disableMsg){control=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:props.disableMsg,anchorClassName:"eui-displayBlock"},control)}const label=props.warningMsg?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:props.warningMsg},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"alert"})),props.label):props.label;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:label,id:props.id,"data-test-subj":"inputControl"+props.controlIndex},control)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class list_control_ListControlUi extends external_kbnSharedDeps_React_["PureComponent"]{constructor(props){super(props);_defineProperty(this,"isMounted",false);_defineProperty(this,"state",{isLoading:false});_defineProperty(this,"textInput",void 0);_defineProperty(this,"componentDidMount",()=>{if(this.textInput){this.textInput.setAttribute("focusable","false")}this.isMounted=true});_defineProperty(this,"componentWillUnmount",()=>{this.isMounted=false});_defineProperty(this,"setTextInputRef",ref=>{this.textInput=ref});_defineProperty(this,"handleOnChange",selectedOptions=>{const selectedValues=selectedOptions.map(({value:value})=>value);this.props.stageFilter(this.props.controlIndex,selectedValues)});_defineProperty(this,"debouncedFetch",external_kbnSharedDeps_Lodash_default.a.debounce(async searchValue=>{if(this.props.fetchOptions){await this.props.fetchOptions(searchValue)}if(this.isMounted){this.setState({isLoading:false})}},300));_defineProperty(this,"onSearchChange",searchValue=>{this.setState({isLoading:true},this.debouncedFetch.bind(null,searchValue))});this.textInput=null}renderControl(){var _this$props$options;const{intl:intl}=this.props;if(this.props.disableMsg){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{"aria-label":intl.formatMessage({id:"inputControl.vis.listControl.selectTextPlaceholder",defaultMessage:"Select..."}),placeholder:intl.formatMessage({id:"inputControl.vis.listControl.selectTextPlaceholder",defaultMessage:"Select..."}),disabled:true})}const options=(_this$props$options=this.props.options)===null||_this$props$options===void 0?void 0:_this$props$options.map(option=>({label:this.props.formatOptionLabel(option).toString(),value:option,["data-test-subj"]:`option_${option.toString().replace(" ","_")}`})).sort((a,b)=>a.label.toLowerCase().localeCompare(b.label.toLowerCase()));const selectedOptions=this.props.selectedOptions.map(selectedOption=>({label:this.props.formatOptionLabel(selectedOption).toString(),value:selectedOption}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{placeholder:intl.formatMessage({id:"inputControl.vis.listControl.selectPlaceholder",defaultMessage:"Select..."}),options:options,isLoading:this.state.isLoading,async:this.props.dynamicOptions,onSearchChange:this.props.dynamicOptions?this.onSearchChange:undefined,selectedOptions:selectedOptions,onChange:this.handleOnChange,singleSelection:!this.props.multiselect,"data-test-subj":`listControlSelect${this.props.controlIndex}`,inputRef:this.setTextInputRef})}render(){const partialResultsWarningMessage=external_kbnSharedDeps_KbnI18n_["i18n"].translate("inputControl.vis.listControl.partialResultsWarningMessage",{defaultMessage:"Terms list might be incomplete because the request is taking too long. "+"Adjust the autocomplete settings in kibana.yml for complete results."});return external_kbnSharedDeps_React_default.a.createElement(FormRow,{id:this.props.id,label:this.props.label,warningMsg:this.props.partialResults?partialResultsWarningMessage:undefined,controlIndex:this.props.controlIndex,disableMsg:this.props.disableMsg},this.renderControl())}}_defineProperty(list_control_ListControlUi,"defaultProps",{dynamicOptions:false,multiselect:true,selectedOptions:[],options:[]});const list_control_ListControl=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(list_control_ListControlUi);var kibanaReact_public_=__webpack_require__(12);function range_control_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function roundWithPrecision(value,decimalPlaces,roundFunction){if(decimalPlaces<=0){return roundFunction(value)}let results=value;results=results*Math.pow(10,decimalPlaces);results=roundFunction(results);results=results/Math.pow(10,decimalPlaces);return results}function ceilWithPrecision(value,decimalPlaces){return roundWithPrecision(value,decimalPlaces,Math.ceil)}function floorWithPrecision(value,decimalPlaces){return roundWithPrecision(value,decimalPlaces,Math.floor)}class range_control_RangeControl extends external_kbnSharedDeps_React_["PureComponent"]{constructor(...args){super(...args);range_control_defineProperty(this,"state",{});range_control_defineProperty(this,"onChangeComplete",external_kbnSharedDeps_Lodash_default.a.debounce(value=>{const controlValue={min:value[0],max:value[1]};this.props.stageFilter(this.props.controlIndex,controlValue)},200))}static getDerivedStateFromProps(nextProps,prevState){const nextValue=nextProps.control.hasValue()?[nextProps.control.value.min,nextProps.control.value.max]:["",""];if(nextProps.control.hasValue()&&nextProps.control.value.min==null){nextValue[0]=""}if(nextProps.control.hasValue()&&nextProps.control.value.max==null){nextValue[1]=""}if(nextValue!==prevState.prevValue){return{value:nextValue,prevValue:nextValue}}return null}renderControl(){if(!this.props.control.isEnabled()){return external_kbnSharedDeps_React_default.a.createElement(kibanaReact_public_["ValidatedDualRange"],{disabled:true,showInput:true})}const decimalPlaces=external_kbnSharedDeps_Lodash_default.a.get(this.props,"control.options.decimalPlaces",0);const min=floorWithPrecision(this.props.control.min,decimalPlaces);const max=ceilWithPrecision(this.props.control.max,decimalPlaces);const ticks=[{value:min,label:min},{value:max,label:max}];return external_kbnSharedDeps_React_default.a.createElement(kibanaReact_public_["ValidatedDualRange"],{id:this.props.control.id,min:min,max:max,value:this.state.value,onChange:this.onChangeComplete,showInput:true,showRange:true,showTicks:true,ticks:ticks})}render(){return external_kbnSharedDeps_React_default.a.createElement(FormRow,{id:this.props.control.id,label:this.props.control.label,controlIndex:this.props.controlIndex,disableMsg:this.props.control.isEnabled()?undefined:this.props.control.disabledReason},this.renderControl())}}var input_control_vis=__webpack_require__(17);function isListControl(control){return control.type===editor_utils["a"].LIST}function isRangeControl(control){return control.type===editor_utils["a"].RANGE}class input_control_vis_InputControlVis extends external_kbnSharedDeps_React_["Component"]{constructor(props){super(props);this.handleSubmit=this.handleSubmit.bind(this);this.handleReset=this.handleReset.bind(this);this.handleClearAll=this.handleClearAll.bind(this)}handleSubmit(){this.props.submitFilters()}handleReset(){this.props.resetControls()}handleClearAll(){this.props.clearControls()}renderControls(){return this.props.controls.map((control,index)=>{let controlComponent=null;if(isListControl(control)){controlComponent=external_kbnSharedDeps_React_default.a.createElement(list_control_ListControl,{id:control.id,label:control.label,options:control.selectOptions,selectedOptions:control.value,formatOptionLabel:control.format,disableMsg:control.isEnabled()?undefined:control.disabledReason,multiselect:control.options.multiselect,partialResults:control.partialResults,dynamicOptions:control.options.dynamicOptions,controlIndex:index,stageFilter:this.props.stageFilter,fetchOptions:query=>{this.props.refreshControl(index,query)}})}else if(isRangeControl(control)){controlComponent=external_kbnSharedDeps_React_default.a.createElement(range_control_RangeControl,{control:control,controlIndex:index,stageFilter:this.props.stageFilter})}else{throw new Error(`Unhandled control type ${control.type}`)}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:control.id,style:{minWidth:"250px"},"data-test-subj":"inputControlItem"},controlComponent)})}renderStagingButtons(){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:true,onClick:this.handleSubmit,disabled:!this.props.hasChanges(),"data-test-subj":"inputControlSubmitBtn"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"inputControl.vis.inputControlVis.applyChangesButtonLabel",defaultMessage:"Apply changes"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:this.handleReset,disabled:!this.props.hasChanges(),"data-test-subj":"inputControlCancelBtn"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"inputControl.vis.inputControlVis.cancelChangesButtonLabel",defaultMessage:"Cancel changes"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:this.handleClearAll,disabled:!this.props.hasValues(),"data-test-subj":"inputControlClearBtn"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"inputControl.vis.inputControlVis.clearFormButtonLabel",defaultMessage:"Clear form"}))))}render(){let stagingButtons;if(this.props.controls.length>0&&!this.props.updateFiltersOnChange){stagingButtons=this.renderStagingButtons()}return external_kbnSharedDeps_React_default.a.createElement("div",{className:"icvContainer__wrapper"},external_kbnSharedDeps_React_default.a.createElement("div",{className:"icvContainer"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true},this.renderControls()),stagingButtons))}}function control_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function noValuesDisableMsg(fieldName,indexPatternName){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("inputControl.control.noValuesDisableTooltip",{defaultMessage:'Filtering occurs on the "{fieldName}" field, which doesn\'t exist on any documents in the "{indexPatternName}" index pattern. Choose a different field or index documents that contain values for this field.',values:{fieldName:fieldName,indexPatternName:indexPatternName}})}function noIndexPatternMsg(indexPatternId){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("inputControl.control.noIndexPatternTooltip",{defaultMessage:"Could not locate index-pattern id: {indexPatternId}.",values:{indexPatternId:indexPatternId}})}class control_Control{constructor(controlParams,filterManager,useTimeFilter){this.controlParams=controlParams;this.filterManager=filterManager;this.useTimeFilter=useTimeFilter;control_defineProperty(this,"kbnFilter",null);control_defineProperty(this,"enable",false);control_defineProperty(this,"disabledReason","");control_defineProperty(this,"value",void 0);control_defineProperty(this,"id",void 0);control_defineProperty(this,"options",void 0);control_defineProperty(this,"type",void 0);control_defineProperty(this,"label",void 0);control_defineProperty(this,"ancestors",[]);control_defineProperty(this,"format",value=>{const indexPattern=this.filterManager.getIndexPattern();const field=this.filterManager.getField();if(field&&indexPattern){return indexPattern.getFormatterForField(field).convert(value)}return value});this.id=controlParams.id;this.controlParams=controlParams;this.options=controlParams.options;this.type=controlParams.type;this.label=controlParams.label?controlParams.label:controlParams.fieldName;this.reset();this.disable(external_kbnSharedDeps_KbnI18n_["i18n"].translate("inputControl.control.notInitializedTooltip",{defaultMessage:"Control has not been initialized"}))}setAncestors(ancestors){this.ancestors=ancestors}hasAncestors(){return this.ancestors&&this.ancestors.length>0}hasUnsetAncestor(){return this.ancestors.reduce((accumulator,ancestor)=>accumulator||!ancestor.hasValue(),false)}getAncestorValues(){return this.ancestors.map(ancestor=>ancestor.value)}getAncestorFilters(){return this.ancestors.map(ancestor=>ancestor.filterManager.createFilter(ancestor.value))}isEnabled(){return this.enable}disable(reason){this.enable=false;this.disabledReason=reason}set(newValue){this.value=newValue;if(this.hasValue()){this.kbnFilter=this.filterManager.createFilter(this.value)}else{this.kbnFilter=null}}reset(){this.kbnFilter=null;this.value=this.filterManager.getValueFromFilterBar()}clear(){this.value=undefined}hasChanged(){return!external_kbnSharedDeps_Lodash_default.a.isEqual(this.value,this.filterManager.getValueFromFilterBar())}hasKbnFilter(){if(this.kbnFilter){return true}return false}getKbnFilter(){return this.kbnFilter}hasValue(){return this.value!==undefined}}function filter_manager_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class filter_manager_FilterManager{constructor(controlId,fieldName,indexPatternId,indexPatternsService,queryFilter){this.controlId=controlId;this.fieldName=fieldName;this.indexPatternId=indexPatternId;this.indexPatternsService=indexPatternsService;this.queryFilter=queryFilter;filter_manager_defineProperty(this,"indexPattern",void 0)}async init(){try{if(!this.indexPattern){this.indexPattern=await this.indexPatternsService.get(this.indexPatternId)}}catch(e){}}getIndexPattern(){return this.indexPattern}getField(){var _this$indexPattern;return(_this$indexPattern=this.indexPattern)===null||_this$indexPattern===void 0?void 0:_this$indexPattern.fields.getByName(this.fieldName)}findFilters(){const kbnFilters=external_kbnSharedDeps_Lodash_default.a.flatten([this.queryFilter.getAppFilters(),this.queryFilter.getGlobalFilters()]);return kbnFilters.filter(kbnFilter=>external_kbnSharedDeps_Lodash_default.a.get(kbnFilter,"meta.controlledBy")===this.controlId)}}var data_public_=__webpack_require__(10);function toRange(sliderValue){return{gte:sliderValue.min,lte:sliderValue.max}}function fromRange(range){const sliderValue={};if(external_kbnSharedDeps_Lodash_default.a.has(range,"gte")){sliderValue.min=external_kbnSharedDeps_Lodash_default.a.get(range,"gte")}if(external_kbnSharedDeps_Lodash_default.a.has(range,"gt")){sliderValue.min=external_kbnSharedDeps_Lodash_default.a.get(range,"gt")}if(external_kbnSharedDeps_Lodash_default.a.has(range,"lte")){sliderValue.max=external_kbnSharedDeps_Lodash_default.a.get(range,"lte")}if(external_kbnSharedDeps_Lodash_default.a.has(range,"lt")){sliderValue.max=external_kbnSharedDeps_Lodash_default.a.get(range,"lt")}return sliderValue}class range_filter_manager_RangeFilterManager extends filter_manager_FilterManager{createFilter(value){const indexPattern=this.getIndexPattern();const newFilter=data_public_["esFilters"].buildRangeFilter(indexPattern.fields.getByName(this.fieldName),toRange(value),indexPattern);newFilter.meta.key=this.fieldName;newFilter.meta.controlledBy=this.controlId;return newFilter}getValueFromFilterBar(){const kbnFilters=this.findFilters();if(kbnFilters.length===0){return}let range;if(external_kbnSharedDeps_Lodash_default.a.has(kbnFilters[0],"script")){range=external_kbnSharedDeps_Lodash_default.a.get(kbnFilters[0],"script.script.params")}else{range=external_kbnSharedDeps_Lodash_default.a.get(kbnFilters[0],["range",this.fieldName])}if(!range){return}return fromRange(range)}}async function createSearchSource({create:create},initialState,indexPattern,aggs,useTimeFilter,filters=[],timefilter){const searchSource=await create(initialState||{});searchSource.setParent(undefined);searchSource.setField("filter",()=>{const activeFilters=[...filters];if(useTimeFilter){const filter=timefilter.createFilter(indexPattern);if(filter){activeFilters.push(filter)}}return activeFilters});searchSource.setField("size",0);searchSource.setField("index",indexPattern);searchSource.setField("aggs",aggs);return searchSource}function range_control_factory_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const minMaxAgg=field=>{const aggBody={};if(field){if(field.scripted){aggBody.script={source:field.script,lang:field.lang}}else{aggBody.field=field.name}}return{maxAgg:{max:aggBody},minAgg:{min:aggBody}}};class range_control_factory_RangeControl extends control_Control{constructor(controlParams,filterManager,useTimeFilter,searchSource,deps){super(controlParams,filterManager,useTimeFilter);range_control_factory_defineProperty(this,"searchSource",void 0);range_control_factory_defineProperty(this,"timefilter",void 0);range_control_factory_defineProperty(this,"abortController",void 0);range_control_factory_defineProperty(this,"min",void 0);range_control_factory_defineProperty(this,"max",void 0);this.timefilter=deps.data.query.timefilter.timefilter;this.searchSource=searchSource}async fetch(){if(this.abortController){this.abortController.abort()}this.abortController=new AbortController;const indexPattern=this.filterManager.getIndexPattern();if(!indexPattern){this.disable(noIndexPatternMsg(this.controlParams.indexPattern));return}const fieldName=this.filterManager.fieldName;const aggs=minMaxAgg(indexPattern.fields.getByName(fieldName));const searchSource=await createSearchSource(this.searchSource,null,indexPattern,aggs,this.useTimeFilter,[],this.timefilter);const abortSignal=this.abortController.signal;let resp;try{resp=await searchSource.fetch({abortSignal:abortSignal})}catch(error){if(error.name==="AbortError")return;this.disable(external_kbnSharedDeps_KbnI18n_["i18n"].translate("inputControl.rangeControl.unableToFetchTooltip",{defaultMessage:"Unable to fetch range min and max, error: {errorMessage}",values:{errorMessage:error.message}}));return}const min=external_kbnSharedDeps_Lodash_default.a.get(resp,"aggregations.minAgg.value",null);const max=external_kbnSharedDeps_Lodash_default.a.get(resp,"aggregations.maxAgg.value",null);if(min===null||max===null){this.disable(noValuesDisableMsg(fieldName,indexPattern.title));return}this.min=min;this.max=max;this.enable=true}destroy(){if(this.abortController)this.abortController.abort()}}async function rangeControlFactory(controlParams,useTimeFilter,deps){const[,{data:dataPluginStart}]=await deps.core.getStartServices();const rangeControl=new range_control_factory_RangeControl(controlParams,new range_filter_manager_RangeFilterManager(controlParams.id,controlParams.fieldName,controlParams.indexPattern,dataPluginStart.indexPatterns,deps.data.query.filterManager),useTimeFilter,dataPluginStart.search.searchSource,deps);await rangeControl.filterManager.init();return rangeControl}class phrase_filter_manager_PhraseFilterManager extends filter_manager_FilterManager{constructor(controlId,fieldName,indexPatternId,indexPatternsService,queryFilter){super(controlId,fieldName,indexPatternId,indexPatternsService,queryFilter)}createFilter(phrases){const indexPattern=this.getIndexPattern();let newFilter;const value=indexPattern.fields.getByName(this.fieldName);if(!value){throw new Error(`Unable to find field with name: ${this.fieldName} on indexPattern`)}if(phrases.length===1){newFilter=data_public_["esFilters"].buildPhraseFilter(value,phrases[0],indexPattern)}else{newFilter=data_public_["esFilters"].buildPhrasesFilter(value,phrases,indexPattern)}newFilter.meta.key=this.fieldName;newFilter.meta.controlledBy=this.controlId;return newFilter}getValueFromFilterBar(){const kbnFilters=this.findFilters();if(kbnFilters.length===0){return}const values=kbnFilters.map(kbnFilter=>this.getValueFromFilter(kbnFilter)).filter(value=>value!=null);if(values.length===0){return}return values.reduce((accumulator,currentValue)=>accumulator.concat(currentValue),[])}getValueFromFilter(kbnFilter){if(external_kbnSharedDeps_Lodash_default.a.has(kbnFilter,"query.bool.should")){return external_kbnSharedDeps_Lodash_default.a.get(kbnFilter,"query.bool.should").map(kbnQueryFilter=>this.getValueFromFilter(kbnQueryFilter)).filter(value=>{if(value){return true}return false})}if(external_kbnSharedDeps_Lodash_default.a.has(kbnFilter,"script")){return external_kbnSharedDeps_Lodash_default.a.get(kbnFilter,"script.script.params.value")}if(data_public_["esFilters"].isPhraseFilter(kbnFilter)){if(data_public_["esFilters"].getPhraseFilterField(kbnFilter)!==this.fieldName){return}return data_public_["esFilters"].getPhraseFilterValue(kbnFilter)}if(external_kbnSharedDeps_Lodash_default.a.has(kbnFilter,["match_phrase",this.fieldName])){return external_kbnSharedDeps_Lodash_default.a.get(kbnFilter,["match_phrase",this.fieldName])}}}function list_control_factory_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function getEscapedQuery(query=""){return query.replace(/[.?+*|{}[\]()"\\#@&<>~]/g,match=>`\\${match}`)}const termsAgg=({field:field,size:size,direction:direction,query:query})=>{const terms={order:{_count:direction}};if(size){terms.size=size<1?1:size}if(field!==null&&field!==void 0&&field.scripted){terms.script={source:field.script,lang:field.lang};terms.value_type=field.type==="number"?"float":field.type}else{terms.field=field===null||field===void 0?void 0:field.name}if(query){terms.include=`.*${getEscapedQuery(query)}.*`}return{termsAgg:{terms:terms}}};class list_control_factory_ListControl extends control_Control{constructor(controlParams,filterManager,useTimeFilter,_searchSource,deps){super(controlParams,filterManager,useTimeFilter);list_control_factory_defineProperty(this,"getSettings",void 0);list_control_factory_defineProperty(this,"timefilter",void 0);list_control_factory_defineProperty(this,"searchSource",void 0);list_control_factory_defineProperty(this,"abortController",void 0);list_control_factory_defineProperty(this,"lastAncestorValues",void 0);list_control_factory_defineProperty(this,"lastQuery",void 0);list_control_factory_defineProperty(this,"partialResults",void 0);list_control_factory_defineProperty(this,"selectOptions",void 0);list_control_factory_defineProperty(this,"fetch",async query=>{if(this.abortController){this.abortController.abort()}this.abortController=new AbortController;const indexPattern=this.filterManager.getIndexPattern();if(!indexPattern){this.disable(noIndexPatternMsg(this.controlParams.indexPattern));return}let ancestorFilters;if(this.hasAncestors()){if(this.hasUnsetAncestor()){this.disable(external_kbnSharedDeps_KbnI18n_["i18n"].translate("inputControl.listControl.disableTooltip",{defaultMessage:"Disabled until '{label}' is set.",values:{label:this.ancestors[0].label}}));this.lastAncestorValues=undefined;return}const ancestorValues=this.getAncestorValues();if(external_kbnSharedDeps_Lodash_default.a.isEqual(ancestorValues,this.lastAncestorValues)&&external_kbnSharedDeps_Lodash_default.a.isEqual(query,this.lastQuery)){return}this.lastAncestorValues=ancestorValues;this.lastQuery=query;ancestorFilters=this.getAncestorFilters()}const fieldName=this.filterManager.fieldName;const settings=await this.getSettings();const initialSearchSourceState={timeout:`${settings.autocompleteTimeout}ms`,terminate_after:Number(settings.autocompleteTerminateAfter)};const field=indexPattern===null||indexPattern===void 0?void 0:indexPattern.fields.getAll().find(({name:name})=>name===this.controlParams.fieldName);if(field&&field.type!=="string"){this.options.dynamicOptions=false}const aggs=termsAgg({field:indexPattern.fields.getByName(fieldName),size:this.options.dynamicOptions?null:external_kbnSharedDeps_Lodash_default.a.get(this.options,"size",5),direction:"desc",query:query});const searchSource=await createSearchSource(this.searchSource,initialSearchSourceState,indexPattern,aggs,this.useTimeFilter,ancestorFilters,this.timefilter);const abortSignal=this.abortController.signal;this.lastQuery=query;let resp;try{resp=await searchSource.fetch({abortSignal:abortSignal})}catch(error){if(error.name==="AbortError")return;this.disable(external_kbnSharedDeps_KbnI18n_["i18n"].translate("inputControl.listControl.unableToFetchTooltip",{defaultMessage:"Unable to fetch terms, error: {errorMessage}",values:{errorMessage:error.message}}));return}if(query&&this.lastQuery!==query){return}const selectOptions=external_kbnSharedDeps_Lodash_default.a.get(resp,"aggregations.termsAgg.buckets",[]).map(bucket=>bucket===null||bucket===void 0?void 0:bucket.key);if(selectOptions.length===0&&!query){this.disable(noValuesDisableMsg(fieldName,indexPattern.title));return}this.partialResults=resp.terminated_early||resp.timed_out;this.selectOptions=selectOptions;this.enable=true;this.disabledReason=""});this.getSettings=deps.getSettings;this.timefilter=deps.data.query.timefilter.timefilter;this.searchSource=_searchSource}destroy(){if(this.abortController)this.abortController.abort()}hasValue(){return typeof this.value!=="undefined"&&this.value.length>0}}async function listControlFactory(controlParams,useTimeFilter,deps){const[,{data:dataPluginStart}]=await deps.core.getStartServices();const listControl=new list_control_factory_ListControl(controlParams,new phrase_filter_manager_PhraseFilterManager(controlParams.id,controlParams.fieldName,controlParams.indexPattern,dataPluginStart.indexPatterns,deps.data.query.filterManager),useTimeFilter,dataPluginStart.search.searchSource,deps);await listControl.filterManager.init();return listControl}function getControlFactory(controlParams){let factory=null;switch(controlParams.type){case editor_utils["a"].RANGE:factory=rangeControlFactory;break;case editor_utils["a"].LIST:factory=listControlFactory;break;default:throw new Error(`Unhandled control type ${controlParams.type}`)}return factory}var lineage=__webpack_require__(16);function vis_controller_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const createInputControlVisController=(deps,handlers)=>{var _temp;return _temp=class InputControlVisController{constructor(el){this.el=el;vis_controller_defineProperty(this,"I18nContext",void 0);vis_controller_defineProperty(this,"_isLoaded",false);vis_controller_defineProperty(this,"controls",void 0);vis_controller_defineProperty(this,"queryBarUpdateHandler",void 0);vis_controller_defineProperty(this,"filterManager",void 0);vis_controller_defineProperty(this,"updateSubsciption",void 0);vis_controller_defineProperty(this,"timeFilterSubscription",void 0);vis_controller_defineProperty(this,"visParams",void 0);vis_controller_defineProperty(this,"drawVis",()=>{var _this$visParams;if(!this.I18nContext){throw new Error("no i18n context found")}Object(external_kbnSharedDeps_ReactDom_["render"])(external_kbnSharedDeps_React_default.a.createElement(this.I18nContext,null,external_kbnSharedDeps_React_default.a.createElement(public_["VisualizationContainer"],{handlers:handlers},external_kbnSharedDeps_React_default.a.createElement(input_control_vis_InputControlVis,{updateFiltersOnChange:(_this$visParams=this.visParams)===null||_this$visParams===void 0?void 0:_this$visParams.updateFiltersOnChange,controls:this.controls,stageFilter:this.stageFilter,submitFilters:this.submitFilters,resetControls:this.updateControlsFromKbn,clearControls:this.clearControls,hasChanges:this.hasChanges,hasValues:this.hasValues,refreshControl:this.refreshControl}))),this.el)});vis_controller_defineProperty(this,"stageFilter",async(controlIndex,newValue)=>{var _this$visParams2;this.controls[controlIndex].set(newValue);if((_this$visParams2=this.visParams)!==null&&_this$visParams2!==void 0&&_this$visParams2.updateFiltersOnChange){this.submitFilters()}else{await this.updateNestedControls();this.drawVis()}});vis_controller_defineProperty(this,"submitFilters",()=>{var _this$visParams3;const stagedControls=this.controls.filter(control=>control.hasChanged());const newFilters=stagedControls.map(control=>control.getKbnFilter()).filter(filter=>filter!==null);stagedControls.forEach(control=>{control.filterManager.findFilters().forEach(existingFilter=>{this.filterManager.removeFilter(existingFilter)})});this.controls.map(control=>{if(control.hasAncestors()&&control.hasUnsetAncestor()){control.filterManager.findFilters().forEach(existingFilter=>{this.filterManager.removeFilter(existingFilter)})}});this.filterManager.addFilters(newFilters,(_this$visParams3=this.visParams)===null||_this$visParams3===void 0?void 0:_this$visParams3.pinFilters)});vis_controller_defineProperty(this,"clearControls",async()=>{this.controls.forEach(control=>{control.clear()});await this.updateNestedControls();this.drawVis()});vis_controller_defineProperty(this,"updateControlsFromKbn",async()=>{this.controls.forEach(control=>{control.reset()});await this.updateNestedControls();this.drawVis()});vis_controller_defineProperty(this,"hasChanges",()=>this.controls.map(control=>control.hasChanged()).some(control=>control));vis_controller_defineProperty(this,"hasValues",()=>this.controls.map(control=>control.hasValue()).reduce((a,b)=>a||b));vis_controller_defineProperty(this,"refreshControl",async(controlIndex,query)=>{await this.controls[controlIndex].fetch(query);this.drawVis()});this.controls=[];this.queryBarUpdateHandler=this.updateControlsFromKbn.bind(this);this.filterManager=deps.data.query.filterManager;this.updateSubsciption=this.filterManager.getUpdates$().subscribe(this.queryBarUpdateHandler);this.timeFilterSubscription=deps.data.query.timefilter.timefilter.getTimeUpdate$().subscribe(()=>{var _this$visParams4;if((_this$visParams4=this.visParams)!==null&&_this$visParams4!==void 0&&_this$visParams4.useTimeFilter){this._isLoaded=false}})}async render(visParams){if(!this.I18nContext){const[{i18n:i18n}]=await deps.core.getStartServices();this.I18nContext=i18n.Context}if(!this._isLoaded||!Object(external_kbnSharedDeps_Lodash_["isEqual"])(visParams,this.visParams)){this.visParams=visParams;this.controls=[];this.controls=await this.initControls(visParams);this._isLoaded=true}this.drawVis()}destroy(){this.updateSubsciption.unsubscribe();this.timeFilterSubscription.unsubscribe();Object(external_kbnSharedDeps_ReactDom_["unmountComponentAtNode"])(this.el);this.controls.forEach(control=>control.destroy())}async initControls(visParams){const controlParamsList=visParams.controls.filter(controlParams=>controlParams.indexPattern&&controlParams.fieldName);const controlFactoryPromises=controlParamsList.map(controlParams=>{const factory=getControlFactory(controlParams);return factory(controlParams,visParams.useTimeFilter,deps)});const controls=await Promise.all(controlFactoryPromises);const getControl=controlId=>controls.find(({id:id})=>id===controlId);const controlInitPromises=[];Object(lineage["a"])(controlParamsList).forEach((lineage,controlId)=>{lineage.shift();const ancestors=[];lineage.forEach(ancestorId=>{const control=getControl(ancestorId);if(control){ancestors.push(control)}});const control=getControl(controlId);if(control){control.setAncestors(ancestors);controlInitPromises.push(control.fetch())}});await Promise.all(controlInitPromises);return controls}async updateNestedControls(){const fetchPromises=this.controls.map(async control=>{if(control.hasAncestors()){await control.fetch()}});return await Promise.all(fetchPromises)}},_temp}}]]);