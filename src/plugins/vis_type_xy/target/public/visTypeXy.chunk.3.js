(window["visTypeXy_bundle_jsonpfunction"]=window["visTypeXy_bundle_jsonpfunction"]||[]).push([[3],{31:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return getInterpolationModes}));__webpack_require__.d(__webpack_exports__,"f",(function(){return getThresholdLineStyles}));__webpack_require__.d(__webpack_exports__,"e",(function(){return getRotateOptions}));__webpack_require__.d(__webpack_exports__,"b",(function(){return getFittingFunctions}));__webpack_require__.d(__webpack_exports__,"a",(function(){return getConfigCollections}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__);var _elastic_charts__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3);var _elastic_charts__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_elastic_charts__WEBPACK_IMPORTED_MODULE_1__);var _types__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0);var _common__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(6);var _charts_public__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5);var _charts_public__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_charts_public__WEBPACK_IMPORTED_MODULE_4__);var _scale_types__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(18);var _positions__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(17);__webpack_require__.d(__webpack_exports__,"d",(function(){return _positions__WEBPACK_IMPORTED_MODULE_6__["a"]}));const getChartTypes=()=>[{text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.chartTypes.lineText",{defaultMessage:"Line"}),value:_common__WEBPACK_IMPORTED_MODULE_3__["a"].Line},{text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.chartTypes.areaText",{defaultMessage:"Area"}),value:_common__WEBPACK_IMPORTED_MODULE_3__["a"].Area},{text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.chartTypes.barText",{defaultMessage:"Bar"}),value:_common__WEBPACK_IMPORTED_MODULE_3__["a"].Histogram}];const getChartModes=()=>[{text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.chartModes.normalText",{defaultMessage:"Normal"}),value:_types__WEBPACK_IMPORTED_MODULE_2__["ChartMode"].Normal},{text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.chartModes.stackedText",{defaultMessage:"Stacked"}),value:_types__WEBPACK_IMPORTED_MODULE_2__["ChartMode"].Stacked}];const getInterpolationModes=()=>[{text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.interpolationModes.straightText",{defaultMessage:"Straight"}),value:_types__WEBPACK_IMPORTED_MODULE_2__["InterpolationMode"].Linear},{text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.interpolationModes.smoothedText",{defaultMessage:"Smoothed"}),value:_types__WEBPACK_IMPORTED_MODULE_2__["InterpolationMode"].Cardinal},{text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.interpolationModes.steppedText",{defaultMessage:"Stepped"}),value:_types__WEBPACK_IMPORTED_MODULE_2__["InterpolationMode"].StepAfter}];const getAxisModes=()=>[{text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.axisModes.normalText",{defaultMessage:"Normal"}),value:_types__WEBPACK_IMPORTED_MODULE_2__["AxisMode"].Normal},{text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.axisModes.percentageText",{defaultMessage:"Percentage"}),value:_types__WEBPACK_IMPORTED_MODULE_2__["AxisMode"].Percentage},{text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.axisModes.wiggleText",{defaultMessage:"Wiggle"}),value:_types__WEBPACK_IMPORTED_MODULE_2__["AxisMode"].Wiggle},{text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.axisModes.silhouetteText",{defaultMessage:"Silhouette"}),value:_types__WEBPACK_IMPORTED_MODULE_2__["AxisMode"].Silhouette}];const getThresholdLineStyles=()=>[{value:_types__WEBPACK_IMPORTED_MODULE_2__["ThresholdLineStyle"].Full,text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.thresholdLine.style.fullText",{defaultMessage:"Full"})},{value:_types__WEBPACK_IMPORTED_MODULE_2__["ThresholdLineStyle"].Dashed,text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.thresholdLine.style.dashedText",{defaultMessage:"Dashed"})},{value:_types__WEBPACK_IMPORTED_MODULE_2__["ThresholdLineStyle"].DotDashed,text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.thresholdLine.style.dotdashedText",{defaultMessage:"Dot-dashed"})}];const getRotateOptions=()=>[{text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.categoryAxis.rotate.horizontalText",{defaultMessage:"Horizontal"}),value:_charts_public__WEBPACK_IMPORTED_MODULE_4__["LabelRotation"].Horizontal},{text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.categoryAxis.rotate.verticalText",{defaultMessage:"Vertical"}),value:_charts_public__WEBPACK_IMPORTED_MODULE_4__["LabelRotation"].Vertical},{text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.categoryAxis.rotate.angledText",{defaultMessage:"Angled"}),value:_charts_public__WEBPACK_IMPORTED_MODULE_4__["LabelRotation"].Angled}];const getFittingFunctions=()=>[{value:_elastic_charts__WEBPACK_IMPORTED_MODULE_1__["Fit"].None,text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.fittingFunctionsTitle.none",{defaultMessage:"Hide (Do not fill gaps)"})},{value:_elastic_charts__WEBPACK_IMPORTED_MODULE_1__["Fit"].Zero,text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.fittingFunctionsTitle.zero",{defaultMessage:"Zero (Fill gaps with zeros)"})},{value:_elastic_charts__WEBPACK_IMPORTED_MODULE_1__["Fit"].Linear,text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.fittingFunctionsTitle.linear",{defaultMessage:"Linear (Fill gaps with a line)"})},{value:_elastic_charts__WEBPACK_IMPORTED_MODULE_1__["Fit"].Carry,text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.fittingFunctionsTitle.carry",{defaultMessage:"Last (Fill gaps with the last value)"})},{value:_elastic_charts__WEBPACK_IMPORTED_MODULE_1__["Fit"].Lookahead,text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("visTypeXy.fittingFunctionsTitle.lookahead",{defaultMessage:"Next (Fill gaps with the next value)"})}];const getConfigCollections=()=>({legendPositions:Object(_positions__WEBPACK_IMPORTED_MODULE_6__["a"])(),positions:Object(_positions__WEBPACK_IMPORTED_MODULE_6__["a"])(),chartTypes:getChartTypes(),axisModes:getAxisModes(),scaleTypes:Object(_scale_types__WEBPACK_IMPORTED_MODULE_5__["a"])(),chartModes:getChartModes(),interpolationModes:getInterpolationModes(),thresholdLineStyles:getThresholdLineStyles(),fittingFunctions:getFittingFunctions()})},53:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",(function(){return PointSeriesOptions}));var external_kbnSharedDeps_React_=__webpack_require__(4);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(13);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(16);var public_=__webpack_require__(28);var data_public_=__webpack_require__(2);function GridPanel({stateParams:stateParams,setValue:setValue,hasHistogramAgg:hasHistogramAgg,extraProps:extraProps}){var _stateParams$grid$val;const setGrid=Object(external_kbnSharedDeps_React_["useCallback"])((paramName,value)=>setValue("grid",{...stateParams.grid,[paramName]:value}),[stateParams.grid,setValue]);const disableCategoryGridLines=Object(external_kbnSharedDeps_React_["useMemo"])(()=>!(extraProps!==null&&extraProps!==void 0&&extraProps.showElasticChartsOptions)&&hasHistogramAgg,[extraProps===null||extraProps===void 0?void 0:extraProps.showElasticChartsOptions,hasHistogramAgg]);const options=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[...stateParams.valueAxes.map(({id:id,name:name})=>({text:name,value:id})),{text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeXy.controls.pointSeries.gridAxis.dontShowLabel",{defaultMessage:"Don't show"}),value:""}],[stateParams.valueAxes]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(disableCategoryGridLines){setGrid("categoryLines",false)}},[disableCategoryGridLines,setGrid]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],{paddingSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeXy.controls.pointSeries.gridAxis.gridText",defaultMessage:"Grid"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(public_["SwitchOption"],{disabled:disableCategoryGridLines,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeXy.controls.pointSeries.gridAxis.xAxisLinesLabel",{defaultMessage:"Show X-axis lines"}),paramName:"categoryLines",tooltip:disableCategoryGridLines?external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeXy.controls.pointSeries.gridAxis.yAxisLinesDisabledTooltip",{defaultMessage:"X-axis lines can't show for histograms."}):undefined,value:stateParams.grid.categoryLines,setValue:setGrid,"data-test-subj":"showCategoryLines"}),external_kbnSharedDeps_React_default.a.createElement(public_["SelectOption"],{id:"gridAxis",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeXy.controls.pointSeries.gridAxis.yAxisLinesLabel",{defaultMessage:"Y-axis lines"}),options:options,paramName:"valueAxis",value:(_stateParams$grid$val=stateParams.grid.valueAxis)!==null&&_stateParams$grid$val!==void 0?_stateParams$grid$val:"",setValue:setGrid}))}var collections=__webpack_require__(31);const thresholdLineStyles=Object(collections["f"])();function ThresholdPanel({stateParams:stateParams,setValue:setValue,setMultipleValidity:setMultipleValidity}){const setThresholdLine=Object(external_kbnSharedDeps_React_["useCallback"])((paramName,value)=>setValue("thresholdLine",{...stateParams.thresholdLine,[paramName]:value}),[stateParams.thresholdLine,setValue]);const setThresholdLineColor=Object(external_kbnSharedDeps_React_["useCallback"])(value=>setThresholdLine("color",value),[setThresholdLine]);const setThresholdLineValidity=Object(external_kbnSharedDeps_React_["useCallback"])((paramName,isValid)=>setMultipleValidity(`thresholdLine__${paramName}`,isValid),[setMultipleValidity]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],{paddingSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeXy.editors.pointSeries.thresholdLineSettingsTitle",defaultMessage:"Threshold line"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(public_["SwitchOption"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeXy.editors.pointSeries.thresholdLine.showLabel",{defaultMessage:"Show threshold line"}),paramName:"show",value:stateParams.thresholdLine.show,setValue:setThresholdLine}),stateParams.thresholdLine.show&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(public_["RequiredNumberInputOption"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeXy.editors.pointSeries.thresholdLine.valueLabel",{defaultMessage:"Threshold value"}),paramName:"value",value:stateParams.thresholdLine.value,setValue:setThresholdLine,setValidity:setThresholdLineValidity,"data-test-subj":"thresholdValueInputOption"}),external_kbnSharedDeps_React_default.a.createElement(public_["RequiredNumberInputOption"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeXy.editors.pointSeries.thresholdLine.widthLabel",{defaultMessage:"Line width"}),paramName:"width",min:1,step:1,value:stateParams.thresholdLine.width,setValue:setThresholdLine,setValidity:setThresholdLineValidity}),external_kbnSharedDeps_React_default.a.createElement(public_["SelectOption"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeXy.editors.pointSeries.thresholdLine.styleLabel",{defaultMessage:"Line style"}),options:thresholdLineStyles,paramName:"style",value:stateParams.thresholdLine.style,setValue:setThresholdLine}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeXy.editors.pointSeries.thresholdLine.colorLabel",{defaultMessage:"Line color"}),fullWidth:true,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiColorPicker"],{compressed:true,color:stateParams.thresholdLine.color,fullWidth:true,onChange:setThresholdLineColor}))))}var common=__webpack_require__(6);function wrapArray(subj){return Array.isArray(subj)?subj:[subj]}class UnreachableCaseError extends Error{constructor(val){super(`Unreachable case: ${val}`)}}function createUiCounterMetric({type:type,appName:appName,eventName:eventName,count:count=1}){return{type:type,appName:appName,eventName:eventName,count:count}}function trackUsageAgent(appName){const userAgent=window&&window.navigator&&window.navigator.userAgent||"";return{type:METRIC_TYPE.USER_AGENT,appName:appName,userAgent:userAgent}}var external_kbnSharedDeps_MomentTimezone_=__webpack_require__(30);var external_kbnSharedDeps_MomentTimezone_default=__webpack_require__.n(external_kbnSharedDeps_MomentTimezone_);function createApplicationUsageMetric(appId,viewId){return{type:METRIC_TYPE.APPLICATION_USAGE,appId:appId,viewId:viewId,startTime:external_kbnSharedDeps_MomentTimezone_default()(),numberOfClicks:0}}let METRIC_TYPE;(function(METRIC_TYPE){METRIC_TYPE["COUNT"]="count";METRIC_TYPE["LOADED"]="loaded";METRIC_TYPE["CLICK"]="click";METRIC_TYPE["USER_AGENT"]="user_agent";METRIC_TYPE["APPLICATION_USAGE"]="application_usage"})(METRIC_TYPE||(METRIC_TYPE={}));function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class ReportStorageManager{constructor(storageKey,storage){_defineProperty(this,"storageKey",void 0);_defineProperty(this,"storage",void 0);this.storageKey=storageKey;this.storage=storage}get(){if(!this.storage)return;return this.storage.get(this.storageKey)}store(report){if(!this.storage)return;this.storage.set(this.storageKey,report)}}function application_usage_tracker_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class application_usage_tracker_ApplicationUsageTracker{constructor(reporter){application_usage_tracker_defineProperty(this,"trackedApplicationViews",{});application_usage_tracker_defineProperty(this,"reporter",void 0);application_usage_tracker_defineProperty(this,"currentAppId",void 0);application_usage_tracker_defineProperty(this,"currentApplicationKeys",[]);application_usage_tracker_defineProperty(this,"beforeUnloadListener",void 0);application_usage_tracker_defineProperty(this,"onVisiblityChangeListener",void 0);this.reporter=reporter}createKey(appId,viewId){return{appId:appId,viewId:viewId}}static serializeKey({appId:appId,viewId:viewId}){return`${appId}-${viewId}`}trackApplications(appKeys){for(const{appId:appId,viewId:viewId}of appKeys.filter(Boolean)){const serializedKey=application_usage_tracker_ApplicationUsageTracker.serializeKey({appId:appId,viewId:viewId});if(typeof this.trackedApplicationViews[serializedKey]!=="undefined"){continue}const metric=createApplicationUsageMetric(appId,viewId);this.trackedApplicationViews[serializedKey]=metric}}attachListeners(){if(typeof window==="undefined"||typeof document==="undefined"){return}this.beforeUnloadListener=()=>{this.flushTrackedViews()};this.onVisiblityChangeListener=()=>{if(document.visibilityState==="visible"){this.resumeTrackingAll()}else if(document.visibilityState==="hidden"){this.pauseTrackingAll()}};window.addEventListener("beforeunload",this.beforeUnloadListener);document.addEventListener("visibilitychange",this.onVisiblityChangeListener)}detachListeners(){if(typeof window==="undefined"||typeof document==="undefined"){return}if(this.beforeUnloadListener){window.removeEventListener("beforeunload",this.beforeUnloadListener)}if(this.onVisiblityChangeListener){document.removeEventListener("visibilitychange",this.onVisiblityChangeListener)}}sendMetricsToReporter(metrics){metrics.forEach(metric=>{this.reporter.reportApplicationUsage(metric)})}updateViewClickCounter(viewId){if(!this.currentAppId){return}const appKey=application_usage_tracker_ApplicationUsageTracker.serializeKey({appId:this.currentAppId,viewId:viewId});if(this.trackedApplicationViews[appKey]){this.trackedApplicationViews[appKey].numberOfClicks++}}flushTrackedViews(){const appViewMetrics=Object.values(this.trackedApplicationViews);this.sendMetricsToReporter(appViewMetrics);this.trackedApplicationViews={}}start(){this.attachListeners()}stop(){this.flushTrackedViews();this.detachListeners()}setCurrentAppId(appId){this.flushTrackedViews();this.currentAppId=appId}trackApplicationViewUsage(viewId){if(!this.currentAppId){return}const appKey=this.createKey(this.currentAppId,viewId);this.trackApplications([appKey])}pauseTrackingAll(){this.currentApplicationKeys=Object.values(this.trackedApplicationViews).map(({appId:appId,viewId:viewId})=>this.createKey(appId,viewId));this.flushTrackedViews()}resumeTrackingAll(){this.trackApplications(this.currentApplicationKeys);this.currentApplicationKeys=[];this.reporter.sendReports()}flushTrackedView(viewId){if(!this.currentAppId){return}const appKey=this.createKey(this.currentAppId,viewId);const serializedKey=application_usage_tracker_ApplicationUsageTracker.serializeKey(appKey);const appViewMetric=this.trackedApplicationViews[serializedKey];this.sendMetricsToReporter([appViewMetric]);delete this.trackedApplicationViews[serializedKey]}}function report_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const REPORT_VERSION=3;class report_ReportManager{constructor(report){report_defineProperty(this,"report",void 0);this.report=report||report_ReportManager.createReport()}static createReport(){return{reportVersion:REPORT_VERSION}}clearReport(){this.report=report_ReportManager.createReport()}isReportEmpty(){const{uiCounter:uiCounter,userAgent:userAgent,application_usage:appUsage}=this.report;const noUiCounters=!uiCounter||Object.keys(uiCounter).length===0;const noUserAgents=!userAgent||Object.keys(userAgent).length===0;const noAppUsage=!appUsage||Object.keys(appUsage).length===0;return noUiCounters&&noUserAgents&&noAppUsage}incrementTotal(count,currentTotal){const currentTotalNumber=typeof currentTotal==="number"?currentTotal:0;return count+currentTotalNumber}assignReports(newMetrics){wrapArray(newMetrics).forEach(newMetric=>this.assignReport(this.report,newMetric));return{report:this.report}}static createMetricKey(metric){switch(metric.type){case METRIC_TYPE.USER_AGENT:{const{appName:appName,type:type}=metric;return`${appName}-${type}`}case METRIC_TYPE.CLICK:case METRIC_TYPE.LOADED:case METRIC_TYPE.COUNT:{const{appName:appName,eventName:eventName,type:type}=metric;return`${appName}-${type}-${eventName}`}case METRIC_TYPE.APPLICATION_USAGE:{const{appId:appId,viewId:viewId}=metric;return application_usage_tracker_ApplicationUsageTracker.serializeKey({appId:appId,viewId:viewId})}default:throw new UnreachableCaseError(metric)}}assignReport(report,metric){const key=report_ReportManager.createMetricKey(metric);switch(metric.type){case METRIC_TYPE.USER_AGENT:{const{appName:appName,type:type,userAgent:userAgent}=metric;if(userAgent){report.userAgent={[key]:{key:key,appName:appName,type:type,userAgent:metric.userAgent}}}return}case METRIC_TYPE.CLICK:case METRIC_TYPE.LOADED:case METRIC_TYPE.COUNT:{var _report$uiCounter$key;const{appName:appName,type:type,eventName:eventName,count:count}=metric;report.uiCounter=report.uiCounter||{};const currentTotal=(_report$uiCounter$key=report.uiCounter[key])===null||_report$uiCounter$key===void 0?void 0:_report$uiCounter$key.total;report.uiCounter[key]={key:key,appName:appName,eventName:eventName,type:type,total:this.incrementTotal(count,currentTotal)};return}case METRIC_TYPE.APPLICATION_USAGE:{const{numberOfClicks:numberOfClicks,startTime:startTime,appId:appId,viewId:viewId}=metric;const minutesOnScreen=external_kbnSharedDeps_MomentTimezone_default()().diff(startTime,"minutes",true);report.application_usage=report.application_usage||{};const appExistingData=report.application_usage[key]||{minutesOnScreen:0,numberOfClicks:0,appId:appId,viewId:viewId};report.application_usage[key]={...appExistingData,minutesOnScreen:appExistingData.minutesOnScreen+minutesOnScreen,numberOfClicks:appExistingData.numberOfClicks+numberOfClicks};return}default:throw new UnreachableCaseError(metric)}}}report_defineProperty(report_ReportManager,"REPORT_VERSION",REPORT_VERSION);function reporter_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class reporter_Reporter{constructor(config){reporter_defineProperty(this,"checkInterval",void 0);reporter_defineProperty(this,"interval",void 0);reporter_defineProperty(this,"http",void 0);reporter_defineProperty(this,"reportManager",void 0);reporter_defineProperty(this,"storageManager",void 0);reporter_defineProperty(this,"debug",void 0);reporter_defineProperty(this,"retryCount",0);reporter_defineProperty(this,"maxRetries",3);reporter_defineProperty(this,"start",()=>{if(!this.interval){this.interval=setTimeout(()=>{this.interval=undefined;this.sendReports()},this.checkInterval)}});reporter_defineProperty(this,"reportUiCounter",(appName,type,eventNames,count)=>{const metrics=wrapArray(eventNames).map(eventName=>{this.log(`${type} Metric -> (${appName}:${eventName}):`);const report=createUiCounterMetric({type:type,appName:appName,eventName:eventName,count:count});this.log(report);return report});this.saveToReport(metrics)});reporter_defineProperty(this,"reportUserAgent",appName=>{this.log(`Reporting user-agent.`);const report=trackUsageAgent(appName);this.saveToReport([report])});reporter_defineProperty(this,"sendReports",async()=>{if(!this.reportManager.isReportEmpty()){try{await this.http(this.reportManager.report);this.flushReport()}catch(err){this.log(`Error Sending Metrics Report ${err}`);this.retryCount=this.retryCount+1;const versionMismatch=this.reportManager.report.reportVersion!==report_ReportManager.REPORT_VERSION;if(versionMismatch||this.retryCount>this.maxRetries){this.flushReport()}}}this.start()});const{http:http,storage:storage,debug:debug,checkInterval:checkInterval=9e4,storageKey:storageKey="analytics"}=config;this.http=http;this.checkInterval=checkInterval;this.storageManager=new ReportStorageManager(storageKey,storage);const storedReport=this.storageManager.get();this.reportManager=new report_ReportManager(storedReport);this.debug=!!debug}saveToReport(newMetrics){this.reportManager.assignReports(newMetrics);this.storageManager.store(this.reportManager.report)}flushReport(){this.retryCount=0;this.reportManager.clearReport();this.storageManager.store(this.reportManager.report)}log(message){if(this.debug){console.debug(message)}}reportApplicationUsage(appUsageReport){this.log(`Reporting application usage for ${appUsageReport.appId}, ${appUsageReport.viewId}`);this.saveToReport([appUsageReport])}}var services=__webpack_require__(8);const fittingFunctions=Object(collections["b"])();function ElasticChartsOptions(props){const trackUiMetric=Object(services["e"])();const[palettesRegistry,setPalettesRegistry]=Object(external_kbnSharedDeps_React_["useState"])(null);const{stateParams:stateParams,setValue:setValue,aggs:aggs}=props;const hasLineChart=stateParams.seriesParams.some(({type:type,data:{id:paramId}})=>{var _aggs$aggs$find;return(type===common["a"].Line||type===common["a"].Area)&&((_aggs$aggs$find=aggs.aggs.find(({id:id})=>id===paramId))===null||_aggs$aggs$find===void 0?void 0:_aggs$aggs$find.enabled)});Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const fetchPalettes=async()=>{const palettes=await Object(services["c"])().getPalettes();setPalettesRegistry(palettes)};fetchPalettes()},[]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(public_["SwitchOption"],{"data-test-subj":"detailedTooltip",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeXy.editors.elasticChartsOptions.detailedTooltip.label",{defaultMessage:"Show detailed tooltip"}),tooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeXy.editors.elasticChartsOptions.detailedTooltip.tooltip",{defaultMessage:"Enables the legacy detailed tooltip for displaying a single value. When disabled, a new summarized tooltip will be used to display multiple values."}),paramName:"detailedTooltip",value:stateParams.detailedTooltip,setValue:(paramName,value)=>{if(trackUiMetric){trackUiMetric(METRIC_TYPE.CLICK,"detailed_tooltip_switched")}setValue(paramName,value)}}),hasLineChart&&external_kbnSharedDeps_React_default.a.createElement(public_["SelectOption"],{"data-test-subj":"fittingFunction",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeXy.editors.elasticChartsOptions.missingValuesLabel",{defaultMessage:"Fill missing values"}),options:fittingFunctions,paramName:"fittingFunction",value:stateParams.fittingFunction,setValue:(paramName,value)=>{if(trackUiMetric){trackUiMetric(METRIC_TYPE.CLICK,"fitting_function_selected")}setValue(paramName,value)}}),palettesRegistry&&external_kbnSharedDeps_React_default.a.createElement(public_["PalettePicker"],{palettes:palettesRegistry,activePalette:stateParams.palette,paramName:"palette",setPalette:(paramName,value)=>{if(trackUiMetric){trackUiMetric(METRIC_TYPE.CLICK,"palette_selected")}setValue(paramName,value)}}))}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}const legendPositions=Object(collections["d"])();function PointSeriesOptions(props){var _props$extraProps;const{stateParams:stateParams,setValue:setValue,vis:vis,aggs:aggs}=props;const hasBarChart=Object(external_kbnSharedDeps_React_["useMemo"])(()=>stateParams.seriesParams.some(({type:type,data:{id:paramId}})=>{var _aggs$aggs$find;return type===common["a"].Histogram&&((_aggs$aggs$find=aggs.aggs.find(({id:id})=>id===paramId))===null||_aggs$aggs$find===void 0?void 0:_aggs$aggs$find.enabled)}),[stateParams.seriesParams,aggs.aggs]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],{paddingSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeXy.editors.pointSeries.settingsTitle",defaultMessage:"Settings"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(public_["BasicOptions"],_extends({},props,{legendPositions:legendPositions})),vis.data.aggs.aggs.some(agg=>agg.schema==="segment"&&agg.type.name===data_public_["BUCKET_TYPES"].DATE_HISTOGRAM)?external_kbnSharedDeps_React_default.a.createElement(public_["SwitchOption"],{"data-test-subj":"addTimeMarker",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeXy.editors.pointSeries.currentTimeMarkerLabel",{defaultMessage:"Current time marker"}),paramName:"addTimeMarker",value:stateParams.addTimeMarker,setValue:setValue}):external_kbnSharedDeps_React_default.a.createElement(public_["SwitchOption"],{"data-test-subj":"orderBucketsBySum",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeXy.editors.pointSeries.orderBucketsBySumLabel",{defaultMessage:"Order buckets by sum"}),paramName:"orderBucketsBySum",value:stateParams.orderBucketsBySum,setValue:setValue}),hasBarChart&&external_kbnSharedDeps_React_default.a.createElement(public_["SwitchOption"],{"data-test-subj":"showValuesOnChart",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeXy.editors.pointSeries.showLabels",{defaultMessage:"Show values on chart"}),paramName:"show",value:stateParams.labels.show,setValue:(paramName,value)=>setValue("labels",{...stateParams.labels,[paramName]:value})}),((_props$extraProps=props.extraProps)===null||_props$extraProps===void 0?void 0:_props$extraProps.showElasticChartsOptions)&&external_kbnSharedDeps_React_default.a.createElement(ElasticChartsOptions,props)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(GridPanel,props),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),stateParams.thresholdLine&&external_kbnSharedDeps_React_default.a.createElement(ThresholdPanel,props))}}}]);