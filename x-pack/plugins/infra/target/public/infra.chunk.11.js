/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window["infra_bundle_jsonpfunction"]=window["infra_bundle_jsonpfunction"]||[]).push([[11],{100:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return METRIC_EXPLORER_AGGREGATIONS}));__webpack_require__.d(__webpack_exports__,"c",(function(){return metricsExplorerAggregationRT}));__webpack_require__.d(__webpack_exports__,"d",(function(){return metricsExplorerMetricRT}));__webpack_require__.d(__webpack_exports__,"b",(function(){return afterKeyObjectRT}));__webpack_require__.d(__webpack_exports__,"e",(function(){return metricsExplorerResponseRT}));var io_ts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);var io_ts__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(io_ts__WEBPACK_IMPORTED_MODULE_0__);const METRIC_EXPLORER_AGGREGATIONS=["avg","max","min","cardinality","rate","count","sum","p95","p99"];const metricsExplorerAggregationKeys=METRIC_EXPLORER_AGGREGATIONS.reduce((acc,agg)=>({...acc,[agg]:null}),{});const metricsExplorerAggregationRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"](metricsExplorerAggregationKeys);const metricsExplorerMetricRequiredFieldsRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({aggregation:metricsExplorerAggregationRT});const metricsExplorerMetricOptionalFieldsRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({field:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["undefined"]])});const metricsExplorerMetricRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([metricsExplorerMetricRequiredFieldsRT,metricsExplorerMetricOptionalFieldsRT]);const timeRangeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],from:io_ts__WEBPACK_IMPORTED_MODULE_0__["number"],to:io_ts__WEBPACK_IMPORTED_MODULE_0__["number"],interval:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]});const metricsExplorerRequestBodyRequiredFieldsRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({timerange:timeRangeRT,indexPattern:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],metrics:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](metricsExplorerMetricRT)});const groupByRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"],io_ts__WEBPACK_IMPORTED_MODULE_0__["undefined"]]);const afterKeyObjectRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["record"](io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"]]));const metricsExplorerRequestBodyOptionalFieldsRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({groupBy:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([groupByRT,io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](groupByRT)]),afterKey:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"],io_ts__WEBPACK_IMPORTED_MODULE_0__["undefined"],afterKeyObjectRT]),limit:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["number"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"],io_ts__WEBPACK_IMPORTED_MODULE_0__["undefined"]]),filterQuery:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"],io_ts__WEBPACK_IMPORTED_MODULE_0__["undefined"]]),forceInterval:io_ts__WEBPACK_IMPORTED_MODULE_0__["boolean"],dropLastBucket:io_ts__WEBPACK_IMPORTED_MODULE_0__["boolean"]});const metricsExplorerRequestBodyRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([metricsExplorerRequestBodyRequiredFieldsRT,metricsExplorerRequestBodyOptionalFieldsRT]);const metricsExplorerPageInfoRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({total:io_ts__WEBPACK_IMPORTED_MODULE_0__["number"],afterKey:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"],afterKeyObjectRT])});const metricsExplorerColumnTypeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({date:null,number:null,string:null});const metricsExplorerColumnRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({name:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],type:metricsExplorerColumnTypeRT});const metricsExplorerRowRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({timestamp:io_ts__WEBPACK_IMPORTED_MODULE_0__["number"]}),io_ts__WEBPACK_IMPORTED_MODULE_0__["record"](io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["number"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"],io_ts__WEBPACK_IMPORTED_MODULE_0__["undefined"],io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](io_ts__WEBPACK_IMPORTED_MODULE_0__["object"])]))]);const metricsExplorerSeriesRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],columns:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](metricsExplorerColumnRT),rows:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](metricsExplorerRowRT)}),io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({keys:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](io_ts__WEBPACK_IMPORTED_MODULE_0__["string"])})]);const metricsExplorerResponseRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({series:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](metricsExplorerSeriesRT),pageInfo:metricsExplorerPageInfoRT})},102:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(70);var useEffectOnce_1=tslib_1.__importDefault(__webpack_require__(123));var useMount=function(fn){useEffectOnce_1.default((function(){fn()}))};exports.default=useMount},104:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return useUrlState}));__webpack_require__.d(__webpack_exports__,"a",(function(){return replaceStateKeyInQueryString}));var query_string__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(34);var query_string__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(query_string__WEBPACK_IMPORTED_MODULE_0__);var react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1);var react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);var rison_node__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(23);var rison_node__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(rison_node__WEBPACK_IMPORTED_MODULE_2__);var react_router_dom__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(67);var react_router_dom__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(react_router_dom__WEBPACK_IMPORTED_MODULE_3__);var _src_plugins_kibana_utils_public__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(33);var _src_plugins_kibana_utils_public__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_src_plugins_kibana_utils_public__WEBPACK_IMPORTED_MODULE_4__);const useUrlState=({defaultState:defaultState,decodeUrlState:decodeUrlState,encodeUrlState:encodeUrlState,urlStateKey:urlStateKey,writeDefaultState:writeDefaultState=false})=>{const history=Object(react_router_dom__WEBPACK_IMPORTED_MODULE_3__["useHistory"])();const queryString=history!==null&&history!==void 0&&history.location?getQueryStringFromLocation(history.location):"";const urlStateString=Object(react__WEBPACK_IMPORTED_MODULE_1__["useMemo"])(()=>{if(!queryString){return}return getParamFromQueryString(queryString,urlStateKey)},[queryString,urlStateKey]);const decodedState=Object(react__WEBPACK_IMPORTED_MODULE_1__["useMemo"])(()=>decodeUrlState(decodeRisonUrlState(urlStateString)),[decodeUrlState,urlStateString]);const state=Object(react__WEBPACK_IMPORTED_MODULE_1__["useMemo"])(()=>typeof decodedState!=="undefined"?decodedState:defaultState,[defaultState,decodedState]);const setState=Object(react__WEBPACK_IMPORTED_MODULE_1__["useCallback"])(newState=>{if(!history||!history.location){return}const currentLocation=history.location;const newLocation=replaceQueryStringInLocation(currentLocation,replaceStateKeyInQueryString(urlStateKey,typeof newState!=="undefined"?encodeUrlState(newState):undefined)(getQueryStringFromLocation(currentLocation)));if(newLocation!==currentLocation){history.replace(newLocation)}},[encodeUrlState,history,urlStateKey]);const[shouldInitialize,setShouldInitialize]=Object(react__WEBPACK_IMPORTED_MODULE_1__["useState"])(writeDefaultState&&typeof decodedState==="undefined");Object(react__WEBPACK_IMPORTED_MODULE_1__["useEffect"])(()=>{if(shouldInitialize){setShouldInitialize(false);setState(defaultState)}},[shouldInitialize,setState,defaultState]);return[state,setState]};const decodeRisonUrlState=value=>{try{return value?Object(rison_node__WEBPACK_IMPORTED_MODULE_2__["decode"])(value):undefined}catch(error){if(error instanceof Error&&error.message.startsWith("rison decoder error")){return{}}throw error}};const encodeRisonUrlState=state=>Object(rison_node__WEBPACK_IMPORTED_MODULE_2__["encode"])(state);const getQueryStringFromLocation=location=>location.search.substring(1);const getParamFromQueryString=(queryString,key)=>{const parsedQueryString=Object(query_string__WEBPACK_IMPORTED_MODULE_0__["parse"])(queryString,{sort:false});const queryParam=parsedQueryString[key];return Array.isArray(queryParam)?queryParam[0]:queryParam};const replaceStateKeyInQueryString=(stateKey,urlState)=>queryString=>{const previousQueryValues=Object(query_string__WEBPACK_IMPORTED_MODULE_0__["parse"])(queryString,{sort:false});const newValue=typeof urlState==="undefined"?previousQueryValues:{...previousQueryValues,[stateKey]:encodeRisonUrlState(urlState)};return Object(query_string__WEBPACK_IMPORTED_MODULE_0__["stringify"])(_src_plugins_kibana_utils_public__WEBPACK_IMPORTED_MODULE_4__["url"].encodeQuery(newValue),{sort:false,encode:false})};const replaceQueryStringInLocation=(location,queryString)=>{if(queryString===getQueryStringFromLocation(location)){return location}else{return{...location,search:`?${queryString}`}}}},123:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var react_1=__webpack_require__(1);var useEffectOnce=function(effect){react_1.useEffect(effect,[])};exports.default=useEffectOnce},125:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var react_1=__webpack_require__(1);function useMountedState(){var mountedRef=react_1.useRef(false);var get=react_1.useCallback((function(){return mountedRef.current}),[]);react_1.useEffect((function(){mountedRef.current=true;return function(){mountedRef.current=false}}));return get}exports.default=useMountedState},127:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return MetricsAPISeriesRT}));var io_ts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);var io_ts__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(io_ts__WEBPACK_IMPORTED_MODULE_0__);var _inventory_models_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(89);var _metrics_explorer__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(100);const MetricsAPITimerangeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],from:io_ts__WEBPACK_IMPORTED_MODULE_0__["number"],to:io_ts__WEBPACK_IMPORTED_MODULE_0__["number"],interval:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]});const groupByRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"],io_ts__WEBPACK_IMPORTED_MODULE_0__["undefined"]]);const MetricsAPIMetricRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],aggregations:_inventory_models_types__WEBPACK_IMPORTED_MODULE_1__["d"]});const MetricsAPIRequestRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({timerange:MetricsAPITimerangeRT,indexPattern:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],metrics:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](MetricsAPIMetricRT)}),io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({groupBy:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](groupByRT),modules:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]),afterKey:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["null"],_metrics_explorer__WEBPACK_IMPORTED_MODULE_2__["b"]]),limit:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["number"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"],io_ts__WEBPACK_IMPORTED_MODULE_0__["undefined"]]),filters:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](io_ts__WEBPACK_IMPORTED_MODULE_0__["object"]),dropLastBucket:io_ts__WEBPACK_IMPORTED_MODULE_0__["boolean"],alignDataToEnd:io_ts__WEBPACK_IMPORTED_MODULE_0__["boolean"]})]);const MetricsAPIPageInfoRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({afterKey:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["null"],_metrics_explorer__WEBPACK_IMPORTED_MODULE_2__["b"],io_ts__WEBPACK_IMPORTED_MODULE_0__["undefined"]]),interval:io_ts__WEBPACK_IMPORTED_MODULE_0__["number"]});const MetricsAPIColumnTypeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({date:null,number:null,string:null});const MetricsAPIColumnRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({name:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],type:MetricsAPIColumnTypeRT});const MetricsAPIRowRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({timestamp:io_ts__WEBPACK_IMPORTED_MODULE_0__["number"]}),io_ts__WEBPACK_IMPORTED_MODULE_0__["record"](io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["number"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"],io_ts__WEBPACK_IMPORTED_MODULE_0__["undefined"],io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](io_ts__WEBPACK_IMPORTED_MODULE_0__["object"])]))]);const MetricsAPISeriesRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],columns:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](MetricsAPIColumnRT),rows:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](MetricsAPIRowRT)}),io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({keys:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](io_ts__WEBPACK_IMPORTED_MODULE_0__["string"])})]);const MetricsAPIResponseRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({series:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](MetricsAPISeriesRT),info:MetricsAPIPageInfoRT})},133:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return logEntryContextRT}));__webpack_require__.d(__webpack_exports__,"e",(function(){return logEntryFieldRT}));__webpack_require__.d(__webpack_exports__,"f",(function(){return logEntryRT}));__webpack_require__.d(__webpack_exports__,"d",(function(){return logEntryCursorRT}));__webpack_require__.d(__webpack_exports__,"b",(function(){return logEntryBeforeCursorRT}));__webpack_require__.d(__webpack_exports__,"a",(function(){return logEntryAfterCursorRT}));var lib=__webpack_require__(0);var typed_json=__webpack_require__(156);var runtime_types=__webpack_require__(13);const logEntryCursorRT=lib["type"]({time:lib["number"],tiebreaker:lib["number"]});const logEntryBeforeCursorRT=lib["type"]({before:lib["union"]([logEntryCursorRT,lib["literal"]("last")])});const logEntryAfterCursorRT=lib["type"]({after:lib["union"]([logEntryCursorRT,lib["literal"]("first")])});const logEntryAroundCursorRT=lib["type"]({center:logEntryCursorRT});const getLogEntryCursorFromHit=hit=>Object(runtime_types["b"])(logEntryCursorRT)({time:hit.sort[0],tiebreaker:hit.sort[1]});const logMessageConstantPartRT=lib["type"]({constant:lib["string"]});const logMessageFieldPartRT=lib["type"]({field:lib["string"],value:typed_json["a"],highlights:lib["array"](lib["string"])});const logMessagePartRT=lib["union"]([logMessageConstantPartRT,logMessageFieldPartRT]);const logTimestampColumnRT=lib["type"]({columnId:lib["string"],timestamp:lib["number"]});const logFieldColumnRT=lib["type"]({columnId:lib["string"],field:lib["string"],value:typed_json["a"],highlights:lib["array"](lib["string"])});const logMessageColumnRT=lib["type"]({columnId:lib["string"],message:lib["array"](logMessagePartRT)});const logColumnRT=lib["union"]([logTimestampColumnRT,logFieldColumnRT,logMessageColumnRT]);const logEntryContextRT=lib["union"]([lib["type"]({}),lib["type"]({"container.id":lib["string"]}),lib["type"]({"host.name":lib["string"],"log.file.path":lib["string"]})]);const logEntryFieldRT=lib["type"]({field:lib["string"],value:typed_json["a"]});const logEntryRT=lib["type"]({id:lib["string"],index:lib["string"],cursor:logEntryCursorRT,columns:lib["array"](logColumnRT),context:logEntryContextRT})},156:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return jsonArrayRT}));__webpack_require__.d(__webpack_exports__,"b",(function(){return jsonObjectRT}));var io_ts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);var io_ts__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(io_ts__WEBPACK_IMPORTED_MODULE_0__);var _src_plugins_kibana_utils_common__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(71);var _src_plugins_kibana_utils_common__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_src_plugins_kibana_utils_common__WEBPACK_IMPORTED_MODULE_1__);const jsonScalarRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["null"],io_ts__WEBPACK_IMPORTED_MODULE_0__["boolean"],io_ts__WEBPACK_IMPORTED_MODULE_0__["number"],io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]]);const jsonValueRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["recursion"]("JsonValue",()=>io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([jsonScalarRT,jsonArrayRT,jsonObjectRT]));const jsonArrayRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["recursion"]("JsonArray",()=>io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](jsonValueRT));const jsonObjectRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["recursion"]("JsonObject",()=>io_ts__WEBPACK_IMPORTED_MODULE_0__["record"](io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],jsonValueRT))},487:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(70);var react_1=__webpack_require__(1);var useTimeoutFn_1=tslib_1.__importDefault(__webpack_require__(488));function useDebounce(fn,ms,deps){if(ms===void 0){ms=0}if(deps===void 0){deps=[]}var _a=useTimeoutFn_1.default(fn,ms),isReady=_a[0],cancel=_a[1],reset=_a[2];react_1.useEffect(reset,deps);return[isReady,cancel]}exports.default=useDebounce},488:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var react_1=__webpack_require__(1);function useTimeoutFn(fn,ms){if(ms===void 0){ms=0}var ready=react_1.useRef(false);var timeout=react_1.useRef();var callback=react_1.useRef(fn);var isReady=react_1.useCallback((function(){return ready.current}),[]);var set=react_1.useCallback((function(){ready.current=false;timeout.current&&clearTimeout(timeout.current);timeout.current=setTimeout((function(){ready.current=true;callback.current()}),ms)}),[ms]);var clear=react_1.useCallback((function(){ready.current=null;timeout.current&&clearTimeout(timeout.current)}),[]);react_1.useEffect((function(){callback.current=fn}),[fn]);react_1.useEffect((function(){set();return clear}),[ms]);return[isReady,clear,set]}exports.default=useTimeoutFn},492:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"ExpressionEditor",(function(){return ExpressionEditor}));__webpack_require__.d(__webpack_exports__,"SourceStatusWrapper",(function(){return SourceStatusWrapper}));__webpack_require__.d(__webpack_exports__,"Editor",(function(){return Editor}));__webpack_require__.d(__webpack_exports__,"ExpressionLike",(function(){return ExpressionLike}));var external_kbnSharedDeps_ElasticEui_=__webpack_require__(8);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(2);var external_kbnSharedDeps_React_=__webpack_require__(1);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var useMount=__webpack_require__(102);var useMount_default=__webpack_require__.n(useMount);var public_=__webpack_require__(3);var triggersActionsUi_public_=__webpack_require__(82);var types=__webpack_require__(5);var runtime_types=__webpack_require__(13);var log_source=__webpack_require__(87);var source_id=__webpack_require__(179);const GroupBySelector=({onChange:onChange,fields:fields,selectedGroups:selectedGroups=[],label:label,placeholder:placeholder})=>{const handleChange=Object(external_kbnSharedDeps_React_["useCallback"])(selectedOptions=>{const groupBy=selectedOptions.map(option=>option.label);onChange(groupBy)},[onChange]);const formattedSelectedGroups=Object(external_kbnSharedDeps_React_["useMemo"])(()=>selectedGroups.map(group=>({label:group})),[selectedGroups]);const options=Object(external_kbnSharedDeps_React_["useMemo"])(()=>fields.filter(field=>field.aggregatable).map(field=>({label:field.name})),[fields]);return external_kbnSharedDeps_React_default.a.createElement("div",{style:{minWidth:"300px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{placeholder:placeholder,"aria-label":label,fullWidth:true,singleSelection:false,selectedOptions:formattedSelectedGroups,options:options,onChange:handleChange,isClearable:true}))};const DEFAULT_GROUP_BY_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.alerting.alertFlyout.groupByLabel",{defaultMessage:"Group By"});const EVERYTHING_PLACEHOLDER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.alerting.alertFlyout.groupBy.placeholder",{defaultMessage:"Nothing (ungrouped)"});const GroupByExpression=({selectedGroups:selectedGroups=[],fields:fields,label:label,onChange:onChange})=>{const[isPopoverOpen,setIsPopoverOpen]=Object(external_kbnSharedDeps_React_["useState"])(false);const expressionValue=Object(external_kbnSharedDeps_React_["useMemo"])(()=>selectedGroups.length>0?selectedGroups.join(", "):EVERYTHING_PLACEHOLDER,[selectedGroups]);const labelProp=label!==null&&label!==void 0?label:DEFAULT_GROUP_BY_LABEL;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"groupByExpression",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiExpression"],{description:labelProp,uppercase:true,value:expressionValue,isActive:isPopoverOpen,onClick:()=>setIsPopoverOpen(true)}),isOpen:isPopoverOpen,closePopover:()=>setIsPopoverOpen(false),ownFocus:true,panelPaddingSize:"s",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement("div",{style:{zIndex:11e3}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverTitle"],null,labelProp),external_kbnSharedDeps_React_default.a.createElement(GroupBySelector,{selectedGroups:selectedGroups,onChange:onChange,fields:fields,label:labelProp,placeholder:EVERYTHING_PLACEHOLDER})))))};var validation=__webpack_require__(43);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(12);var external_kbnSharedDeps_Lodash_=__webpack_require__(21);const firstCriterionFieldPrefix=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.firstCriterionFieldPrefix",{defaultMessage:"with"});const successiveCriterionFieldPrefix=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.successiveCriterionFieldPrefix",{defaultMessage:"and"});const criterionFieldTitle=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.criterionFieldTitle",{defaultMessage:"Field"});const criterionComparatorValueTitle=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.criterionComparatorValueTitle",{defaultMessage:"Comparison : Value"});const getCompatibleComparatorsForField=fieldInfo=>{if((fieldInfo===null||fieldInfo===void 0?void 0:fieldInfo.type)==="number"){return[{value:types["a"].GT,text:types["b"][types["a"].GT]},{value:types["a"].GT_OR_EQ,text:types["b"][types["a"].GT_OR_EQ]},{value:types["a"].LT,text:types["b"][types["a"].LT]},{value:types["a"].LT_OR_EQ,text:types["b"][types["a"].LT_OR_EQ]},{value:types["a"].EQ,text:types["b"][`${types["a"].EQ}:number`]},{value:types["a"].NOT_EQ,text:types["b"][`${types["a"].NOT_EQ}:number`]}]}else if(fieldInfo!==null&&fieldInfo!==void 0&&fieldInfo.aggregatable){return[{value:types["a"].EQ,text:types["b"][types["a"].EQ]},{value:types["a"].NOT_EQ,text:types["b"][types["a"].NOT_EQ]}]}else{return[{value:types["a"].MATCH,text:types["b"][types["a"].MATCH]},{value:types["a"].NOT_MATCH,text:types["b"][types["a"].NOT_MATCH]},{value:types["a"].MATCH_PHRASE,text:types["b"][types["a"].MATCH_PHRASE]},{value:types["a"].NOT_MATCH_PHRASE,text:types["b"][types["a"].NOT_MATCH_PHRASE]}]}};const getFieldInfo=(fields,fieldName)=>fields.find(field=>field.name===fieldName);const Criterion=({idx:idx,fields:fields,criterion:criterion,updateCriterion:updateCriterion,removeCriterion:removeCriterion,canDelete:canDelete,errors:errors})=>{var _criterion$field,_criterion$field2,_ref,_ComparatorToi18nMap$;const[isFieldPopoverOpen,setIsFieldPopoverOpen]=Object(external_kbnSharedDeps_React_["useState"])(false);const[isComparatorPopoverOpen,setIsComparatorPopoverOpen]=Object(external_kbnSharedDeps_React_["useState"])(false);const fieldOptions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>fields.map(field=>({value:field.name,text:field.name})),[fields]);const fieldInfo=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(criterion.field){return getFieldInfo(fields,criterion.field)}else{return undefined}},[fields,criterion]);const compatibleComparatorOptions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getCompatibleComparatorsForField(fieldInfo),[fieldInfo]);const handleFieldChange=Object(external_kbnSharedDeps_React_["useCallback"])(e=>{const fieldName=e.target.value;const nextFieldInfo=getFieldInfo(fields,fieldName);if((fieldInfo===null||fieldInfo===void 0?void 0:fieldInfo.type)!==(nextFieldInfo===null||nextFieldInfo===void 0?void 0:nextFieldInfo.type)||(fieldInfo===null||fieldInfo===void 0?void 0:fieldInfo.aggregatable)!==(nextFieldInfo===null||nextFieldInfo===void 0?void 0:nextFieldInfo.aggregatable)){const compatibleComparators=getCompatibleComparatorsForField(nextFieldInfo);updateCriterion(idx,{field:fieldName,comparator:compatibleComparators[0].value,value:undefined})}else{updateCriterion(idx,{field:fieldName})}},[fieldInfo,fields,idx,updateCriterion]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"criterion-field",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiExpression"],{description:idx===0?firstCriterionFieldPrefix:successiveCriterionFieldPrefix,uppercase:true,value:(_criterion$field=criterion.field)!==null&&_criterion$field!==void 0?_criterion$field:"a chosen field",isActive:isFieldPopoverOpen,color:errors.field.length===0?"secondary":"danger",onClick:e=>{e.stopPropagation();setIsFieldPopoverOpen(true)}}),isOpen:isFieldPopoverOpen,closePopover:()=>setIsFieldPopoverOpen(false),ownFocus:true,panelPaddingSize:"s",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverTitle"],null,criterionFieldTitle),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{isInvalid:errors.field.length>0,error:errors.field},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{compressed:true,hasNoInitialSelection:criterion.field==null,value:(_criterion$field2=criterion.field)!==null&&_criterion$field2!==void 0?_criterion$field2:"",onChange:handleFieldChange,options:fieldOptions}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"criterion-comparator-value",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiExpression"],{description:criterion.comparator?(_ref=(_ComparatorToi18nMap$=types["b"][`${criterion.comparator}:${fieldInfo===null||fieldInfo===void 0?void 0:fieldInfo.type}`])!==null&&_ComparatorToi18nMap$!==void 0?_ComparatorToi18nMap$:types["b"][criterion.comparator])!==null&&_ref!==void 0?_ref:"":"",uppercase:true,value:criterion.value,isActive:isComparatorPopoverOpen,color:errors.comparator.length===0&&errors.value.length===0?"secondary":"danger",onClick:e=>{e.stopPropagation();setIsComparatorPopoverOpen(true)}}),isOpen:isComparatorPopoverOpen,closePopover:()=>setIsComparatorPopoverOpen(false),ownFocus:true,panelPaddingSize:"s",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverTitle"],null,criterionComparatorValueTitle),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"l"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{isInvalid:errors.comparator.length>0,error:errors.comparator},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{compressed:true,hasNoInitialSelection:criterion.comparator==null,value:criterion.comparator,onChange:e=>updateCriterion(idx,{comparator:e.target.value}),options:compatibleComparatorOptions}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{isInvalid:errors.value.length>0,error:errors.value},(fieldInfo===null||fieldInfo===void 0?void 0:fieldInfo.type)==="number"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{compressed:true,value:criterion.value,onChange:e=>{const number=parseFloat(e.target.value);updateCriterion(idx,{value:Object(external_kbnSharedDeps_Lodash_["isNumber"])(number)&&Object(external_kbnSharedDeps_Lodash_["isFinite"])(number)?number:undefined})}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{compressed:true,value:criterion.value,onChange:e=>updateCriterion(idx,{value:e.target.value})}))))))))),canDelete&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.removeCondition",{defaultMessage:"Remove condition"}),color:"danger",iconType:"trash",onClick:e=>{e.stopPropagation();removeCriterion(idx)}})))};var useDebounce=__webpack_require__(487);var useDebounce_default=__webpack_require__.n(useDebounce);var external_kbnSharedDeps_ElasticCharts_=__webpack_require__(69);var external_kbnSharedDeps_Moment_=__webpack_require__(50);var external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_);var formatters_number=__webpack_require__(7);const tooltipProps={headerFormatter:tooltipValue=>external_kbnSharedDeps_Moment_default()(tooltipValue.value).format("Y-MM-DD HH:mm:ss")};const NUM_BUCKETS=20;const TIME_LABELS={s:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.alerts.timeLabels.seconds",{defaultMessage:"seconds"}),m:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.alerts.timeLabels.minutes",{defaultMessage:"minutes"}),h:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.alerts.timeLabels.hours",{defaultMessage:"hours"}),d:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.alerts.timeLabels.days",{defaultMessage:"days"})};const useDateFormatter=(xMin,xMax)=>{const dateFormatter=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(typeof xMin==="number"&&typeof xMax==="number"){return Object(external_kbnSharedDeps_ElasticCharts_["niceTimeFormatter"])([xMin,xMax])}else{return value=>`${value}`}},[xMin,xMax]);return dateFormatter};const yAxisFormatter=formatters_number["a"];const getDomain=(series,stacked=false)=>{let min=null;let max=null;const valuesByTimestamp=series.reduce((acc,serie)=>{serie.points.forEach(point=>{const valuesForTimestamp=acc[point.timestamp]||[];acc[point.timestamp]=[...valuesForTimestamp,point.value]});return acc},{});const pointValues=Object.values(valuesByTimestamp);pointValues.forEach(results=>{const maxResult=stacked?Object(external_kbnSharedDeps_Lodash_["sum"])(results):Object(external_kbnSharedDeps_Lodash_["max"])(results);const minResult=Object(external_kbnSharedDeps_Lodash_["min"])(results);if(maxResult&&(!max||maxResult>max)){max=maxResult}if(minResult&&(!min||minResult<min)){min=minResult}});const timestampValues=Object.keys(valuesByTimestamp).map(Number);const minTimestamp=Object(external_kbnSharedDeps_Lodash_["min"])(timestampValues)||0;const maxTimestamp=Object(external_kbnSharedDeps_Lodash_["max"])(timestampValues)||0;return{yMin:min||0,yMax:max||0,xMin:minTimestamp,xMax:maxTimestamp}};const getChartTheme=isDarkMode=>isDarkMode?external_kbnSharedDeps_ElasticCharts_["DARK_THEME"]:external_kbnSharedDeps_ElasticCharts_["LIGHT_THEME"];const EmptyContainer=({children:children})=>external_kbnSharedDeps_React_default.a.createElement("div",{style:{width:"100%",height:150,display:"flex",justifyContent:"center",alignItems:"center"}},children);const ChartContainer=({children:children})=>external_kbnSharedDeps_React_default.a.createElement("div",{style:{width:"100%",height:150}},children);const NoDataState=()=>external_kbnSharedDeps_React_default.a.createElement(EmptyContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued","data-test-subj":"noChartData"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.infra.alerts.charts.noDataMessage",defaultMessage:"No chart data available"})));const LoadingState=()=>external_kbnSharedDeps_React_default.a.createElement(EmptyContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued","data-test-subj":"loadingData"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.infra.alerts.charts.loadingMessage",defaultMessage:"Loading"})));const ErrorState=()=>external_kbnSharedDeps_React_default.a.createElement(EmptyContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued","data-test-subj":"chartErrorState"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.infra.alerts.charts.errorMessage",defaultMessage:"Uh oh, something went wrong"})));var color_palette=__webpack_require__(91);var log_alerts=__webpack_require__(217);var use_tracked_promise=__webpack_require__(85);var http_api=__webpack_require__(95);const useChartPreviewData=({sourceId:sourceId,alertParams:alertParams,buckets:buckets})=>{const{http:http}=Object(public_["useKibana"])().services;const[chartPreviewData,setChartPreviewData]=Object(external_kbnSharedDeps_React_["useState"])([]);const[hasError,setHasError]=Object(external_kbnSharedDeps_React_["useState"])(false);const[getChartPreviewDataRequest,getChartPreviewData]=Object(use_tracked_promise["b"])({cancelPreviousOn:"creation",createPromise:async()=>{setHasError(false);return await callGetChartPreviewDataAPI(sourceId,http.fetch,alertParams,buckets)},onResolve:({data:{series:series}})=>{setHasError(false);setChartPreviewData(series)},onReject:error=>{setHasError(true)}},[sourceId,http,alertParams,buckets]);const isLoading=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getChartPreviewDataRequest.state==="pending",[getChartPreviewDataRequest.state]);return{chartPreviewData:chartPreviewData,hasError:hasError,isLoading:isLoading,getChartPreviewData:getChartPreviewData}};const callGetChartPreviewDataAPI=async(sourceId,fetch,alertParams,buckets)=>{const response=await fetch(http_api["a"],{method:"POST",body:JSON.stringify(http_api["l"].encode({data:{sourceId:sourceId,alertParams:alertParams,buckets:buckets}}))});return Object(runtime_types["b"])(http_api["m"])(response)};const GROUP_LIMIT=5;const CriterionPreview=({alertParams:alertParams,chartCriterion:chartCriterion,sourceId:sourceId,showThreshold:showThreshold})=>{const chartAlertParams=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const{field:field,comparator:comparator,value:value}=chartCriterion;const criteria=field&&comparator&&value?[{field:field,comparator:comparator,value:value}]:[];const params={criteria:criteria,timeSize:alertParams.timeSize,timeUnit:alertParams.timeUnit,groupBy:alertParams.groupBy};try{return Object(runtime_types["b"])(log_alerts["b"])(params)}catch(error){return null}},[alertParams.timeSize,alertParams.timeUnit,alertParams.groupBy,chartCriterion]);if(chartAlertParams===null||chartAlertParams.criteria.length===0)return null;return external_kbnSharedDeps_React_default.a.createElement(CriterionPreviewChart,{buckets:!chartAlertParams.groupBy||chartAlertParams.groupBy.length===0?NUM_BUCKETS:NUM_BUCKETS/4,sourceId:sourceId,threshold:alertParams.count,chartAlertParams:chartAlertParams,showThreshold:showThreshold})};const CriterionPreviewChart=({buckets:buckets,sourceId:sourceId,threshold:threshold,chartAlertParams:chartAlertParams,showThreshold:showThreshold})=>{const{uiSettings:uiSettings}=Object(public_["useKibana"])().services;const isDarkMode=(uiSettings===null||uiSettings===void 0?void 0:uiSettings.get("theme:darkMode"))||false;const{getChartPreviewData:getChartPreviewData,isLoading:isLoading,hasError:hasError,chartPreviewData:series}=useChartPreviewData({sourceId:sourceId,alertParams:chartAlertParams,buckets:buckets});useDebounce_default()(()=>{getChartPreviewData()},500,[getChartPreviewData]);const isStacked=false;const{timeSize:timeSize,timeUnit:timeUnit,groupBy:groupBy}=chartAlertParams;const isGrouped=groupBy&&groupBy.length>0?true:false;const isAbove=showThreshold&&threshold&&threshold.comparator?[types["a"].GT,types["a"].GT_OR_EQ].includes(threshold.comparator):false;const isBelow=showThreshold&&threshold&&threshold.comparator?[types["a"].LT,types["a"].LT_OR_EQ].includes(threshold.comparator):false;const filteredSeries=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(!isGrouped){return series}const sortedByMax=series.sort((a,b)=>{const aMax=Math.max(...a.points.map(point=>point.value));const bMax=Math.max(...b.points.map(point=>point.value));return bMax-aMax});const sortedSeries=!isAbove&&!isBelow||isAbove?sortedByMax:sortedByMax.reverse();return sortedSeries.slice(0,GROUP_LIMIT)},[series,isGrouped,isAbove,isBelow]);const barSeries=Object(external_kbnSharedDeps_React_["useMemo"])(()=>filteredSeries.reduce((acc,serie)=>{const barPoints=serie.points.reduce((pointAcc,point)=>[...pointAcc,{...point,groupBy:serie.id}],[]);return[...acc,...barPoints]},[]),[filteredSeries]);const lookback=timeSize*buckets;const hasData=series.length>0;const{yMin:yMin,yMax:yMax,xMin:xMin,xMax:xMax}=getDomain(filteredSeries,isStacked);const chartDomain={max:showThreshold&&threshold&&threshold.value?Math.max(yMax,threshold.value)*1.1:yMax*1.1,min:showThreshold&&threshold&&threshold.value?Math.min(yMin,threshold.value):yMin};if(showThreshold&&threshold&&threshold.value&&chartDomain.min===threshold.value){chartDomain.min=chartDomain.min*.9}const THRESHOLD_OPACITY=.3;const groupByLabel=groupBy&&groupBy.length>0?groupBy.join(", "):null;const dateFormatter=useDateFormatter(xMin,xMax);const timeLabel=TIME_LABELS[timeUnit];if(isLoading){return external_kbnSharedDeps_React_default.a.createElement(LoadingState,null)}else if(hasError){return external_kbnSharedDeps_React_default.a.createElement(ErrorState,null)}else if(!hasData){return external_kbnSharedDeps_React_default.a.createElement(NoDataState,null)}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ChartContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Chart"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["BarSeries"],{id:"criterion-preview",xScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear,yScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear,xAccessor:"timestamp",yAccessors:["value"],splitSeriesAccessors:["groupBy"],stackAccessors:isStacked?["timestamp"]:undefined,data:barSeries,barSeriesStyle:{rectBorder:{stroke:!isGrouped?Object(color_palette["b"])(color_palette["a"].color0):undefined,strokeWidth:1,visible:true},rect:{opacity:1}},color:!isGrouped?Object(color_palette["b"])(color_palette["a"].color0):undefined}),showThreshold&&threshold&&threshold.value?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["LineAnnotation"],{id:`threshold-line`,domainType:external_kbnSharedDeps_ElasticCharts_["AnnotationDomainTypes"].YDomain,dataValues:[{dataValue:threshold.value}],style:{line:{strokeWidth:2,stroke:Object(color_palette["b"])(color_palette["a"].color1),opacity:1}}}):null,showThreshold&&threshold&&threshold.value&&isBelow?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["RectAnnotation"],{id:"below-threshold",style:{fill:Object(color_palette["b"])(color_palette["a"].color1),opacity:THRESHOLD_OPACITY},dataValues:[{coordinates:{x0:xMin,x1:xMax,y0:chartDomain.min,y1:threshold.value}}]}):null,showThreshold&&threshold&&threshold.value&&isAbove?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["RectAnnotation"],{id:"above-threshold",style:{fill:Object(color_palette["b"])(color_palette["a"].color1),opacity:THRESHOLD_OPACITY},dataValues:[{coordinates:{x0:xMin,x1:xMax,y0:threshold.value,y1:chartDomain.max}}]}):null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Axis"],{id:"timestamp",position:external_kbnSharedDeps_ElasticCharts_["Position"].Bottom,showOverlappingTicks:true,tickFormat:dateFormatter}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Axis"],{id:"values",position:external_kbnSharedDeps_ElasticCharts_["Position"].Left,tickFormat:yAxisFormatter,domain:chartDomain}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Settings"],{tooltip:tooltipProps,theme:getChartTheme(isDarkMode)}))),external_kbnSharedDeps_React_default.a.createElement("div",{style:{textAlign:"center"}},groupByLabel!=null?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.infra.logs.alerts.dataTimeRangeLabelWithGrouping",defaultMessage:"Last {lookback} {timeLabel} of data, grouped by {groupByLabel} (showing {displayedGroups}/{totalGroups} groups)",values:{groupByLabel:groupByLabel,timeLabel:timeLabel,lookback:lookback,displayedGroups:filteredSeries.length,totalGroups:series.length}})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.infra.logs.alerts.dataTimeRangeLabel",defaultMessage:"Last {lookback} {timeLabel} of data",values:{timeLabel:timeLabel,lookback:lookback}}))))};function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}const QueryAText=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alerting.threshold.ratioCriteriaQueryAText",{defaultMessage:"Query A"});const QueryBText=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alerting.threshold.ratioCriteriaQueryBText",{defaultMessage:"Query B"});const Criteria=props=>{const{criteria:criteria,errors:errors}=props;if(!criteria||criteria.length===0)return null;return!Object(types["h"])(criteria)?external_kbnSharedDeps_React_default.a.createElement(CountCriteria,_extends({},props,{criteria:criteria,errors:errors})):external_kbnSharedDeps_React_default.a.createElement(RatioCriteria,_extends({},props,{criteria:criteria,errors:errors}))};const CriteriaWrapper=props=>{const{updateCriterion:updateCriterion,removeCriterion:removeCriterion,addCriterion:addCriterion,criteria:criteria,fields:fields,errors:errors,alertParams:alertParams,sourceId:sourceId,isRatio:isRatio=false}=props;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},criteria.map((criterion,idx)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAccordion"],{id:`criterion-${idx}`,buttonContent:external_kbnSharedDeps_React_default.a.createElement(Criterion,{idx:idx,fields:fields,criterion:criterion,updateCriterion:updateCriterion,removeCriterion:removeCriterion,canDelete:criteria.length>1,errors:errors[idx]}),key:idx,arrowDisplay:"right"},external_kbnSharedDeps_React_default.a.createElement(CriterionPreview,{alertParams:alertParams,chartCriterion:criterion,sourceId:sourceId,showThreshold:!isRatio}))),external_kbnSharedDeps_React_default.a.createElement(AddCriterionButton,{addCriterion:addCriterion})))};const RatioCriteria=props=>{const{criteria:criteria,defaultCriterion:defaultCriterion,errors:errors,updateCriteria:updateCriteria}=props;const handleUpdateNumeratorCriteria=Object(external_kbnSharedDeps_React_["useCallback"])(criteriaParam=>{const nextCriteria=[criteriaParam,Object(types["e"])(criteria)];updateCriteria(nextCriteria)},[updateCriteria,criteria]);const handleUpdateDenominatorCriteria=Object(external_kbnSharedDeps_React_["useCallback"])(criteriaParam=>{const nextCriteria=[Object(types["f"])(criteria),criteriaParam];updateCriteria(nextCriteria)},[updateCriteria,criteria]);const{updateCriterion:updateNumeratorCriterion,addCriterion:addNumeratorCriterion,removeCriterion:removeNumeratorCriterion}=useCriteriaState(Object(types["f"])(criteria),defaultCriterion,handleUpdateNumeratorCriteria);const{updateCriterion:updateDenominatorCriterion,addCriterion:addDenominatorCriterion,removeCriterion:removeDenominatorCriterion}=useCriteriaState(Object(types["e"])(criteria),defaultCriterion,handleUpdateDenominatorCriteria);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xxl"}),external_kbnSharedDeps_React_default.a.createElement(ExpressionLike,{text:QueryAText}),external_kbnSharedDeps_React_default.a.createElement(CriteriaWrapper,_extends({},props,{criteria:Object(types["f"])(criteria),updateCriterion:updateNumeratorCriterion,addCriterion:addNumeratorCriterion,removeCriterion:removeNumeratorCriterion,errors:errors[0],isRatio:true})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(ExpressionLike,{text:QueryBText}),external_kbnSharedDeps_React_default.a.createElement(CriteriaWrapper,_extends({},props,{criteria:Object(types["e"])(criteria),updateCriterion:updateDenominatorCriterion,addCriterion:addDenominatorCriterion,removeCriterion:removeDenominatorCriterion,errors:errors[1],isRatio:true})))};const CountCriteria=props=>{const{criteria:criteria,defaultCriterion:defaultCriterion,updateCriteria:updateCriteria,errors:errors}=props;const{updateCriterion:updateCriterion,addCriterion:addCriterion,removeCriterion:removeCriterion}=useCriteriaState(criteria,defaultCriterion,updateCriteria);return external_kbnSharedDeps_React_default.a.createElement(CriteriaWrapper,_extends({},props,{updateCriterion:updateCriterion,addCriterion:addCriterion,removeCriterion:removeCriterion,errors:errors[0]}))};const useCriteriaState=(criteria,defaultCriterion,onUpdateCriteria)=>{const updateCriterion=Object(external_kbnSharedDeps_React_["useCallback"])((idx,criterionParams)=>{const nextCriteria=criteria.map((criterion,index)=>idx===index?{...criterion,...criterionParams}:criterion);onUpdateCriteria(nextCriteria)},[criteria,onUpdateCriteria]);const addCriterion=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{const nextCriteria=[...criteria,defaultCriterion];onUpdateCriteria(nextCriteria)},[criteria,defaultCriterion,onUpdateCriteria]);const removeCriterion=Object(external_kbnSharedDeps_React_["useCallback"])(idx=>{const nextCriteria=criteria.filter((_criterion,index)=>index!==idx);onUpdateCriteria(nextCriteria)},[criteria,onUpdateCriteria]);return{updateCriterion:updateCriterion,addCriterion:addCriterion,removeCriterion:removeCriterion}};const AddCriterionButton=({addCriterion:addCriterion})=>external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{color:"primary",iconSide:"left",flush:"left",iconType:"plusInCircleFilled",onClick:addCriterion},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.infra.logs.alertFlyout.addCondition",defaultMessage:"Add condition"})));const thresholdPrefix=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.thresholdPrefix",{defaultMessage:"is"});const popoverTitle=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.thresholdPopoverTitle",{defaultMessage:"Threshold"});const getComparatorOptions=()=>[{value:types["a"].LT,text:types["b"][types["a"].LT]},{value:types["a"].LT_OR_EQ,text:types["b"][types["a"].LT_OR_EQ]},{value:types["a"].GT,text:types["b"][types["a"].GT]},{value:types["a"].GT_OR_EQ,text:types["b"][types["a"].GT_OR_EQ]}];const Threshold=({comparator:comparator,value:value,updateThreshold:updateThreshold,errors:errors})=>{const[isThresholdPopoverOpen,setThresholdPopoverOpenState]=Object(external_kbnSharedDeps_React_["useState"])(false);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"threshold",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiExpression"],{description:thresholdPrefix,uppercase:true,value:`${comparator?types["b"][comparator]:""} ${value?value:""}`,isActive:isThresholdPopoverOpen,onClick:()=>setThresholdPopoverOpenState(true)}),isOpen:isThresholdPopoverOpen,closePopover:()=>setThresholdPopoverOpenState(false),ownFocus:true,panelPaddingSize:"s",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverTitle"],null,popoverTitle),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{compressed:true,value:comparator,onChange:e=>updateThreshold({comparator:e.target.value}),options:getComparatorOptions()}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{isInvalid:errors.value.length>0,error:errors.value},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{compressed:true,value:value,onChange:e=>{const number=parseFloat(e.target.value);updateThreshold({value:Object(external_kbnSharedDeps_Lodash_["isNumber"])(number)&&Object(external_kbnSharedDeps_Lodash_["isFinite"])(number)?number:undefined})}}))))))))};const typePrefix=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.thresholdTypePrefix",{defaultMessage:"when the"});const countSuffix=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.thresholdTypeCountSuffix",{defaultMessage:"of log entries"});const ratioSuffix=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.thresholdTypeRatioSuffix",{defaultMessage:"of Query A to Query B"});const countI18n=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.thresholdTypeCount",{defaultMessage:"count"});const ratioI18n=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.thresholdTypeRatio",{defaultMessage:"ratio"});const getOptions=()=>[{value:"ratio",text:ratioI18n},{value:"count",text:countI18n}];const getThresholdType=criteria=>Object(types["h"])(criteria)?"ratio":"count";const TypeSwitcher=({criteria:criteria,updateType:updateType})=>{const[isThresholdTypePopoverOpen,setThresholdTypePopoverOpenState]=Object(external_kbnSharedDeps_React_["useState"])(false);const thresholdType=getThresholdType(criteria);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"thresholdType",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiExpression"],{description:typePrefix,uppercase:true,value:thresholdType==="ratio"?ratioI18n:countI18n,isActive:isThresholdTypePopoverOpen,onClick:()=>setThresholdTypePopoverOpenState(true)}),external_kbnSharedDeps_React_default.a.createElement(ExpressionLike,{text:thresholdType==="ratio"?ratioSuffix.toUpperCase():countSuffix.toUpperCase()})),isOpen:isThresholdTypePopoverOpen,closePopover:()=>setThresholdTypePopoverOpenState(false),ownFocus:true,panelPaddingSize:"s",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{compressed:true,value:thresholdType,onChange:e=>updateType(thresholdType==="ratio"?"count":"ratio"),options:getOptions()}))))))};const DEFAULT_BASE_EXPRESSION={timeSize:5,timeUnit:"m"};const DEFAULT_FIELD="log.level";const createDefaultCriterion=(availableFields,value)=>availableFields.some(availableField=>availableField.name===DEFAULT_FIELD)?{field:DEFAULT_FIELD,comparator:types["a"].EQ,value:value}:{field:undefined,comparator:undefined,value:undefined};const createDefaultCountAlertParams=availableFields=>({...DEFAULT_BASE_EXPRESSION,count:{value:75,comparator:types["a"].GT},criteria:[createDefaultCriterion(availableFields,"error")]});const createDefaultRatioAlertParams=availableFields=>({...DEFAULT_BASE_EXPRESSION,count:{value:2,comparator:types["a"].GT},criteria:[[createDefaultCriterion(availableFields,"error")],[createDefaultCriterion(availableFields,"warning")]]});const ExpressionEditor=props=>{var _props$metadata$isInt,_props$metadata;const isInternal=(_props$metadata$isInt=(_props$metadata=props.metadata)===null||_props$metadata===void 0?void 0:_props$metadata.isInternal)!==null&&_props$metadata$isInt!==void 0?_props$metadata$isInt:false;const[sourceId]=Object(source_id["b"])();const{http:http}=Object(public_["useKibana"])().services;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isInternal?external_kbnSharedDeps_React_default.a.createElement(SourceStatusWrapper,props,external_kbnSharedDeps_React_default.a.createElement(Editor,props)):external_kbnSharedDeps_React_default.a.createElement(log_source["a"],{sourceId:sourceId,fetch:http.fetch},external_kbnSharedDeps_React_default.a.createElement(SourceStatusWrapper,props,external_kbnSharedDeps_React_default.a.createElement(Editor,props))))};const SourceStatusWrapper=({children:children})=>{const{initialize:initialize,isLoadingSourceStatus:isLoadingSourceStatus,isUninitialized:isUninitialized,hasFailedLoadingSourceStatus:hasFailedLoadingSourceStatus,loadSourceStatus:loadSourceStatus}=Object(log_source["c"])();useMount_default()(()=>{initialize()});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isLoadingSourceStatus||isUninitialized?external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"})):hasFailedLoadingSourceStatus?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.sourceStatusError",{defaultMessage:"Sorry, there was a problem loading field information"}),color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{onClick:loadSourceStatus,iconType:"refresh"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.infra.logs.alertFlyout.sourceStatusErrorTryAgain",{defaultMessage:"Try again"}))):children)};const Editor=props=>{var _alertParams$count,_alertParams$count2;const{setAlertParams:setAlertParams,alertParams:alertParams,errors:errors}=props;const[hasSetDefaults,setHasSetDefaults]=Object(external_kbnSharedDeps_React_["useState"])(false);const{sourceId:sourceId,sourceStatus:sourceStatus}=Object(log_source["c"])();const{criteria:criteriaErrors,threshold:thresholdErrors,timeSizeUnit:timeSizeUnitErrors,timeWindowSize:timeWindowSizeErrors}=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(runtime_types["b"])(validation["a"])(errors),[errors]);const supportedFields=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(sourceStatus!==null&&sourceStatus!==void 0&&sourceStatus.logIndexFields){return sourceStatus.logIndexFields.filter(field=>(field.type==="string"||field.type==="number")&&field.searchable)}else{return[]}},[sourceStatus]);const groupByFields=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(sourceStatus!==null&&sourceStatus!==void 0&&sourceStatus.logIndexFields){return sourceStatus.logIndexFields.filter(field=>field.type==="string"&&field.aggregatable)}else{return[]}},[sourceStatus]);const updateThreshold=Object(external_kbnSharedDeps_React_["useCallback"])(thresholdParams=>{const nextThresholdParams={...alertParams.count,...thresholdParams};setAlertParams("count",nextThresholdParams)},[alertParams.count,setAlertParams]);const updateCriteria=Object(external_kbnSharedDeps_React_["useCallback"])(criteria=>{setAlertParams("criteria",criteria)},[setAlertParams]);const updateTimeSize=Object(external_kbnSharedDeps_React_["useCallback"])(ts=>{setAlertParams("timeSize",ts)},[setAlertParams]);const updateTimeUnit=Object(external_kbnSharedDeps_React_["useCallback"])(tu=>{if(types["j"].is(tu)){setAlertParams("timeUnit",tu)}},[setAlertParams]);const updateGroupBy=Object(external_kbnSharedDeps_React_["useCallback"])(groups=>{setAlertParams("groupBy",groups)},[setAlertParams]);const defaultCountAlertParams=Object(external_kbnSharedDeps_React_["useMemo"])(()=>createDefaultCountAlertParams(supportedFields),[supportedFields]);const updateType=Object(external_kbnSharedDeps_React_["useCallback"])(type=>{const defaults=type==="count"?defaultCountAlertParams:createDefaultRatioAlertParams(supportedFields);setAlertParams("count",defaults.count);setAlertParams("criteria",defaults.criteria)},[defaultCountAlertParams,setAlertParams,supportedFields]);useMount_default()(()=>{const newAlertParams={...defaultCountAlertParams,...alertParams};for(const[key,value]of Object.entries(newAlertParams)){setAlertParams(key,value)}setHasSetDefaults(true)});if(!hasSetDefaults)return null;const criteriaComponent=alertParams.criteria?external_kbnSharedDeps_React_default.a.createElement(Criteria,{fields:supportedFields,criteria:alertParams.criteria,defaultCriterion:defaultCountAlertParams.criteria[0],errors:criteriaErrors,alertParams:alertParams,sourceId:sourceId,updateCriteria:updateCriteria}):null;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(TypeSwitcher,{criteria:alertParams.criteria||[],updateType:updateType}),alertParams.criteria&&!Object(types["h"])(alertParams.criteria)&&criteriaComponent,external_kbnSharedDeps_React_default.a.createElement(Threshold,{comparator:(_alertParams$count=alertParams.count)===null||_alertParams$count===void 0?void 0:_alertParams$count.comparator,value:(_alertParams$count2=alertParams.count)===null||_alertParams$count2===void 0?void 0:_alertParams$count2.value,updateThreshold:updateThreshold,errors:thresholdErrors}),external_kbnSharedDeps_React_default.a.createElement(triggersActionsUi_public_["ForLastExpression"],{timeWindowSize:alertParams.timeSize,timeWindowUnit:alertParams.timeUnit,onChangeWindowSize:updateTimeSize,onChangeWindowUnit:updateTimeUnit,errors:{timeWindowSize:timeWindowSizeErrors,timeSizeUnit:timeSizeUnitErrors}}),external_kbnSharedDeps_React_default.a.createElement(GroupByExpression,{selectedGroups:alertParams.groupBy,onChange:updateGroupBy,fields:groupByFields}),alertParams.criteria&&Object(types["h"])(alertParams.criteria)&&criteriaComponent,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}))};var editor=__webpack_exports__["default"]=ExpressionEditor;const ExpressionLike=({text:text})=>external_kbnSharedDeps_React_default.a.createElement("div",{className:"euiExpression euiExpression-isUppercase euiExpression--secondary"},external_kbnSharedDeps_React_default.a.createElement("span",{className:"euiExpression__description"},text))},83:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var React=__webpack_require__(1);var isDev="production"!=="production";var NO_PROVIDER="_NP_";function createUseContext(context){return function(){var value=React.useContext(context);if(isDev&&value===NO_PROVIDER){console.warn("[constate] Component not wrapped within a Provider.")}return value}}function constate(useValue){for(var _len=arguments.length,splitValues=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){splitValues[_key-1]=arguments[_key]}var Context=React.createContext(NO_PROVIDER);var Provider=function Provider(props){var value=useValue(props);var createMemoDeps=splitValues[0];var deps=createMemoDeps&&createMemoDeps(value);if(isDev&&Array.isArray(deps)){console.warn("[constate] Passing `createMemoDeps` as the second argument is deprecated.","Please, use `React.useMemo` in your custom hook instead.","See https://github.com/diegohaz/constate/issues/98")}var memoizedValue=Array.isArray(deps)?React.useMemo((function(){return value}),deps):value;return React.createElement(Context.Provider,{value:memoizedValue},props.children)};if(isDev&&useValue.name){Context.displayName=useValue.name+".Context";Provider.displayName=useValue.name+".Provider"}var useContext=createUseContext(Context);useContext.Context=Context;useContext.Provider=Provider;var tuple=[];if(!splitValues.length){tuple.push(Provider,createUseContext(Context))}else{var contexts=[];var SplitProvider=function SplitProvider(props){var value=useValue(props);var children=props.children;for(var i=0;i<contexts.length;i+=1){var context=contexts[i];var splitValue=splitValues[i];children=React.createElement(context.Provider,{value:splitValue(value)},children)}return children};if(isDev&&useValue.name){SplitProvider.displayName=useValue.name+".Provider"}tuple.push(SplitProvider);for(var i=0;i<splitValues.length;i+=1){var context=React.createContext(NO_PROVIDER);contexts.push(context);tuple.push(createUseContext(context))}}for(var _i=0;_i<tuple.length;_i+=1){useContext[_i]=tuple[_i]}if(typeof Symbol==="function"&&Symbol.iterator){useContext[Symbol.iterator]=function(){return tuple[Symbol.iterator]()}}return useContext}exports.default=constate},85:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return useTrackedPromise}));__webpack_require__.d(__webpack_exports__,"a",(function(){return CanceledPromiseError}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var react_use_lib_useMountedState__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(125);var react_use_lib_useMountedState__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react_use_lib_useMountedState__WEBPACK_IMPORTED_MODULE_1__);function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const useTrackedPromise=({createPromise:createPromise,onResolve:onResolve=noOp,onReject:onReject=noOp,cancelPreviousOn:cancelPreviousOn="never",triggerOrThrow:triggerOrThrow="whenMounted"},dependencies)=>{const isComponentMounted=react_use_lib_useMountedState__WEBPACK_IMPORTED_MODULE_1___default()();const shouldTriggerOrThrow=Object(react__WEBPACK_IMPORTED_MODULE_0__["useCallback"])(()=>{switch(triggerOrThrow){case"always":return true;case"whenMounted":return isComponentMounted()}},[isComponentMounted,triggerOrThrow]);const pendingPromises=Object(react__WEBPACK_IMPORTED_MODULE_0__["useRef"])([]);const[promiseState,setPromiseState]=Object(react__WEBPACK_IMPORTED_MODULE_0__["useState"])({state:"uninitialized"});const execute=Object(react__WEBPACK_IMPORTED_MODULE_0__["useMemo"])(()=>(...args)=>{let rejectCancellationPromise;const cancellationPromise=new Promise((_,reject)=>{rejectCancellationPromise=reject});const previousPendingPromises=pendingPromises.current;const cancelPreviousPendingPromises=()=>{previousPendingPromises.forEach(promise=>promise.cancel())};const newPromise=createPromise(...args);const newCancelablePromise=Promise.race([newPromise,cancellationPromise]);setPromiseState({state:"pending",promise:newCancelablePromise});if(cancelPreviousOn==="creation"){cancelPreviousPendingPromises()}const newPendingPromise={cancel:()=>{rejectCancellationPromise(new CanceledPromiseError)},cancelSilently:()=>{rejectCancellationPromise(new SilentCanceledPromiseError)},promise:newCancelablePromise.then(value=>{setPromiseState(previousPromiseState=>previousPromiseState.state==="pending"&&previousPromiseState.promise===newCancelablePromise?{state:"resolved",promise:newPendingPromise.promise,value:value}:previousPromiseState);if(["settlement","resolution"].includes(cancelPreviousOn)){cancelPreviousPendingPromises()}pendingPromises.current=pendingPromises.current.filter(pendingPromise=>pendingPromise.promise!==newPendingPromise.promise);if(onResolve&&shouldTriggerOrThrow()){onResolve(value)}return value},value=>{if(!(value instanceof SilentCanceledPromiseError)){setPromiseState(previousPromiseState=>previousPromiseState.state==="pending"&&previousPromiseState.promise===newCancelablePromise?{state:"rejected",promise:newCancelablePromise,value:value}:previousPromiseState)}if(["settlement","rejection"].includes(cancelPreviousOn)){cancelPreviousPendingPromises()}pendingPromises.current=pendingPromises.current.filter(pendingPromise=>pendingPromise.promise!==newPendingPromise.promise);if(shouldTriggerOrThrow()){if(onReject){onReject(value)}throw value}})};pendingPromises.current=[...pendingPromises.current,newPendingPromise];newPendingPromise.promise.catch(noOp);return newPendingPromise.promise},dependencies);Object(react__WEBPACK_IMPORTED_MODULE_0__["useEffect"])(()=>()=>{pendingPromises.current.forEach(promise=>promise.cancelSilently())},[]);return[promiseState,execute]};class CanceledPromiseError extends Error{constructor(message){super(message);_defineProperty(this,"isCanceled",true);Object.setPrototypeOf(this,new.target.prototype)}}class SilentCanceledPromiseError extends CanceledPromiseError{}const noOp=()=>undefined},87:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return useLogSource}));__webpack_require__.d(__webpack_exports__,"a",(function(){return LogSourceProvider}));__webpack_require__.d(__webpack_exports__,"c",(function(){return useLogSourceContext}));var constate_cjs=__webpack_require__(83);var constate_cjs_default=__webpack_require__.n(constate_cjs);var external_kbnSharedDeps_React_=__webpack_require__(1);var useMountedState=__webpack_require__(125);var useMountedState_default=__webpack_require__.n(useMountedState);var log_sources=__webpack_require__(9);var use_tracked_promise=__webpack_require__(85);var fetch_log_source_configuration=__webpack_require__(37);var fetch_log_source_status=__webpack_require__(38);var runtime_types=__webpack_require__(13);const callPatchLogSourceConfigurationAPI=async(sourceId,patchedProperties,fetch)=>{const response=await fetch(Object(log_sources["a"])(sourceId),{method:"PATCH",body:JSON.stringify(log_sources["f"].encode({data:patchedProperties}))});return Object(runtime_types["b"])(log_sources["g"])(response)};const useLogSource=({sourceId:sourceId,fetch:fetch})=>{const getIsMounted=useMountedState_default()();const[sourceConfiguration,setSourceConfiguration]=Object(external_kbnSharedDeps_React_["useState"])(undefined);const[sourceStatus,setSourceStatus]=Object(external_kbnSharedDeps_React_["useState"])(undefined);const[loadSourceConfigurationRequest,loadSourceConfiguration]=Object(use_tracked_promise["b"])({cancelPreviousOn:"resolution",createPromise:async()=>await Object(fetch_log_source_configuration["a"])(sourceId,fetch),onResolve:({data:data})=>{if(!getIsMounted()){return}setSourceConfiguration(data)}},[sourceId,fetch]);const[updateSourceConfigurationRequest,updateSourceConfiguration]=Object(use_tracked_promise["b"])({cancelPreviousOn:"resolution",createPromise:async patchedProperties=>await callPatchLogSourceConfigurationAPI(sourceId,patchedProperties,fetch),onResolve:({data:data})=>{if(!getIsMounted()){return}setSourceConfiguration(data);loadSourceStatus()}},[sourceId,fetch]);const[loadSourceStatusRequest,loadSourceStatus]=Object(use_tracked_promise["b"])({cancelPreviousOn:"resolution",createPromise:async()=>await Object(fetch_log_source_status["a"])(sourceId,fetch),onResolve:({data:data})=>{if(!getIsMounted()){return}setSourceStatus(data)}},[sourceId,fetch]);const derivedIndexPattern=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _sourceStatus$logInde,_sourceConfiguration$;return{fields:(_sourceStatus$logInde=sourceStatus===null||sourceStatus===void 0?void 0:sourceStatus.logIndexFields)!==null&&_sourceStatus$logInde!==void 0?_sourceStatus$logInde:[],title:(_sourceConfiguration$=sourceConfiguration===null||sourceConfiguration===void 0?void 0:sourceConfiguration.configuration.logAlias)!==null&&_sourceConfiguration$!==void 0?_sourceConfiguration$:"unknown"}},[sourceConfiguration,sourceStatus]);const isLoadingSourceConfiguration=Object(external_kbnSharedDeps_React_["useMemo"])(()=>loadSourceConfigurationRequest.state==="pending",[loadSourceConfigurationRequest.state]);const isUpdatingSourceConfiguration=Object(external_kbnSharedDeps_React_["useMemo"])(()=>updateSourceConfigurationRequest.state==="pending",[updateSourceConfigurationRequest.state]);const isLoadingSourceStatus=Object(external_kbnSharedDeps_React_["useMemo"])(()=>loadSourceStatusRequest.state==="pending",[loadSourceStatusRequest.state]);const isLoading=Object(external_kbnSharedDeps_React_["useMemo"])(()=>isLoadingSourceConfiguration||isLoadingSourceStatus||isUpdatingSourceConfiguration,[isLoadingSourceConfiguration,isLoadingSourceStatus,isUpdatingSourceConfiguration]);const isUninitialized=Object(external_kbnSharedDeps_React_["useMemo"])(()=>loadSourceConfigurationRequest.state==="uninitialized"||loadSourceStatusRequest.state==="uninitialized",[loadSourceConfigurationRequest.state,loadSourceStatusRequest.state]);const hasFailedLoadingSource=Object(external_kbnSharedDeps_React_["useMemo"])(()=>loadSourceConfigurationRequest.state==="rejected",[loadSourceConfigurationRequest.state]);const hasFailedLoadingSourceStatus=Object(external_kbnSharedDeps_React_["useMemo"])(()=>loadSourceStatusRequest.state==="rejected",[loadSourceStatusRequest.state]);const loadSourceFailureMessage=Object(external_kbnSharedDeps_React_["useMemo"])(()=>loadSourceConfigurationRequest.state==="rejected"?`${loadSourceConfigurationRequest.value}`:undefined,[loadSourceConfigurationRequest]);const loadSource=Object(external_kbnSharedDeps_React_["useCallback"])(()=>Promise.all([loadSourceConfiguration(),loadSourceStatus()]),[loadSourceConfiguration,loadSourceStatus]);const initialize=Object(external_kbnSharedDeps_React_["useCallback"])(async()=>{if(!isUninitialized){return}return await loadSource()},[isUninitialized,loadSource]);return{derivedIndexPattern:derivedIndexPattern,hasFailedLoadingSource:hasFailedLoadingSource,hasFailedLoadingSourceStatus:hasFailedLoadingSourceStatus,initialize:initialize,isLoading:isLoading,isLoadingSourceConfiguration:isLoadingSourceConfiguration,isLoadingSourceStatus:isLoadingSourceStatus,isUninitialized:isUninitialized,loadSource:loadSource,loadSourceFailureMessage:loadSourceFailureMessage,loadSourceConfiguration:loadSourceConfiguration,loadSourceStatus:loadSourceStatus,sourceConfiguration:sourceConfiguration,sourceId:sourceId,sourceStatus:sourceStatus,updateSourceConfiguration:updateSourceConfiguration}};const[LogSourceProvider,useLogSourceContext]=constate_cjs_default()(useLogSource)},89:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return ItemTypeRT}));__webpack_require__.d(__webpack_exports__,"b",(function(){return InventoryVisTypeRT}));__webpack_require__.d(__webpack_exports__,"a",(function(){return InventoryMetricRT}));__webpack_require__.d(__webpack_exports__,"d",(function(){return MetricsUIAggregationRT}));__webpack_require__.d(__webpack_exports__,"e",(function(){return SnapshotMetricTypeKeys}));__webpack_require__.d(__webpack_exports__,"f",(function(){return SnapshotMetricTypeRT}));var io_ts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);var io_ts__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(io_ts__WEBPACK_IMPORTED_MODULE_0__);const ItemTypeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({host:null,pod:null,container:null,awsEC2:null,awsS3:null,awsSQS:null,awsRDS:null});const InventoryVisTypeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({line:null,area:null,bar:null});const InventoryFormatterTypeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({abbreviatedNumber:null,bits:null,bytes:null,number:null,percent:null,highPercision:null});const InventoryMetricRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({hostSystemOverview:null,hostCpuUsage:null,hostFilesystem:null,hostK8sOverview:null,hostK8sCpuCap:null,hostK8sDiskCap:null,hostK8sMemoryCap:null,hostK8sPodCap:null,hostLoad:null,hostMemoryUsage:null,hostNetworkTraffic:null,hostDockerOverview:null,hostDockerInfo:null,hostDockerTop5ByCpu:null,hostDockerTop5ByMemory:null,podOverview:null,podCpuUsage:null,podMemoryUsage:null,podLogUsage:null,podNetworkTraffic:null,containerOverview:null,containerCpuKernel:null,containerCpuUsage:null,containerDiskIOOps:null,containerDiskIOBytes:null,containerMemory:null,containerNetworkTraffic:null,nginxHits:null,nginxRequestRate:null,nginxActiveConnections:null,nginxRequestsPerConnection:null,awsOverview:null,awsCpuUtilization:null,awsNetworkBytes:null,awsNetworkPackets:null,awsDiskioBytes:null,awsDiskioOps:null,awsEC2CpuUtilization:null,awsEC2NetworkTraffic:null,awsEC2DiskIOBytes:null,awsS3TotalRequests:null,awsS3NumberOfObjects:null,awsS3BucketSize:null,awsS3DownloadBytes:null,awsS3UploadBytes:null,awsRDSCpuTotal:null,awsRDSConnections:null,awsRDSQueriesExecuted:null,awsRDSActiveTransactions:null,awsRDSLatency:null,awsSQSMessagesVisible:null,awsSQSMessagesDelayed:null,awsSQSMessagesSent:null,awsSQSMessagesEmpty:null,awsSQSOldestMessage:null,custom:null});const TSVBMetricTypeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({avg:null,max:null,min:null,calculation:null,cardinality:null,series_agg:null,positive_only:null,derivative:null,count:null,sum:null,cumulative_sum:null});const TSVBMetricModelCountRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],type:io_ts__WEBPACK_IMPORTED_MODULE_0__["literal"]("count")});const TSVBMetricModelBasicMetricRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],type:TSVBMetricTypeRT}),io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]})]);const TSVBMetricModelVariableRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],name:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]});const TSVBMetricModelBucketScriptRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],script:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],type:io_ts__WEBPACK_IMPORTED_MODULE_0__["literal"]("calculation"),variables:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](TSVBMetricModelVariableRT)});const TSVBMetricModelDerivativeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],unit:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],type:io_ts__WEBPACK_IMPORTED_MODULE_0__["literal"]("derivative")});const TSVBMetricModelSeriesAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],function:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],type:io_ts__WEBPACK_IMPORTED_MODULE_0__["literal"]("series_agg")});const TSVBPercentileItemRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],value:io_ts__WEBPACK_IMPORTED_MODULE_0__["number"]});const TSVBMetricModePercentileAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],type:io_ts__WEBPACK_IMPORTED_MODULE_0__["literal"]("percentile"),percentiles:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](TSVBPercentileItemRT)}),io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]})]);const TSVBMetricRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([TSVBMetricModelCountRT,TSVBMetricModelBasicMetricRT,TSVBMetricModelBucketScriptRT,TSVBMetricModelDerivativeRT,TSVBMetricModePercentileAggRT,TSVBMetricModelSeriesAggRT]);const TSVBSeriesRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],metrics:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](TSVBMetricRT),split_mode:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]}),io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({terms_field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],terms_size:io_ts__WEBPACK_IMPORTED_MODULE_0__["number"],terms_order_by:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],filter:io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({query:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],language:io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({lucene:null,kuery:null})})})]);const TSVBMetricModelRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({id:InventoryMetricRT,requires:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]),index_pattern:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](io_ts__WEBPACK_IMPORTED_MODULE_0__["string"])]),interval:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],time_field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],type:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],series:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](TSVBSeriesRT)}),io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({filter:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],map_field_to:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],id_type:io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({cloud:null,node:null}),drop_last_bucket:io_ts__WEBPACK_IMPORTED_MODULE_0__["boolean"]})]);const ESBasicMetricAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["record"](io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["undefined"],io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]})]));const ESPercentileAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({percentiles:io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],percents:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](io_ts__WEBPACK_IMPORTED_MODULE_0__["number"])})});const ESCaridnalityAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({cardinality:io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],script:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]})});const ESBucketScriptAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({bucket_script:io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({buckets_path:io_ts__WEBPACK_IMPORTED_MODULE_0__["record"](io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["undefined"],io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]])),script:io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({source:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],lang:io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({painless:null,expression:null})})}),io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({gap_policy:io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({skip:null,insert_zeros:null})})])});const ESCumulativeSumAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({cumulative_sum:io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({buckets_path:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]})});const ESDerivativeAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({derivative:io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({buckets_path:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],gap_policy:io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"]({skip:null,insert_zeros:null}),unit:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]})});const ESSumBucketAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({sum_bucket:io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({buckets_path:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]})});const ESTopHitsAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({top_hits:io_ts__WEBPACK_IMPORTED_MODULE_0__["object"]});const ESTermsWithAggregationRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["recursion"]("SnapshotModelRT",()=>io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({terms:io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]}),aggregations:MetricsUIAggregationRT}));const ESAggregationRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([ESBasicMetricAggRT,ESPercentileAggRT,ESBucketScriptAggRT,ESCumulativeSumAggRT,ESDerivativeAggRT,ESSumBucketAggRT,ESTermsWithAggregationRT,ESCaridnalityAggRT,ESTopHitsAggRT]);const MetricsUIAggregationRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["record"](io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],ESAggregationRT);const SnapshotMetricTypeKeys={count:null,cpu:null,load:null,memory:null,tx:null,rx:null,logRate:null,diskIOReadBytes:null,diskIOWriteBytes:null,s3TotalRequests:null,s3NumberOfObjects:null,s3BucketSize:null,s3DownloadBytes:null,s3UploadBytes:null,rdsConnections:null,rdsQueriesExecuted:null,rdsActiveTransactions:null,rdsLatency:null,sqsMessagesVisible:null,sqsMessagesDelayed:null,sqsMessagesSent:null,sqsMessagesEmpty:null,sqsOldestMessage:null,custom:null};const SnapshotMetricTypeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"](SnapshotMetricTypeKeys)},91:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Color}));__webpack_require__.d(__webpack_exports__,"b",(function(){return colorTransformer}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(21);var lodash__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__);var _elastic_eui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(8);var _elastic_eui__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__);let Color;(function(Color){Color["color0"]="color0";Color["color1"]="color1";Color["color2"]="color2";Color["color3"]="color3";Color["color4"]="color4";Color["color5"]="color5";Color["color6"]="color6";Color["color7"]="color7";Color["color8"]="color8";Color["color9"]="color9"})(Color||(Color={}));const euiPalette=Object(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["euiPaletteColorBlind"])();const defaultPalette={[Color.color0]:euiPalette[1],[Color.color1]:euiPalette[2],[Color.color2]:euiPalette[0],[Color.color3]:euiPalette[3],[Color.color4]:euiPalette[4],[Color.color5]:euiPalette[5],[Color.color6]:euiPalette[6],[Color.color7]:euiPalette[7],[Color.color8]:euiPalette[8],[Color.color9]:euiPalette[9]};const createPaletteTransformer=palette=>color=>palette[color];const colorTransformer=createPaletteTransformer(defaultPalette);const sampleColor=(usedColors=[])=>{const available=Object(lodash__WEBPACK_IMPORTED_MODULE_0__["difference"])(Object(lodash__WEBPACK_IMPORTED_MODULE_0__["values"])(Color),usedColors);return Object(lodash__WEBPACK_IMPORTED_MODULE_0__["first"])(available)||Color.color0}},92:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"g",(function(){return SnapshotNodeResponseRT}));__webpack_require__.d(__webpack_exports__,"a",(function(){return InfraTimerangeInputRT}));__webpack_require__.d(__webpack_exports__,"e",(function(){return SnapshotGroupByRT}));__webpack_require__.d(__webpack_exports__,"b",(function(){return SNAPSHOT_CUSTOM_AGGREGATIONS}));__webpack_require__.d(__webpack_exports__,"c",(function(){return SnapshotCustomAggregationRT}));__webpack_require__.d(__webpack_exports__,"d",(function(){return SnapshotCustomMetricInputRT}));__webpack_require__.d(__webpack_exports__,"f",(function(){return SnapshotMetricInputRT}));var io_ts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);var io_ts__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(io_ts__WEBPACK_IMPORTED_MODULE_0__);var _inventory_models_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(89);var _metrics_api__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(127);const SnapshotNodePathRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({value:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],label:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]}),io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({ip:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"]])})]);const SnapshotNodeMetricOptionalRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({value:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["number"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"]]),avg:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["number"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"]]),max:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["number"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"]]),timeseries:_metrics_api__WEBPACK_IMPORTED_MODULE_2__["a"]});const SnapshotNodeMetricRequiredRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({name:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([_inventory_models_types__WEBPACK_IMPORTED_MODULE_1__["f"],io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]])});const SnapshotNodeMetricRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([SnapshotNodeMetricRequiredRT,SnapshotNodeMetricOptionalRT]);const SnapshotNodeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({metrics:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](SnapshotNodeMetricRT),path:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](SnapshotNodePathRT),name:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]});const SnapshotNodeResponseRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({nodes:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](SnapshotNodeRT),interval:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]});const InfraTimerangeInputRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({interval:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],to:io_ts__WEBPACK_IMPORTED_MODULE_0__["number"],from:io_ts__WEBPACK_IMPORTED_MODULE_0__["number"]}),io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({lookbackSize:io_ts__WEBPACK_IMPORTED_MODULE_0__["number"],ignoreLookback:io_ts__WEBPACK_IMPORTED_MODULE_0__["boolean"],forceInterval:io_ts__WEBPACK_IMPORTED_MODULE_0__["boolean"]})]);const SnapshotGroupByRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({label:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"]]),field:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"]])}));const SnapshotNamedMetricInputRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({type:_inventory_models_types__WEBPACK_IMPORTED_MODULE_1__["f"]});const SNAPSHOT_CUSTOM_AGGREGATIONS=["avg","max","min","rate"];const snapshotCustomAggregationKeys=SNAPSHOT_CUSTOM_AGGREGATIONS.reduce((acc,agg)=>({...acc,[agg]:null}),{});const SnapshotCustomAggregationRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["keyof"](snapshotCustomAggregationKeys);const SnapshotCustomMetricInputRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({type:io_ts__WEBPACK_IMPORTED_MODULE_0__["literal"]("custom"),field:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],aggregation:SnapshotCustomAggregationRT,id:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]}),io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({label:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]})]);const SnapshotMetricInputRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([SnapshotNamedMetricInputRT,SnapshotCustomMetricInputRT]);const SnapshotRequestRT=io_ts__WEBPACK_IMPORTED_MODULE_0__["intersection"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["type"]({timerange:InfraTimerangeInputRT,metrics:io_ts__WEBPACK_IMPORTED_MODULE_0__["array"](SnapshotMetricInputRT),groupBy:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([SnapshotGroupByRT,io_ts__WEBPACK_IMPORTED_MODULE_0__["null"]]),nodeType:_inventory_models_types__WEBPACK_IMPORTED_MODULE_1__["c"],sourceId:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"]}),io_ts__WEBPACK_IMPORTED_MODULE_0__["partial"]({accountId:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],region:io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],filterQuery:io_ts__WEBPACK_IMPORTED_MODULE_0__["union"]([io_ts__WEBPACK_IMPORTED_MODULE_0__["string"],io_ts__WEBPACK_IMPORTED_MODULE_0__["null"]]),includeTimeseries:io_ts__WEBPACK_IMPORTED_MODULE_0__["boolean"],overrideCompositeSize:io_ts__WEBPACK_IMPORTED_MODULE_0__["number"]})])}}]);