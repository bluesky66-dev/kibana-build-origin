(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:true,get:getter})}};__webpack_require__.r=function(exports){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(exports,"__esModule",{value:true})};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if(mode&4&&typeof value==="object"&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,"default",{enumerable:true,value:value});if(mode&2&&typeof value!="string")for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=7)})([function(module,exports){module.exports=__kbnSharedDeps__.React},function(module,exports){module.exports=__kbnSharedDeps__.ElasticEui},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18n},function(module,exports){module.exports=__kbnSharedDeps__.Rxjs},function(module,exports){module.exports=__kbnSharedDeps__.RxjsOperators},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18nReact},function(module,exports){module.exports=__kbnSharedDeps__.ReactDom},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_val_loader_dist_cjs_js_key_securityOss_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8);var _node_modules_val_loader_dist_cjs_js_key_securityOss_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_val_loader_dist_cjs_js_key_securityOss_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0__);__kbnBundles__.define("plugin/securityOss/public",__webpack_require__,9)},function(module,exports,__webpack_require__){__webpack_require__.p=window.__kbnPublicPath__["securityOss"]},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"SecurityOssPluginSetup",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"SecurityOssPluginStart",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"plugin",(function(){return public_plugin}));var external_kbnSharedDeps_Rxjs_=__webpack_require__(3);var external_kbnSharedDeps_RxjsOperators_=__webpack_require__(4);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(1);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(2);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(5);var external_kbnSharedDeps_React_=__webpack_require__(0);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ReactDom_=__webpack_require__(6);const defaultAlertTitle=external_kbnSharedDeps_KbnI18n_["i18n"].translate("security.checkup.insecureClusterTitle",{defaultMessage:"Your data is not secure"});const defaultAlertText=onDismiss=>e=>{const AlertText=()=>{const[persist,setPersist]=Object(external_kbnSharedDeps_React_["useState"])(false);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["I18nProvider"],null,external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"insecureClusterDefaultAlertText"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"security.checkup.insecureClusterMessage",defaultMessage:"Don't lose one bit. Secure your data for free with Elastic."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCheckbox"],{id:"persistDismissedAlertPreference",checked:persist,onChange:changeEvent=>setPersist(changeEvent.target.checked),label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("security.checkup.dontShowAgain",{defaultMessage:`Don't show again`})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{size:"s",color:"primary",fill:true,href:"https://www.elastic.co/what-is/elastic-stack-security?blade=kibanasecuritymessage",target:"_blank"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("security.checkup.learnMoreButtonText",{defaultMessage:`Learn more`}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{size:"s",onClick:()=>onDismiss(persist),"data-test-subj":"defaultDismissAlertButton"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("security.checkup.dismissButtonText",{defaultMessage:`Dismiss`}))))))};Object(external_kbnSharedDeps_ReactDom_["render"])(external_kbnSharedDeps_React_default.a.createElement(AlertText,null),e);return()=>Object(external_kbnSharedDeps_ReactDom_["unmountComponentAtNode"])(e)};function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class insecure_cluster_service_InsecureClusterService{constructor(config,storage){_defineProperty(this,"enabled",void 0);_defineProperty(this,"alertVisibility$",void 0);_defineProperty(this,"storage",void 0);_defineProperty(this,"alertToast",void 0);_defineProperty(this,"alertTitle",void 0);_defineProperty(this,"alertText",void 0);_defineProperty(this,"storageKey",void 0);this.storage=storage;this.enabled=config.showInsecureClusterWarning;this.alertVisibility$=new external_kbnSharedDeps_Rxjs_["BehaviorSubject"](this.enabled)}setup({core:core}){const tenant=core.http.basePath.serverBasePath;this.storageKey=`insecureClusterWarningVisibility${tenant}`;this.enabled=this.enabled&&this.getPersistedVisibilityPreference();this.alertVisibility$.next(this.enabled);return{setAlertTitle:alertTitle=>{if(this.alertTitle){throw new Error("alert title has already been set")}this.alertTitle=alertTitle},setAlertText:alertText=>{if(this.alertText){throw new Error("alert text has already been set")}this.alertText=alertText}}}start({core:core,appState:appState}){if(this.enabled){this.initializeAlert(core,appState)}return{hideAlert:persist=>this.setAlertVisibility(false,persist)}}initializeAlert(core,appState){const appState$=Object(external_kbnSharedDeps_Rxjs_["from"])(appState.getState());const oneMinute=6e4;const tenDays=oneMinute*60*24*10;Object(external_kbnSharedDeps_Rxjs_["combineLatest"])([appState$,this.alertVisibility$]).pipe(Object(external_kbnSharedDeps_RxjsOperators_["map"])(([{insecureClusterAlert:insecureClusterAlert},isAlertVisible])=>insecureClusterAlert.displayAlert&&isAlertVisible),Object(external_kbnSharedDeps_RxjsOperators_["distinctUntilChanged"])()).subscribe(showAlert=>{if(showAlert&&!this.alertToast){var _this$alertTitle,_this$alertText;this.alertToast=core.notifications.toasts.addWarning({title:(_this$alertTitle=this.alertTitle)!==null&&_this$alertTitle!==void 0?_this$alertTitle:defaultAlertTitle,text:(_this$alertText=this.alertText)!==null&&_this$alertText!==void 0?_this$alertText:defaultAlertText(persist=>this.setAlertVisibility(false,persist)),iconType:"alert"},{toastLifeTimeMs:tenDays})}else if(!showAlert&&this.alertToast){core.notifications.toasts.remove(this.alertToast);this.alertToast=undefined}})}setAlertVisibility(show,persist){if(!this.enabled){return}this.alertVisibility$.next(show);if(persist){this.setPersistedVisibilityPreference(show)}}getPersistedVisibilityPreference(){var _this$storage$getItem;const entry=(_this$storage$getItem=this.storage.getItem(this.storageKey))!==null&&_this$storage$getItem!==void 0?_this$storage$getItem:"{}";try{const{show:show=true}=JSON.parse(entry);return show}catch(e){return true}}setPersistedVisibilityPreference(show){this.storage.setItem(this.storageKey,JSON.stringify({show:show}))}}const DEFAULT_APP_STATE=Object.freeze({insecureClusterAlert:{displayAlert:false},anonymousAccess:{isEnabled:false,accessURLParameters:null}});class AppStateService{start({core:core}){const appStatePromise=core.http.anonymousPaths.isAnonymous(window.location.pathname)?Promise.resolve(DEFAULT_APP_STATE):core.http.get("/internal/security_oss/app_state").catch(()=>DEFAULT_APP_STATE);return{getState:()=>appStatePromise}}}function plugin_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class plugin_SecurityOssPlugin{constructor(initializerContext){this.initializerContext=initializerContext;plugin_defineProperty(this,"config",this.initializerContext.config.get());plugin_defineProperty(this,"insecureClusterService",new insecure_cluster_service_InsecureClusterService(this.config,localStorage));plugin_defineProperty(this,"appStateService",new AppStateService)}setup(core){return{insecureCluster:this.insecureClusterService.setup({core:core})}}start(core){const appState=this.appStateService.start({core:core});return{insecureCluster:this.insecureClusterService.start({core:core,appState:appState}),anonymousAccess:{async getAccessURLParameters(){const{anonymousAccess:anonymousAccess}=await appState.getState();return anonymousAccess.accessURLParameters},getCapabilities(){return core.http.get("/internal/security_oss/anonymous_access/capabilities")}}}}}const public_plugin=initializerContext=>new plugin_SecurityOssPlugin(initializerContext)}]);