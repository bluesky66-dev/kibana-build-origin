(window["inspector_bundle_jsonpfunction"]=window["inspector_bundle_jsonpfunction"]||[]).push([[1],{39:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"RequestsViewComponent",(function(){return requests_view_RequestsViewComponent}));__webpack_require__.d(__webpack_exports__,"default",(function(){return requests_view_RequestsViewComponent}));var external_kbnSharedDeps_React_=__webpack_require__(0);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(9);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(1);var adapters=__webpack_require__(3);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(2);function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class request_selector_RequestSelector extends external_kbnSharedDeps_React_["Component"]{constructor(...args){super(...args);_defineProperty(this,"state",{isPopoverOpen:false});_defineProperty(this,"togglePopover",()=>{this.setState(prevState=>({isPopoverOpen:!prevState.isPopoverOpen}))});_defineProperty(this,"closePopover",()=>{this.setState({isPopoverOpen:false})});_defineProperty(this,"renderRequestDropdownItem",(request,index)=>{const hasFailed=request.status===adapters["RequestStatus"].ERROR;const inProgress=request.status===adapters["RequestStatus"].PENDING;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:index,icon:request===this.props.selectedRequest?"check":"empty",onClick:()=>{this.props.onRequestChanged(request);this.closePopover()},toolTipContent:request.description,toolTipPosition:"left","data-test-subj":`inspectorRequestChooser${request.name}`},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTextColor"],{color:hasFailed?"danger":"default"},request.name,hasFailed&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"inspector.requests.failedLabel",defaultMessage:" (failed)"}),inProgress&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"s","aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("inspector.requests.requestInProgressAriaLabel",{defaultMessage:"Request in progress"}),className:"insRequestSelector__menuSpinner"})))})}renderRequestDropdown(){const button=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{iconType:"arrowDown",iconSide:"right",size:"s",onClick:this.togglePopover,"data-test-subj":"inspectorRequestChooser"},this.props.selectedRequest.name);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"inspectorRequestChooser",button:button,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none",anchorPosition:"downLeft",repositionOnScroll:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuPanel"],{items:this.props.requests.map(this.renderRequestDropdownItem),"data-test-subj":"inspectorRequestChooserMenuPanel"}))}render(){const{selectedRequest:selectedRequest,requests:requests}=this.props;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"inspector.requests.requestLabel",defaultMessage:"Request:"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},requests.length<=1&&external_kbnSharedDeps_React_default.a.createElement("div",{className:"insRequestSelector__singleRequest","data-test-subj":"inspectorRequestName"},selectedRequest.name),requests.length>1&&this.renderRequestDropdown()),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},selectedRequest.status!==adapters["RequestStatus"].PENDING&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"left",title:selectedRequest.status===adapters["RequestStatus"].OK?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"inspector.requests.requestSucceededTooltipTitle",defaultMessage:"Request succeeded"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"inspector.requests.requestFailedTooltipTitle",defaultMessage:"Request failed"}),content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"inspector.requests.requestTooltipDescription",defaultMessage:"The total time the request took."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{color:selectedRequest.status===adapters["RequestStatus"].OK?"secondary":"danger",iconType:selectedRequest.status===adapters["RequestStatus"].OK?"check":"cross"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"inspector.requests.requestTimeLabel",defaultMessage:"{requestTime}ms",values:{requestTime:selectedRequest.time}}))),selectedRequest.status===adapters["RequestStatus"].PENDING&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m","aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("inspector.requests.requestInProgressAriaLabel",{defaultMessage:"Request in progress"})})))}}var external_kbnSharedDeps_KbnMonaco_=__webpack_require__(38);var public_=__webpack_require__(7);const copyToClipboardLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("inspector.requests.copyToClipboardLabel",{defaultMessage:"Copy to clipboard"});const RequestCodeViewer=({json:json})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"s",wrap:false,responsive:false,className:"insRequestCodeViewer"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"eui-textRight"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCopy"],{textToCopy:json},copy=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{size:"xs",flush:"right",iconType:"copyClipboard",onClick:copy,"data-test-subj":"inspectorRequestCopyClipboardButton"},copyToClipboardLabel)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(public_["CodeEditor"],{languageId:external_kbnSharedDeps_KbnMonaco_["XJsonLang"].ID,value:json,onChange:()=>{},options:{readOnly:true,lineNumbers:"off",fontSize:12,minimap:{enabled:false},folding:true,scrollBeyondLastLine:false,wordWrap:"on",wrappingIndent:"indent",automaticLayout:true}})));function req_details_request_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class req_details_request_RequestDetailsRequest extends external_kbnSharedDeps_React_["Component"]{render(){const{json:json}=this.props.request;if(!json){return null}return external_kbnSharedDeps_React_default.a.createElement(RequestCodeViewer,{json:JSON.stringify(json,null,2)})}}req_details_request_defineProperty(req_details_request_RequestDetailsRequest,"shouldShow",request=>Boolean(request&&request.json));function req_details_response_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class req_details_response_RequestDetailsResponse extends external_kbnSharedDeps_React_["Component"]{render(){const responseJSON=req_details_response_RequestDetailsResponse.getResponseJson(this.props.request);if(!responseJSON){return null}return external_kbnSharedDeps_React_default.a.createElement(RequestCodeViewer,{json:JSON.stringify(responseJSON,null,2)})}}req_details_response_defineProperty(req_details_response_RequestDetailsResponse,"shouldShow",request=>Boolean(req_details_response_RequestDetailsResponse.getResponseJson(request)));req_details_response_defineProperty(req_details_response_RequestDetailsResponse,"getResponseJson",request=>request.response?request.response.json:null);function req_details_stats_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class req_details_stats_RequestDetailsStats extends external_kbnSharedDeps_React_["Component"]{constructor(...args){super(...args);req_details_stats_defineProperty(this,"renderStatRow",stat=>[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTableRow"],{key:stat.id},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTableRowCell"],null,external_kbnSharedDeps_React_default.a.createElement("span",{className:"insRequestDetailsStats__icon"},stat.description?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("inspector.requests.descriptionRowIconAriaLabel",{defaultMessage:"Description"}),type:"questionInCircle",color:"subdued",content:stat.description}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"empty"})),stat.label),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTableRowCell"],null,stat.value))])}render(){const{stats:stats}=this.props.request;if(!stats){return null}const sortedStats=Object.keys(stats).sort().map(id=>({id:id,...stats[id]}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTable"],{responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTableBody"],null,sortedStats.map(this.renderStatRow)))}}req_details_stats_defineProperty(req_details_stats_RequestDetailsStats,"shouldShow",request=>Boolean(request.stats&&Object.keys(request.stats).length));function request_details_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const DETAILS=[{name:"Statistics",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("inspector.requests.statisticsTabLabel",{defaultMessage:"Statistics"}),component:req_details_stats_RequestDetailsStats},{name:"Request",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("inspector.requests.requestTabLabel",{defaultMessage:"Request"}),component:req_details_request_RequestDetailsRequest},{name:"Response",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("inspector.requests.responseTabLabel",{defaultMessage:"Response"}),component:req_details_response_RequestDetailsResponse}];class request_details_RequestDetails extends external_kbnSharedDeps_React_["Component"]{constructor(...args){super(...args);request_details_defineProperty(this,"state",{availableDetails:[],selectedDetail:null});request_details_defineProperty(this,"selectDetailsTab",detail=>{if(detail!==this.state.selectedDetail){this.setState({selectedDetail:detail})}});request_details_defineProperty(this,"renderDetailTab",detail=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{key:detail.name,isSelected:detail===this.state.selectedDetail,onClick:()=>this.selectDetailsTab(detail),"data-test-subj":`inspectorRequestDetail${detail.name}`},detail.label))}static getDerivedStateFromProps(nextProps,prevState){const selectedDetail=prevState&&prevState.selectedDetail;const availableDetails=DETAILS.filter(detail=>!detail.component.shouldShow||detail.component.shouldShow(nextProps.request));if(selectedDetail&&availableDetails.includes(selectedDetail)){return{availableDetails:availableDetails}}return{availableDetails:availableDetails,selectedDetail:availableDetails[0]}}static getSelectedDetailComponent(detail){return detail?detail.component:null}render(){const{selectedDetail:selectedDetail,availableDetails:availableDetails}=this.state;const DetailComponent=request_details_RequestDetails.getSelectedDetailComponent(selectedDetail);if(!availableDetails.length||!DetailComponent){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabs"],{size:"s"},this.state.availableDetails.map(this.renderDetailTab)),external_kbnSharedDeps_React_default.a.createElement(DetailComponent,{request:this.props.request}))}}function requests_view_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class requests_view_RequestsViewComponent extends external_kbnSharedDeps_React_["Component"]{constructor(props){super(props);requests_view_defineProperty(this,"_onRequestsChange",()=>{const requests=this.props.adapters.requests.getRequests();const newState={requests:requests};if(!this.state.request||!requests.includes(this.state.request)){newState.request=requests.length?requests[0]:null}this.setState(newState)});requests_view_defineProperty(this,"selectRequest",request=>{if(request!==this.state.request){this.setState({request:request})}});props.adapters.requests.on("change",this._onRequestsChange);const _requests=props.adapters.requests.getRequests();this.state={requests:_requests,request:_requests.length?_requests[0]:null}}componentWillUnmount(){this.props.adapters.requests.removeListener("change",this._onRequestsChange)}static renderEmptyRequests(){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{"data-test-subj":"inspectorNoRequestsMessage",title:external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"inspector.requests.noRequestsLoggedTitle",defaultMessage:"No requests logged"})),body:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"inspector.requests.noRequestsLoggedDescription.elementHasNotLoggedAnyRequestsText",defaultMessage:"The element hasn't logged any requests (yet)."})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"inspector.requests.noRequestsLoggedDescription.whatDoesItUsuallyMeanText",defaultMessage:"This usually means that there was no need to fetch any data or that the element has not yet started fetching data."})))})}render(){if(!this.state.requests||!this.state.requests.length){return requests_view_RequestsViewComponent.renderEmptyRequests()}const failedCount=this.state.requests.filter(req=>req.status===adapters["RequestStatus"].ERROR).length;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("p",{role:"status","aria-live":"polite","aria-atomic":"true"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"inspector.requests.requestWasMadeDescription",defaultMessage:"{requestsCount, plural, one {# request was} other {# requests were} } made{failedRequests}",values:{requestsCount:this.state.requests.length,failedRequests:failedCount>0?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTextColor"],{color:"danger"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"inspector.requests.requestWasMadeDescription.requestHadFailureText",defaultMessage:", {failedCount} had a failure",values:{failedCount:failedCount}})):""}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),this.state.request&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(request_selector_RequestSelector,{requests:this.state.requests,selectedRequest:this.state.request,onRequestChanged:this.selectRequest}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"})),this.state.request&&this.state.request.description&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("p",null,this.state.request.description)),this.state.request&&this.state.request.searchSessionId&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("p",{"data-test-subj":"inspectorRequestSearchSessionId","data-search-session-id":this.state.request.searchSessionId},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"inspector.requests.searchSessionId",defaultMessage:"Search session id: {searchSessionId}",values:{searchSessionId:this.state.request.searchSessionId}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),this.state.request&&external_kbnSharedDeps_React_default.a.createElement(request_details_RequestDetails,{request:this.state.request}))}}}}]);