(window["visTypeTimeseries_bundle_jsonpfunction"]=window["visTypeTimeseries_bundle_jsonpfunction"]||[]).push([[9],{353:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",(function(){return vis_TableVis}));var external_kbnSharedDeps_Lodash_=__webpack_require__(31);var external_kbnSharedDeps_Lodash_default=__webpack_require__.n(external_kbnSharedDeps_Lodash_);var external_kbnSharedDeps_React_=__webpack_require__(1);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(3);var public_=__webpack_require__(33);var tick_formatter=__webpack_require__(46);var basic_aggs=__webpack_require__(95);function isSortable(metric){return basic_aggs["a"].includes(metric.type)}var external_kbnSharedDeps_ElasticEui_=__webpack_require__(12);var replace_vars=__webpack_require__(57);var data_public_=__webpack_require__(13);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(30);var services=__webpack_require__(0);function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function getColor(rules,colorKey,value){let color;if(rules){rules.forEach(rule=>{if(rule.operator&&rule.value!=null){if(external_kbnSharedDeps_Lodash_default.a[rule.operator](value,rule.value)){color=rule[colorKey]}}})}return color}class vis_TableVis extends external_kbnSharedDeps_React_["Component"]{constructor(props){super(props);_defineProperty(this,"renderRow",row=>{const{model:model}=this.props;let rowDisplay=model.pivot_type==="date"?this.dateFormatter.convert(row.key):row.key;if(model.drilldown_url){const url=Object(replace_vars["a"])(model.drilldown_url,{},{key:row.key});rowDisplay=external_kbnSharedDeps_React_default.a.createElement("a",{href:url},rowDisplay)}const columns=row.series.filter(item=>item).map(item=>{const column=this.visibleSeries.find(c=>c.id===item.id);if(!column)return null;const formatter=Object(tick_formatter["a"])(column.formatter,column.value_template,this.props.getConfig);const value=formatter(item.last);let trend;if(column.trend_arrows){const trendIcon=item.slope>0?"sortUp":"sortDown";trend=external_kbnSharedDeps_React_default.a.createElement("span",null,"Â  ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:trendIcon,color:"subdued"}))}const style={color:getColor(column.color_rules,"text",item.last)};return external_kbnSharedDeps_React_default.a.createElement("td",{key:`${row.key}-${item.id}`,"data-test-subj":"tvbTableVis__value",className:"eui-textRight",style:style},external_kbnSharedDeps_React_default.a.createElement("span",null,value),trend)});return external_kbnSharedDeps_React_default.a.createElement("tr",{key:row.key},external_kbnSharedDeps_React_default.a.createElement("td",null,rowDisplay||external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.emptyTextValue",{defaultMessage:"(empty)"})),columns)});const fieldFormatsService=Object(services["d"])();const DateFormat=fieldFormatsService.getType(data_public_["fieldFormats"].FIELD_FORMAT_IDS.DATE);this.dateFormatter=new DateFormat({},this.props.getConfig)}get visibleSeries(){return Object(external_kbnSharedDeps_Lodash_["get"])(this.props,"model.series",[]).filter(series=>!series.hidden)}renderHeader(){const{model:model,uiState:uiState,onUiState:onUiState,visData:visData}=this.props;const stateKey=`${model.type}.sort`;const sort=uiState.get(stateKey,{column:"_default_",order:"asc"});const calculateHeaderLabel=(metric,item)=>{var _visData$series$,_visData$series$$seri,_visData$series$$seri2;return item.label||((_visData$series$=visData.series[0])===null||_visData$series$===void 0?void 0:(_visData$series$$seri=_visData$series$.series)===null||_visData$series$$seri===void 0?void 0:(_visData$series$$seri2=_visData$series$$seri.find(s=>item.id===s.id))===null||_visData$series$$seri2===void 0?void 0:_visData$series$$seri2.label)};const columns=this.visibleSeries.map(item=>{const metric=Object(external_kbnSharedDeps_Lodash_["last"])(item.metrics);const label=calculateHeaderLabel(metric,item);const handleClick=()=>{if(!isSortable(metric))return;let order;if(sort.column===item.id){order=sort.order==="asc"?"desc":"asc"}else{order="asc"}onUiState(stateKey,{column:item.id,order:order})};let sortComponent;if(isSortable(metric)){let sortIcon;if(sort.column===item.id){sortIcon=sort.order==="asc"?"sortUp":"sortDown"}else{sortIcon="empty"}sortComponent=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:sortIcon})}let headerContent=external_kbnSharedDeps_React_default.a.createElement("span",null,label," ",sortComponent);if(!isSortable(metric)){headerContent=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.columnNotSortableTooltip",defaultMessage:"This column is not sortable"})},headerContent)}return external_kbnSharedDeps_React_default.a.createElement("th",{onClick:handleClick,key:item.id,scope:"col"},headerContent)});const label=visData.pivot_label||model.pivot_label||model.pivot_id;let sortIcon;if(sort.column==="_default_"){sortIcon=sort.order==="asc"?"sortUp":"sortDown"}else{sortIcon="empty"}const sortComponent=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:sortIcon});const handleSortClick=()=>{let order;if(sort.column==="_default_"){order=sort.order==="asc"?"desc":"asc"}else{order="asc"}onUiState(stateKey,{column:"_default_",order:order})};return external_kbnSharedDeps_React_default.a.createElement("tr",null,external_kbnSharedDeps_React_default.a.createElement("th",{className:"eui-textLeft",scope:"col",onClick:handleSortClick},label," ",sortComponent),columns)}render(){const{visData:visData,model:model}=this.props;const header=this.renderHeader();let rows;if(Object(external_kbnSharedDeps_Lodash_["isArray"])(visData.series)&&visData.series.length){rows=visData.series.map(this.renderRow)}else{const message=model.pivot_id?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.noResultsAvailableMessage",defaultMessage:"No results available."}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visTypeTimeseries.table.noResultsAvailableWithDescriptionMessage",defaultMessage:"No results available. You must choose a group by field for this visualization."});rows=external_kbnSharedDeps_React_default.a.createElement("tr",null,external_kbnSharedDeps_React_default.a.createElement("td",{colSpan:this.visibleSeries.length+1},message))}return external_kbnSharedDeps_React_default.a.createElement(public_["RedirectAppLinks"],{application:Object(services["b"])().application,className:"tvbVis","data-test-subj":"tableView"},external_kbnSharedDeps_React_default.a.createElement("table",{className:"table"},external_kbnSharedDeps_React_default.a.createElement("thead",null,header),external_kbnSharedDeps_React_default.a.createElement("tbody",null,rows)))}}vis_TableVis.defaultProps={sort:{}}},57:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return replaceVars}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(31);var lodash__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__);var handlebars_dist_handlebars__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(65);var handlebars_dist_handlebars__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(handlebars_dist_handlebars__WEBPACK_IMPORTED_MODULE_1__);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(3);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__);function replaceVars(str,args={},vars={}){try{const template=handlebars_dist_handlebars__WEBPACK_IMPORTED_MODULE_1___default.a.compile(str,{strict:true,knownHelpersOnly:true});const string=template(lodash__WEBPACK_IMPORTED_MODULE_0___default.a.assign({},vars,{args:args}));return string}catch(e){if(e.toString().indexOf("Parse error")!==-1){return str}else if(e.message.indexOf("not defined in")!==-1){const badVar=e.message.split(/"/)[1];e.error={caused_by:{reason:_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].translate("visTypeTimeseries.replaceVars.errors.unknownVarDescription",{defaultMessage:"{badVar} is an unknown variable",values:{badVar:"{{"+badVar+"}}"}}),title:_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].translate("visTypeTimeseries.replaceVars.errors.unknownVarTitle",{defaultMessage:"Error processing your markdown"})}}}else{e.error={caused_by:{reason:_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].translate("visTypeTimeseries.replaceVars.errors.markdownErrorDescription",{defaultMessage:"Please verify you are only using markdown, known variables, and built-in Handlebars expressions"}),title:_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].translate("visTypeTimeseries.replaceVars.errors.markdownErrorTitle",{defaultMessage:"Error processing your markdown"})}}}return e}}},95:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return basicAggs}));const basicAggs=["count","avg","max","min","sum","std_deviation","variance","sum_of_squares","value_count","cardinality"]}}]);