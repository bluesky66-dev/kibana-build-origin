(window["discover_bundle_jsonpfunction"]=window["discover_bundle_jsonpfunction"]||[]).push([[6],{224:function(module,exports,__webpack_require__){__webpack_require__(225);module.exports="ngRoute"},225:function(module,exports){
/**
 * @license AngularJS v1.8.0
 * (c) 2010-2020 Google, Inc. http://angularjs.org
 * License: MIT
 */
(function(window,angular){"use strict";function shallowCopy(src,dst){if(isArray(src)){dst=dst||[];for(var i=0,ii=src.length;i<ii;i++){dst[i]=src[i]}}else if(isObject(src)){dst=dst||{};for(var key in src){if(!(key.charAt(0)==="$"&&key.charAt(1)==="$")){dst[key]=src[key]}}}return dst||src}function routeToRegExp(path,opts){var keys=[];var pattern=path.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)(\*\?|[?*])?/g,(function(_,slash,key,option){var optional=option==="?"||option==="*?";var star=option==="*"||option==="*?";keys.push({name:key,optional:optional});slash=slash||"";return(optional?"(?:"+slash:slash+"(?:")+(star?"(.+?)":"([^/]+)")+(optional?"?)?":")")})).replace(/([/$*])/g,"\\$1");if(opts.ignoreTrailingSlashes){pattern=pattern.replace(/\/+$/,"")+"/*"}return{keys:keys,regexp:new RegExp("^"+pattern+"(?:[?#]|$)",opts.caseInsensitiveMatch?"i":"")}}var isArray;var isObject;var isDefined;var noop;var ngRouteModule=angular.module("ngRoute",[]).info({angularVersion:"1.8.0"}).provider("$route",$RouteProvider).run(instantiateRoute);var $routeMinErr=angular.$$minErr("ngRoute");var isEagerInstantiationEnabled;function $RouteProvider(){isArray=angular.isArray;isObject=angular.isObject;isDefined=angular.isDefined;noop=angular.noop;function inherit(parent,extra){return angular.extend(Object.create(parent),extra)}var routes={};this.when=function(path,route){var routeCopy=shallowCopy(route);if(angular.isUndefined(routeCopy.reloadOnUrl)){routeCopy.reloadOnUrl=true}if(angular.isUndefined(routeCopy.reloadOnSearch)){routeCopy.reloadOnSearch=true}if(angular.isUndefined(routeCopy.caseInsensitiveMatch)){routeCopy.caseInsensitiveMatch=this.caseInsensitiveMatch}routes[path]=angular.extend(routeCopy,{originalPath:path},path&&routeToRegExp(path,routeCopy));if(path){var redirectPath=path[path.length-1]==="/"?path.substr(0,path.length-1):path+"/";routes[redirectPath]=angular.extend({originalPath:path,redirectTo:path},routeToRegExp(redirectPath,routeCopy))}return this};this.caseInsensitiveMatch=false;this.otherwise=function(params){if(typeof params==="string"){params={redirectTo:params}}this.when(null,params);return this};isEagerInstantiationEnabled=true;this.eagerInstantiationEnabled=function eagerInstantiationEnabled(enabled){if(isDefined(enabled)){isEagerInstantiationEnabled=enabled;return this}return isEagerInstantiationEnabled};this.$get=["$rootScope","$location","$routeParams","$q","$injector","$templateRequest","$sce","$browser",function($rootScope,$location,$routeParams,$q,$injector,$templateRequest,$sce,$browser){var forceReload=false,preparedRoute,preparedRouteIsUpdateOnly,$route={routes:routes,reload:function(){forceReload=true;var fakeLocationEvent={defaultPrevented:false,preventDefault:function fakePreventDefault(){this.defaultPrevented=true;forceReload=false}};$rootScope.$evalAsync((function(){prepareRoute(fakeLocationEvent);if(!fakeLocationEvent.defaultPrevented)commitRoute()}))},updateParams:function(newParams){if(this.current&&this.current.$$route){newParams=angular.extend({},this.current.params,newParams);$location.path(interpolate(this.current.$$route.originalPath,newParams));$location.search(newParams)}else{throw $routeMinErr("norout","Tried updating route with no current route")}}};$rootScope.$on("$locationChangeStart",prepareRoute);$rootScope.$on("$locationChangeSuccess",commitRoute);return $route;function switchRouteMatcher(on,route){var keys=route.keys,params={};if(!route.regexp)return null;var m=route.regexp.exec(on);if(!m)return null;for(var i=1,len=m.length;i<len;++i){var key=keys[i-1];var val=m[i];if(key&&val){params[key.name]=val}}return params}function prepareRoute($locationEvent){var lastRoute=$route.current;preparedRoute=parseRoute();preparedRouteIsUpdateOnly=isNavigationUpdateOnly(preparedRoute,lastRoute);if(!preparedRouteIsUpdateOnly&&(lastRoute||preparedRoute)){if($rootScope.$broadcast("$routeChangeStart",preparedRoute,lastRoute).defaultPrevented){if($locationEvent){$locationEvent.preventDefault()}}}}function commitRoute(){var lastRoute=$route.current;var nextRoute=preparedRoute;if(preparedRouteIsUpdateOnly){lastRoute.params=nextRoute.params;angular.copy(lastRoute.params,$routeParams);$rootScope.$broadcast("$routeUpdate",lastRoute)}else if(nextRoute||lastRoute){forceReload=false;$route.current=nextRoute;var nextRoutePromise=$q.resolve(nextRoute);$browser.$$incOutstandingRequestCount("$route");nextRoutePromise.then(getRedirectionData).then(handlePossibleRedirection).then((function(keepProcessingRoute){return keepProcessingRoute&&nextRoutePromise.then(resolveLocals).then((function(locals){if(nextRoute===$route.current){if(nextRoute){nextRoute.locals=locals;angular.copy(nextRoute.params,$routeParams)}$rootScope.$broadcast("$routeChangeSuccess",nextRoute,lastRoute)}}))})).catch((function(error){if(nextRoute===$route.current){$rootScope.$broadcast("$routeChangeError",nextRoute,lastRoute,error)}})).finally((function(){$browser.$$completeOutstandingRequest(noop,"$route")}))}}function getRedirectionData(route){var data={route:route,hasRedirection:false};if(route){if(route.redirectTo){if(angular.isString(route.redirectTo)){data.path=interpolate(route.redirectTo,route.params);data.search=route.params;data.hasRedirection=true}else{var oldPath=$location.path();var oldSearch=$location.search();var newUrl=route.redirectTo(route.pathParams,oldPath,oldSearch);if(angular.isDefined(newUrl)){data.url=newUrl;data.hasRedirection=true}}}else if(route.resolveRedirectTo){return $q.resolve($injector.invoke(route.resolveRedirectTo)).then((function(newUrl){if(angular.isDefined(newUrl)){data.url=newUrl;data.hasRedirection=true}return data}))}}return data}function handlePossibleRedirection(data){var keepProcessingRoute=true;if(data.route!==$route.current){keepProcessingRoute=false}else if(data.hasRedirection){var oldUrl=$location.url();var newUrl=data.url;if(newUrl){$location.url(newUrl).replace()}else{newUrl=$location.path(data.path).search(data.search).replace().url()}if(newUrl!==oldUrl){keepProcessingRoute=false}}return keepProcessingRoute}function resolveLocals(route){if(route){var locals=angular.extend({},route.resolve);angular.forEach(locals,(function(value,key){locals[key]=angular.isString(value)?$injector.get(value):$injector.invoke(value,null,null,key)}));var template=getTemplateFor(route);if(angular.isDefined(template)){locals["$template"]=template}return $q.all(locals)}}function getTemplateFor(route){var template,templateUrl;if(angular.isDefined(template=route.template)){if(angular.isFunction(template)){template=template(route.params)}}else if(angular.isDefined(templateUrl=route.templateUrl)){if(angular.isFunction(templateUrl)){templateUrl=templateUrl(route.params)}if(angular.isDefined(templateUrl)){route.loadedTemplateUrl=$sce.valueOf(templateUrl);template=$templateRequest(templateUrl)}}return template}function parseRoute(){var params,match;angular.forEach(routes,(function(route,path){if(!match&&(params=switchRouteMatcher($location.path(),route))){match=inherit(route,{params:angular.extend({},$location.search(),params),pathParams:params});match.$$route=route}}));return match||routes[null]&&inherit(routes[null],{params:{},pathParams:{}})}function isNavigationUpdateOnly(newRoute,oldRoute){return!forceReload&&newRoute&&oldRoute&&newRoute.$$route===oldRoute.$$route&&(!newRoute.reloadOnUrl||!newRoute.reloadOnSearch&&angular.equals(newRoute.pathParams,oldRoute.pathParams))}function interpolate(string,params){var result=[];angular.forEach((string||"").split(":"),(function(segment,i){if(i===0){result.push(segment)}else{var segmentMatch=segment.match(/(\w+)(?:[?*])?(.*)/);var key=segmentMatch[1];result.push(params[key]);result.push(segmentMatch[2]||"");delete params[key]}}));return result.join("")}}]}instantiateRoute.$inject=["$injector"];function instantiateRoute($injector){if(isEagerInstantiationEnabled){$injector.get("$route")}}ngRouteModule.provider("$routeParams",$RouteParamsProvider);function $RouteParamsProvider(){this.$get=function(){return{}}}ngRouteModule.directive("ngView",ngViewFactory);ngRouteModule.directive("ngView",ngViewFillContentFactory);ngViewFactory.$inject=["$route","$anchorScroll","$animate"];function ngViewFactory($route,$anchorScroll,$animate){return{restrict:"ECA",terminal:true,priority:400,transclude:"element",link:function(scope,$element,attr,ctrl,$transclude){var currentScope,currentElement,previousLeaveAnimation,autoScrollExp=attr.autoscroll,onloadExp=attr.onload||"";scope.$on("$routeChangeSuccess",update);update();function cleanupLastView(){if(previousLeaveAnimation){$animate.cancel(previousLeaveAnimation);previousLeaveAnimation=null}if(currentScope){currentScope.$destroy();currentScope=null}if(currentElement){previousLeaveAnimation=$animate.leave(currentElement);previousLeaveAnimation.done((function(response){if(response!==false)previousLeaveAnimation=null}));currentElement=null}}function update(){var locals=$route.current&&$route.current.locals,template=locals&&locals.$template;if(angular.isDefined(template)){var newScope=scope.$new();var current=$route.current;var clone=$transclude(newScope,(function(clone){$animate.enter(clone,null,currentElement||$element).done((function onNgViewEnter(response){if(response!==false&&angular.isDefined(autoScrollExp)&&(!autoScrollExp||scope.$eval(autoScrollExp))){$anchorScroll()}}));cleanupLastView()}));currentElement=clone;currentScope=current.scope=newScope;currentScope.$emit("$viewContentLoaded");currentScope.$eval(onloadExp)}else{cleanupLastView()}}}}}ngViewFillContentFactory.$inject=["$compile","$controller","$route"];function ngViewFillContentFactory($compile,$controller,$route){return{restrict:"ECA",priority:-400,link:function(scope,$element){var current=$route.current,locals=current.locals;$element.html(locals.$template);var link=$compile($element.contents());if(current.controller){locals.$scope=scope;var controller=$controller(current.controller,locals);if(current.controllerAs){scope[current.controllerAs]=controller}$element.data("$ngControllerController",controller);$element.children().data("$ngControllerController",controller)}scope[current.resolveAs||"$resolve"]=locals;link(scope)}}}})(window,window.angular)},226:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var angular_sanitize=__webpack_require__(83);var angular_route=__webpack_require__(224);var external_kbnSharedDeps_Lodash_=__webpack_require__(20);var external_kbnSharedDeps_Lodash_default=__webpack_require__.n(external_kbnSharedDeps_Lodash_);var external_kbnSharedDeps_Rxjs_=__webpack_require__(21);var external_kbnSharedDeps_RxjsOperators_=__webpack_require__(15);var external_kbnSharedDeps_Moment_=__webpack_require__(49);var external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_);var elastic_datemath=__webpack_require__(88);var elastic_datemath_default=__webpack_require__.n(elastic_datemath);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);var public_=__webpack_require__(5);var data_public_=__webpack_require__(4);function migrateLegacyQuery(query){if(!Object(external_kbnSharedDeps_Lodash_["has"])(query,"language")){return{query:query,language:"lucene"}}return query}var url_generator=__webpack_require__(7);var helpers=__webpack_require__(66);const APP_STATE_URL_KEY="_a";function getState({getStateDefaults:getStateDefaults,storeInSessionStorage:storeInSessionStorage=false,history:history,toasts:toasts,uiSettings:uiSettings}){const defaultAppState=getStateDefaults?getStateDefaults():{};const stateStorage=Object(public_["createKbnUrlStateStorage"])({useHash:storeInSessionStorage,history:history,...toasts&&Object(public_["withNotifyOnErrors"])(toasts)});const appStateFromUrl=stateStorage.get(APP_STATE_URL_KEY);if(appStateFromUrl&&appStateFromUrl.query&&!appStateFromUrl.query.language){appStateFromUrl.query=migrateLegacyQuery(appStateFromUrl.query)}let initialAppState=Object(helpers["d"])({...defaultAppState,...appStateFromUrl},uiSettings);let previousAppState;const appStateContainer=Object(public_["createStateContainer"])(initialAppState);const appStateContainerModified={...appStateContainer,set:value=>{if(value){previousAppState=appStateContainer.getState();appStateContainer.set(value)}}};const{start:start,stop:stop}=Object(public_["syncState"])({storageKey:APP_STATE_URL_KEY,stateContainer:appStateContainerModified,stateStorage:stateStorage});return{kbnUrlStateStorage:stateStorage,appStateContainer:appStateContainerModified,startSync:start,stopSync:stop,setAppState:newPartial=>setState(appStateContainerModified,newPartial),replaceUrlAppState:async(newPartial={})=>{const state={...appStateContainer.getState(),...newPartial};await stateStorage.set(APP_STATE_URL_KEY,state,{replace:true})},resetInitialAppState:()=>{initialAppState=appStateContainer.getState()},resetAppState:()=>{const defaultState=getStateDefaults?getStateDefaults():{};setState(appStateContainerModified,defaultState)},getPreviousAppState:()=>previousAppState,flushToUrl:()=>stateStorage.kbnUrlControls.flush(),isAppStateDirty:()=>!isEqualState(initialAppState,appStateContainer.getState())}}function setState(stateContainer,newState){const oldState=stateContainer.getState();const mergedState={...oldState,...newState};if(!isEqualState(oldState,mergedState)){stateContainer.set(mergedState)}}function isEqualFilters(filtersA,filtersB){if(!filtersA&&!filtersB){return true}else if(!filtersA||!filtersB){return false}return data_public_["esFilters"].compareFilters(filtersA,filtersB,data_public_["esFilters"].COMPARE_ALL_OPTIONS)}function splitState(state={}){const{filters:filters=[],...statePartial}=state;return{filters:filters,state:statePartial}}function isEqualState(stateA,stateB){if(!stateA&&!stateB){return true}else if(!stateA||!stateB){return false}const{filters:stateAFilters=[],...stateAPartial}=stateA;const{filters:stateBFilters=[],...stateBPartial}=stateB;return Object(external_kbnSharedDeps_Lodash_["isEqual"])(stateAPartial,stateBPartial)&&isEqualFilters(stateAFilters,stateBFilters)}function createSearchSessionRestorationDataProvider(deps){const getSavedSearchId=()=>deps.getSavedSearch().id;return{getName:async()=>{const savedSearch=deps.getSavedSearch();return savedSearch.id&&savedSearch.title||external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.discoverDefaultSearchSessionName",{defaultMessage:"Discover"})},getUrlGeneratorData:async()=>({urlGeneratorId:url_generator["a"],initialState:createUrlGeneratorState({...deps,getSavedSearchId:getSavedSearchId,shouldRestoreSearchSession:false}),restoreState:createUrlGeneratorState({...deps,getSavedSearchId:getSavedSearchId,shouldRestoreSearchSession:true})})}}function createUrlGeneratorState({appStateContainer:appStateContainer,data:data,getSavedSearchId:getSavedSearchId,shouldRestoreSearchSession:shouldRestoreSearchSession}){const appState=appStateContainer.get();return{filters:data.query.filterManager.getFilters(),indexPatternId:appState.index,query:appState.query,savedSearchId:getSavedSearchId(),timeRange:shouldRestoreSearchSession?data.query.timefilter.timefilter.getAbsoluteTime():data.query.timefilter.timefilter.getTime(),searchSessionId:shouldRestoreSearchSession?data.search.session.getSessionId():undefined,columns:appState.columns,sort:appState.sort,savedQuery:appState.savedQuery,interval:appState.interval,useHash:false}}var inspector_public_=__webpack_require__(54);var doc_table=__webpack_require__(64);var discover_legacy='<discover-app>\n  <discover\n    fetch="fetch"\n    fetch-counter="fetchCounter"\n    fetch-error="fetchError"\n    field-counts="fieldCounts"\n    histogram-data="histogramData"\n    hits="hits"\n    index-pattern="indexPattern"\n    minimum-visible-rows="minimumVisibleRows"\n    on-skip-bottom-button-click="onSkipBottomButtonClick"\n    opts="opts"\n    reset-query="resetQuery"\n    result-state="resultState"\n    rows="rows"\n    search-source="volatileSearchSource"\n    state="state"\n    time-range="timeRange"\n    top-nav-menu="topNavMenu"\n    use-new-fields-api="useNewFieldsApi"\n    unmapped-fields-config="unmappedFieldsConfig"\n  >\n  </discover>\n</discover-app>\n';var kibana_services=__webpack_require__(3);const{docLinks:docLinks}=Object(kibana_services["h"])();function addHelpMenuToAppChrome(chrome){chrome.setHelpExtension({appName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.helpMenu.appName",{defaultMessage:"Discover"}),links:[{linkType:"documentation",href:`${docLinks.links.discover.guide}`}]})}function tableResponseHandler(table,dimensions){const converted={tables:[]};const split=dimensions.splitColumn||dimensions.splitRow;if(split){converted.direction=dimensions.splitRow?"row":"column";const splitColumnIndex=split[0].accessor;const splitColumnFormatter=Object(kibana_services["h"])().data.fieldFormats.deserialize(split[0].format);const splitColumn=table.columns[splitColumnIndex];const splitMap={};let splitIndex=0;table.rows.forEach((row,rowIndex)=>{const splitValue=row[splitColumn.id];if(!splitMap.hasOwnProperty(splitValue)){splitMap[splitValue]=splitIndex++;const tableGroup={$parent:converted,title:`${splitColumnFormatter.convert(splitValue)}: ${splitColumn.name}`,name:splitColumn.name,key:splitValue,column:splitColumnIndex,row:rowIndex,table:table,tables:[]};tableGroup.tables.push({$parent:tableGroup,columns:table.columns,rows:[]});converted.tables.push(tableGroup)}const tableIndex=splitMap[splitValue];converted.tables[tableIndex].tables[0].rows.push(row)})}else{converted.tables.push({columns:table.columns,rows:table.rows})}return converted}function convertTableGroup(tableGroup,convertTable){const tables=tableGroup.tables;if(!tables.length)return;const firstChild=tables[0];if(firstChild.columns){const chart=convertTable(firstChild);if(tableGroup.$parent){chart.label=tableGroup.title}return chart}const out={};let outList;tables.forEach((function(table){if(!outList){const direction=tableGroup.direction==="row"?"rows":"columns";outList=out[direction]=[]}let output;if(output=convertTableGroup(table,convertTable)){outList.push(output)}}));return out}const discoverResponseHandler=(response,dimensions)=>{const tableGroup=tableResponseHandler(response,dimensions);let converted=convertTableGroup(tableGroup,table=>Object(helpers["a"])(table,dimensions));if(!converted){converted={rows:[]}}converted.hits=response.rows.length;return converted};var breadcrumbs=__webpack_require__(69);function validateTimeRange({from:from,to:to},toastNotifications){const fromMoment=elastic_datemath_default.a.parse(from);const toMoment=elastic_datemath_default.a.parse(to);if(!fromMoment||!toMoment||!fromMoment.isValid()||!toMoment.isValid()){toastNotifications.addDanger({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.notifications.invalidTimeRangeTitle",{defaultMessage:`Invalid time range`}),text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.notifications.invalidTimeRangeText",{defaultMessage:`The provided time range is invalid. (from: '{from}', to: '{to}')`,values:{from:from,to:to}})});return false}return true}var kibanaLegacy_public_=__webpack_require__(12);var common=__webpack_require__(62);function findIndexPatternById(indexPatterns,id){if(!Array.isArray(indexPatterns)||!id){return}return indexPatterns.find(o=>o.id===id)}function getFallbackIndexPatternId(indexPatterns,defaultIndex=""){var _indexPatterns$;if(defaultIndex&&findIndexPatternById(indexPatterns,defaultIndex)){return defaultIndex}return indexPatterns&&(_indexPatterns$=indexPatterns[0])!==null&&_indexPatterns$!==void 0&&_indexPatterns$.id?indexPatterns[0].id:""}function getIndexPatternId(id="",indexPatterns=[],defaultIndex=""){if(!id||!findIndexPatternById(indexPatterns,id)){return getFallbackIndexPatternId(indexPatterns,defaultIndex)}return id}async function loadIndexPattern(id,indexPatterns,config){const indexPatternList=await indexPatterns.getCache();const actualId=getIndexPatternId(id,indexPatternList,config.get("defaultIndex"));return{list:indexPatternList||[],loaded:await indexPatterns.get(actualId),stateVal:id,stateValFound:!!id&&actualId===id}}function resolveIndexPattern(ip,searchSource,toastNotifications){const{loaded:loadedIndexPattern,stateVal:stateVal,stateValFound:stateValFound}=ip;const ownIndexPattern=searchSource.getOwnField("index");if(ownIndexPattern&&!stateVal){return ownIndexPattern}if(stateVal&&!stateValFound){const warningTitle=external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.valueIsNotConfiguredIndexPatternIDWarningTitle",{defaultMessage:"{stateVal} is not a configured index pattern ID",values:{stateVal:`"${stateVal}"`}});if(ownIndexPattern){toastNotifications.addWarning({title:warningTitle,text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.showingSavedIndexPatternWarningDescription",{defaultMessage:'Showing the saved index pattern: "{ownIndexPatternTitle}" ({ownIndexPatternId})',values:{ownIndexPatternTitle:ownIndexPattern.title,ownIndexPatternId:ownIndexPattern.id}})});return ownIndexPattern}toastNotifications.addWarning({title:warningTitle,text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.showingDefaultIndexPatternWarningDescription",{defaultMessage:'Showing the default index pattern: "{loadedIndexPatternTitle}" ({loadedIndexPatternId})',values:{loadedIndexPatternTitle:loadedIndexPattern.title,loadedIndexPatternId:loadedIndexPattern.id}})})}return loadedIndexPattern}var update_search_source=__webpack_require__(87);function calcFieldCounts(counts={},rows,indexPattern){for(const hit of rows){const fields=Object.keys(indexPattern.flattenHit(hit));for(const fieldName of fields){counts[fieldName]=(counts[fieldName]||0)+1}}return counts}var get_default_sort=__webpack_require__(79);function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class discover_search_session_DiscoverSearchSessionManager{constructor(deps){this.deps=deps;_defineProperty(this,"newSearchSessionIdFromURL$",Object(public_["createQueryParamObservable"])(this.deps.history,url_generator["d"]).pipe(Object(external_kbnSharedDeps_RxjsOperators_["filter"])(searchSessionId=>{if(!searchSessionId)return true;return!this.deps.session.isCurrentSession(searchSessionId)})));_defineProperty(this,"getSearchSessionIdFromURL",()=>Object(public_["getQueryParams"])(this.deps.history.location)[url_generator["d"]])}getNextSearchSessionId(){var _searchSessionIdFromU;let searchSessionIdFromURL=this.getSearchSessionIdFromURL();if(searchSessionIdFromURL){if(this.deps.session.isRestore()&&this.deps.session.isCurrentSession(searchSessionIdFromURL)){this.removeSearchSessionIdFromURL({replace:true});searchSessionIdFromURL=undefined}else{this.deps.session.restore(searchSessionIdFromURL)}}return(_searchSessionIdFromU=searchSessionIdFromURL)!==null&&_searchSessionIdFromU!==void 0?_searchSessionIdFromU:this.deps.session.start()}removeSearchSessionIdFromURL({replace:replace=true}={replace:true}){if(this.hasSearchSessionIdInURL()){Object(public_["removeQueryParam"])(this.deps.history,url_generator["d"],replace)}}hasSearchSessionIdInURL(){return!!this.getSearchSessionIdFromURL()}}const services=Object(kibana_services["h"])();const{core:core,capabilities:capabilities,chrome:discover_chrome,data:discover_data,history:getHistory,filterManager:discover_filterManager,timefilter:timefilter,toastNotifications:discover_toastNotifications,uiSettings:config}=Object(kibana_services["h"])();const fetchStatuses={UNINITIALIZED:"uninitialized",LOADING:"loading",COMPLETE:"complete",ERROR:"error"};const app=Object(kibana_services["a"])();app.config($routeProvider=>{const defaults={requireDefaultIndex:true,requireUICapability:"discover.show",k7Breadcrumbs:($route,$injector)=>$injector.invoke($route.current.params.id?breadcrumbs["b"]:breadcrumbs["a"]),badge:()=>{if(capabilities.discover.save){return undefined}return{text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.badge.readOnly.text",{defaultMessage:"Read only"}),tooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.badge.readOnly.tooltip",{defaultMessage:"Unable to save searches"}),iconType:"glasses"}}};const discoverRoute={...defaults,template:discover_legacy,reloadOnSearch:false,resolve:{savedObjects:function($route,Promise){const history=getHistory();const savedSearchId=$route.current.params.id;return discover_data.indexPatterns.ensureDefaultIndexPattern(history).then(()=>{const{appStateContainer:appStateContainer}=getState({history:history,uiSettings:config});const{index:index}=appStateContainer.getState();return Promise.props({ip:loadIndexPattern(index,discover_data.indexPatterns,config),savedSearch:Object(kibana_services["h"])().getSavedSearchById(savedSearchId).then(savedSearch=>{if(savedSearchId){discover_chrome.recentlyAccessed.add(savedSearch.getFullPath(),savedSearch.title,savedSearchId)}return savedSearch}).catch(Object(kibana_services["k"])({history:history,navigateToApp:core.application.navigateToApp,mapping:{search:"/","index-pattern":{app:"management",path:`kibana/objects/savedSearches/${$route.current.params.id}`}},toastNotifications:discover_toastNotifications,onBeforeRedirect(){Object(kibana_services["j"])().setTrackedUrl("/")}}))})})}}};$routeProvider.when("/view/:id?",discoverRoute);$routeProvider.when("/",discoverRoute)});app.directive("discoverApp",(function(){return{restrict:"E",controllerAs:"discoverApp",controller:discoverController}}));function discoverController($route,$scope,Promise){const{isDefault:isDefaultType}=data_public_["indexPatterns"];const subscriptions=new external_kbnSharedDeps_Rxjs_["Subscription"];const refetch$=new external_kbnSharedDeps_Rxjs_["Subject"];let inspectorRequest;let isChangingIndexPattern=false;const savedSearch=$route.current.locals.savedObjects.savedSearch;const persistentSearchSource=savedSearch.searchSource;$scope.indexPattern=resolveIndexPattern($route.current.locals.savedObjects.ip,persistentSearchSource,discover_toastNotifications);$scope.useNewFieldsApi=!config.get(common["i"]);$scope.fetchCounter=0;const getTimeField=()=>isDefaultType($scope.indexPattern)?$scope.indexPattern.timeFieldName:undefined;const history=getHistory();const searchSessionManager=new discover_search_session_DiscoverSearchSessionManager({history:history,session:discover_data.search.session});const stateContainer=getState({getStateDefaults:getStateDefaults,storeInSessionStorage:config.get("state:storeInSessionStorage"),history:history,toasts:core.notifications.toasts,uiSettings:config});const{appStateContainer:appStateContainer,startSync:startStateSync,stopSync:stopStateSync,setAppState:setAppState,replaceUrlAppState:replaceUrlAppState,kbnUrlStateStorage:kbnUrlStateStorage,getPreviousAppState:getPreviousAppState}=stateContainer;if(appStateContainer.getState().index!==$scope.indexPattern.id){setAppState({index:$scope.indexPattern.id})}$scope.state={...appStateContainer.getState()};const{stop:stopSyncingGlobalStateWithUrl}=Object(data_public_["syncQueryStateWithUrl"])(discover_data.query,kbnUrlStateStorage);discover_filterManager.setAppFilters(external_kbnSharedDeps_Lodash_default.a.cloneDeep(appStateContainer.getState().filters));discover_data.query.queryString.setQuery(appStateContainer.getState().query);const stopSyncingQueryAppStateWithStateContainer=Object(data_public_["connectToQueryState"])(discover_data.query,appStateContainer,{filters:data_public_["esFilters"].FilterStateStore.APP_STATE,query:true});const appStateUnsubscribe=appStateContainer.subscribe(async newState=>{const{state:newStatePartial}=splitState(newState);const{state:oldStatePartial}=splitState(getPreviousAppState());if(!external_kbnSharedDeps_Lodash_default.a.isEqual(newStatePartial,oldStatePartial)){$scope.$evalAsync(async()=>{if(newStatePartial.index&&oldStatePartial.index!==newStatePartial.index){isChangingIndexPattern=true;$route.reload();return}$scope.state={...newState};const changes=["interval","sort"].filter(prop=>!external_kbnSharedDeps_Lodash_default.a.isEqual(newStatePartial[prop],oldStatePartial[prop]));if(oldStatePartial.hideChart&&!newStatePartial.hideChart){changes.push(true)}if(changes.length){refetch$.next()}})}});const unlistenHistoryBasePath=history.listen(({pathname:pathname,search:search,hash:hash})=>{if(!search&&!hash&&pathname==="/"){$route.reload()}});discover_data.search.session.enableStorage(createSearchSessionRestorationDataProvider({appStateContainer:appStateContainer,data:discover_data,getSavedSearch:()=>savedSearch}),{isDisabled:()=>capabilities.discover.storeSearchSession?{disabled:false}:{disabled:true,reasonText:data_public_["noSearchSessionStorageCapabilityMessage"]}});subscriptions.add(Object(kibana_services["s"])($scope,discover_filterManager.getUpdates$(),{next:()=>{$scope.state.filters=discover_filterManager.getAppFilters();$scope.updateDataSource()}},error=>Object(kibanaLegacy_public_["addFatalError"])(core.fatalErrors,error)));$scope.opts={sampleSize:config.get(common["h"]),timefield:getTimeField(),savedSearch:savedSearch,services:services,indexPatternList:$route.current.locals.savedObjects.ip.list,config:config,setHeaderActionMenu:Object(kibana_services["c"])(),filterManager:discover_filterManager,setAppState:setAppState,data:discover_data,stateContainer:stateContainer,searchSessionManager:searchSessionManager,refetch$:refetch$};const inspectorAdapters=$scope.opts.inspectorAdapters={requests:new inspector_public_["RequestAdapter"]};$scope.minimumVisibleRows=50;$scope.fetchStatus=fetchStatuses.UNINITIALIZED;let abortController;$scope.$on("$destroy",()=>{if(abortController)abortController.abort();savedSearch.destroy();subscriptions.unsubscribe();if(!isChangingIndexPattern){discover_data.search.session.clear()}appStateUnsubscribe();stopStateSync();stopSyncingGlobalStateWithUrl();stopSyncingQueryAppStateWithStateContainer();unlistenHistoryBasePath()});$scope.opts.getFieldCounts=async()=>{if($scope.fetchStatus===fetchStatuses.COMPLETE){return $scope.fieldCounts}return await new Promise(resolve=>{const unwatch=$scope.$watch("fetchStatus",newValue=>{if(newValue===fetchStatuses.COMPLETE){unwatch();resolve($scope.fieldCounts)}})})};$scope.opts.navigateTo=path=>{$scope.$evalAsync(()=>{history.push(path)})};persistentSearchSource.setField("index",$scope.indexPattern);const volatileSearchSource=savedSearch.searchSource.create();if(isDefaultType($scope.indexPattern)){volatileSearchSource.setField("filter",()=>timefilter.createFilter($scope.indexPattern))}volatileSearchSource.setParent(persistentSearchSource);$scope.volatileSearchSource=volatileSearchSource;const pageTitleSuffix=savedSearch.id&&savedSearch.title?`: ${savedSearch.title}`:"";discover_chrome.docTitle.change(`Discover${pageTitleSuffix}`);Object(breadcrumbs["c"])(savedSearch,discover_chrome);function getDefaultColumns(){if(savedSearch.columns.length>0){return[...savedSearch.columns]}return[...config.get(common["d"])]}function getStateDefaults(){const query=persistentSearchSource.getField("query")||discover_data.query.queryString.getDefaultQuery();const sort=Object(doc_table["b"])(savedSearch.sort,$scope.indexPattern);const columns=getDefaultColumns();const defaultState={query:query,sort:!sort.length?Object(get_default_sort["a"])($scope.indexPattern,config.get(common["k"],"desc")):sort,columns:columns,index:$scope.indexPattern.id,interval:"auto",filters:external_kbnSharedDeps_Lodash_default.a.cloneDeep(persistentSearchSource.getOwnField("filter"))};if(savedSearch.grid){defaultState.grid=savedSearch.grid}if(savedSearch.hideChart){defaultState.hideChart=savedSearch.hideChart}return defaultState}$scope.state.index=$scope.indexPattern.id;$scope.state.sort=Object(doc_table["b"])($scope.state.sort,$scope.indexPattern);const shouldSearchOnPageLoad=()=>config.get(common["j"])||savedSearch.id!==undefined||timefilter.getRefreshInterval().pause===false||searchSessionManager.hasSearchSessionIdInURL();const init=external_kbnSharedDeps_Lodash_default.a.once(()=>{$scope.updateDataSource().then(async()=>{const fetch$=Object(external_kbnSharedDeps_Rxjs_["merge"])(refetch$,discover_filterManager.getFetches$(),timefilter.getFetch$(),timefilter.getAutoRefreshFetch$(),discover_data.query.queryString.getUpdates$(),searchSessionManager.newSearchSessionIdFromURL$).pipe(Object(external_kbnSharedDeps_RxjsOperators_["debounceTime"])(100));subscriptions.add(Object(kibana_services["s"])($scope,fetch$,{next:$scope.fetch},error=>Object(kibanaLegacy_public_["addFatalError"])(core.fatalErrors,error)));subscriptions.add(Object(kibana_services["s"])($scope,timefilter.getTimeUpdate$(),{next:()=>{$scope.updateTime()}},error=>Object(kibanaLegacy_public_["addFatalError"])(core.fatalErrors,error)));$scope.$watchMulti(["rows","fetchStatus"],function updateResultState(){let prev={};const status={UNINITIALIZED:"uninitialized",LOADING:"loading",READY:"ready",NO_RESULTS:"none"};function pick(rows,oldRows,fetchStatus){if(!$scope.fetchError&&rows==null&&oldRows==null&&shouldSearchOnPageLoad()){return status.LOADING}if(fetchStatus===fetchStatuses.UNINITIALIZED){return status.UNINITIALIZED}const rowsEmpty=external_kbnSharedDeps_Lodash_default.a.isEmpty(rows);if(rowsEmpty&&fetchStatus===fetchStatuses.LOADING)return status.LOADING;else if(!rowsEmpty)return status.READY;else return status.NO_RESULTS}return function(){const current={rows:$scope.rows,fetchStatus:$scope.fetchStatus};$scope.resultState=pick(current.rows,prev.rows,current.fetchStatus,prev.fetchStatus);prev=current}}());if(getTimeField()){setupVisualization();$scope.updateTime()}init.complete=true;if(shouldSearchOnPageLoad()){refetch$.next()}})});$scope.opts.fetch=$scope.fetch=function(){if(!init.complete)return;$scope.fetchCounter++;$scope.fetchError=undefined;$scope.minimumVisibleRows=50;if(!validateTimeRange(timefilter.getTime(),discover_toastNotifications)){$scope.resultState="none";return}if(abortController)abortController.abort();abortController=new AbortController;const searchSessionId=searchSessionManager.getNextSearchSessionId();$scope.updateDataSource().then(setupVisualization).then((function(){$scope.fetchStatus=fetchStatuses.LOADING;logInspectorRequest({searchSessionId:searchSessionId});return $scope.volatileSearchSource.fetch({abortSignal:abortController.signal,sessionId:searchSessionId})})).then(onResults).catch(error=>{if(error instanceof Error&&error.name==="AbortError")return;$scope.fetchStatus=fetchStatuses.NO_RESULTS;$scope.fetchError=error;discover_data.search.showError(error)})};function getDimensions(aggs,timeRange){const[metric,agg]=aggs;agg.params.timeRange=timeRange;const bounds=agg.params.timeRange?timefilter.calculateBounds(agg.params.timeRange):null;agg.buckets.setBounds(bounds);const{esUnit:esUnit,esValue:esValue}=agg.buckets.getInterval();return{x:{accessor:0,label:agg.makeLabel(),format:agg.toSerializedFieldFormat(),params:{date:true,interval:external_kbnSharedDeps_Moment_default.a.duration(esValue,esUnit),intervalESValue:esValue,intervalESUnit:esUnit,format:agg.buckets.getScaledDateFormat(),bounds:agg.buckets.getBounds()}},y:{accessor:1,format:metric.toSerializedFieldFormat(),label:metric.makeLabel()}}}function onResults(resp){inspectorRequest.stats(Object(kibana_services["f"])(resp,$scope.volatileSearchSource)).ok({json:resp});if(getTimeField()&&!$scope.state.hideChart){const tabifiedData=Object(kibana_services["u"])($scope.opts.chartAggConfigs,resp);$scope.volatileSearchSource.rawResponse=resp;$scope.histogramData=discoverResponseHandler(tabifiedData,getDimensions($scope.opts.chartAggConfigs.aggs,$scope.timeRange));$scope.updateTime()}$scope.hits=resp.hits.total;$scope.rows=resp.hits.hits;$scope.fieldCounts=calcFieldCounts($scope.fieldCounts||{},resp.hits.hits,$scope.indexPattern);$scope.fetchStatus=fetchStatuses.COMPLETE}function logInspectorRequest({searchSessionId:searchSessionId=null}={searchSessionId:null}){inspectorAdapters.requests.reset();const title=external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.inspectorRequestDataTitle",{defaultMessage:"data"});const description=external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.inspectorRequestDescription",{defaultMessage:"This request queries Elasticsearch to fetch the data for the search."});inspectorRequest=inspectorAdapters.requests.start(title,{description:description,searchSessionId:searchSessionId});inspectorRequest.stats(Object(kibana_services["e"])($scope.volatileSearchSource));$scope.volatileSearchSource.getSearchRequestBody().then(body=>{inspectorRequest.json(body)})}$scope.updateTime=function(){const{from:from,to:to}=timefilter.getTime();$scope.timeRange={from:elastic_datemath_default.a.parse(from),to:elastic_datemath_default.a.parse(to,{roundUp:true})}};$scope.resetQuery=function(){history.push($route.current.params.id?`/view/${encodeURIComponent($route.current.params.id)}`:"/");$route.reload()};$scope.onSkipBottomButtonClick=async()=>{$scope.minimumVisibleRows=$scope.hits;const bottomMarker=document.getElementById("discoverBottomMarker");const wait=ms=>new Promise(resolve=>setTimeout(resolve,ms));while($scope.rows.length!==document.getElementsByClassName("kbnDocTable__row").length){await wait(50)}bottomMarker.focus();await wait(50);bottomMarker.blur()};$scope.newQuery=function(){history.push("/")};const showUnmappedFields=$scope.useNewFieldsApi;$scope.unmappedFieldsConfig={showUnmappedFields:showUnmappedFields};$scope.updateDataSource=()=>{const{indexPattern:indexPattern,useNewFieldsApi:useNewFieldsApi}=$scope;const{columns:columns,sort:sort}=$scope.state;Object(update_search_source["a"])({persistentSearchSource:persistentSearchSource,volatileSearchSource:$scope.volatileSearchSource,indexPattern:indexPattern,services:services,sort:sort,columns:columns,useNewFieldsApi:useNewFieldsApi,showUnmappedFields:showUnmappedFields});return Promise.resolve()};async function setupVisualization(){if(!getTimeField()||$scope.state.hideChart)return;const{interval:histogramInterval}=$scope.state;const visStateAggs=[{type:"count",schema:"metric"},{type:"date_histogram",schema:"segment",params:{field:getTimeField(),interval:histogramInterval,timeRange:timefilter.getTime()}}];$scope.opts.chartAggConfigs=discover_data.search.aggs.createAggConfigs($scope.indexPattern,visStateAggs);$scope.volatileSearchSource.onRequestStart((searchSource,options)=>{if(!$scope.opts.chartAggConfigs)return;return $scope.opts.chartAggConfigs.onSearchRequestStart(searchSource,options)});$scope.volatileSearchSource.setField("aggs",(function(){if(!$scope.opts.chartAggConfigs)return;return $scope.opts.chartAggConfigs.toDsl()}))}addHelpMenuToAppChrome(discover_chrome);init();replaceUrlAppState().then(()=>startStateSync())}var doc='<div class="app-container">\n    <discover-doc\n      id="id"\n      index="index"\n      index-pattern-id="indexPatternId"\n      index-pattern-service="indexPatternService"\n    ></discover-doc>\n</div>\n';var external_kbnSharedDeps_React_=__webpack_require__(0);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(6);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(2);let ElasticRequestState;(function(ElasticRequestState){ElasticRequestState[ElasticRequestState["Loading"]=0]="Loading";ElasticRequestState[ElasticRequestState["NotFound"]=1]="NotFound";ElasticRequestState[ElasticRequestState["Found"]=2]="Found";ElasticRequestState[ElasticRequestState["Error"]=3]="Error";ElasticRequestState[ElasticRequestState["NotFoundIndexPattern"]=4]="NotFoundIndexPattern"})(ElasticRequestState||(ElasticRequestState={}));function buildSearchBody(id,indexPattern,useNewFieldsApi){const computedFields=indexPattern.getComputedFields();return{query:{ids:{values:[id]}},stored_fields:computedFields.storedFields,_source:!useNewFieldsApi,fields:useNewFieldsApi?[{field:"*",include_unmapped:"true"}]:undefined,script_fields:computedFields.scriptFields,docvalue_fields:computedFields.docvalueFields}}function useEsDocSearch({id:id,index:index,indexPatternId:indexPatternId,indexPatternService:indexPatternService}){const[indexPattern,setIndexPattern]=Object(external_kbnSharedDeps_React_["useState"])(null);const[status,setStatus]=Object(external_kbnSharedDeps_React_["useState"])(ElasticRequestState.Loading);const[hit,setHit]=Object(external_kbnSharedDeps_React_["useState"])(null);const{data:data,uiSettings:uiSettings}=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(kibana_services["h"])(),[]);const useNewFieldsApi=Object(external_kbnSharedDeps_React_["useMemo"])(()=>!uiSettings.get(common["i"]),[uiSettings]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{async function requestData(){try{var _hits$hits;const indexPatternEntity=await indexPatternService.get(indexPatternId);setIndexPattern(indexPatternEntity);const{rawResponse:rawResponse}=await data.search.search({params:{index:index,body:buildSearchBody(id,indexPatternEntity,useNewFieldsApi)}}).toPromise();const hits=rawResponse.hits;if(hits!==null&&hits!==void 0&&(_hits$hits=hits.hits)!==null&&_hits$hits!==void 0&&_hits$hits[0]){setStatus(ElasticRequestState.Found);setHit(hits.hits[0])}else{setStatus(ElasticRequestState.NotFound)}}catch(err){if(err.savedObjectId){setStatus(ElasticRequestState.NotFoundIndexPattern)}else if(err.status===404){setStatus(ElasticRequestState.NotFound)}else{setStatus(ElasticRequestState.Error)}}}requestData()},[id,index,indexPatternId,indexPatternService,data.search,useNewFieldsApi]);return[status,hit,indexPattern]}var doc_viewer=__webpack_require__(82);function Doc(props){const[reqState,hit,indexPattern]=useEsDocSearch(props);const indexExistsLink=Object(kibana_services["h"])().docLinks.links.apis.indexExists;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["I18nProvider"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPage"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContent"],null,reqState===ElasticRequestState.NotFoundIndexPattern&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{color:"danger","data-test-subj":`doc-msg-notFoundIndexPattern`,iconType:"alert",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"discover.doc.failedToLocateIndexPattern",defaultMessage:"No index pattern matches ID {indexPatternId}.",values:{indexPatternId:props.indexPatternId}})}),reqState===ElasticRequestState.NotFound&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{color:"danger","data-test-subj":`doc-msg-notFound`,iconType:"alert",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"discover.doc.failedToLocateDocumentDescription",defaultMessage:"Cannot find document"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"discover.doc.couldNotFindDocumentsDescription",defaultMessage:"No documents match that ID."})),reqState===ElasticRequestState.Error&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{color:"danger","data-test-subj":`doc-msg-error`,iconType:"alert",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"discover.doc.failedToExecuteQueryDescription",defaultMessage:"Cannot run search"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"discover.doc.somethingWentWrongDescription",defaultMessage:"{indexName} is missing.",values:{indexName:props.index}})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:indexExistsLink,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"discover.doc.somethingWentWrongDescriptionAddon",defaultMessage:"Please ensure the index exists."}))),reqState===ElasticRequestState.Loading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{"data-test-subj":`doc-msg-loading`},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"discover.doc.loadingDescription",defaultMessage:"Loadingâ€¦"})),reqState===ElasticRequestState.Found&&hit!==null&&indexPattern&&external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"doc-hit"},external_kbnSharedDeps_React_default.a.createElement(doc_viewer["a"],{hit:hit,indexPattern:indexPattern})))))}const{timefilter:doc_timefilter}=Object(kibana_services["h"])();const doc_app=Object(kibana_services["a"])();doc_app.directive("discoverDoc",(function(reactDirective){return reactDirective(Doc,[["id",{watchDepth:"value"}],["index",{watchDepth:"value"}],["indexPatternId",{watchDepth:"reference"}],["indexPatternService",{watchDepth:"reference"}]],{restrict:"E"})}));doc_app.config($routeProvider=>{$routeProvider.when("/doc/:indexPattern/:index/:type",{redirectTo:"/doc/:indexPattern/:index"}).when("/doc/:indexPattern/:index",{controller:function($scope,$route){doc_timefilter.disableAutoRefreshSelector();doc_timefilter.disableTimeRangeSelector();$scope.id=$route.current.params.id;$scope.index=$route.current.params.index;$scope.indexPatternId=$route.current.params.indexPattern;$scope.indexPatternService=Object(kibana_services["h"])().indexPatterns},template:doc,k7Breadcrumbs:$route=>[...Object(breadcrumbs["a"])(),{text:`${$route.current.params.index}#${$route.current.params.id}`}]})});var context_app='\x3c!-- Context App Legacy --\x3e\n<context-app-legacy\n  filter="contextApp.actions.addFilter"\n  hits="contextApp.state.rows.all"\n  index-pattern="contextApp.indexPattern"\n  sorting="contextApp.state.queryParameters.sort"\n  columns="contextApp.state.queryParameters.columns"\n  minimum-visible-rows="contextApp.state.rows.all.length"\n  status="contextApp.state.loadingStatus.anchor.status"\n  reason="contextApp.state.loadingStatus.anchor.reason"\n  default-step-size="contextApp.state.queryParameters.defaultStepSize"\n  predecessor-count="contextApp.state.queryParameters.predecessorCount"\n  predecessor-available="contextApp.state.rows.predecessors.length"\n  predecessor-status="contextApp.state.loadingStatus.predecessors.status"\n  on-change-predecessor-count="contextApp.actions.fetchGivenPredecessorRows"\n  successor-count="contextApp.state.queryParameters.successorCount"\n  successor-available="contextApp.state.rows.successors.length"\n  successor-status="contextApp.state.loadingStatus.successors.status"\n  on-change-successor-count="contextApp.actions.fetchGivenSuccessorRows"\n  use-new-fields-api="contextApp.state.useNewFieldsApi"\n  top-nav-menu="contextApp.topNavMenu"\n></context-app-legacy>\n';var action_bar=__webpack_require__(91);Object(kibana_services["a"])().directive("contextActionBar",(function(reactDirective){return reactDirective(action_bar["a"])}));var sorting=__webpack_require__(84);var query_parameters=__webpack_require__(92);var context_query=__webpack_require__(89);function callAfterBindingsWorkaround(constructor){return function InitAfterBindingsWrapper($injector,$attrs,$element,$scope,$transclude){this.$onInit=()=>{$injector.invoke(constructor,this,{$attrs:$attrs,$element:$element,$scope:$scope,$transclude:$transclude})}}}Object(kibana_services["a"])().directive("contextApp",(function ContextApp(){return{bindToController:true,controller:callAfterBindingsWorkaround(ContextAppController),controllerAs:"contextApp",restrict:"E",scope:{anchorId:"=",columns:"=",indexPattern:"=",filters:"=",predecessorCount:"=",successorCount:"=",sort:"="},template:context_app}}));function ContextAppController($scope,Private){const{filterManager:filterManager,indexPatterns:indexPatterns,uiSettings:uiSettings,navigation:navigation}=Object(kibana_services["h"])();const useNewFieldsApi=!uiSettings.get(common["i"]);const queryParameterActions=Object(query_parameters["c"])(filterManager,indexPatterns);const queryActions=Private(context_query["c"]);this.state=createInitialState(parseInt(uiSettings.get(common["b"]),10),Object(sorting["a"])(this.indexPattern,uiSettings.get(common["c"])),useNewFieldsApi);this.state.useNewFieldsApi=useNewFieldsApi;this.topNavMenu=navigation.ui.TopNavMenu;this.actions=external_kbnSharedDeps_Lodash_default.a.mapValues({...queryParameterActions,...queryActions},action=>(...args)=>action(this.state)(...args));this.constants={FAILURE_REASONS:context_query["a"],LOADING_STATUS:context_query["b"]};$scope.$watchGroup([()=>this.state.rows.predecessors,()=>this.state.rows.anchor,()=>this.state.rows.successors],newValues=>this.actions.setAllRows(...newValues));$scope.$watchCollection(()=>({...external_kbnSharedDeps_Lodash_default.a.pick(this,query_parameters["a"]),indexPatternId:this.indexPattern.id}),newQueryParameters=>{const{queryParameters:queryParameters}=this.state;if(newQueryParameters.indexPatternId!==queryParameters.indexPatternId||newQueryParameters.anchorId!==queryParameters.anchorId||!external_kbnSharedDeps_Lodash_default.a.isEqual(newQueryParameters.sort,queryParameters.sort)){this.actions.fetchAllRowsWithNewQueryParameters(external_kbnSharedDeps_Lodash_default.a.cloneDeep(newQueryParameters))}else if(newQueryParameters.predecessorCount!==queryParameters.predecessorCount||newQueryParameters.successorCount!==queryParameters.successorCount||!external_kbnSharedDeps_Lodash_default.a.isEqual(newQueryParameters.filters,queryParameters.filters)){this.actions.fetchContextRowsWithNewQueryParameters(external_kbnSharedDeps_Lodash_default.a.cloneDeep(newQueryParameters))}});$scope.$watchCollection(()=>({predecessorCount:this.state.queryParameters.predecessorCount,successorCount:this.state.queryParameters.successorCount}),newParameters=>{external_kbnSharedDeps_Lodash_default.a.assign(this,newParameters)})}function createInitialState(defaultStepSize,tieBreakerField,useNewFieldsApi){return{queryParameters:Object(query_parameters["b"])(defaultStepSize,tieBreakerField),rows:{all:[],anchor:null,predecessors:[],successors:[]},loadingStatus:Object(context_query["d"])(),useNewFieldsApi:useNewFieldsApi}}const GLOBAL_STATE_URL_KEY="_g";const context_state_APP_STATE_URL_KEY="_a";function context_state_getState({defaultStepSize:defaultStepSize,timeFieldName:timeFieldName,storeInSessionStorage:storeInSessionStorage=false,history:history,toasts:toasts,uiSettings:uiSettings}){const stateStorage=Object(public_["createKbnUrlStateStorage"])({useHash:storeInSessionStorage,history:history,...toasts&&Object(public_["withNotifyOnErrors"])(toasts)});const globalStateInitial=stateStorage.get(GLOBAL_STATE_URL_KEY);const globalStateContainer=Object(public_["createStateContainer"])(globalStateInitial);const appStateFromUrl=stateStorage.get(context_state_APP_STATE_URL_KEY);const appStateInitial=createInitialAppState(defaultStepSize,timeFieldName,appStateFromUrl,uiSettings);const appStateContainer=Object(public_["createStateContainer"])(appStateInitial);const{start:start,stop:stop}=Object(public_["syncStates"])([{storageKey:GLOBAL_STATE_URL_KEY,stateContainer:{...globalStateContainer,...{set:value=>{if(value){globalStateContainer.set(value)}}}},stateStorage:stateStorage},{storageKey:context_state_APP_STATE_URL_KEY,stateContainer:{...appStateContainer,...{set:value=>{if(value){appStateContainer.set(value)}}}},stateStorage:stateStorage}]);return{globalState:globalStateContainer,appState:appStateContainer,startSync:start,stopSync:stop,setAppState:newState=>{const oldState=appStateContainer.getState();const mergedState={...oldState,...newState};if(!context_state_isEqualState(oldState,mergedState)){appStateContainer.set(mergedState)}},getFilters:()=>[...context_state_getFilters(globalStateContainer.getState()),...context_state_getFilters(appStateContainer.getState())],setFilters:filterManager=>{const globalFilters=filterManager.getGlobalFilters();const globalFilterChanged=!context_state_isEqualFilters(globalFilters,context_state_getFilters(globalStateContainer.getState()));if(globalFilterChanged){globalStateContainer.set({filters:globalFilters})}const appFilters=filterManager.getAppFilters();const appFilterChanged=!context_state_isEqualFilters(appFilters,context_state_getFilters(appStateContainer.getState()));if(appFilterChanged){appStateContainer.set({...appStateContainer.getState(),...{filters:appFilters}})}},flushToUrl:replace=>stateStorage.kbnUrlControls.flush(replace)}}function context_state_isEqualFilters(filtersA,filtersB){if(!filtersA&&!filtersB){return true}else if(!filtersA||!filtersB){return false}return data_public_["esFilters"].compareFilters(filtersA,filtersB,data_public_["esFilters"].COMPARE_ALL_OPTIONS)}function context_state_isEqualState(stateA,stateB){if(!stateA&&!stateB){return true}else if(!stateA||!stateB){return false}const{filters:stateAFilters=[],...stateAPartial}=stateA;const{filters:stateBFilters=[],...stateBPartial}=stateB;return external_kbnSharedDeps_Lodash_default.a.isEqual(stateAPartial,stateBPartial)&&data_public_["esFilters"].compareFilters(stateAFilters,stateBFilters,data_public_["esFilters"].COMPARE_ALL_OPTIONS)}function context_state_getFilters(state){if(!state||!Array.isArray(state.filters)){return[]}return state.filters}function createInitialAppState(defaultSize,timeFieldName,urlState,uiSettings){const defaultState={columns:["_source"],filters:[],predecessorCount:parseInt(defaultSize,10),sort:[timeFieldName,"desc"],successorCount:parseInt(defaultSize,10)};if(typeof urlState!=="object"){return defaultState}return Object(helpers["d"])({...defaultState,...urlState},uiSettings)}var context='<context-app\n  anchor-id="contextAppRoute.anchorId"\n  columns="contextAppRoute.state.columns"\n  index-pattern="contextAppRoute.indexPattern"\n  filters="contextAppRoute.filters"\n  predecessor-count="contextAppRoute.state.predecessorCount"\n  successor-count="contextAppRoute.state.successorCount"\n  sort="contextAppRoute.state.sort"\n></context-app>\n';const k7Breadcrumbs=$route=>{const{indexPattern:indexPattern}=$route.current.locals;const{id:id}=$route.current.params;return[...Object(breadcrumbs["a"])(),{text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("discover.context.breadcrumb",{defaultMessage:"Context of {indexPatternTitle}#{docId}",values:{indexPatternTitle:indexPattern.title,docId:id}})}]};Object(kibana_services["a"])().config($routeProvider=>{$routeProvider.when("/context/:indexPatternId/:id*",{controller:ContextAppRouteController,k7Breadcrumbs:k7Breadcrumbs,controllerAs:"contextAppRoute",resolve:{indexPattern:($route,Promise)=>{const indexPattern=Object(kibana_services["h"])().indexPatterns.get($route.current.params.indexPatternId);return Promise.props({ip:indexPattern})}},template:context})});function ContextAppRouteController($routeParams,$scope,$route){const filterManager=Object(kibana_services["h"])().filterManager;const indexPattern=$route.current.locals.indexPattern.ip;const{startSync:startStateSync,stopSync:stopStateSync,appState:appState,getFilters:getFilters,setFilters:setFilters,setAppState:setAppState,flushToUrl:flushToUrl}=context_state_getState({defaultStepSize:Object(kibana_services["h"])().uiSettings.get(common["a"]),timeFieldName:indexPattern.timeFieldName,storeInSessionStorage:Object(kibana_services["h"])().uiSettings.get("state:storeInSessionStorage"),history:Object(kibana_services["h"])().history(),toasts:Object(kibana_services["h"])().core.notifications.toasts,uiSettings:Object(kibana_services["h"])().core.uiSettings});this.state={...appState.getState()};this.anchorId=$routeParams.id;this.indexPattern=indexPattern;filterManager.setFilters(external_kbnSharedDeps_Lodash_default.a.cloneDeep(getFilters()));startStateSync();$scope.$watchGroup(["contextAppRoute.state.columns","contextAppRoute.state.predecessorCount","contextAppRoute.state.successorCount"],newValues=>{const[columns,predecessorCount,successorCount]=newValues;if(Array.isArray(columns)&&predecessorCount>=0&&successorCount>=0){setAppState({columns:columns,predecessorCount:predecessorCount,successorCount:successorCount});flushToUrl(true)}});const filterObservable=filterManager.getUpdates$().subscribe(()=>{setFilters(filterManager);$route.reload()});$scope.$on("$destroy",()=>{stopStateSync();filterObservable.unsubscribe()})}var angular_doc_viewer=__webpack_require__(86);Object(kibana_services["a"])().config($routeProvider=>{$routeProvider.otherwise({resolveRedirectTo:$rootScope=>{const path=window.location.hash.substr(1);Object(kibana_services["j"])().restorePreviousUrl();$rootScope.$applyAsync(()=>{const{urlForwarding:urlForwarding}=Object(kibana_services["h"])();const{navigated:navigated}=urlForwarding.navigateToLegacyKibanaUrl(path);if(!navigated){urlForwarding.navigateToDefaultApp()}});return new Promise(()=>{})}})});var directives=__webpack_require__(90)},88:function(module,exports,__webpack_require__){const moment=__webpack_require__(49);const unitsMap={ms:{weight:1,type:"fixed",base:1},s:{weight:2,type:"fixed",base:1e3},m:{weight:3,type:"mixed",base:1e3*60},h:{weight:4,type:"mixed",base:1e3*60*60},d:{weight:5,type:"mixed",base:1e3*60*60*24},w:{weight:6,type:"calendar",base:NaN},M:{weight:7,type:"calendar",base:NaN},y:{weight:9,type:"calendar",base:NaN}};const units=Object.keys(unitsMap).sort((a,b)=>unitsMap[b].weight-unitsMap[a].weight);const unitsDesc=[...units];const unitsAsc=[...units].reverse();const isDate=d=>Object.prototype.toString.call(d)==="[object Date]";const isValidDate=d=>isDate(d)&&!isNaN(d.valueOf());function parse(text,{roundUp:roundUp=false,momentInstance:momentInstance=moment,forceNow:forceNow}={}){if(!text)return undefined;if(momentInstance.isMoment(text))return text;if(isDate(text))return momentInstance(text);if(forceNow!==undefined&&!isValidDate(forceNow)){throw new Error("forceNow must be a valid Date")}let time;let mathString="";let index;let parseString;if(text.substring(0,3)==="now"){time=momentInstance(forceNow);mathString=text.substring("now".length)}else{index=text.indexOf("||");if(index===-1){parseString=text;mathString=""}else{parseString=text.substring(0,index);mathString=text.substring(index+2)}time=momentInstance(parseString)}if(!mathString.length){return time}return parseDateMath(mathString,time,roundUp)}function parseDateMath(mathString,time,roundUp){const dateTime=time;const len=mathString.length;let i=0;while(i<len){const c=mathString.charAt(i++);let type;let num;let unit;if(c==="/"){type=0}else if(c==="+"){type=1}else if(c==="-"){type=2}else{return}if(isNaN(mathString.charAt(i))){num=1}else if(mathString.length===2){num=mathString.charAt(i)}else{const numFrom=i;while(!isNaN(mathString.charAt(i))){i++;if(i>=len)return}num=parseInt(mathString.substring(numFrom,i),10)}if(type===0){if(num!==1){return}}unit=mathString.charAt(i++);for(let j=i;j<len;j++){const unitChar=mathString.charAt(i);if(/[a-z]/i.test(unitChar)){unit+=unitChar;i++}else{break}}if(units.indexOf(unit)===-1){return}else{if(type===0){if(roundUp)dateTime.endOf(unit);else dateTime.startOf(unit)}else if(type===1){dateTime.add(num,unit)}else if(type===2){dateTime.subtract(num,unit)}}}return dateTime}module.exports={parse:parse,unitsMap:Object.freeze(unitsMap),units:Object.freeze(units),unitsAsc:Object.freeze(unitsAsc),unitsDesc:Object.freeze(unitsDesc)}}}]);