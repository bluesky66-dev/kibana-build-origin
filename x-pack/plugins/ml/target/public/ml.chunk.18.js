/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window["ml_bundle_jsonpfunction"]=window["ml_bundle_jsonpfunction"]||[]).push([[18],{839:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"OverviewPage",(function(){return OverviewPage}));var external_kbnSharedDeps_React_=__webpack_require__(10);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(33);var check_capabilities=__webpack_require__(63);var check_ml_nodes=__webpack_require__(80);var navigation_menu=__webpack_require__(94);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(34);var kibana=__webpack_require__(58);const feedbackLink="https://www.elastic.co/community/";const OverviewSideBar=({createAnomalyDetectionJobDisabled:createAnomalyDetectionJobDisabled})=>{const{services:{docLinks:docLinks,http:{basePath:basePath}}}=Object(kibana["b"])();const docsLink=docLinks.links.ml.guide;const transformsLink=`${basePath.get()}/app/management/data/transform`;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.ml.overview.gettingStartedSectionTitle",defaultMessage:"Getting started"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{className:"mlOverview__sidebar"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.ml.overview.gettingStartedSectionText",defaultMessage:"Welcome to Machine Learning. Get started by reviewing our {docs} or creating a new job. We recommend using {transforms} to create feature indices for analytics jobs.",values:{docs:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:docsLink,target:"blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.ml.overview.gettingStartedSectionDocs",defaultMessage:"documentation"})),transforms:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:transformsLink,target:"blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.ml.overview.gettingStartedSectionTransforms",defaultMessage:"Elasticsearch's transforms"}))}})),external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.ml.overview.feedbackSectionTitle",defaultMessage:"Feedback"})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.ml.overview.feedbackSectionText",defaultMessage:"If you have input or suggestions regarding your experience, please submit {feedbackLink}.",values:{feedbackLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:feedbackLink,target:"blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.ml.overview.feedbackSectionLink",defaultMessage:"feedback online"}))}}))))};var external_kbnSharedDeps_KbnI18n_=__webpack_require__(2);var external_kbnSharedDeps_Moment_=__webpack_require__(12);var external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_);var date_utils=__webpack_require__(67);var use_create_ad_links=__webpack_require__(228);const ExplorerLink=({jobsList:jobsList})=>{const openJobsInAnomalyExplorerText=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.anomalyDetection.resultActions.openJobsInAnomalyExplorerText",{defaultMessage:"Open {jobsCount, plural, one {{jobId}} other {# jobs}} in Anomaly Explorer",values:{jobsCount:jobsList.length,jobId:jobsList[0]&&jobsList[0].id}});const{createLinkWithUserDefaults:createLinkWithUserDefaults}=Object(use_create_ad_links["a"])();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"bottom",content:openJobsInAnomalyExplorerText},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{href:createLinkWithUserDefaults("explorer",jobsList),color:"text",size:"xs",iconType:"visTable","aria-label":openJobsInAnomalyExplorerText,className:"results-button","data-test-subj":`openOverviewJobsInAnomalyExplorer`},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.anomalyDetection.viewActionName",{defaultMessage:"View"})))};var states=__webpack_require__(101);function getGroupsFromJobs(jobs){const groups={ungrouped:{id:"ungrouped",jobIds:[],docs_processed:0,latest_timestamp:0,max_anomaly_score:null,jobs_in_group:0}};jobs.forEach(job=>{if(job.groups.length>0){job.groups.forEach(g=>{if(groups[g]===undefined){groups[g]={id:g,jobIds:[job.id],docs_processed:job.processed_record_count,latest_timestamp:job.latestTimestampMs,max_anomaly_score:null,jobs_in_group:1}}else{groups[g].jobIds.push(job.id);groups[g].docs_processed+=job.processed_record_count;groups[g].jobs_in_group++;if(groups[g].latest_timestamp===undefined){groups[g].latest_timestamp=job.latestTimestampMs}else if(job.latestTimestampMs&&job.latestTimestampMs>groups[g].latest_timestamp){groups[g].latest_timestamp=job.latestTimestampMs}}})}else{groups.ungrouped.jobIds.push(job.id);groups.ungrouped.docs_processed+=job.processed_record_count;groups.ungrouped.jobs_in_group++;if(job.latestTimestampMs&&job.latestTimestampMs>groups.ungrouped.latest_timestamp){groups.ungrouped.latest_timestamp=job.latestTimestampMs}}});if(groups.ungrouped.jobIds.length===0){delete groups.ungrouped}const count=Object.values(groups).length;return{groups:groups,count:count}}function getStatsBarData(jobsList){const jobStats={activeNodes:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overviewJobsList.statsBar.activeMLNodesLabel",{defaultMessage:"Active ML nodes"}),value:0,show:true},total:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overviewJobsList.statsBar.totalJobsLabel",{defaultMessage:"Total jobs"}),value:0,show:true},open:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overviewJobsList.statsBar.openJobsLabel",{defaultMessage:"Open jobs"}),value:0,show:true},closed:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overviewJobsList.statsBar.closedJobsLabel",{defaultMessage:"Closed jobs"}),value:0,show:true},failed:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overviewJobsList.statsBar.failedJobsLabel",{defaultMessage:"Failed jobs"}),value:0,show:false},activeDatafeeds:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.jobsList.statsBar.activeDatafeedsLabel",{defaultMessage:"Active datafeeds"}),value:0,show:true}};if(jobsList===undefined){return jobStats}const mlNodes={};let failedJobs=0;jobsList.forEach(job=>{if(job.jobState===states["c"].OPENED){jobStats.open.value++}else if(job.jobState===states["c"].CLOSED){jobStats.closed.value++}else if(job.jobState===states["c"].FAILED){failedJobs++}if(job.hasDatafeed&&job.datafeedState===states["a"].STARTED){jobStats.activeDatafeeds.value++}if(job.nodeName!==undefined){mlNodes[job.nodeName]={}}});jobStats.total.value=jobsList.length;if(failedJobs){jobStats.failed.value=failedJobs;jobStats.failed.show=true}else{jobStats.failed.show=false}jobStats.activeNodes.value=Object.keys(mlNodes).length;return jobStats}function getJobsFromGroup(group,jobs){return group.jobIds.map(jobId=>jobs[jobId]).filter(id=>id!==undefined)}function getJobsWithTimerange(jobsList){const jobs={};jobsList.forEach(job=>{if(jobs[job.id]===undefined){if(job.earliestTimestampMs!==undefined){const{earliestTimestampMs:earliestTimestampMs,latestResultsTimestampMs:latestResultsTimestampMs}=job;jobs[job.id]={id:job.id,earliestTimestampMs:earliestTimestampMs,latestResultsTimestampMs:latestResultsTimestampMs}}}});return jobs}var stats_bar=__webpack_require__(173);var job_selector_badge=__webpack_require__(214);var string_utils=__webpack_require__(84);var anomaly_utils=__webpack_require__(6);let AnomalyDetectionListColumns;(function(AnomalyDetectionListColumns){AnomalyDetectionListColumns["id"]="id";AnomalyDetectionListColumns["maxAnomalyScore"]="max_anomaly_score";AnomalyDetectionListColumns["jobIds"]="jobIds";AnomalyDetectionListColumns["latestTimestamp"]="latest_timestamp";AnomalyDetectionListColumns["docsProcessed"]="docs_processed";AnomalyDetectionListColumns["jobsInGroup"]="jobs_in_group"})(AnomalyDetectionListColumns||(AnomalyDetectionListColumns={}));const AnomalyDetectionTable=({items:items,jobsList:jobsList,statsBarData:statsBarData})=>{const groupsList=Object.values(items);const[pageIndex,setPageIndex]=Object(external_kbnSharedDeps_React_["useState"])(0);const[pageSize,setPageSize]=Object(external_kbnSharedDeps_React_["useState"])(10);const[sortField,setSortField]=Object(external_kbnSharedDeps_React_["useState"])(AnomalyDetectionListColumns.id);const[sortDirection,setSortDirection]=Object(external_kbnSharedDeps_React_["useState"])("asc");const columns=[{field:AnomalyDetectionListColumns.id,name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.anomalyDetection.tableId",{defaultMessage:"Group ID"}),render:id=>external_kbnSharedDeps_React_default.a.createElement(job_selector_badge["a"],{id:id,isGroup:id!=="ungrouped"}),sortable:true,truncateText:true,width:"20%"},{field:AnomalyDetectionListColumns.maxAnomalyScore,name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.anomalyDetection.tableMaxScoreTooltip",{defaultMessage:"Maximum score across all jobs in the group over its most recent 24 hour period"})},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.anomalyDetection.tableMaxScore",{defaultMessage:"Max anomaly score"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),sortable:true,render:score=>{if(score===undefined){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],null)}else if(score===null){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.anomalyDetection.tableMaxScoreErrorTooltip",{defaultMessage:"There was a problem loading the maximum anomaly score"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"alert"}))}else if(score===0){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:"transparent",compressed:"true"},score)}else{const color=Object(anomaly_utils["i"])(score);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:color,compressed:"true"},Object(anomaly_utils["f"])(score))}},truncateText:true,width:"150px"},{field:AnomalyDetectionListColumns.jobsInGroup,name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.anomalyDetection.tableNumJobs",{defaultMessage:"Jobs in group"}),sortable:true,truncateText:true,width:"100px"},{field:AnomalyDetectionListColumns.latestTimestamp,name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.anomalyDetection.tableLatestTimestamp",{defaultMessage:"Latest timestamp"}),dataType:"date",render:time=>Object(date_utils["c"])(time),textOnly:true,truncateText:true,sortable:true,width:"20%"},{field:AnomalyDetectionListColumns.docsProcessed,name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.anomalyDetection.tableDocsProcessed",{defaultMessage:"Docs processed"}),render:docs=>Object(string_utils["g"])(docs),textOnly:true,sortable:true,width:"20%"},{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.anomalyDetection.tableActionLabel",{defaultMessage:"Actions"}),render:group=>external_kbnSharedDeps_React_default.a.createElement(ExplorerLink,{jobsList:getJobsFromGroup(group,jobsList)}),width:"100px",align:"right"}];const onTableChange=({page:page={index:0,size:10},sort:sort={field:AnomalyDetectionListColumns.id,direction:"asc"}})=>{const{index:index,size:size}=page;setPageIndex(index);setPageSize(size);const{field:field,direction:direction}=sort;setSortField(field);setSortDirection(direction)};const pagination={initialPageIndex:pageIndex,initialPageSize:pageSize,totalItemCount:groupsList.length,pageSizeOptions:[10,20,50],hidePerPageOptions:false};const sorting={sort:{field:sortField,direction:sortDirection}};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.anomalyDetection.panelTitle",{defaultMessage:"Anomaly Detection"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,className:"mlOverviewPanel__statsBar"},external_kbnSharedDeps_React_default.a.createElement(stats_bar["a"],{stats:statsBarData,dataTestSub:"mlOverviewJobStatsBar"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiInMemoryTable"],{allowNeutralSort:false,className:"mlAnomalyDetectionTable",columns:columns,hasActions:false,isExpandable:false,isSelectable:false,items:groupsList,itemId:AnomalyDetectionListColumns.id,onTableChange:onTableChange,pagination:pagination,sorting:sorting,"data-test-subj":"mlOverviewTableAnomalyDetection"}))};var ml_api_service=__webpack_require__(59);var ml_url_generator=__webpack_require__(0);function getDefaultAnomalyScores(groups){const anomalyScores={};groups.forEach(group=>{anomalyScores[group.id]={maxScore:0}});return anomalyScores}const AnomalyDetectionPanel=({jobCreationDisabled:jobCreationDisabled,setLazyJobCount:setLazyJobCount})=>{const{services:{notifications:notifications}}=Object(kibana["b"])();const mlUrlGenerator=Object(kibana["d"])();const navigateToPath=Object(kibana["e"])();const redirectToJobsManagementPage=async()=>{const path=await mlUrlGenerator.createUrl({page:ml_url_generator["b"].ANOMALY_DETECTION_JOBS_MANAGE});await navigateToPath(path,true)};const redirectToCreateJobSelectIndexPage=async()=>{const path=await mlUrlGenerator.createUrl({page:ml_url_generator["b"].ANOMALY_DETECTION_CREATE_JOB_SELECT_INDEX});await navigateToPath(path,true)};const[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_["useState"])(false);const[groups,setGroups]=Object(external_kbnSharedDeps_React_["useState"])({});const[groupsCount,setGroupsCount]=Object(external_kbnSharedDeps_React_["useState"])(0);const[jobsList,setJobsList]=Object(external_kbnSharedDeps_React_["useState"])([]);const[statsBarData,setStatsBarData]=Object(external_kbnSharedDeps_React_["useState"])(undefined);const[errorMessage,setErrorMessage]=Object(external_kbnSharedDeps_React_["useState"])(undefined);const loadJobs=async()=>{setIsLoading(true);let lazyJobCount=0;try{const jobsResult=await ml_api_service["ml"].jobs.jobsSummary([]);const jobsSummaryList=jobsResult.map(job=>{job.latestTimestampSortValue=job.latestTimestampMs||0;if(job.awaitingNodeAssignment){lazyJobCount++}return job});const{groups:jobsGroups,count:count}=getGroupsFromJobs(jobsSummaryList);const jobsWithTimerange=getJobsWithTimerange(jobsSummaryList);const stats=getStatsBarData(jobsSummaryList);setIsLoading(false);setErrorMessage(undefined);setStatsBarData(stats);setGroupsCount(count);setGroups(jobsGroups);setJobsList(jobsWithTimerange);loadMaxAnomalyScores(jobsGroups);setLazyJobCount(lazyJobCount)}catch(e){setErrorMessage(e.message!==undefined?e.message:JSON.stringify(e));setIsLoading(false)}};const loadMaxAnomalyScores=async groupsObject=>{const groupsList=Object.values(groupsObject);const scores=getDefaultAnomalyScores(groupsList);try{const promises=groupsList.filter(group=>group.jobIds.length>0).map((group,i)=>{scores[group.id].index=i;const latestTimestamp=group.latest_timestamp;const startMoment=external_kbnSharedDeps_Moment_default()(latestTimestamp);const twentyFourHoursAgo=startMoment.subtract(24,"hours").valueOf();return ml_api_service["ml"].results.getMaxAnomalyScore(group.jobIds,twentyFourHoursAgo,latestTimestamp)});const results=await Promise.all(promises);const tempGroups={...groupsObject};Object.keys(scores).forEach(groupId=>{const resultsIndex=scores[groupId]&&scores[groupId].index;const{maxScore:maxScore}=resultsIndex!==undefined&&results[resultsIndex];tempGroups[groupId].max_anomaly_score=maxScore});setGroups(tempGroups)}catch(e){const{toasts:toasts}=notifications;toasts.addDanger(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.anomalyDetection.errorWithFetchingAnomalyScoreNotificationErrorMessage",{defaultMessage:"An error occurred fetching anomaly scores: {error}",values:{error:e.message!==undefined?e.message:JSON.stringify(e)}}))}};Object(external_kbnSharedDeps_React_["useEffect"])(()=>{loadJobs()},[]);const onRefresh=()=>{loadJobs()};const errorDisplay=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.anomalyDetection.errorPromptTitle",{defaultMessage:"An error occurred getting the anomaly detection jobs list."}),color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("pre",null,errorMessage)));const panelClass=isLoading?"mlOverviewPanel__isLoading":"mlOverviewPanel";return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],{className:panelClass},typeof errorMessage!=="undefined"&&errorDisplay,isLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{className:"mlOverviewPanel__spinner",size:"xl"}),isLoading===false&&typeof errorMessage==="undefined"&&groupsCount===0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{iconType:"createSingleMetricJob",title:external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.anomalyDetection.createFirstJobMessage",{defaultMessage:"Create your first anomaly detection job"})),body:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.anomalyDetection.emptyPromptText",{defaultMessage:`Anomaly detection enables you to find unusual behavior in time series data. Start automatically spotting the anomalies hiding in your data and resolve issues faster.`}))),actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{color:"primary",onClick:redirectToCreateJobSelectIndexPage,fill:true,iconType:"plusInCircle",isDisabled:jobCreationDisabled,"data-test-subj":"mlOverviewCreateADJobButton"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.anomalyDetection.createJobButtonText",{defaultMessage:"Create job"}))}),isLoading===false&&typeof errorMessage==="undefined"&&groupsCount>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(AnomalyDetectionTable,{items:groups,jobsList:jobsList,statsBarData:statsBarData}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlOverviewPanel__buttons"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{size:"s",onClick:onRefresh,className:"mlOverviewPanel__refreshButton"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.anomalyDetection.refreshJobsButtonText",{defaultMessage:"Refresh"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{size:"s",fill:true,onClick:redirectToJobsManagementPage},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.anomalyDetection.manageJobsButtonText",{defaultMessage:"Manage jobs"})))))};var common_analytics=__webpack_require__(62);var common=__webpack_require__(88);var use_columns=__webpack_require__(260);var get_view_link_status=__webpack_require__(191);const ViewLink=({item:item})=>{const{disabled:disabled,tooltipContent:tooltipContent}=Object(get_view_link_status["a"])(item);const viewJobResultsButtonText=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.analytics.resultActions.openJobText",{defaultMessage:"View job results"});const tooltipText=disabled===false?viewJobResultsButtonText:tooltipContent;const analysisType=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(common_analytics["r"])(item.config.analysis),[item]);const viewAnalyticsResultsLink=Object(kibana["c"])({page:ml_url_generator["b"].DATA_FRAME_ANALYTICS_EXPLORATION,pageState:{jobId:item.id,analysisType:analysisType}});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"bottom",content:tooltipText},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{href:viewAnalyticsResultsLink,color:"text",size:"xs",iconType:"visTable","aria-label":viewJobResultsButtonText,className:"results-button","data-test-subj":"mlOverviewAnalyticsJobViewButton",isDisabled:disabled},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.analytics.viewActionName",{defaultMessage:"View"})))};const AnalyticsTable=({items:items})=>{const[pageIndex,setPageIndex]=Object(external_kbnSharedDeps_React_["useState"])(0);const[pageSize,setPageSize]=Object(external_kbnSharedDeps_React_["useState"])(10);const[sortField,setSortField]=Object(external_kbnSharedDeps_React_["useState"])(common["c"].id);const[sortDirection,setSortDirection]=Object(external_kbnSharedDeps_React_["useState"])("asc");const columns=[{field:common["c"].id,name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.analyticsList.id",{defaultMessage:"ID"}),sortable:true,truncateText:true,width:"20%"},{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.analyticsList.type",{defaultMessage:"Type"}),sortable:item=>Object(common_analytics["r"])(item.config.analysis),truncateText:true,render(item){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{color:"hollow"},Object(common_analytics["r"])(item.config.analysis))},width:"150px"},{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.analyticsList.status",{defaultMessage:"Status"}),sortable:item=>item.stats.state,truncateText:true,render(item){return Object(use_columns["b"])(item.stats.state,item.stats.failure_reason)},width:"100px"},use_columns["c"],{field:common["c"].configCreateTime,name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.analyticsList.reatedTimeColumnName",{defaultMessage:"Creation time"}),dataType:"date",render:time=>Object(date_utils["c"])(time),textOnly:true,truncateText:true,sortable:true,width:"20%"},{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.analyticsList.tableActionLabel",{defaultMessage:"Actions"}),actions:[{render:item=>external_kbnSharedDeps_React_default.a.createElement(ViewLink,{item:item})}],width:"100px"}];const onTableChange=({page:page={index:0,size:10},sort:sort={field:common["c"].id,direction:"asc"}})=>{const{index:index,size:size}=page;setPageIndex(index);setPageSize(size);const{field:field,direction:direction}=sort;setSortField(field);setSortDirection(direction)};const pagination={initialPageIndex:pageIndex,initialPageSize:pageSize,totalItemCount:items.length,pageSizeOptions:[10,20,50],hidePerPageOptions:false};const sorting={sort:{field:sortField,direction:sortDirection}};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiInMemoryTable"],{allowNeutralSort:false,className:"mlAnalyticsTable",columns:columns,hasActions:false,isExpandable:false,isSelectable:false,items:items,itemId:common["c"].id,onTableChange:onTableChange,pagination:pagination,sorting:sorting,"data-test-subj":"mlOverviewTableAnalytics"})};var analytics_service=__webpack_require__(172);const AnalyticsPanel=({jobCreationDisabled:jobCreationDisabled,setLazyJobCount:setLazyJobCount})=>{const[analytics,setAnalytics]=Object(external_kbnSharedDeps_React_["useState"])([]);const[analyticsStats,setAnalyticsStats]=Object(external_kbnSharedDeps_React_["useState"])(undefined);const[errorMessage,setErrorMessage]=Object(external_kbnSharedDeps_React_["useState"])(undefined);const[isInitialized,setIsInitialized]=Object(external_kbnSharedDeps_React_["useState"])(false);const mlUrlGenerator=Object(kibana["d"])();const navigateToPath=Object(kibana["e"])();const redirectToDataFrameAnalyticsManagementPage=async()=>{const path=await mlUrlGenerator.createUrl({page:ml_url_generator["b"].DATA_FRAME_ANALYTICS_JOBS_MANAGE});await navigateToPath(path,true)};const getAnalytics=Object(analytics_service["d"])(setAnalytics,setAnalyticsStats,setErrorMessage,setIsInitialized,setLazyJobCount,false,false);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{getAnalytics(true)},[]);const onRefresh=()=>{getAnalytics(true)};const errorDisplay=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.analyticsList.errorPromptTitle",{defaultMessage:"An error occurred getting the data frame analytics list."}),color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("pre",null,errorMessage&&errorMessage.message!==undefined?errorMessage.message:JSON.stringify(errorMessage)));const panelClass=isInitialized===false?"mlOverviewPanel__isLoading":"mlOverviewPanel";return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],{className:panelClass},typeof errorMessage!=="undefined"&&errorDisplay,isInitialized===false&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{className:"mlOverviewPanel__spinner",size:"xl"}),errorMessage===undefined&&isInitialized===true&&analytics.length===0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{iconType:"createAdvancedJob",title:external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.analyticsList.createFirstJobMessage",{defaultMessage:"Create your first data frame analytics job"})),body:external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.analyticsList.emptyPromptText",{defaultMessage:`Data frame analytics enables you to perform outlier detection, regression, or classification analysis on your data and annotates it with the results. The job puts the annotated data and a copy of the source data in a new index.`})),actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{onClick:redirectToDataFrameAnalyticsManagementPage,color:"primary",fill:true,iconType:"plusInCircle",isDisabled:jobCreationDisabled,"data-test-subj":"mlOverviewCreateDFAJobButton"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.analyticsList.createJobButtonText",{defaultMessage:"Create job"}))}),isInitialized===true&&analytics.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.analyticsList.PanelTitle",{defaultMessage:"Analytics"})))),analyticsStats!==undefined&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,className:"mlOverviewPanel__statsBar"},external_kbnSharedDeps_React_default.a.createElement(stats_bar["a"],{stats:analyticsStats,dataTestSub:"mlOverviewAnalyticsStatsBar"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(AnalyticsTable,{items:analytics}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlOverviewPanel__buttons"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{size:"s",onClick:onRefresh,className:"mlOverviewPanel__refreshButton"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.analyticsList.refreshJobsButtonText",{defaultMessage:"Refresh"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{size:"s",fill:true,onClick:redirectToDataFrameAnalyticsManagementPage},external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.ml.overview.analyticsList.manageJobsButtonText",{defaultMessage:"Manage jobs"})))))};const OverviewContent=({createAnomalyDetectionJobDisabled:createAnomalyDetectionJobDisabled,createAnalyticsJobDisabled:createAnalyticsJobDisabled,setAdLazyJobCount:setAdLazyJobCount,setDfaLazyJobCount:setDfaLazyJobCount})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:3},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(AnomalyDetectionPanel,{jobCreationDisabled:createAnomalyDetectionJobDisabled,setLazyJobCount:setAdLazyJobCount})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(AnalyticsPanel,{jobCreationDisabled:createAnalyticsJobDisabled,setLazyJobCount:setDfaLazyJobCount}))));var node_available_warning=__webpack_require__(267);var jobs_awaiting_node_warning=__webpack_require__(153);var saved_objects_warning=__webpack_require__(268);var upgrade=__webpack_require__(269);var help_menu=__webpack_require__(98);const OverviewPage=()=>{const disableCreateAnomalyDetectionJob=!Object(check_capabilities["e"])("canCreateJob")||!Object(check_ml_nodes["e"])();const disableCreateAnalyticsButton=!Object(check_ml_nodes["e"])()||!Object(check_capabilities["e"])("canCreateDataFrameAnalytics")||!Object(check_capabilities["e"])("canStartStopDataFrameAnalytics");const{services:{docLinks:docLinks}}=Object(kibana["b"])();const helpLink=docLinks.links.ml.guide;const[adLazyJobCount,setAdLazyJobCount]=Object(external_kbnSharedDeps_React_["useState"])(0);const[dfaLazyJobCount,setDfaLazyJobCount]=Object(external_kbnSharedDeps_React_["useState"])(0);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(navigation_menu["a"],{tabId:"overview"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPage"],{"data-test-subj":"mlPageOverview"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageBody"],null,external_kbnSharedDeps_React_default.a.createElement(node_available_warning["a"],null),external_kbnSharedDeps_React_default.a.createElement(jobs_awaiting_node_warning["a"],{jobCount:adLazyJobCount+dfaLazyJobCount}),external_kbnSharedDeps_React_default.a.createElement(saved_objects_warning["a"],null),external_kbnSharedDeps_React_default.a.createElement(upgrade["a"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(OverviewSideBar,{createAnomalyDetectionJobDisabled:disableCreateAnomalyDetectionJob}),external_kbnSharedDeps_React_default.a.createElement(OverviewContent,{createAnomalyDetectionJobDisabled:disableCreateAnomalyDetectionJob,createAnalyticsJobDisabled:disableCreateAnalyticsButton,setAdLazyJobCount:setAdLazyJobCount,setDfaLazyJobCount:setDfaLazyJobCount})))),external_kbnSharedDeps_React_default.a.createElement(help_menu["a"],{docLink:helpLink}))};var overview_page=__webpack_exports__["default"]=OverviewPage}}]);