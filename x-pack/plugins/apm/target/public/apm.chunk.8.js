/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window["apm_bundle_jsonpfunction"]=window["apm_bundle_jsonpfunction"]||[]).push([[8],{124:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return getSeverity}));__webpack_require__.d(__webpack_exports__,"c",(function(){return getSeverityColor}));__webpack_require__.d(__webpack_exports__,"a",(function(){return ML_ERRORS}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__);var _ml_common__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1);var _ml_common__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_ml_common__WEBPACK_IMPORTED_MODULE_1__);function getSeverity(score){if(score===undefined){return _ml_common__WEBPACK_IMPORTED_MODULE_1__["ANOMALY_SEVERITY"].UNKNOWN}return Object(_ml_common__WEBPACK_IMPORTED_MODULE_1__["getSeverityType"])(score)}function getSeverityColor(score){return Object(_ml_common__WEBPACK_IMPORTED_MODULE_1__["getSeverityColor"])(score)}const ML_ERRORS={INVALID_LICENSE:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.apm.anomaly_detection.error.invalid_license",{defaultMessage:`To use anomaly detection, you must be subscribed to an Elastic Platinum license. With it, you'll be able to monitor your services with the aid of machine learning.`}),MISSING_READ_PRIVILEGES:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.apm.anomaly_detection.error.missing_read_privileges",{defaultMessage:'You must have "read" privileges to Machine Learning and APM in order to view Anomaly Detection jobs'}),MISSING_WRITE_PRIVILEGES:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.apm.anomaly_detection.error.missing_write_privileges",{defaultMessage:'You must have "write" privileges to Machine Learning and APM in order to create Anomaly Detection jobs'}),ML_NOT_AVAILABLE:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.apm.anomaly_detection.error.not_available",{defaultMessage:"Machine learning is not available"}),ML_NOT_AVAILABLE_IN_SPACE:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.apm.anomaly_detection.error.not_available_in_space",{defaultMessage:"Machine learning is not available in the selected space"})}},1423:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"TransactionDurationAnomalyAlertTrigger",(function(){return TransactionDurationAnomalyAlertTrigger}));var external_kbnSharedDeps_ReactRouterDom_=__webpack_require__(11);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(0);var external_kbnSharedDeps_React_=__webpack_require__(2);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var common_=__webpack_require__(1);var use_environments_fetcher=__webpack_require__(111);var use_url_params=__webpack_require__(36);var service_alert_trigger=__webpack_require__(98);var popover_expression=__webpack_require__(77);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(21);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(10);var anomaly_detection=__webpack_require__(124);var alert_types=__webpack_require__(3);function AnomalySeverity({type:type}){const selectedOption=alert_types["b"].find(option=>option.type===type);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:Object(anomaly_detection["c"])(selectedOption.threshold),style:{lineHeight:"inherit"}},selectedOption.label)}function SelectAnomalySeverity({onChange:onChange,value:value}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSuperSelect"],{hasDividers:true,style:{width:200},options:alert_types["b"].map(option=>({value:option.type,inputDisplay:external_kbnSharedDeps_React_default.a.createElement(AnomalySeverity,{type:option.type}),dropdownDisplay:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(AnomalySeverity,{type:option.type}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",{className:"euiTextColor--subdued","data-test-subj":"SelectAnomalySeverity option text"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.apm.alerts.anomalySeverity.scoreDetailsDescription",defaultMessage:"score {value} {value, select, critical {} other {and above}}",values:{value:option.type}}))))})),valueOfSelected:value,onChange:selectedValue=>{onChange(selectedValue)}})}var environment_filter_values=__webpack_require__(54);var alerting_fields=__webpack_require__(97);var use_apm_service_context=__webpack_require__(47);function TransactionDurationAnomalyAlertTrigger(props){const{setAlertParams:setAlertParams,alertParams:alertParams,setAlertProperty:setAlertProperty}=props;const{urlParams:urlParams}=Object(use_url_params["a"])();const{transactionTypes:transactionTypes}=Object(use_apm_service_context["a"])();const{serviceName:serviceName}=Object(external_kbnSharedDeps_ReactRouterDom_["useParams"])();const{start:start,end:end,transactionType:transactionType}=urlParams;const{environmentOptions:environmentOptions}=Object(use_environments_fetcher["a"])({serviceName:serviceName,start:start,end:end});if(serviceName&&!transactionTypes.length){return null}const defaults={windowSize:15,windowUnit:"m",transactionType:transactionType||transactionTypes[0],serviceName:serviceName,environment:urlParams.environment||environment_filter_values["a"].value,anomalySeverityType:common_["ANOMALY_SEVERITY"].CRITICAL};const params={...defaults,...alertParams};const fields=[external_kbnSharedDeps_React_default.a.createElement(alerting_fields["c"],{value:serviceName}),external_kbnSharedDeps_React_default.a.createElement(alerting_fields["d"],{currentValue:params.transactionType,options:transactionTypes.map(key=>({text:key,value:key})),onChange:e=>setAlertParams("transactionType",e.target.value)}),external_kbnSharedDeps_React_default.a.createElement(alerting_fields["a"],{currentValue:params.environment,options:environmentOptions,onChange:e=>setAlertParams("environment",e.target.value)}),external_kbnSharedDeps_React_default.a.createElement(popover_expression["a"],{value:external_kbnSharedDeps_React_default.a.createElement(AnomalySeverity,{type:params.anomalySeverityType}),title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.apm.transactionDurationAnomalyAlertTrigger.anomalySeverity",{defaultMessage:"Has anomaly with severity"})},external_kbnSharedDeps_React_default.a.createElement(SelectAnomalySeverity,{value:params.anomalySeverityType,onChange:value=>{setAlertParams("anomalySeverityType",value)}}))];return external_kbnSharedDeps_React_default.a.createElement(service_alert_trigger["a"],{fields:fields,defaults:defaults,setAlertParams:setAlertParams,setAlertProperty:setAlertProperty})}var transaction_duration_anomaly_alert_trigger=__webpack_exports__["default"]=TransactionDurationAnomalyAlertTrigger},47:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useApmServiceContext}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var _apm_service_context__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(82);function useApmServiceContext(){return Object(react__WEBPACK_IMPORTED_MODULE_0__["useContext"])(_apm_service_context__WEBPACK_IMPORTED_MODULE_1__["a"])}},58:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return OPEN_TELEMETRY_AGENT_NAMES}));__webpack_require__.d(__webpack_exports__,"b",(function(){return RUM_AGENT_NAMES}));__webpack_require__.d(__webpack_exports__,"c",(function(){return isJavaAgentName}));__webpack_require__.d(__webpack_exports__,"d",(function(){return isRumAgentName}));const OPEN_TELEMETRY_AGENT_NAMES=["otlp","opentelemetry/cpp","opentelemetry/dotnet","opentelemetry/erlang","opentelemetry/go","opentelemetry/java","opentelemetry/nodejs","opentelemetry/php","opentelemetry/python","opentelemetry/ruby","opentelemetry/webjs"];const AGENT_NAMES=["dotnet","go","java","js-base","nodejs","python","ruby","rum-js",...OPEN_TELEMETRY_AGENT_NAMES];const RUM_AGENT_NAMES=["js-base","rum-js","opentelemetry/webjs"];function isJavaAgentName(agentName){return agentName==="java"}function isRumAgentName(agentName){return RUM_AGENT_NAMES.includes(agentName)}},72:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return TRANSACTION_PAGE_LOAD}));__webpack_require__.d(__webpack_exports__,"b",(function(){return TRANSACTION_REQUEST}));const TRANSACTION_PAGE_LOAD="page-load";const TRANSACTION_REQUEST="request";const TRANSACTION_ROUTE_CHANGE="route-change"},77:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return PopoverExpression}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var _elastic_eui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(10);var _elastic_eui__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__);function PopoverExpression(props){const{title:title,value:value,children:children}=props;const[popoverOpen,setPopoverOpen]=Object(react__WEBPACK_IMPORTED_MODULE_0__["useState"])(false);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiPopover"],{isOpen:popoverOpen,anchorPosition:"downLeft",closePopover:()=>setPopoverOpen(false),button:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiExpression"],{description:title,value:value,isActive:popoverOpen,onClick:()=>setPopoverOpen(true)}),repositionOnScroll:true},children)}},82:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return APMServiceContext}));__webpack_require__.d(__webpack_exports__,"b",(function(){return ApmServiceContextProvider}));var external_kbnSharedDeps_React_=__webpack_require__(2);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var agent_name=__webpack_require__(58);var transaction_types=__webpack_require__(72);var external_kbnSharedDeps_ReactRouterDom_=__webpack_require__(11);var use_fetcher=__webpack_require__(37);var use_url_params=__webpack_require__(36);const INITIAL_DATA={transactionTypes:[]};function useServiceTransactionTypesFetcher(){const{serviceName:serviceName}=Object(external_kbnSharedDeps_ReactRouterDom_["useParams"])();const{urlParams:urlParams}=Object(use_url_params["a"])();const{start:start,end:end}=urlParams;const{data:data=INITIAL_DATA}=Object(use_fetcher["b"])(callApmApi=>{if(serviceName&&start&&end){return callApmApi({endpoint:"GET /api/apm/services/{serviceName}/transaction_types",params:{path:{serviceName:serviceName},query:{start:start,end:end}}})}},[serviceName,start,end]);return data.transactionTypes}function useServiceAgentNameFetcher(){const{serviceName:serviceName}=Object(external_kbnSharedDeps_ReactRouterDom_["useParams"])();const{urlParams:urlParams}=Object(use_url_params["a"])();const{start:start,end:end}=urlParams;const{data:data,error:error,status:status}=Object(use_fetcher["b"])(callApmApi=>{if(serviceName&&start&&end){return callApmApi({endpoint:"GET /api/apm/services/{serviceName}/agent_name",params:{path:{serviceName:serviceName},query:{start:start,end:end}}})}},[serviceName,start,end]);return{agentName:data===null||data===void 0?void 0:data.agentName,status:status,error:error}}const APMServiceContext=Object(external_kbnSharedDeps_React_["createContext"])({transactionTypes:[]});function ApmServiceContextProvider({children:children}){const{urlParams:urlParams}=Object(use_url_params["a"])();const{agentName:agentName}=useServiceAgentNameFetcher();const transactionTypes=useServiceTransactionTypesFetcher();const transactionType=getTransactionType({urlParams:urlParams,transactionTypes:transactionTypes,agentName:agentName});return external_kbnSharedDeps_React_default.a.createElement(APMServiceContext.Provider,{value:{agentName:agentName,transactionType:transactionType,transactionTypes:transactionTypes},children:children})}function getTransactionType({urlParams:urlParams,transactionTypes:transactionTypes,agentName:agentName}){if(urlParams.transactionType){return urlParams.transactionType}if(!agentName||transactionTypes.length===0){return}const defaultTransactionType=Object(agent_name["d"])(agentName)?transaction_types["a"]:transaction_types["b"];return transactionTypes.includes(defaultTransactionType)?defaultTransactionType:transactionTypes[0]}},97:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return ServiceField}));__webpack_require__.d(__webpack_exports__,"a",(function(){return EnvironmentField}));__webpack_require__.d(__webpack_exports__,"d",(function(){return TransactionTypeField}));__webpack_require__.d(__webpack_exports__,"b",(function(){return IsAboveField}));var _elastic_eui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10);var _elastic_eui__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__);var react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2);var react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__);var _common_environment_filter_values__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(54);var _service_alert_trigger_popover_expression__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(77);const ALL_OPTION=_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].translate("xpack.apm.alerting.fields.all_option",{defaultMessage:"All"});function ServiceField({value:value}){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__["EuiExpression"],{description:_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].translate("xpack.apm.alerting.fields.service",{defaultMessage:"Service"}),value:value||ALL_OPTION})}function EnvironmentField({currentValue:currentValue,options:options,onChange:onChange}){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_service_alert_trigger_popover_expression__WEBPACK_IMPORTED_MODULE_4__["a"],{value:Object(_common_environment_filter_values__WEBPACK_IMPORTED_MODULE_3__["c"])(currentValue),title:_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].translate("xpack.apm.alerting.fields.environment",{defaultMessage:"Environment"})},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__["EuiSelect"],{defaultValue:currentValue,options:options,onChange:onChange,compressed:true}))}function TransactionTypeField({currentValue:currentValue,options:options,onChange:onChange}){const label=_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].translate("xpack.apm.alerting.fields.type",{defaultMessage:"Type"});if(!options||options.length<=1){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__["EuiExpression"],{description:label,value:currentValue||ALL_OPTION})}return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_service_alert_trigger_popover_expression__WEBPACK_IMPORTED_MODULE_4__["a"],{value:currentValue,title:label},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__["EuiSelect"],{"data-test-subj":"transactionTypeField",defaultValue:currentValue,options:options,onChange:onChange,compressed:true}))}function IsAboveField({value:value,unit:unit,onChange:onChange,step:step}){return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_service_alert_trigger_popover_expression__WEBPACK_IMPORTED_MODULE_4__["a"],{value:value?`${value.toString()}${unit}`:"",title:_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].translate("xpack.apm.transactionErrorRateAlertTrigger.isAbove",{defaultMessage:"is above"})},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__["EuiFieldNumber"],{value:value!==null&&value!==void 0?value:"",onChange:e=>onChange(parseInt(e.target.value,10)),append:unit,compressed:true,step:step}))}},98:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ServiceAlertTrigger}));var _elastic_eui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10);var _elastic_eui__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__);var react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2);var react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);var react_router_dom__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(11);var react_router_dom__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(react_router_dom__WEBPACK_IMPORTED_MODULE_2__);function ServiceAlertTrigger(props){const{serviceName:serviceName}=Object(react_router_dom__WEBPACK_IMPORTED_MODULE_2__["useParams"])();const{fields:fields,setAlertParams:setAlertParams,defaults:defaults,chartPreview:chartPreview}=props;const params={...defaults,serviceName:serviceName};Object(react__WEBPACK_IMPORTED_MODULE_1__["useEffect"])(()=>{Object.keys(params).forEach(key=>{setAlertParams(key,params[key])})},[]);return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_1___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__["EuiSpacer"],{size:"l"}),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__["EuiFlexGrid"],{gutterSize:"l",direction:"row",columns:2},fields.map((field,index)=>react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__["EuiFlexItem"],{grow:false,key:index},field))),chartPreview,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__["EuiSpacer"],{size:"m"}))}}}]);