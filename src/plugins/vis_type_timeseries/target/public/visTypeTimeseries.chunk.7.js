(window["visTypeTimeseries_bundle_jsonpfunction"]=window["visTypeTimeseries_bundle_jsonpfunction"]||[]).push([[7],{259:function(module,exports,__webpack_require__){if(false){var throwOnDirectAccess,ReactIs}else{module.exports=__webpack_require__(260)()}},260:function(module,exports,__webpack_require__){"use strict";var ReactPropTypesSecret=__webpack_require__(261);function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction;module.exports=function(){function shim(props,propName,componentName,location,propFullName,secret){if(secret===ReactPropTypesSecret){return}var err=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. "+"Use PropTypes.checkPropTypes() to call them. "+"Read more at http://fb.me/use-check-prop-types");err.name="Invariant Violation";throw err}shim.isRequired=shim;function getShim(){return shim}var ReactPropTypes={array:shim,bool:shim,func:shim,number:shim,object:shim,string:shim,symbol:shim,any:shim,arrayOf:getShim,element:shim,elementType:shim,instanceOf:getShim,node:shim,objectOf:getShim,oneOf:getShim,oneOfType:getShim,shape:getShim,exact:getShim,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};ReactPropTypes.PropTypes=ReactPropTypes;return ReactPropTypes}},261:function(module,exports,__webpack_require__){"use strict";var ReactPropTypesSecret="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";module.exports=ReactPropTypesSecret},348:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",(function(){return vis_TimeseriesVisualization}));var external_kbnSharedDeps_React_=__webpack_require__(1);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_Lodash_=__webpack_require__(31);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(12);var external_kbnSharedDeps_ElasticCharts_=__webpack_require__(32);var tick_formatter=__webpack_require__(46);var classnames=__webpack_require__(73);var classnames_default=__webpack_require__.n(classnames);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(3);var label_date_formatter=__webpack_require__(54);var get_timezone=__webpack_require__(16);var external_kbnSharedDeps_Rxjs_=__webpack_require__(34);const activeCursor$=new external_kbnSharedDeps_Rxjs_["Subject"];var services=__webpack_require__(0);var constants=__webpack_require__(45);const DEFAULT_COLOR="#000";const getAreaStyles=({points:points,lines:lines,color:color})=>({areaSeriesStyle:{line:{stroke:color,strokeWidth:Number(lines.lineWidth)||0,visible:Boolean(lines.show&&lines.lineWidth)},area:{fill:color,opacity:lines.fill<=0?0:lines.fill,visible:Boolean(lines.show)},point:{radius:points.radius||.5,stroke:color||DEFAULT_COLOR,strokeWidth:points.lineWidth||5,visible:points.lineWidth>0&&Boolean(points.show)}},curve:lines.steps?external_kbnSharedDeps_ElasticCharts_["CurveType"].CURVE_STEP:external_kbnSharedDeps_ElasticCharts_["CurveType"].LINEAR});const getBarStyles=({show:show=true,lineWidth:lineWidth=0,fill:fill=1},color)=>({barSeriesStyle:{rectBorder:{stroke:color||DEFAULT_COLOR,strokeWidth:lineWidth,visible:show},rect:{fill:color||DEFAULT_COLOR,opacity:fill}}});var prop_types=__webpack_require__(259);var prop_types_default=__webpack_require__.n(prop_types);const Chart={seriesId:prop_types_default.a.string.isRequired,seriesGroupId:prop_types_default.a.string.isRequired,name:prop_types_default.a.string.isRequired,data:prop_types_default.a.arrayOf(prop_types_default.a.arrayOf(prop_types_default.a.number)).isRequired,hideInLegend:prop_types_default.a.bool.isRequired,color:prop_types_default.a.string.isRequired,stackMode:prop_types_default.a.oneOf(["percentage","wiggle","silhouette"]),stackAccessors:prop_types_default.a.arrayOf(prop_types_default.a.number),xScaleType:prop_types_default.a.string,yScaleType:prop_types_default.a.string,timeZone:prop_types_default.a.string.isRequired,enableHistogramMode:prop_types_default.a.bool.isRequired,sortIndex:prop_types_default.a.number};const BarChart={...Chart,bars:prop_types_default.a.shape({fill:prop_types_default.a.number,lineWidth:prop_types_default.a.number,show:prop_types_default.a.boolean}).isRequired};const AreaChart={...Chart,lines:prop_types_default.a.shape({fill:prop_types_default.a.number,lineWidth:prop_types_default.a.number,show:prop_types_default.a.bool,steps:prop_types_default.a.oneOfType([prop_types_default.a.number,prop_types_default.a.bool])}).isRequired,points:prop_types_default.a.shape({lineWidth:prop_types_default.a.number,radius:prop_types_default.a.number,show:prop_types_default.a.bool}).isRequired};const ChartsEntities={BarChart:BarChart,AreaChart:AreaChart};function AreaSeriesDecorator({seriesId:seriesId,seriesGroupId:seriesGroupId,name:name,data:data,hideInLegend:hideInLegend,lines:lines,color:color,stackAccessors:stackAccessors,stackMode:stackMode,points:points,xScaleType:xScaleType,yScaleType:yScaleType,timeZone:timeZone,enableHistogramMode:enableHistogramMode,sortIndex:sortIndex,y1AccessorFormat:y1AccessorFormat,y0AccessorFormat:y0AccessorFormat,tickFormat:tickFormat}){const id=seriesId;const groupId=seriesGroupId;const areaSeriesStyle=getAreaStyles({points:points,lines:lines,color:color});const seriesSettings={id:id,name:name,groupId:groupId,data:data,color:color,hideInLegend:hideInLegend,xAccessor:constants["e"],yAccessors:constants["g"],y0Accessors:lines.mode==="band"?constants["f"]:undefined,y1AccessorFormat:y1AccessorFormat,y0AccessorFormat:y0AccessorFormat,stackAccessors:stackAccessors,stackMode:stackMode,xScaleType:xScaleType,yScaleType:yScaleType,timeZone:timeZone,enableHistogramMode:enableHistogramMode,sortIndex:sortIndex,tickFormat:tickFormat,...areaSeriesStyle};if(enableHistogramMode){seriesSettings.histogramModeAlignment="center"}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["AreaSeries"],seriesSettings)}AreaSeriesDecorator.defaultProps={yScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear,xScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Time};function BarSeriesDecorator({seriesId:seriesId,seriesGroupId:seriesGroupId,name:name,data:data,hideInLegend:hideInLegend,bars:bars,color:color,stackAccessors:stackAccessors,stackMode:stackMode,xScaleType:xScaleType,yScaleType:yScaleType,timeZone:timeZone,enableHistogramMode:enableHistogramMode,sortIndex:sortIndex,y1AccessorFormat:y1AccessorFormat,y0AccessorFormat:y0AccessorFormat,tickFormat:tickFormat}){const id=seriesId;const groupId=seriesGroupId;const barSeriesStyle=getBarStyles(bars,color);const seriesSettings={id:id,name:name,groupId:groupId,data:data,color:color,hideInLegend:hideInLegend,xAccessor:constants["e"],yAccessors:constants["g"],y0Accessors:bars.mode==="band"?constants["f"]:undefined,y1AccessorFormat:y1AccessorFormat,y0AccessorFormat:y0AccessorFormat,stackAccessors:stackAccessors,stackMode:stackMode,xScaleType:xScaleType,yScaleType:yScaleType,timeZone:timeZone,enableHistogramMode:enableHistogramMode,sortIndex:sortIndex,tickFormat:tickFormat,...barSeriesStyle};if(enableHistogramMode){seriesSettings.histogramModeAlignment="center"}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["BarSeries"],seriesSettings)}BarSeriesDecorator.defaultProps={yScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear,xScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Time};const getStackAccessors=stack=>{switch(stack){case constants["c"].STACKED:case constants["c"].STACKED_WITHIN_SERIES:case constants["c"].PERCENT:return constants["d"];default:return undefined}};var node_modules_color=__webpack_require__(115);var color_default=__webpack_require__.n(node_modules_color);function computeRelativeLuminosity(rgb){return color_default()(rgb).luminosity()}function computeContrast(rgb1,rgb2){return color_default()(rgb1).contrast(color_default()(rgb2))}function getAAARelativeLum(bgColor,fgColor,ratio=7){const relLum1=computeRelativeLuminosity(bgColor);const relLum2=computeRelativeLuminosity(fgColor);if(relLum1>relLum2){return(relLum1+.05-ratio*.05)/ratio}else{return Math.min(ratio*(relLum1+.05)-.05,1)}}function getGrayFromRelLum(relLum){if(relLum<=.0031308){return relLum*12.92}else{return(1+.055)*Math.pow(relLum,1/2.4)-.055}}function getGrayRGBfromGray(gray){const g=Math.round(gray*255);return`rgb(${g},${g},${g})`}function getAAAGray(bgColor,fgColor,ratio=7){const relLum=getAAARelativeLum(bgColor,fgColor,ratio);const gray=getGrayFromRelLum(relLum);return getGrayRGBfromGray(gray)}function findBestContrastColor(bgColor,lightFgColor,darkFgColor,ratio=4.5){const lc=computeContrast(bgColor,lightFgColor);const dc=computeContrast(bgColor,darkFgColor);if(lc>=dc){if(lc>=ratio){return lightFgColor}return getAAAGray(bgColor,lightFgColor,ratio)}if(dc>=ratio){return darkFgColor}return getAAAGray(bgColor,darkFgColor,ratio)}function isValidColor(color){if(typeof color!=="string"){return false}if(color.length===0){return false}try{color_default()(color);return true}catch{return false}}function getBaseTheme(baseTheme,bgColor){if(!isValidColor(bgColor)){return baseTheme}const bgLuminosity=computeRelativeLuminosity(bgColor);const mainTheme=bgLuminosity<=.179?external_kbnSharedDeps_ElasticCharts_["DARK_THEME"]:external_kbnSharedDeps_ElasticCharts_["LIGHT_THEME"];const color=findBestContrastColor(bgColor,external_kbnSharedDeps_ElasticCharts_["LIGHT_THEME"].axes.axisTitle.fill,external_kbnSharedDeps_ElasticCharts_["DARK_THEME"].axes.axisTitle.fill);return{...mainTheme,axes:{...mainTheme.axes,axisTitle:{...mainTheme.axes.axisTitle,fill:color},tickLabel:{...mainTheme.axes.tickLabel,fill:color},axisLine:{...mainTheme.axes.axisLine,stroke:color},tickLine:{...mainTheme.axes.tickLine,stroke:color}}}}function getChartClasses(bgColor){if(typeof bgColor!=="string"){return}const bgLuminosity=computeRelativeLuminosity(bgColor);return bgLuminosity<=.179?"tvbVisTimeSeriesDark":"tvbVisTimeSeriesLight"}const generateAnnotationData=(values,formatter)=>values.map(({key:key,docs:docs})=>({dataValue:key,details:docs[0],header:formatter({value:key})}));const decorateFormatter=formatter=>({value:value})=>formatter(value);const handleCursorUpdate=cursor=>{activeCursor$.next(cursor)};const TimeSeries=({backgroundColor:backgroundColor,showGrid:showGrid,legend:legend,legendPosition:legendPosition,tooltipMode:tooltipMode,xAxisLabel:xAxisLabel,series:series,yAxis:yAxis,onBrush:onBrush,xAxisFormatter:xAxisFormatter,annotations:annotations})=>{const chartRef=Object(external_kbnSharedDeps_React_["useRef"])();Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const updateCursor=cursor=>{if(chartRef.current){chartRef.current.dispatchExternalPointerEvent(cursor)}};const subscription=activeCursor$.subscribe(updateCursor);return()=>{subscription.unsubscribe()}},[]);const tooltipFormatter=decorateFormatter(xAxisFormatter);const uiSettings=Object(services["g"])();const timeZone=Object(get_timezone["a"])(uiSettings);const hasBarChart=series.some(({bars:bars})=>bars===null||bars===void 0?void 0:bars.show);const classes=classnames_default()("tvbVisTimeSeries",getChartClasses(backgroundColor));const{legacyColors:colors,theme:themeService}=Object(services["a"])();const baseTheme=getBaseTheme(themeService.useChartsBaseTheme(),backgroundColor);colors.mappedColors.mapKeys(series.filter(({color:color})=>!color).map(({label:label})=>label));const onBrushEndListener=({x:x})=>{if(!x){return}const[min,max]=x;onBrush(min,max)};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Chart"],{ref:chartRef,renderer:"canvas",className:classes},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Settings"],{showLegend:legend,showLegendExtra:true,legendPosition:legendPosition,onBrushEnd:onBrushEndListener,animateData:false,onPointerUpdate:handleCursorUpdate,theme:[hasBarChart?{}:{crosshair:{band:{fill:"#F00"}}},{background:{color:backgroundColor}}],baseTheme:baseTheme,tooltip:{snap:true,type:tooltipMode==="show_focused"?external_kbnSharedDeps_ElasticCharts_["TooltipType"].Follow:external_kbnSharedDeps_ElasticCharts_["TooltipType"].VerticalCursor,headerFormatter:tooltipFormatter},externalPointerEvents:{tooltip:{visible:false}}}),annotations.map(({id:id,data:data,icon:icon,color:color})=>{const dataValues=generateAnnotationData(data,tooltipFormatter);const style={line:{stroke:color}};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["LineAnnotation"],{key:id,id:id,domainType:external_kbnSharedDeps_ElasticCharts_["AnnotationDomainTypes"].XDomain,dataValues:dataValues,marker:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:constants["b"][icon]||"asterisk"}),hideLinesTooltips:true,style:style})}),series.map(({id:id,label:label,labelFormatted:labelFormatted,bars:bars,lines:lines,data:data,hideInLegend:hideInLegend,xScaleType:xScaleType,yScaleType:yScaleType,groupId:groupId,color:color,stack:stack,points:points,y1AccessorFormat:y1AccessorFormat,y0AccessorFormat:y0AccessorFormat,tickFormat:tickFormat},sortIndex)=>{const stackAccessors=getStackAccessors(stack);const isPercentage=stack===constants["c"].PERCENT;const isStacked=stack!==constants["c"].NONE;const key=`${id}-${label}`;const finalColor=color!==null&&color!==void 0?color:colors.mappedColors.mapping[label];let seriesName=label.toString();if(labelFormatted){seriesName=Object(label_date_formatter["a"])(labelFormatted)}if(bars!==null&&bars!==void 0&&bars.show){return external_kbnSharedDeps_React_default.a.createElement(BarSeriesDecorator,{key:key,seriesId:id,seriesGroupId:groupId,name:seriesName||external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.emptyTextValue",{defaultMessage:"(empty)"}),data:data,hideInLegend:hideInLegend,bars:bars,color:finalColor,stackAccessors:stackAccessors,stackMode:isPercentage?external_kbnSharedDeps_ElasticCharts_["StackMode"].Percentage:undefined,xScaleType:xScaleType,yScaleType:yScaleType,timeZone:timeZone,enableHistogramMode:isStacked,sortIndex:sortIndex,y1AccessorFormat:y1AccessorFormat,y0AccessorFormat:y0AccessorFormat,tickFormat:tickFormat})}if(lines!==null&&lines!==void 0&&lines.show){return external_kbnSharedDeps_React_default.a.createElement(AreaSeriesDecorator,{key:key,seriesId:id,seriesGroupId:groupId,name:seriesName||external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.emptyTextValue",{defaultMessage:"(empty)"}),data:data,hideInLegend:hideInLegend,lines:lines,color:finalColor,stackAccessors:stackAccessors,stackMode:isPercentage?external_kbnSharedDeps_ElasticCharts_["StackMode"].Percentage:undefined,points:points,xScaleType:xScaleType,yScaleType:yScaleType,timeZone:timeZone,enableHistogramMode:isStacked,sortIndex:sortIndex,y1AccessorFormat:y1AccessorFormat,y0AccessorFormat:y0AccessorFormat,tickFormat:tickFormat})}return null}),yAxis.map(({id:id,groupId:groupId,position:position,tickFormatter:tickFormatter,domain:domain,hide:hide})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Axis"],{key:groupId,groupId:groupId,id:id,position:position,domain:domain,hide:hide,gridLine:{...constants["a"],visible:showGrid},tickFormat:tickFormatter})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Axis"],{id:"bottom",position:external_kbnSharedDeps_ElasticCharts_["Position"].Bottom,title:xAxisLabel,tickFormat:xAxisFormatter,gridLine:{...constants["a"],visible:showGrid}}))};TimeSeries.defaultProps={showGrid:true,legend:true,legendPosition:"right"};var public_=__webpack_require__(33);var replace_vars=__webpack_require__(57);var get_interval=__webpack_require__(62);function getAxisLabelString(interval){if(!interval){return""}const convertedValue=Object(get_interval["a"])(interval);if(convertedValue){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTimeseries.axisLabelOptions.axisLabel",{defaultMessage:"per {unitValue} {unitString}",values:{unitValue:convertedValue.unitValue,unitString:convertedValue.unitString}})}}var external_kbnSharedDeps_Moment_=__webpack_require__(17);var external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_);function getFormat(interval,rules=[]){for(let i=rules.length-1;i>=0;i--){const rule=rules[i];if(!rule[0]||interval>=external_kbnSharedDeps_Moment_default.a.duration(rule[0])){return rule[1]}}}function createXaxisFormatter(interval,rules,dateFormat){return val=>{var _getFormat;return external_kbnSharedDeps_Moment_default()(val).format((_getFormat=getFormat(interval,rules))!==null&&_getFormat!==void 0?_getFormat:dateFormat)}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class vis_TimeseriesVisualization extends external_kbnSharedDeps_React_["Component"]{constructor(...args){super(...args);_defineProperty(this,"scaledDataFormat",this.props.getConfig("dateFormat:scaled"));_defineProperty(this,"dateFormat",this.props.getConfig("dateFormat"));_defineProperty(this,"xAxisFormatter",interval=>val=>{const formatter=createXaxisFormatter(interval,this.scaledDataFormat,this.dateFormat);return formatter(val)});_defineProperty(this,"yAxisStackedByPercentFormatter",val=>{const n=Number(val)*100;return`${(Number.isNaN(n)?0:n).toFixed(0)}%`});_defineProperty(this,"applyDocTo",template=>doc=>{const vars=Object(replace_vars["a"])(template,null,doc);if(vars instanceof Error){this.showToastNotification=vars.error.caused_by;return template}return vars});_defineProperty(this,"prepareAnnotations",()=>{const{model:model,visData:visData}=this.props;return Object(external_kbnSharedDeps_Lodash_["map"])(model.annotations,({id:id,color:color,icon:icon,template:template})=>{const annotationData=Object(external_kbnSharedDeps_Lodash_["get"])(visData,`${model.id}.annotations.${id}`,[]);const applyDocToTemplate=this.applyDocTo(template);return{id:id,color:color,icon:icon,data:annotationData.map(({docs:docs,...rest})=>({...rest,docs:docs.map(applyDocToTemplate)}))}})})}componentDidUpdate(){const toastNotifications=Object(services["b"])().notifications.toasts;if(this.showToastNotification&&this.notificationReason!==this.showToastNotification.reason){if(this.notification){toastNotifications.remove(this.notification)}this.notificationReason=this.showToastNotification.reason;this.notification=toastNotifications.addDanger({title:this.showToastNotification.title,text:external_kbnSharedDeps_React_default.a.createElement(public_["MarkdownSimple"],null,this.showToastNotification.reason)})}if(!this.showToastNotification&&this.notification){toastNotifications.remove(this.notification);this.notificationReason=null;this.notification=null}}render(){const{model:model,visData:visData,onBrush:onBrush}=this.props;const series=Object(external_kbnSharedDeps_Lodash_["get"])(visData,`${model.id}.series`,[]);const interval=Object(get_interval["b"])(visData,model);const yAxisIdGenerator=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])("yaxis");const mainAxisGroupId=yAxisIdGenerator("main_group");const seriesModel=model.series.filter(s=>!s.hidden).map(s=>Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(s));const mainAxisScaleType=vis_TimeseriesVisualization.getAxisScaleType(model);const mainAxisDomain=vis_TimeseriesVisualization.getYAxisDomain(model);const yAxis=[];let mainDomainAdded=false;const allSeriesHaveSameFormatters=seriesModel.every(seriesGroup=>seriesGroup.formatter===seriesModel[0].formatter);this.showToastNotification=null;seriesModel.forEach(seriesGroup=>{const isStackedWithinSeries=seriesGroup.stacked===constants["c"].STACKED_WITHIN_SERIES;const hasSeparateAxis=Boolean(seriesGroup.separate_axis);const groupId=hasSeparateAxis||isStackedWithinSeries?seriesGroup.id:mainAxisGroupId;const domain=hasSeparateAxis?vis_TimeseriesVisualization.getYAxisDomain(seriesGroup):undefined;const isCustomDomain=groupId!==mainAxisGroupId;const seriesGroupTickFormatter=vis_TimeseriesVisualization.getTickFormatter(seriesGroup,this.props.getConfig);const yScaleType=hasSeparateAxis?vis_TimeseriesVisualization.getAxisScaleType(seriesGroup):mainAxisScaleType;if(seriesGroup.stacked===constants["c"].PERCENT){seriesGroup.separate_axis=true;seriesGroup.axisFormatter="percent";seriesGroup.axis_min=seriesGroup.axis_min||0;seriesGroup.axis_max=seriesGroup.axis_max||1;seriesGroup.axis_position=model.axis_position}series.filter(r=>Object(external_kbnSharedDeps_Lodash_["startsWith"])(r.id,seriesGroup.id)).forEach(seriesDataRow=>{seriesDataRow.tickFormat=seriesGroupTickFormatter;seriesDataRow.groupId=groupId;seriesDataRow.yScaleType=yScaleType;seriesDataRow.hideInLegend=Boolean(seriesGroup.hide_in_legend)});if(isCustomDomain){vis_TimeseriesVisualization.addYAxis(yAxis,{domain:domain,groupId:groupId,id:yAxisIdGenerator(seriesGroup.id),position:seriesGroup.axis_position,hide:isStackedWithinSeries,tickFormatter:seriesGroup.stacked===constants["c"].PERCENT?this.yAxisStackedByPercentFormatter:seriesGroupTickFormatter})}else if(!mainDomainAdded){vis_TimeseriesVisualization.addYAxis(yAxis,{tickFormatter:allSeriesHaveSameFormatters?seriesGroupTickFormatter:val=>val,id:yAxisIdGenerator("main"),groupId:mainAxisGroupId,position:model.axis_position,domain:mainAxisDomain});mainDomainAdded=true}});return external_kbnSharedDeps_React_default.a.createElement("div",{className:"tvbVis"},external_kbnSharedDeps_React_default.a.createElement(TimeSeries,{series:series,yAxis:yAxis,onBrush:onBrush,backgroundColor:model.background_color,showGrid:Boolean(model.show_grid),legend:Boolean(model.show_legend),legendPosition:model.legend_position,tooltipMode:model.tooltip_mode,xAxisLabel:getAxisLabelString(interval),xAxisFormatter:this.xAxisFormatter(interval),annotations:this.prepareAnnotations()}))}}_defineProperty(vis_TimeseriesVisualization,"getYAxisDomain",model=>{const axisMin=Object(external_kbnSharedDeps_Lodash_["get"])(model,"axis_min","").toString();const axisMax=Object(external_kbnSharedDeps_Lodash_["get"])(model,"axis_max","").toString();const fit=model.series?model.series.filter(({hidden:hidden})=>!hidden).every(({fill:fill})=>fill==="0"):model.fill==="0";return{min:axisMin.length?Number(axisMin):undefined,max:axisMax.length?Number(axisMax):undefined,fit:fit}});_defineProperty(vis_TimeseriesVisualization,"addYAxis",(yAxis,{id:id,groupId:groupId,position:position,tickFormatter:tickFormatter,domain:domain,hide:hide})=>{yAxis.push({id:id,groupId:groupId,position:position,tickFormatter:tickFormatter,domain:domain,hide:hide})});_defineProperty(vis_TimeseriesVisualization,"getAxisScaleType",model=>Object(external_kbnSharedDeps_Lodash_["get"])(model,"axis_scale")==="log"?external_kbnSharedDeps_ElasticCharts_["ScaleType"].Log:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear);_defineProperty(vis_TimeseriesVisualization,"getTickFormatter",(model,getConfig)=>Object(tick_formatter["a"])(Object(external_kbnSharedDeps_Lodash_["get"])(model,"formatter"),Object(external_kbnSharedDeps_Lodash_["get"])(model,"value_template"),getConfig))},44:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return COLORS}));__webpack_require__.d(__webpack_exports__,"b",(function(){return GRID_LINE_CONFIG}));__webpack_require__.d(__webpack_exports__,"e",(function(){return X_ACCESSOR_INDEX}));__webpack_require__.d(__webpack_exports__,"d",(function(){return STACK_ACCESSORS}));__webpack_require__.d(__webpack_exports__,"g",(function(){return Y_ACCESSOR_INDEXES}));__webpack_require__.d(__webpack_exports__,"f",(function(){return Y0_ACCESSOR_INDEXES}));__webpack_require__.d(__webpack_exports__,"c",(function(){return STACKED_OPTIONS}));const COLORS={LINE_COLOR:"rgba(105,112,125,0.2)",TEXT_COLOR:"rgba(0,0,0,0.4)",TEXT_COLOR_REVERSED:"rgba(255,255,255,0.5)",VALUE_COLOR:"rgba(0,0,0,0.7)",VALUE_COLOR_REVERSED:"rgba(255,255,255,0.8)"};const GRID_LINE_CONFIG={stroke:"rgba(125,125,125,0.1)"};const X_ACCESSOR_INDEX=0;const STACK_ACCESSORS=[0];const Y_ACCESSOR_INDEXES=[1];const Y0_ACCESSOR_INDEXES=[2];const STACKED_OPTIONS={NONE:"none",PERCENT:"percent",STACKED:"stacked",STACKED_WITHIN_SERIES:"stacked_within_series"}},45:function(module,__webpack_exports__,__webpack_require__){"use strict";var _chart__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(44);__webpack_require__.d(__webpack_exports__,"a",(function(){return _chart__WEBPACK_IMPORTED_MODULE_0__["b"]}));__webpack_require__.d(__webpack_exports__,"c",(function(){return _chart__WEBPACK_IMPORTED_MODULE_0__["c"]}));__webpack_require__.d(__webpack_exports__,"d",(function(){return _chart__WEBPACK_IMPORTED_MODULE_0__["d"]}));__webpack_require__.d(__webpack_exports__,"e",(function(){return _chart__WEBPACK_IMPORTED_MODULE_0__["e"]}));__webpack_require__.d(__webpack_exports__,"f",(function(){return _chart__WEBPACK_IMPORTED_MODULE_0__["f"]}));__webpack_require__.d(__webpack_exports__,"g",(function(){return _chart__WEBPACK_IMPORTED_MODULE_0__["g"]}));var _icons__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(61);__webpack_require__.d(__webpack_exports__,"b",(function(){return _icons__WEBPACK_IMPORTED_MODULE_1__["a"]}))},57:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return replaceVars}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(31);var lodash__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__);var handlebars_dist_handlebars__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(65);var handlebars_dist_handlebars__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(handlebars_dist_handlebars__WEBPACK_IMPORTED_MODULE_1__);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(3);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__);function replaceVars(str,args={},vars={}){try{const template=handlebars_dist_handlebars__WEBPACK_IMPORTED_MODULE_1___default.a.compile(str,{strict:true,knownHelpersOnly:true});const string=template(lodash__WEBPACK_IMPORTED_MODULE_0___default.a.assign({},vars,{args:args}));return string}catch(e){if(e.toString().indexOf("Parse error")!==-1){return str}else if(e.message.indexOf("not defined in")!==-1){const badVar=e.message.split(/"/)[1];e.error={caused_by:{reason:_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].translate("visTypeTimeseries.replaceVars.errors.unknownVarDescription",{defaultMessage:"{badVar} is an unknown variable",values:{badVar:"{{"+badVar+"}}"}}),title:_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].translate("visTypeTimeseries.replaceVars.errors.unknownVarTitle",{defaultMessage:"Error processing your markdown"})}}}else{e.error={caused_by:{reason:_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].translate("visTypeTimeseries.replaceVars.errors.markdownErrorDescription",{defaultMessage:"Please verify you are only using markdown, known variables, and built-in Handlebars expressions"}),title:_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].translate("visTypeTimeseries.replaceVars.errors.markdownErrorTitle",{defaultMessage:"Error processing your markdown"})}}}return e}}},61:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ICON_TYPES_MAP}));var external_kbnSharedDeps_React_=__webpack_require__(1);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);const bombIcon=()=>external_kbnSharedDeps_React_default.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},external_kbnSharedDeps_React_default.a.createElement("path",{d:"M3.92176768,4.53361616 L3.46466635,5.59664282 L2.65302767,4.14840719 L0.999875397,3.99598886 L2.12641918,2.77654518 L1.76052549,1.15720408 L3.26840652,1.85178207 L4.69542405,1.00339256 L4.500802,2.65210905 L5.74864103,3.7471166 L4.73514583,3.9490388 L5.61669633,5.03766301 C6.0459022,4.69009896 6.67559863,4.75628272 7.02316269,5.18548858 L7.15815921,5.3521954 C7.8837785,5.06498672 8.68754455,4.943927 9.51742529,5.03115098 C12.2637217,5.31979836 14.2560398,7.78010639 13.9673924,10.5264028 C13.6787451,13.2726992 11.218437,15.2650173 8.47214065,14.9763699 C5.72584427,14.6877226 3.73352611,12.2274145 4.02217349,9.48111814 C4.10939747,8.6512374 4.39492411,7.8902053 4.82672133,7.24015658 L4.6917248,7.07344975 C4.34416075,6.64424389 4.41034451,6.01454746 4.83955037,5.6669834 L3.92176768,4.53361616 Z M5.46887076,6.44412936 L6.12580983,7.24015658 C6.03489722,7.30663504 5.87952666,7.491071 5.65969815,7.79346445 C5.30650784,8.32517447 5.08508565,8.93495668 5.01669539,9.5856466 C4.78577748,11.7826837 6.37963201,13.7509301 8.57666912,13.981848 C10.7737062,14.2127659 12.7419526,12.6189114 12.9728706,10.4218743 C13.2037885,8.2248372 11.6099339,6.25659078 9.41289682,6.02567287 C8.7622069,5.95728261 8.11971364,6.04708534 7.52619036,6.28200886 C7.24048061,6.40187373 7.0242157,6.5121707 6.87739563,6.61289978 L6.24601673,5.81480897 L5.46887076,6.44412936 Z M3.34009664,3.61834468 C3.6160708,3.60870745 3.83197954,3.37717367 3.82234231,3.10119951 C3.81270508,2.82522536 3.5811713,2.60931662 3.30519715,2.61895385 C3.02922299,2.62859108 2.81331425,2.86012485 2.82295148,3.13609901 C2.83258871,3.41207317 3.06412249,3.62798191 3.34009664,3.61834468 Z M9.2038399,8.01471666 C8.92921026,7.98585193 8.72997844,7.73982112 8.75884318,7.46519148 C8.78770792,7.19056185 9.03373872,6.99133003 9.30836836,7.02019477 C10.7411945,7.17079087 11.8319627,8.30660625 11.9782919,9.68376241 C11.9842403,9.72621687 11.9855849,9.77015886 11.9808868,9.81485847 C11.9520221,10.0894881 11.7059913,10.2887199 11.4313616,10.2598552 C11.1835304,10.2338071 10.9971003,10.0309074 10.9842889,9.78973323 C10.8859009,8.87197536 10.1588372,8.11509093 9.2038399,8.01471666 Z"}));const fireIcon=()=>external_kbnSharedDeps_React_default.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},external_kbnSharedDeps_React_default.a.createElement("path",{d:"M10.4285489,13.2131862 C11.3850613,12.5116211 12,11.4062861 12,10.1681623 C12,8.88948911 11.7647926,7.64522527 11.315853,6.48027409 L10.7184365,8.07936372 L9.62838732,6.51595716 C8.65161637,5.11502026 7.41222171,3.90368767 5.9820674,2.94508952 C5.99399825,3.12925457 6,3.31436795 6,3.50022638 C6,5.08794888 5.48443413,6.95085436 4.74437685,7.94154468 C4.26219055,8.5870316 4,9.35779518 4,10.1681623 C4,11.4427639 4.65170744,12.5766371 5.65687647,13.2741368 C5.73557697,13.041105 5.84196228,12.8229717 5.97161458,12.624616 C6.26836682,12.1706132 6.5,11.2280234 6.5,10.4287008 C6.5,9.92871906 6.42479348,9.44813694 6.28619258,9 C7.47628141,9.64169048 8.4897566,10.6210605 9.22434324,11.8251557 C9.23213615,11.8013168 9.2406884,11.7775998 9.25,11.7540048 C9.39656041,11.3826304 9.5,11.0805724 9.5,10.6495848 C9.5,10.6240812 9.49971537,10.5986511 9.49914944,10.5732981 C9.96875289,11.3529062 10.2928315,12.2486386 10.4285489,13.2131862 Z M10.4486865,5.94402249 C10.4642723,5.90230435 10.4813768,5.86079967 10.5,5.81950846 C10.7931208,5.16960326 11,4.64100165 11,3.88677339 C11,3.84214218 10.9994307,3.79763944 10.9982989,3.7532716 C12.2630338,5.59045545 13,7.7961396 13,10.1681623 C13,12.8367126 10.7614237,15 8,15 C5.23857625,15 3,12.8367126 3,10.1681623 C3,9.11340491 3.34972471,8.13758287 3.94322917,7.34307798 C4.53673363,6.54857309 5,4.8990409 5,3.50022638 C5,2.62525836 4.84958695,1.78423964 4.57238517,1 C6.95256283,2.12295834 8.97951321,3.83685594 10.4486865,5.94402249 Z"}));const ICON_NAMES={ASTERISK:"fa-asterisk",BELL:"fa-bell",BOLT:"fa-bolt",BOMB:"fa-bomb",BUG:"fa-bug",COMMENT:"fa-comment",EXCLAMATION_CIRCLE:"fa-exclamation-circle",EXCLAMATION_TRIANGLE:"fa-exclamation-triangle",FIRE:"fa-fire",FLAG:"fa-flag",HEART:"fa-heart",MAP_MARKER:"fa-map-marker",MAP_PIN:"fa-map-pin",STAR:"fa-star",TAG:"fa-tag"};const ICON_TYPES_MAP={[ICON_NAMES.ASTERISK]:"asterisk",[ICON_NAMES.BELL]:"bell",[ICON_NAMES.BOLT]:"bolt",[ICON_NAMES.BOMB]:bombIcon,[ICON_NAMES.BUG]:"bug",[ICON_NAMES.COMMENT]:"editorComment",[ICON_NAMES.EXCLAMATION_CIRCLE]:"alert",[ICON_NAMES.EXCLAMATION_TRIANGLE]:"alert",[ICON_NAMES.FIRE]:fireIcon,[ICON_NAMES.FLAG]:"flag",[ICON_NAMES.HEART]:"heart",[ICON_NAMES.MAP_MARKER]:"mapMarker",[ICON_NAMES.MAP_PIN]:"pinFilled",[ICON_NAMES.STAR]:"starFilled",[ICON_NAMES.TAG]:"tag"}},62:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return convertIntervalIntoUnit}));__webpack_require__.d(__webpack_exports__,"d",(function(){return isGteInterval}));__webpack_require__.d(__webpack_exports__,"c",(function(){return isAutoInterval}));__webpack_require__.d(__webpack_exports__,"e",(function(){return validateReInterval}));__webpack_require__.d(__webpack_exports__,"b",(function(){return getInterval}));var moment__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(17);var moment__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_1__);var lodash__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(31);var lodash__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_2__);var _plugins_data_public__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(13);var _plugins_data_public__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__);var _common_interval_regexp__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(15);var _common_constants__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(8);const{parseEsInterval:parseEsInterval}=_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__["search"].aggs;const unitLookup={s:_kbn_i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].translate("visTypeTimeseries.getInterval.secondsLabel",{defaultMessage:"seconds"}),m:_kbn_i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].translate("visTypeTimeseries.getInterval.minutesLabel",{defaultMessage:"minutes"}),h:_kbn_i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].translate("visTypeTimeseries.getInterval.hoursLabel",{defaultMessage:"hours"}),d:_kbn_i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].translate("visTypeTimeseries.getInterval.daysLabel",{defaultMessage:"days"}),w:_kbn_i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].translate("visTypeTimeseries.getInterval.weeksLabel",{defaultMessage:"weeks"}),M:_kbn_i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].translate("visTypeTimeseries.getInterval.monthsLabel",{defaultMessage:"months"}),y:_kbn_i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].translate("visTypeTimeseries.getInterval.yearsLabel",{defaultMessage:"years"})};const convertIntervalIntoUnit=(interval,hasTranslateUnitString=true)=>{const units=Object.keys(unitLookup).reverse();const duration=moment__WEBPACK_IMPORTED_MODULE_0___default.a.duration(interval,"ms");for(let i=0;i<units.length;i++){const as=duration.as(units[i]);if(Math.abs(as)>1){return{unitValue:Math.round(Math.abs(as)),unitString:hasTranslateUnitString?unitLookup[units[i]]:units[i]}}}};const isGteInterval=interval=>_common_interval_regexp__WEBPACK_IMPORTED_MODULE_4__["a"].test(interval);const isAutoInterval=interval=>!interval||interval===_common_constants__WEBPACK_IMPORTED_MODULE_5__["a"];const validateReInterval=intervalValue=>{const validationResult={};try{parseEsInterval(intervalValue)}catch({message:message}){validationResult.errorMessage=message}finally{validationResult.isValid=!validationResult.errorMessage}return validationResult};const getInterval=(visData,model)=>{let series;if(model&&model.type==="table"){series=Object(lodash__WEBPACK_IMPORTED_MODULE_2__["get"])(visData,`series[0].series`,[])}else{series=Object(lodash__WEBPACK_IMPORTED_MODULE_2__["get"])(visData,`${model.id}.series`,[])}return series.reduce((currentInterval,item)=>{if(item.data.length>1){const seriesInterval=item.data[1][0]-item.data[0][0];if(!currentInterval||seriesInterval<currentInterval)return seriesInterval}return currentInterval},0)}},73:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(){"use strict";var hasOwn={}.hasOwnProperty;function classNames(){var classes=[];for(var i=0;i<arguments.length;i++){var arg=arguments[i];if(!arg)continue;var argType=typeof arg;if(argType==="string"||argType==="number"){classes.push(arg)}else if(Array.isArray(arg)&&arg.length){var inner=classNames.apply(null,arg);if(inner){classes.push(inner)}}else if(argType==="object"){for(var key in arg){if(hasOwn.call(arg,key)&&arg[key]){classes.push(key)}}}}return classes.join(" ")}if(true&&module.exports){classNames.default=classNames;module.exports=classNames}else if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return classNames}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}else{}})()}}]);