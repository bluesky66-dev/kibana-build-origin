(window["visDefaultEditor_bundle_jsonpfunction"]=window["visDefaultEditor_bundle_jsonpfunction"]||[]).push([[1],Array(18).concat([function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(15);var useEffectOnce_1=tslib_1.__importDefault(__webpack_require__(22));var useMount=function(fn){useEffectOnce_1.default((function(){fn()}))};exports.default=useMount},function(module,exports,__webpack_require__){"use strict";var isOldIE=function isOldIE(){var memo;return function memorize(){if(typeof memo==="undefined"){memo=Boolean(window&&document&&document.all&&!window.atob)}return memo}}();var getTarget=function getTarget(){var memo={};return function memorize(target){if(typeof memo[target]==="undefined"){var styleTarget=document.querySelector(target);if(window.HTMLIFrameElement&&styleTarget instanceof window.HTMLIFrameElement){try{styleTarget=styleTarget.contentDocument.head}catch(e){styleTarget=null}}memo[target]=styleTarget}return memo[target]}}();var stylesInDom=[];function getIndexByIdentifier(identifier){var result=-1;for(var i=0;i<stylesInDom.length;i++){if(stylesInDom[i].identifier===identifier){result=i;break}}return result}function modulesToDom(list,options){var idCountMap={};var identifiers=[];for(var i=0;i<list.length;i++){var item=list[i];var id=options.base?item[0]+options.base:item[0];var count=idCountMap[id]||0;var identifier="".concat(id," ").concat(count);idCountMap[id]=count+1;var index=getIndexByIdentifier(identifier);var obj={css:item[1],media:item[2],sourceMap:item[3]};if(index!==-1){stylesInDom[index].references++;stylesInDom[index].updater(obj)}else{stylesInDom.push({identifier:identifier,updater:addStyle(obj,options),references:1})}identifiers.push(identifier)}return identifiers}function insertStyleElement(options){var style=document.createElement("style");var attributes=options.attributes||{};if(typeof attributes.nonce==="undefined"){var nonce=true?__webpack_require__.nc:undefined;if(nonce){attributes.nonce=nonce}}Object.keys(attributes).forEach((function(key){style.setAttribute(key,attributes[key])}));if(typeof options.insert==="function"){options.insert(style)}else{var target=getTarget(options.insert||"head");if(!target){throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.")}target.appendChild(style)}return style}function removeStyleElement(style){if(style.parentNode===null){return false}style.parentNode.removeChild(style)}var replaceText=function replaceText(){var textStore=[];return function replace(index,replacement){textStore[index]=replacement;return textStore.filter(Boolean).join("\n")}}();function applyToSingletonTag(style,index,remove,obj){var css=remove?"":obj.media?"@media ".concat(obj.media," {").concat(obj.css,"}"):obj.css;if(style.styleSheet){style.styleSheet.cssText=replaceText(index,css)}else{var cssNode=document.createTextNode(css);var childNodes=style.childNodes;if(childNodes[index]){style.removeChild(childNodes[index])}if(childNodes.length){style.insertBefore(cssNode,childNodes[index])}else{style.appendChild(cssNode)}}}function applyToTag(style,options,obj){var css=obj.css;var media=obj.media;var sourceMap=obj.sourceMap;if(media){style.setAttribute("media",media)}else{style.removeAttribute("media")}if(sourceMap&&btoa){css+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))," */")}if(style.styleSheet){style.styleSheet.cssText=css}else{while(style.firstChild){style.removeChild(style.firstChild)}style.appendChild(document.createTextNode(css))}}var singleton=null;var singletonCounter=0;function addStyle(obj,options){var style;var update;var remove;if(options.singleton){var styleIndex=singletonCounter++;style=singleton||(singleton=insertStyleElement(options));update=applyToSingletonTag.bind(null,style,styleIndex,false);remove=applyToSingletonTag.bind(null,style,styleIndex,true)}else{style=insertStyleElement(options);update=applyToTag.bind(null,style,options);remove=function remove(){removeStyleElement(style)}}update(obj);return function updateStyle(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap){return}update(obj=newObj)}else{remove()}}}module.exports=function(list,options){options=options||{};if(!options.singleton&&typeof options.singleton!=="boolean"){options.singleton=isOldIE()}list=list||[];var lastIdentifiers=modulesToDom(list,options);return function update(newList){newList=newList||[];if(Object.prototype.toString.call(newList)!=="[object Array]"){return}for(var i=0;i<lastIdentifiers.length;i++){var identifier=lastIdentifiers[i];var index=getIndexByIdentifier(identifier);stylesInDom[index].references--}var newLastIdentifiers=modulesToDom(newList,options);for(var _i=0;_i<lastIdentifiers.length;_i++){var _identifier=lastIdentifiers[_i];var _index=getIndexByIdentifier(_identifier);if(stylesInDom[_index].references===0){stylesInDom[_index].updater();stylesInDom.splice(_index,1)}}lastIdentifiers=newLastIdentifiers}}},function(module,exports,__webpack_require__){"use strict";module.exports=function(useSourceMap){var list=[];list.toString=function toString(){return this.map((function(item){var content=cssWithMappingToString(item,useSourceMap);if(item[2]){return"@media ".concat(item[2]," {").concat(content,"}")}return content})).join("")};list.i=function(modules,mediaQuery,dedupe){if(typeof modules==="string"){modules=[[null,modules,""]]}var alreadyImportedModules={};if(dedupe){for(var i=0;i<this.length;i++){var id=this[i][0];if(id!=null){alreadyImportedModules[id]=true}}}for(var _i=0;_i<modules.length;_i++){var item=[].concat(modules[_i]);if(dedupe&&alreadyImportedModules[item[0]]){continue}if(mediaQuery){if(!item[2]){item[2]=mediaQuery}else{item[2]="".concat(mediaQuery," and ").concat(item[2])}}list.push(item)}};return list};function cssWithMappingToString(item,useSourceMap){var content=item[1]||"";var cssMapping=item[3];if(!cssMapping){return content}if(useSourceMap&&typeof btoa==="function"){var sourceMapping=toComment(cssMapping);var sourceURLs=cssMapping.sources.map((function(source){return"/*# sourceURL=".concat(cssMapping.sourceRoot||"").concat(source," */")}));return[content].concat(sourceURLs).concat([sourceMapping]).join("\n")}return[content].join("\n")}function toComment(sourceMap){var base64=btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));var data="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(base64);return"/*# ".concat(data," */")}},function(module,exports,__webpack_require__){ace.define("ace/mode/json_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],(function(acequire,exports,module){"use strict";var oop=acequire("../lib/oop");var TextHighlightRules=acequire("./text_highlight_rules").TextHighlightRules;var JsonHighlightRules=function(){this.$rules={start:[{token:"variable",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]\\s*(?=:)'},{token:"string",regex:'"',next:"string"},{token:"constant.numeric",regex:"0[xX][0-9a-fA-F]+\\b"},{token:"constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"constant.language.boolean",regex:"(?:true|false)\\b"},{token:"text",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"comment",regex:"\\/\\/.*$"},{token:"comment.start",regex:"\\/\\*",next:"comment"},{token:"paren.lparen",regex:"[[({]"},{token:"paren.rparen",regex:"[\\])}]"},{token:"text",regex:"\\s+"}],string:[{token:"constant.language.escape",regex:/\\(?:x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|["\\\/bfnrt])/},{token:"string",regex:'"|$',next:"start"},{defaultToken:"string"}],comment:[{token:"comment.end",regex:"\\*\\/",next:"start"},{defaultToken:"comment"}]}};oop.inherits(JsonHighlightRules,TextHighlightRules);exports.JsonHighlightRules=JsonHighlightRules}));ace.define("ace/mode/matching_brace_outdent",["require","exports","module","ace/range"],(function(acequire,exports,module){"use strict";var Range=acequire("../range").Range;var MatchingBraceOutdent=function(){};(function(){this.checkOutdent=function(line,input){if(!/^\s+$/.test(line))return false;return/^\s*\}/.test(input)};this.autoOutdent=function(doc,row){var line=doc.getLine(row);var match=line.match(/^(\s*\})/);if(!match)return 0;var column=match[1].length;var openBracePos=doc.findMatchingBracket({row:row,column:column});if(!openBracePos||openBracePos.row==row)return 0;var indent=this.$getIndent(doc.getLine(openBracePos.row));doc.replace(new Range(row,0,row,column-1),indent)};this.$getIndent=function(line){return line.match(/^\s*/)[0]}}).call(MatchingBraceOutdent.prototype);exports.MatchingBraceOutdent=MatchingBraceOutdent}));ace.define("ace/mode/folding/cstyle",["require","exports","module","ace/lib/oop","ace/range","ace/mode/folding/fold_mode"],(function(acequire,exports,module){"use strict";var oop=acequire("../../lib/oop");var Range=acequire("../../range").Range;var BaseFoldMode=acequire("./fold_mode").FoldMode;var FoldMode=exports.FoldMode=function(commentRegex){if(commentRegex){this.foldingStartMarker=new RegExp(this.foldingStartMarker.source.replace(/\|[^|]*?$/,"|"+commentRegex.start));this.foldingStopMarker=new RegExp(this.foldingStopMarker.source.replace(/\|[^|]*?$/,"|"+commentRegex.end))}};oop.inherits(FoldMode,BaseFoldMode);(function(){this.foldingStartMarker=/([\{\[\(])[^\}\]\)]*$|^\s*(\/\*)/;this.foldingStopMarker=/^[^\[\{\(]*([\}\]\)])|^[\s\*]*(\*\/)/;this.singleLineBlockCommentRe=/^\s*(\/\*).*\*\/\s*$/;this.tripleStarBlockCommentRe=/^\s*(\/\*\*\*).*\*\/\s*$/;this.startRegionRe=/^\s*(\/\*|\/\/)#?region\b/;this._getFoldWidgetBase=this.getFoldWidget;this.getFoldWidget=function(session,foldStyle,row){var line=session.getLine(row);if(this.singleLineBlockCommentRe.test(line)){if(!this.startRegionRe.test(line)&&!this.tripleStarBlockCommentRe.test(line))return""}var fw=this._getFoldWidgetBase(session,foldStyle,row);if(!fw&&this.startRegionRe.test(line))return"start";return fw};this.getFoldWidgetRange=function(session,foldStyle,row,forceMultiline){var line=session.getLine(row);if(this.startRegionRe.test(line))return this.getCommentRegionBlock(session,line,row);var match=line.match(this.foldingStartMarker);if(match){var i=match.index;if(match[1])return this.openingBracketBlock(session,match[1],row,i);var range=session.getCommentFoldRange(row,i+match[0].length,1);if(range&&!range.isMultiLine()){if(forceMultiline){range=this.getSectionRange(session,row)}else if(foldStyle!="all")range=null}return range}if(foldStyle==="markbegin")return;var match=line.match(this.foldingStopMarker);if(match){var i=match.index+match[0].length;if(match[1])return this.closingBracketBlock(session,match[1],row,i);return session.getCommentFoldRange(row,i,-1)}};this.getSectionRange=function(session,row){var line=session.getLine(row);var startIndent=line.search(/\S/);var startRow=row;var startColumn=line.length;row=row+1;var endRow=row;var maxRow=session.getLength();while(++row<maxRow){line=session.getLine(row);var indent=line.search(/\S/);if(indent===-1)continue;if(startIndent>indent)break;var subRange=this.getFoldWidgetRange(session,"all",row);if(subRange){if(subRange.start.row<=startRow){break}else if(subRange.isMultiLine()){row=subRange.end.row}else if(startIndent==indent){break}}endRow=row}return new Range(startRow,startColumn,endRow,session.getLine(endRow).length)};this.getCommentRegionBlock=function(session,line,row){var startColumn=line.search(/\s*$/);var maxRow=session.getLength();var startRow=row;var re=/^\s*(?:\/\*|\/\/|--)#?(end)?region\b/;var depth=1;while(++row<maxRow){line=session.getLine(row);var m=re.exec(line);if(!m)continue;if(m[1])depth--;else depth++;if(!depth)break}var endRow=row;if(endRow>startRow){return new Range(startRow,startColumn,endRow,line.length)}}}).call(FoldMode.prototype)}));ace.define("ace/mode/json",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/json_highlight_rules","ace/mode/matching_brace_outdent","ace/mode/behaviour/cstyle","ace/mode/folding/cstyle","ace/worker/worker_client"],(function(acequire,exports,module){"use strict";var oop=acequire("../lib/oop");var TextMode=acequire("./text").Mode;var HighlightRules=acequire("./json_highlight_rules").JsonHighlightRules;var MatchingBraceOutdent=acequire("./matching_brace_outdent").MatchingBraceOutdent;var CstyleBehaviour=acequire("./behaviour/cstyle").CstyleBehaviour;var CStyleFoldMode=acequire("./folding/cstyle").FoldMode;var WorkerClient=acequire("../worker/worker_client").WorkerClient;var Mode=function(){this.HighlightRules=HighlightRules;this.$outdent=new MatchingBraceOutdent;this.$behaviour=new CstyleBehaviour;this.foldingRules=new CStyleFoldMode};oop.inherits(Mode,TextMode);(function(){this.getNextLineIndent=function(state,line,tab){var indent=this.$getIndent(line);if(state=="start"){var match=line.match(/^.*[\{\(\[]\s*$/);if(match){indent+=tab}}return indent};this.checkOutdent=function(state,line,input){return this.$outdent.checkOutdent(line,input)};this.autoOutdent=function(state,doc,row){this.$outdent.autoOutdent(doc,row)};this.createWorker=function(session){var worker=new WorkerClient(["ace"],__webpack_require__(32),"JsonWorker");worker.attachToDocument(session.getDocument());worker.on("annotate",(function(e){session.setAnnotations(e.data)}));worker.on("terminate",(function(){session.clearAnnotations()}));return worker};this.$id="ace/mode/json"}).call(Mode.prototype);exports.Mode=Mode}))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var react_1=__webpack_require__(0);var useEffectOnce=function(effect){react_1.useEffect(effect,[])};exports.default=useEffectOnce},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(24);case"v7light":return __webpack_require__(26);case"v8dark":return __webpack_require__(28);case"v8light":return __webpack_require__(30)}},function(module,exports,__webpack_require__){var api=__webpack_require__(19);var content=__webpack_require__(25);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(20);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visEditor--default {\n  flex: 1 1 auto;\n  display: flex; }\n  @media only screen and (max-width: 574px) {\n    .visEditor--default {\n      flex-direction: column; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor--default {\n      flex-direction: column; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor--default {\n      flex-direction: column; } }\n\n/**\n * Collapsible sidebar container\n */\n.visEditor__collapsibleSidebar {\n  background: #25262E;\n  min-width: 350px;\n  max-width: 100%;\n  position: relative;\n  flex-shrink: 0; }\n  @media only screen and (max-width: 574px) {\n    .visEditor__collapsibleSidebar {\n      width: 100% !important; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor__collapsibleSidebar {\n      width: 100% !important; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor__collapsibleSidebar {\n      width: 100% !important; } }\n  @media only screen and (min-width: 992px) and (max-width: 1199px) {\n    .visEditor__collapsibleSidebar {\n      max-width: 75%; } }\n  @media only screen and (min-width: 1200px) {\n    .visEditor__collapsibleSidebar {\n      max-width: 75%; } }\n\n.visEditor__collapsibleSidebar-isClosed {\n  min-width: 0;\n  width: 32px !important; }\n  .visEditor__collapsibleSidebar-isClosed .visEditorSidebar {\n    display: none; }\n  @media only screen and (max-width: 574px) {\n    .visEditor__collapsibleSidebar-isClosed {\n      height: 40px;\n      width: 100% !important; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor__collapsibleSidebar-isClosed {\n      height: 40px;\n      width: 100% !important; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor__collapsibleSidebar-isClosed {\n      height: 40px;\n      width: 100% !important; } }\n\n.visEditor__collapsibleSidebarButton {\n  position: absolute;\n  right: 4px;\n  top: 8px; }\n\n/**\n * Resizer\n */\n.visEditor__resizer {\n  position: relative;\n  display: flex;\n  flex: 0 0 12px;\n  background-color: #1a1b20;\n  align-items: center;\n  justify-content: center;\n  margin: 0;\n  -webkit-user-select: none;\n          user-select: none;\n  width: 12px; }\n  .visEditor__resizer:hover {\n    background-color: #0b4462; }\n  .visEditor__resizer:focus, .visEditor__resizer.active {\n    background-color: #1BA9F5;\n    color: #1D1E24; }\n  .visEditor__resizer::after {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    cursor: ew-resize; }\n  @media only screen and (max-width: 574px) {\n    .visEditor__resizer {\n      display: none; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor__resizer {\n      display: none; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor__resizer {\n      display: none; } }\n\n.visEditor__resizer-isHidden {\n  display: none; }\n\n/**\n * Canvas area\n */\n.visEditor__visualization {\n  display: flex;\n  flex: 1 1 auto;\n  overflow: hidden; }\n  @media only screen and (max-width: 574px) {\n    .visEditor__visualization {\n      width: 100% !important; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor__visualization {\n      width: 100% !important; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor__visualization {\n      width: 100% !important; } }\n\n.visEditor__canvas {\n  background-color: #1D1E24;\n  display: flex;\n  flex-direction: row;\n  overflow: auto;\n  flex-shrink: 1;\n  flex-basis: 100%; }\n  .visEditor__canvas.embedded {\n    flex-shrink: 1;\n    flex-basis: 100%; }\n  .visEditor__canvas .visualize {\n    display: flex;\n    flex-direction: column;\n    flex: 1 1 100%; }\n  .visEditor__canvas .visChart {\n    position: relative; }\n\n.visEditorSidebar {\n  min-width: 350px; }\n  .visEditorSidebar > .visEditorSidebar__formWrapper {\n    flex-basis: auto; }\n\n.visEditorSidebar__form {\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n  max-width: 100%; }\n  .visEditorSidebar__form > * {\n    flex-shrink: 0; }\n\n.visEditorSidebar__config {\n  padding: 8px; }\n  .visEditorSidebar__config > * {\n    flex-grow: 0; }\n  @media only screen and (min-width: 992px) and (max-width: 1199px) {\n    .visEditorSidebar__config {\n      flex: 1 1 1px;\n      display: flex;\n      flex-direction: column;\n      scrollbar-width: thin;\n      overflow: auto; }\n      .visEditorSidebar__config > * {\n        flex-shrink: 0; }\n      .visEditorSidebar__config::-webkit-scrollbar {\n        width: 16px;\n        height: 16px; }\n      .visEditorSidebar__config::-webkit-scrollbar-thumb {\n        background-color: rgba(152, 162, 179, 0.5);\n        border: 6px solid transparent;\n        background-clip: content-box; }\n      .visEditorSidebar__config::-webkit-scrollbar-corner, .visEditorSidebar__config::-webkit-scrollbar-track {\n        background-color: transparent; } }\n  @media only screen and (min-width: 1200px) {\n    .visEditorSidebar__config {\n      flex: 1 1 1px;\n      display: flex;\n      flex-direction: column;\n      scrollbar-width: thin;\n      overflow: auto; }\n      .visEditorSidebar__config > * {\n        flex-shrink: 0; }\n      .visEditorSidebar__config::-webkit-scrollbar {\n        width: 16px;\n        height: 16px; }\n      .visEditorSidebar__config::-webkit-scrollbar-thumb {\n        background-color: rgba(152, 162, 179, 0.5);\n        border: 6px solid transparent;\n        background-clip: content-box; }\n      .visEditorSidebar__config::-webkit-scrollbar-corner, .visEditorSidebar__config::-webkit-scrollbar-track {\n        background-color: transparent; } }\n\n.visEditorSidebar__config-isHidden {\n  display: none; }\n\n.visEditorSidebar__titleContainer {\n  padding: 8px 32px 8px 8px; }\n\n.visEditorSidebar__indexPatternPlaceholder {\n  min-height: 40px;\n  border-bottom: 1px solid #343741; }\n\n.visEditorSidebar__nav,\n.visEditorSidebar__linkedSearch {\n  flex-grow: 0; }\n\n.visEditorSidebar__section {\n  background-color: #1D1E24;\n  padding: 8px;\n  border-radius: 4px; }\n  .visEditorSidebar__section + .visEditorSidebar__section {\n    margin-top: 8px; }\n\n.visEditorSidebar__collapsible {\n  background-color: #25262E; }\n\n.visEditorSidebar__collapsible--marginBottom {\n  margin-bottom: 12px; }\n\n.visEditorSidebar__formRow {\n  display: flex;\n  align-items: center;\n  margin-top: 12px; }\n\n.visEditorSidebar__formLabel {\n  display: flex;\n  align-items: center;\n  flex: 1 1 40%;\n  padding-right: 4px; }\n\n.visEditorSidebar__formControl {\n  display: flex;\n  align-items: center;\n  flex: 1 1 60%; }\n\n.visEditorSidebar__aggGroupAccordionButtonContent {\n  font-size: 14px; }\n  .visEditorSidebar__aggGroupAccordionButtonContent span {\n    color: #98A2B3; }\n\n.visEditorSidebar__controls {\n  border-top: 1px solid #343741;\n  padding: 8px;\n  display: flex;\n  justify-content: flex-end;\n  align-items: center; }\n  .visEditorSidebar__controls .visEditorSidebar__autoApplyButton {\n    margin-left: 12px; }\n\n.visEditorAgg__subAgg {\n  border: 2px solid #343741;\n  border-radius: 4px;\n  background-color: transparent;\n  padding: 8px; }\n\n.visEditorAgg__subAgg + .visEditorAggParam__string {\n  margin-top: 16px; }\n\n.visEditorAggParam--half {\n  margin: 16px 0;\n  display: inline-block;\n  width: calc(50% - 4px); }\n\n.visEditorAggParam--half-size {\n  margin-left: 8px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(19);var content=__webpack_require__(27);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(20);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visEditor--default {\n  flex: 1 1 auto;\n  display: flex; }\n  @media only screen and (max-width: 574px) {\n    .visEditor--default {\n      flex-direction: column; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor--default {\n      flex-direction: column; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor--default {\n      flex-direction: column; } }\n\n/**\n * Collapsible sidebar container\n */\n.visEditor__collapsibleSidebar {\n  background: #F5F7FA;\n  min-width: 350px;\n  max-width: 100%;\n  position: relative;\n  flex-shrink: 0; }\n  @media only screen and (max-width: 574px) {\n    .visEditor__collapsibleSidebar {\n      width: 100% !important; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor__collapsibleSidebar {\n      width: 100% !important; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor__collapsibleSidebar {\n      width: 100% !important; } }\n  @media only screen and (min-width: 992px) and (max-width: 1199px) {\n    .visEditor__collapsibleSidebar {\n      max-width: 75%; } }\n  @media only screen and (min-width: 1200px) {\n    .visEditor__collapsibleSidebar {\n      max-width: 75%; } }\n\n.visEditor__collapsibleSidebar-isClosed {\n  min-width: 0;\n  width: 32px !important; }\n  .visEditor__collapsibleSidebar-isClosed .visEditorSidebar {\n    display: none; }\n  @media only screen and (max-width: 574px) {\n    .visEditor__collapsibleSidebar-isClosed {\n      height: 40px;\n      width: 100% !important; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor__collapsibleSidebar-isClosed {\n      height: 40px;\n      width: 100% !important; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor__collapsibleSidebar-isClosed {\n      height: 40px;\n      width: 100% !important; } }\n\n.visEditor__collapsibleSidebarButton {\n  position: absolute;\n  right: 4px;\n  top: 8px; }\n\n/**\n * Resizer\n */\n.visEditor__resizer {\n  position: relative;\n  display: flex;\n  flex: 0 0 12px;\n  background-color: #fafbfd;\n  align-items: center;\n  justify-content: center;\n  margin: 0;\n  -webkit-user-select: none;\n          user-select: none;\n  width: 12px; }\n  .visEditor__resizer:hover {\n    background-color: #cce1f0; }\n  .visEditor__resizer:focus, .visEditor__resizer.active {\n    background-color: #006BB4;\n    color: #FFF; }\n  .visEditor__resizer::after {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    cursor: ew-resize; }\n  @media only screen and (max-width: 574px) {\n    .visEditor__resizer {\n      display: none; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor__resizer {\n      display: none; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor__resizer {\n      display: none; } }\n\n.visEditor__resizer-isHidden {\n  display: none; }\n\n/**\n * Canvas area\n */\n.visEditor__visualization {\n  display: flex;\n  flex: 1 1 auto;\n  overflow: hidden; }\n  @media only screen and (max-width: 574px) {\n    .visEditor__visualization {\n      width: 100% !important; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor__visualization {\n      width: 100% !important; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor__visualization {\n      width: 100% !important; } }\n\n.visEditor__canvas {\n  background-color: #FFF;\n  display: flex;\n  flex-direction: row;\n  overflow: auto;\n  flex-shrink: 1;\n  flex-basis: 100%; }\n  .visEditor__canvas.embedded {\n    flex-shrink: 1;\n    flex-basis: 100%; }\n  .visEditor__canvas .visualize {\n    display: flex;\n    flex-direction: column;\n    flex: 1 1 100%; }\n  .visEditor__canvas .visChart {\n    position: relative; }\n\n.visEditorSidebar {\n  min-width: 350px; }\n  .visEditorSidebar > .visEditorSidebar__formWrapper {\n    flex-basis: auto; }\n\n.visEditorSidebar__form {\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n  max-width: 100%; }\n  .visEditorSidebar__form > * {\n    flex-shrink: 0; }\n\n.visEditorSidebar__config {\n  padding: 8px; }\n  .visEditorSidebar__config > * {\n    flex-grow: 0; }\n  @media only screen and (min-width: 992px) and (max-width: 1199px) {\n    .visEditorSidebar__config {\n      flex: 1 1 1px;\n      display: flex;\n      flex-direction: column;\n      scrollbar-width: thin;\n      overflow: auto; }\n      .visEditorSidebar__config > * {\n        flex-shrink: 0; }\n      .visEditorSidebar__config::-webkit-scrollbar {\n        width: 16px;\n        height: 16px; }\n      .visEditorSidebar__config::-webkit-scrollbar-thumb {\n        background-color: rgba(105, 112, 125, 0.5);\n        border: 6px solid transparent;\n        background-clip: content-box; }\n      .visEditorSidebar__config::-webkit-scrollbar-corner, .visEditorSidebar__config::-webkit-scrollbar-track {\n        background-color: transparent; } }\n  @media only screen and (min-width: 1200px) {\n    .visEditorSidebar__config {\n      flex: 1 1 1px;\n      display: flex;\n      flex-direction: column;\n      scrollbar-width: thin;\n      overflow: auto; }\n      .visEditorSidebar__config > * {\n        flex-shrink: 0; }\n      .visEditorSidebar__config::-webkit-scrollbar {\n        width: 16px;\n        height: 16px; }\n      .visEditorSidebar__config::-webkit-scrollbar-thumb {\n        background-color: rgba(105, 112, 125, 0.5);\n        border: 6px solid transparent;\n        background-clip: content-box; }\n      .visEditorSidebar__config::-webkit-scrollbar-corner, .visEditorSidebar__config::-webkit-scrollbar-track {\n        background-color: transparent; } }\n\n.visEditorSidebar__config-isHidden {\n  display: none; }\n\n.visEditorSidebar__titleContainer {\n  padding: 8px 32px 8px 8px; }\n\n.visEditorSidebar__indexPatternPlaceholder {\n  min-height: 40px;\n  border-bottom: 1px solid #D3DAE6; }\n\n.visEditorSidebar__nav,\n.visEditorSidebar__linkedSearch {\n  flex-grow: 0; }\n\n.visEditorSidebar__section {\n  background-color: #FFF;\n  padding: 8px;\n  border-radius: 4px; }\n  .visEditorSidebar__section + .visEditorSidebar__section {\n    margin-top: 8px; }\n\n.visEditorSidebar__collapsible {\n  background-color: #fafbfd; }\n\n.visEditorSidebar__collapsible--marginBottom {\n  margin-bottom: 12px; }\n\n.visEditorSidebar__formRow {\n  display: flex;\n  align-items: center;\n  margin-top: 12px; }\n\n.visEditorSidebar__formLabel {\n  display: flex;\n  align-items: center;\n  flex: 1 1 40%;\n  padding-right: 4px; }\n\n.visEditorSidebar__formControl {\n  display: flex;\n  align-items: center;\n  flex: 1 1 60%; }\n\n.visEditorSidebar__aggGroupAccordionButtonContent {\n  font-size: 14px; }\n  .visEditorSidebar__aggGroupAccordionButtonContent span {\n    color: #69707D; }\n\n.visEditorSidebar__controls {\n  border-top: 1px solid #D3DAE6;\n  padding: 8px;\n  display: flex;\n  justify-content: flex-end;\n  align-items: center; }\n  .visEditorSidebar__controls .visEditorSidebar__autoApplyButton {\n    margin-left: 12px; }\n\n.visEditorAgg__subAgg {\n  border: 2px solid #D3DAE6;\n  border-radius: 4px;\n  background-color: transparent;\n  padding: 8px; }\n\n.visEditorAgg__subAgg + .visEditorAggParam__string {\n  margin-top: 16px; }\n\n.visEditorAggParam--half {\n  margin: 16px 0;\n  display: inline-block;\n  width: calc(50% - 4px); }\n\n.visEditorAggParam--half-size {\n  margin-left: 8px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(19);var content=__webpack_require__(29);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(20);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visEditor--default {\n  flex: 1 1 auto;\n  display: flex; }\n  @media only screen and (max-width: 574px) {\n    .visEditor--default {\n      flex-direction: column; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor--default {\n      flex-direction: column; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor--default {\n      flex-direction: column; } }\n\n/**\n * Collapsible sidebar container\n */\n.visEditor__collapsibleSidebar {\n  background: #25262E;\n  min-width: 350px;\n  max-width: 100%;\n  position: relative;\n  flex-shrink: 0; }\n  @media only screen and (max-width: 574px) {\n    .visEditor__collapsibleSidebar {\n      width: 100% !important; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor__collapsibleSidebar {\n      width: 100% !important; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor__collapsibleSidebar {\n      width: 100% !important; } }\n  @media only screen and (min-width: 992px) and (max-width: 1199px) {\n    .visEditor__collapsibleSidebar {\n      max-width: 75%; } }\n  @media only screen and (min-width: 1200px) {\n    .visEditor__collapsibleSidebar {\n      max-width: 75%; } }\n\n.visEditor__collapsibleSidebar-isClosed {\n  min-width: 0;\n  width: 32px !important; }\n  .visEditor__collapsibleSidebar-isClosed .visEditorSidebar {\n    display: none; }\n  @media only screen and (max-width: 574px) {\n    .visEditor__collapsibleSidebar-isClosed {\n      height: 40px;\n      width: 100% !important; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor__collapsibleSidebar-isClosed {\n      height: 40px;\n      width: 100% !important; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor__collapsibleSidebar-isClosed {\n      height: 40px;\n      width: 100% !important; } }\n\n.visEditor__collapsibleSidebarButton {\n  position: absolute;\n  right: 4px;\n  top: 8px; }\n\n/**\n * Resizer\n */\n.visEditor__resizer {\n  position: relative;\n  display: flex;\n  flex: 0 0 12px;\n  background-color: #1a1b20;\n  align-items: center;\n  justify-content: center;\n  margin: 0;\n  -webkit-user-select: none;\n          user-select: none;\n  width: 12px; }\n  .visEditor__resizer:hover {\n    background-color: #164160; }\n  .visEditor__resizer:focus, .visEditor__resizer.active {\n    background-color: #36A2EF;\n    color: #1D1E24; }\n  .visEditor__resizer::after {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    cursor: ew-resize; }\n  @media only screen and (max-width: 574px) {\n    .visEditor__resizer {\n      display: none; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor__resizer {\n      display: none; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor__resizer {\n      display: none; } }\n\n.visEditor__resizer-isHidden {\n  display: none; }\n\n/**\n * Canvas area\n */\n.visEditor__visualization {\n  display: flex;\n  flex: 1 1 auto;\n  overflow: hidden; }\n  @media only screen and (max-width: 574px) {\n    .visEditor__visualization {\n      width: 100% !important; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor__visualization {\n      width: 100% !important; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor__visualization {\n      width: 100% !important; } }\n\n.visEditor__canvas {\n  background-color: #1D1E24;\n  display: flex;\n  flex-direction: row;\n  overflow: auto;\n  flex-shrink: 1;\n  flex-basis: 100%; }\n  .visEditor__canvas.embedded {\n    flex-shrink: 1;\n    flex-basis: 100%; }\n  .visEditor__canvas .visualize {\n    display: flex;\n    flex-direction: column;\n    flex: 1 1 100%; }\n  .visEditor__canvas .visChart {\n    position: relative; }\n\n.visEditorSidebar {\n  min-width: 350px; }\n  .visEditorSidebar > .visEditorSidebar__formWrapper {\n    flex-basis: auto; }\n\n.visEditorSidebar__form {\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n  max-width: 100%; }\n  .visEditorSidebar__form > * {\n    flex-shrink: 0; }\n\n.visEditorSidebar__config {\n  padding: 8px; }\n  .visEditorSidebar__config > * {\n    flex-grow: 0; }\n  @media only screen and (min-width: 992px) and (max-width: 1199px) {\n    .visEditorSidebar__config {\n      flex: 1 1 1px;\n      display: flex;\n      flex-direction: column;\n      scrollbar-width: thin;\n      overflow: auto; }\n      .visEditorSidebar__config > * {\n        flex-shrink: 0; }\n      .visEditorSidebar__config::-webkit-scrollbar {\n        width: 16px;\n        height: 16px; }\n      .visEditorSidebar__config::-webkit-scrollbar-thumb {\n        background-color: rgba(152, 162, 179, 0.5);\n        border: 6px solid transparent;\n        background-clip: content-box; }\n      .visEditorSidebar__config::-webkit-scrollbar-corner, .visEditorSidebar__config::-webkit-scrollbar-track {\n        background-color: transparent; } }\n  @media only screen and (min-width: 1200px) {\n    .visEditorSidebar__config {\n      flex: 1 1 1px;\n      display: flex;\n      flex-direction: column;\n      scrollbar-width: thin;\n      overflow: auto; }\n      .visEditorSidebar__config > * {\n        flex-shrink: 0; }\n      .visEditorSidebar__config::-webkit-scrollbar {\n        width: 16px;\n        height: 16px; }\n      .visEditorSidebar__config::-webkit-scrollbar-thumb {\n        background-color: rgba(152, 162, 179, 0.5);\n        border: 6px solid transparent;\n        background-clip: content-box; }\n      .visEditorSidebar__config::-webkit-scrollbar-corner, .visEditorSidebar__config::-webkit-scrollbar-track {\n        background-color: transparent; } }\n\n.visEditorSidebar__config-isHidden {\n  display: none; }\n\n.visEditorSidebar__titleContainer {\n  padding: 8px 32px 8px 8px; }\n\n.visEditorSidebar__indexPatternPlaceholder {\n  min-height: 40px;\n  border-bottom: 1px solid #343741; }\n\n.visEditorSidebar__nav,\n.visEditorSidebar__linkedSearch {\n  flex-grow: 0; }\n\n.visEditorSidebar__section {\n  background-color: #1D1E24;\n  padding: 8px;\n  border-radius: 6px; }\n  .visEditorSidebar__section + .visEditorSidebar__section {\n    margin-top: 8px; }\n\n.visEditorSidebar__collapsible {\n  background-color: #25262E; }\n\n.visEditorSidebar__collapsible--marginBottom {\n  margin-bottom: 12px; }\n\n.visEditorSidebar__formRow {\n  display: flex;\n  align-items: center;\n  margin-top: 12px; }\n\n.visEditorSidebar__formLabel {\n  display: flex;\n  align-items: center;\n  flex: 1 1 40%;\n  padding-right: 4px; }\n\n.visEditorSidebar__formControl {\n  display: flex;\n  align-items: center;\n  flex: 1 1 60%; }\n\n.visEditorSidebar__aggGroupAccordionButtonContent {\n  font-size: 14px; }\n  .visEditorSidebar__aggGroupAccordionButtonContent span {\n    color: #98A2B3; }\n\n.visEditorSidebar__controls {\n  border-top: 1px solid #343741;\n  padding: 8px;\n  display: flex;\n  justify-content: flex-end;\n  align-items: center; }\n  .visEditorSidebar__controls .visEditorSidebar__autoApplyButton {\n    margin-left: 12px; }\n\n.visEditorAgg__subAgg {\n  border: 2px solid #343741;\n  border-radius: 6px;\n  background-color: transparent;\n  padding: 8px; }\n\n.visEditorAgg__subAgg + .visEditorAggParam__string {\n  margin-top: 16px; }\n\n.visEditorAggParam--half {\n  margin: 16px 0;\n  display: inline-block;\n  width: calc(50% - 4px); }\n\n.visEditorAggParam--half-size {\n  margin-left: 8px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(19);var content=__webpack_require__(31);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(20);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".visEditor--default {\n  flex: 1 1 auto;\n  display: flex; }\n  @media only screen and (max-width: 574px) {\n    .visEditor--default {\n      flex-direction: column; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor--default {\n      flex-direction: column; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor--default {\n      flex-direction: column; } }\n\n/**\n * Collapsible sidebar container\n */\n.visEditor__collapsibleSidebar {\n  background: #F5F7FA;\n  min-width: 350px;\n  max-width: 100%;\n  position: relative;\n  flex-shrink: 0; }\n  @media only screen and (max-width: 574px) {\n    .visEditor__collapsibleSidebar {\n      width: 100% !important; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor__collapsibleSidebar {\n      width: 100% !important; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor__collapsibleSidebar {\n      width: 100% !important; } }\n  @media only screen and (min-width: 992px) and (max-width: 1199px) {\n    .visEditor__collapsibleSidebar {\n      max-width: 75%; } }\n  @media only screen and (min-width: 1200px) {\n    .visEditor__collapsibleSidebar {\n      max-width: 75%; } }\n\n.visEditor__collapsibleSidebar-isClosed {\n  min-width: 0;\n  width: 32px !important; }\n  .visEditor__collapsibleSidebar-isClosed .visEditorSidebar {\n    display: none; }\n  @media only screen and (max-width: 574px) {\n    .visEditor__collapsibleSidebar-isClosed {\n      height: 40px;\n      width: 100% !important; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor__collapsibleSidebar-isClosed {\n      height: 40px;\n      width: 100% !important; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor__collapsibleSidebar-isClosed {\n      height: 40px;\n      width: 100% !important; } }\n\n.visEditor__collapsibleSidebarButton {\n  position: absolute;\n  right: 4px;\n  top: 8px; }\n\n/**\n * Resizer\n */\n.visEditor__resizer {\n  position: relative;\n  display: flex;\n  flex: 0 0 12px;\n  background-color: #fafbfd;\n  align-items: center;\n  justify-content: center;\n  margin: 0;\n  -webkit-user-select: none;\n          user-select: none;\n  width: 12px; }\n  .visEditor__resizer:hover {\n    background-color: #cce4f5; }\n  .visEditor__resizer:focus, .visEditor__resizer.active {\n    background-color: #07C;\n    color: #FFF; }\n  .visEditor__resizer::after {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    cursor: ew-resize; }\n  @media only screen and (max-width: 574px) {\n    .visEditor__resizer {\n      display: none; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor__resizer {\n      display: none; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor__resizer {\n      display: none; } }\n\n.visEditor__resizer-isHidden {\n  display: none; }\n\n/**\n * Canvas area\n */\n.visEditor__visualization {\n  display: flex;\n  flex: 1 1 auto;\n  overflow: hidden; }\n  @media only screen and (max-width: 574px) {\n    .visEditor__visualization {\n      width: 100% !important; } }\n  @media only screen and (min-width: 575px) and (max-width: 767px) {\n    .visEditor__visualization {\n      width: 100% !important; } }\n  @media only screen and (min-width: 768px) and (max-width: 991px) {\n    .visEditor__visualization {\n      width: 100% !important; } }\n\n.visEditor__canvas {\n  background-color: #FFF;\n  display: flex;\n  flex-direction: row;\n  overflow: auto;\n  flex-shrink: 1;\n  flex-basis: 100%; }\n  .visEditor__canvas.embedded {\n    flex-shrink: 1;\n    flex-basis: 100%; }\n  .visEditor__canvas .visualize {\n    display: flex;\n    flex-direction: column;\n    flex: 1 1 100%; }\n  .visEditor__canvas .visChart {\n    position: relative; }\n\n.visEditorSidebar {\n  min-width: 350px; }\n  .visEditorSidebar > .visEditorSidebar__formWrapper {\n    flex-basis: auto; }\n\n.visEditorSidebar__form {\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n  max-width: 100%; }\n  .visEditorSidebar__form > * {\n    flex-shrink: 0; }\n\n.visEditorSidebar__config {\n  padding: 8px; }\n  .visEditorSidebar__config > * {\n    flex-grow: 0; }\n  @media only screen and (min-width: 992px) and (max-width: 1199px) {\n    .visEditorSidebar__config {\n      flex: 1 1 1px;\n      display: flex;\n      flex-direction: column;\n      scrollbar-width: thin;\n      overflow: auto; }\n      .visEditorSidebar__config > * {\n        flex-shrink: 0; }\n      .visEditorSidebar__config::-webkit-scrollbar {\n        width: 16px;\n        height: 16px; }\n      .visEditorSidebar__config::-webkit-scrollbar-thumb {\n        background-color: rgba(105, 112, 125, 0.5);\n        border: 6px solid transparent;\n        background-clip: content-box; }\n      .visEditorSidebar__config::-webkit-scrollbar-corner, .visEditorSidebar__config::-webkit-scrollbar-track {\n        background-color: transparent; } }\n  @media only screen and (min-width: 1200px) {\n    .visEditorSidebar__config {\n      flex: 1 1 1px;\n      display: flex;\n      flex-direction: column;\n      scrollbar-width: thin;\n      overflow: auto; }\n      .visEditorSidebar__config > * {\n        flex-shrink: 0; }\n      .visEditorSidebar__config::-webkit-scrollbar {\n        width: 16px;\n        height: 16px; }\n      .visEditorSidebar__config::-webkit-scrollbar-thumb {\n        background-color: rgba(105, 112, 125, 0.5);\n        border: 6px solid transparent;\n        background-clip: content-box; }\n      .visEditorSidebar__config::-webkit-scrollbar-corner, .visEditorSidebar__config::-webkit-scrollbar-track {\n        background-color: transparent; } }\n\n.visEditorSidebar__config-isHidden {\n  display: none; }\n\n.visEditorSidebar__titleContainer {\n  padding: 8px 32px 8px 8px; }\n\n.visEditorSidebar__indexPatternPlaceholder {\n  min-height: 40px;\n  border-bottom: 1px solid #D3DAE6; }\n\n.visEditorSidebar__nav,\n.visEditorSidebar__linkedSearch {\n  flex-grow: 0; }\n\n.visEditorSidebar__section {\n  background-color: #FFF;\n  padding: 8px;\n  border-radius: 6px; }\n  .visEditorSidebar__section + .visEditorSidebar__section {\n    margin-top: 8px; }\n\n.visEditorSidebar__collapsible {\n  background-color: #fafbfd; }\n\n.visEditorSidebar__collapsible--marginBottom {\n  margin-bottom: 12px; }\n\n.visEditorSidebar__formRow {\n  display: flex;\n  align-items: center;\n  margin-top: 12px; }\n\n.visEditorSidebar__formLabel {\n  display: flex;\n  align-items: center;\n  flex: 1 1 40%;\n  padding-right: 4px; }\n\n.visEditorSidebar__formControl {\n  display: flex;\n  align-items: center;\n  flex: 1 1 60%; }\n\n.visEditorSidebar__aggGroupAccordionButtonContent {\n  font-size: 14px; }\n  .visEditorSidebar__aggGroupAccordionButtonContent span {\n    color: #69707D; }\n\n.visEditorSidebar__controls {\n  border-top: 1px solid #D3DAE6;\n  padding: 8px;\n  display: flex;\n  justify-content: flex-end;\n  align-items: center; }\n  .visEditorSidebar__controls .visEditorSidebar__autoApplyButton {\n    margin-left: 12px; }\n\n.visEditorAgg__subAgg {\n  border: 2px solid #D3DAE6;\n  border-radius: 6px;\n  background-color: transparent;\n  padding: 8px; }\n\n.visEditorAgg__subAgg + .visEditorAggParam__string {\n  margin-top: 16px; }\n\n.visEditorAggParam--half {\n  margin: 16px 0;\n  display: inline-block;\n  width: calc(50% - 4px); }\n\n.visEditorAggParam--half-size {\n  margin-left: 8px; }\n",""]);module.exports=exports},function(module,exports){module.exports.id="ace/mode/json_worker";module.exports.src='"no use strict";!function(window){function resolveModuleId(id,paths){for(var testPath=id,tail="";testPath;){var alias=paths[testPath];if("string"==typeof alias)return alias+tail;if(alias)return alias.location.replace(/\\/*$/,"/")+(tail||alias.main||alias.name);if(alias===!1)return"";var i=testPath.lastIndexOf("/");if(-1===i)break;tail=testPath.substr(i)+tail,testPath=testPath.slice(0,i)}return id}if(!(void 0!==window.window&&window.document||window.acequire&&window.define)){window.console||(window.console=function(){var msgs=Array.prototype.slice.call(arguments,0);postMessage({type:"log",data:msgs})},window.console.error=window.console.warn=window.console.log=window.console.trace=window.console),window.window=window,window.ace=window,window.onerror=function(message,file,line,col,err){postMessage({type:"error",data:{message:message,data:err.data,file:file,line:line,col:col,stack:err.stack}})},window.normalizeModule=function(parentId,moduleName){if(-1!==moduleName.indexOf("!")){var chunks=moduleName.split("!");return window.normalizeModule(parentId,chunks[0])+"!"+window.normalizeModule(parentId,chunks[1])}if("."==moduleName.charAt(0)){var base=parentId.split("/").slice(0,-1).join("/");for(moduleName=(base?base+"/":"")+moduleName;-1!==moduleName.indexOf(".")&&previous!=moduleName;){var previous=moduleName;moduleName=moduleName.replace(/^\\.\\//,"").replace(/\\/\\.\\//,"/").replace(/[^\\/]+\\/\\.\\.\\//,"")}}return moduleName},window.acequire=function acequire(parentId,id){if(id||(id=parentId,parentId=null),!id.charAt)throw Error("worker.js acequire() accepts only (parentId, id) as arguments");id=window.normalizeModule(parentId,id);var module=window.acequire.modules[id];if(module)return module.initialized||(module.initialized=!0,module.exports=module.factory().exports),module.exports;if(!window.acequire.tlns)return console.log("unable to load "+id);var path=resolveModuleId(id,window.acequire.tlns);return".js"!=path.slice(-3)&&(path+=".js"),window.acequire.id=id,window.acequire.modules[id]={},importScripts(path),window.acequire(parentId,id)},window.acequire.modules={},window.acequire.tlns={},window.define=function(id,deps,factory){if(2==arguments.length?(factory=deps,"string"!=typeof id&&(deps=id,id=window.acequire.id)):1==arguments.length&&(factory=id,deps=[],id=window.acequire.id),"function"!=typeof factory)return window.acequire.modules[id]={exports:factory,initialized:!0},void 0;deps.length||(deps=["require","exports","module"]);var req=function(childId){return window.acequire(id,childId)};window.acequire.modules[id]={exports:{},factory:function(){var module=this,returnExports=factory.apply(this,deps.map(function(dep){switch(dep){case"require":return req;case"exports":return module.exports;case"module":return module;default:return req(dep)}}));return returnExports&&(module.exports=returnExports),module}}},window.define.amd={},acequire.tlns={},window.initBaseUrls=function(topLevelNamespaces){for(var i in topLevelNamespaces)acequire.tlns[i]=topLevelNamespaces[i]},window.initSender=function(){var EventEmitter=window.acequire("ace/lib/event_emitter").EventEmitter,oop=window.acequire("ace/lib/oop"),Sender=function(){};return function(){oop.implement(this,EventEmitter),this.callback=function(data,callbackId){postMessage({type:"call",id:callbackId,data:data})},this.emit=function(name,data){postMessage({type:"event",name:name,data:data})}}.call(Sender.prototype),new Sender};var main=window.main=null,sender=window.sender=null;window.onmessage=function(e){var msg=e.data;if(msg.event&&sender)sender._signal(msg.event,msg.data);else if(msg.command)if(main[msg.command])main[msg.command].apply(main,msg.args);else{if(!window[msg.command])throw Error("Unknown command:"+msg.command);window[msg.command].apply(window,msg.args)}else if(msg.init){window.initBaseUrls(msg.tlns),acequire("ace/lib/es5-shim"),sender=window.sender=window.initSender();var clazz=acequire(msg.module)[msg.classname];main=window.main=new clazz(sender)}}}}(this),ace.define("ace/lib/oop",["require","exports","module"],function(acequire,exports){"use strict";exports.inherits=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})},exports.mixin=function(obj,mixin){for(var key in mixin)obj[key]=mixin[key];return obj},exports.implement=function(proto,mixin){exports.mixin(proto,mixin)}}),ace.define("ace/range",["require","exports","module"],function(acequire,exports){"use strict";var comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},Range=function(startRow,startColumn,endRow,endColumn){this.start={row:startRow,column:startColumn},this.end={row:endRow,column:endColumn}};(function(){this.isEqual=function(range){return this.start.row===range.start.row&&this.end.row===range.end.row&&this.start.column===range.start.column&&this.end.column===range.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(row,column){return 0==this.compare(row,column)},this.compareRange=function(range){var cmp,end=range.end,start=range.start;return cmp=this.compare(end.row,end.column),1==cmp?(cmp=this.compare(start.row,start.column),1==cmp?2:0==cmp?1:0):-1==cmp?-2:(cmp=this.compare(start.row,start.column),-1==cmp?-1:1==cmp?42:0)},this.comparePoint=function(p){return this.compare(p.row,p.column)},this.containsRange=function(range){return 0==this.comparePoint(range.start)&&0==this.comparePoint(range.end)},this.intersects=function(range){var cmp=this.compareRange(range);return-1==cmp||0==cmp||1==cmp},this.isEnd=function(row,column){return this.end.row==row&&this.end.column==column},this.isStart=function(row,column){return this.start.row==row&&this.start.column==column},this.setStart=function(row,column){"object"==typeof row?(this.start.column=row.column,this.start.row=row.row):(this.start.row=row,this.start.column=column)},this.setEnd=function(row,column){"object"==typeof row?(this.end.column=row.column,this.end.row=row.row):(this.end.row=row,this.end.column=column)},this.inside=function(row,column){return 0==this.compare(row,column)?this.isEnd(row,column)||this.isStart(row,column)?!1:!0:!1},this.insideStart=function(row,column){return 0==this.compare(row,column)?this.isEnd(row,column)?!1:!0:!1},this.insideEnd=function(row,column){return 0==this.compare(row,column)?this.isStart(row,column)?!1:!0:!1},this.compare=function(row,column){return this.isMultiLine()||row!==this.start.row?this.start.row>row?-1:row>this.end.row?1:this.start.row===row?column>=this.start.column?0:-1:this.end.row===row?this.end.column>=column?0:1:0:this.start.column>column?-1:column>this.end.column?1:0},this.compareStart=function(row,column){return this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.compareEnd=function(row,column){return this.end.row==row&&this.end.column==column?1:this.compare(row,column)},this.compareInside=function(row,column){return this.end.row==row&&this.end.column==column?1:this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.clipRows=function(firstRow,lastRow){if(this.end.row>lastRow)var end={row:lastRow+1,column:0};else if(firstRow>this.end.row)var end={row:firstRow,column:0};if(this.start.row>lastRow)var start={row:lastRow+1,column:0};else if(firstRow>this.start.row)var start={row:firstRow,column:0};return Range.fromPoints(start||this.start,end||this.end)},this.extend=function(row,column){var cmp=this.compare(row,column);if(0==cmp)return this;if(-1==cmp)var start={row:row,column:column};else var end={row:row,column:column};return Range.fromPoints(start||this.start,end||this.end)},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return Range.fromPoints(this.start,this.end)},this.collapseRows=function(){return 0==this.end.column?new Range(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new Range(this.start.row,0,this.end.row,0)},this.toScreenRange=function(session){var screenPosStart=session.documentToScreenPosition(this.start),screenPosEnd=session.documentToScreenPosition(this.end);return new Range(screenPosStart.row,screenPosStart.column,screenPosEnd.row,screenPosEnd.column)},this.moveBy=function(row,column){this.start.row+=row,this.start.column+=column,this.end.row+=row,this.end.column+=column}}).call(Range.prototype),Range.fromPoints=function(start,end){return new Range(start.row,start.column,end.row,end.column)},Range.comparePoints=comparePoints,Range.comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},exports.Range=Range}),ace.define("ace/apply_delta",["require","exports","module"],function(acequire,exports){"use strict";exports.applyDelta=function(docLines,delta){var row=delta.start.row,startColumn=delta.start.column,line=docLines[row]||"";switch(delta.action){case"insert":var lines=delta.lines;if(1===lines.length)docLines[row]=line.substring(0,startColumn)+delta.lines[0]+line.substring(startColumn);else{var args=[row,1].concat(delta.lines);docLines.splice.apply(docLines,args),docLines[row]=line.substring(0,startColumn)+docLines[row],docLines[row+delta.lines.length-1]+=line.substring(startColumn)}break;case"remove":var endColumn=delta.end.column,endRow=delta.end.row;row===endRow?docLines[row]=line.substring(0,startColumn)+line.substring(endColumn):docLines.splice(row,endRow-row+1,line.substring(0,startColumn)+docLines[endRow].substring(endColumn))}}}),ace.define("ace/lib/event_emitter",["require","exports","module"],function(acequire,exports){"use strict";var EventEmitter={},stopPropagation=function(){this.propagationStopped=!0},preventDefault=function(){this.defaultPrevented=!0};EventEmitter._emit=EventEmitter._dispatchEvent=function(eventName,e){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var listeners=this._eventRegistry[eventName]||[],defaultHandler=this._defaultHandlers[eventName];if(listeners.length||defaultHandler){"object"==typeof e&&e||(e={}),e.type||(e.type=eventName),e.stopPropagation||(e.stopPropagation=stopPropagation),e.preventDefault||(e.preventDefault=preventDefault),listeners=listeners.slice();for(var i=0;listeners.length>i&&(listeners[i](e,this),!e.propagationStopped);i++);return defaultHandler&&!e.defaultPrevented?defaultHandler(e,this):void 0}},EventEmitter._signal=function(eventName,e){var listeners=(this._eventRegistry||{})[eventName];if(listeners){listeners=listeners.slice();for(var i=0;listeners.length>i;i++)listeners[i](e,this)}},EventEmitter.once=function(eventName,callback){var _self=this;callback&&this.addEventListener(eventName,function newCallback(){_self.removeEventListener(eventName,newCallback),callback.apply(null,arguments)})},EventEmitter.setDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers||(handlers=this._defaultHandlers={_disabled_:{}}),handlers[eventName]){var old=handlers[eventName],disabled=handlers._disabled_[eventName];disabled||(handlers._disabled_[eventName]=disabled=[]),disabled.push(old);var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}handlers[eventName]=callback},EventEmitter.removeDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers){var disabled=handlers._disabled_[eventName];if(handlers[eventName]==callback)handlers[eventName],disabled&&this.setDefaultHandler(eventName,disabled.pop());else if(disabled){var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}}},EventEmitter.on=EventEmitter.addEventListener=function(eventName,callback,capturing){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];return listeners||(listeners=this._eventRegistry[eventName]=[]),-1==listeners.indexOf(callback)&&listeners[capturing?"unshift":"push"](callback),callback},EventEmitter.off=EventEmitter.removeListener=EventEmitter.removeEventListener=function(eventName,callback){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];if(listeners){var index=listeners.indexOf(callback);-1!==index&&listeners.splice(index,1)}},EventEmitter.removeAllListeners=function(eventName){this._eventRegistry&&(this._eventRegistry[eventName]=[])},exports.EventEmitter=EventEmitter}),ace.define("ace/anchor",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(acequire,exports){"use strict";var oop=acequire("./lib/oop"),EventEmitter=acequire("./lib/event_emitter").EventEmitter,Anchor=exports.Anchor=function(doc,row,column){this.$onChange=this.onChange.bind(this),this.attach(doc),column===void 0?this.setPosition(row.row,row.column):this.setPosition(row,column)};(function(){function $pointsInOrder(point1,point2,equalPointsInOrder){var bColIsAfter=equalPointsInOrder?point1.column<=point2.column:point1.column<point2.column;return point1.row<point2.row||point1.row==point2.row&&bColIsAfter}function $getTransformedPoint(delta,point,moveIfEqual){var deltaIsInsert="insert"==delta.action,deltaRowShift=(deltaIsInsert?1:-1)*(delta.end.row-delta.start.row),deltaColShift=(deltaIsInsert?1:-1)*(delta.end.column-delta.start.column),deltaStart=delta.start,deltaEnd=deltaIsInsert?deltaStart:delta.end;return $pointsInOrder(point,deltaStart,moveIfEqual)?{row:point.row,column:point.column}:$pointsInOrder(deltaEnd,point,!moveIfEqual)?{row:point.row+deltaRowShift,column:point.column+(point.row==deltaEnd.row?deltaColShift:0)}:{row:deltaStart.row,column:deltaStart.column}}oop.implement(this,EventEmitter),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.$insertRight=!1,this.onChange=function(delta){if(!(delta.start.row==delta.end.row&&delta.start.row!=this.row||delta.start.row>this.row)){var point=$getTransformedPoint(delta,{row:this.row,column:this.column},this.$insertRight);this.setPosition(point.row,point.column,!0)}},this.setPosition=function(row,column,noClip){var pos;if(pos=noClip?{row:row,column:column}:this.$clipPositionToDocument(row,column),this.row!=pos.row||this.column!=pos.column){var old={row:this.row,column:this.column};this.row=pos.row,this.column=pos.column,this._signal("change",{old:old,value:pos})}},this.detach=function(){this.document.removeEventListener("change",this.$onChange)},this.attach=function(doc){this.document=doc||this.document,this.document.on("change",this.$onChange)},this.$clipPositionToDocument=function(row,column){var pos={};return row>=this.document.getLength()?(pos.row=Math.max(0,this.document.getLength()-1),pos.column=this.document.getLine(pos.row).length):0>row?(pos.row=0,pos.column=0):(pos.row=row,pos.column=Math.min(this.document.getLine(pos.row).length,Math.max(0,column))),0>column&&(pos.column=0),pos}}).call(Anchor.prototype)}),ace.define("ace/document",["require","exports","module","ace/lib/oop","ace/apply_delta","ace/lib/event_emitter","ace/range","ace/anchor"],function(acequire,exports){"use strict";var oop=acequire("./lib/oop"),applyDelta=acequire("./apply_delta").applyDelta,EventEmitter=acequire("./lib/event_emitter").EventEmitter,Range=acequire("./range").Range,Anchor=acequire("./anchor").Anchor,Document=function(textOrLines){this.$lines=[""],0===textOrLines.length?this.$lines=[""]:Array.isArray(textOrLines)?this.insertMergedLines({row:0,column:0},textOrLines):this.insert({row:0,column:0},textOrLines)};(function(){oop.implement(this,EventEmitter),this.setValue=function(text){var len=this.getLength()-1;this.remove(new Range(0,0,len,this.getLine(len).length)),this.insert({row:0,column:0},text)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},this.createAnchor=function(row,column){return new Anchor(this,row,column)},this.$split=0==="aaa".split(/a/).length?function(text){return text.replace(/\\r\\n|\\r/g,"\\n").split("\\n")}:function(text){return text.split(/\\r\\n|\\r|\\n/)},this.$detectNewLine=function(text){var match=text.match(/^.*?(\\r\\n|\\r|\\n)/m);this.$autoNewLine=match?match[1]:"\\n",this._signal("changeNewLineMode")},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\\r\\n";case"unix":return"\\n";default:return this.$autoNewLine||"\\n"}},this.$autoNewLine="",this.$newLineMode="auto",this.setNewLineMode=function(newLineMode){this.$newLineMode!==newLineMode&&(this.$newLineMode=newLineMode,this._signal("changeNewLineMode"))},this.getNewLineMode=function(){return this.$newLineMode},this.isNewLine=function(text){return"\\r\\n"==text||"\\r"==text||"\\n"==text},this.getLine=function(row){return this.$lines[row]||""},this.getLines=function(firstRow,lastRow){return this.$lines.slice(firstRow,lastRow+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getTextRange=function(range){return this.getLinesForRange(range).join(this.getNewLineCharacter())},this.getLinesForRange=function(range){var lines;if(range.start.row===range.end.row)lines=[this.getLine(range.start.row).substring(range.start.column,range.end.column)];else{lines=this.getLines(range.start.row,range.end.row),lines[0]=(lines[0]||"").substring(range.start.column);var l=lines.length-1;range.end.row-range.start.row==l&&(lines[l]=lines[l].substring(0,range.end.column))}return lines},this.insertLines=function(row,lines){return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."),this.insertFullLines(row,lines)},this.removeLines=function(firstRow,lastRow){return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."),this.removeFullLines(firstRow,lastRow)},this.insertNewLine=function(position){return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, [\'\', \'\']) instead."),this.insertMergedLines(position,["",""])},this.insert=function(position,text){return 1>=this.getLength()&&this.$detectNewLine(text),this.insertMergedLines(position,this.$split(text))},this.insertInLine=function(position,text){var start=this.clippedPos(position.row,position.column),end=this.pos(position.row,position.column+text.length);return this.applyDelta({start:start,end:end,action:"insert",lines:[text]},!0),this.clonePos(end)},this.clippedPos=function(row,column){var length=this.getLength();void 0===row?row=length:0>row?row=0:row>=length&&(row=length-1,column=void 0);var line=this.getLine(row);return void 0==column&&(column=line.length),column=Math.min(Math.max(column,0),line.length),{row:row,column:column}},this.clonePos=function(pos){return{row:pos.row,column:pos.column}},this.pos=function(row,column){return{row:row,column:column}},this.$clipPosition=function(position){var length=this.getLength();return position.row>=length?(position.row=Math.max(0,length-1),position.column=this.getLine(length-1).length):(position.row=Math.max(0,position.row),position.column=Math.min(Math.max(position.column,0),this.getLine(position.row).length)),position},this.insertFullLines=function(row,lines){row=Math.min(Math.max(row,0),this.getLength());var column=0;this.getLength()>row?(lines=lines.concat([""]),column=0):(lines=[""].concat(lines),row--,column=this.$lines[row].length),this.insertMergedLines({row:row,column:column},lines)},this.insertMergedLines=function(position,lines){var start=this.clippedPos(position.row,position.column),end={row:start.row+lines.length-1,column:(1==lines.length?start.column:0)+lines[lines.length-1].length};return this.applyDelta({start:start,end:end,action:"insert",lines:lines}),this.clonePos(end)},this.remove=function(range){var start=this.clippedPos(range.start.row,range.start.column),end=this.clippedPos(range.end.row,range.end.column);return this.applyDelta({start:start,end:end,action:"remove",lines:this.getLinesForRange({start:start,end:end})}),this.clonePos(start)},this.removeInLine=function(row,startColumn,endColumn){var start=this.clippedPos(row,startColumn),end=this.clippedPos(row,endColumn);return this.applyDelta({start:start,end:end,action:"remove",lines:this.getLinesForRange({start:start,end:end})},!0),this.clonePos(start)},this.removeFullLines=function(firstRow,lastRow){firstRow=Math.min(Math.max(0,firstRow),this.getLength()-1),lastRow=Math.min(Math.max(0,lastRow),this.getLength()-1);var deleteFirstNewLine=lastRow==this.getLength()-1&&firstRow>0,deleteLastNewLine=this.getLength()-1>lastRow,startRow=deleteFirstNewLine?firstRow-1:firstRow,startCol=deleteFirstNewLine?this.getLine(startRow).length:0,endRow=deleteLastNewLine?lastRow+1:lastRow,endCol=deleteLastNewLine?0:this.getLine(endRow).length,range=new Range(startRow,startCol,endRow,endCol),deletedLines=this.$lines.slice(firstRow,lastRow+1);return this.applyDelta({start:range.start,end:range.end,action:"remove",lines:this.getLinesForRange(range)}),deletedLines},this.removeNewLine=function(row){this.getLength()-1>row&&row>=0&&this.applyDelta({start:this.pos(row,this.getLine(row).length),end:this.pos(row+1,0),action:"remove",lines:["",""]})},this.replace=function(range,text){if(range instanceof Range||(range=Range.fromPoints(range.start,range.end)),0===text.length&&range.isEmpty())return range.start;if(text==this.getTextRange(range))return range.end;this.remove(range);var end;return end=text?this.insert(range.start,text):range.start},this.applyDeltas=function(deltas){for(var i=0;deltas.length>i;i++)this.applyDelta(deltas[i])},this.revertDeltas=function(deltas){for(var i=deltas.length-1;i>=0;i--)this.revertDelta(deltas[i])},this.applyDelta=function(delta,doNotValidate){var isInsert="insert"==delta.action;(isInsert?1>=delta.lines.length&&!delta.lines[0]:!Range.comparePoints(delta.start,delta.end))||(isInsert&&delta.lines.length>2e4&&this.$splitAndapplyLargeDelta(delta,2e4),applyDelta(this.$lines,delta,doNotValidate),this._signal("change",delta))},this.$splitAndapplyLargeDelta=function(delta,MAX){for(var lines=delta.lines,l=lines.length,row=delta.start.row,column=delta.start.column,from=0,to=0;;){from=to,to+=MAX-1;var chunk=lines.slice(from,to);if(to>l){delta.lines=chunk,delta.start.row=row+from,delta.start.column=column;break}chunk.push(""),this.applyDelta({start:this.pos(row+from,column),end:this.pos(row+to,column=0),action:delta.action,lines:chunk},!0)}},this.revertDelta=function(delta){this.applyDelta({start:this.clonePos(delta.start),end:this.clonePos(delta.end),action:"insert"==delta.action?"remove":"insert",lines:delta.lines.slice()})},this.indexToPosition=function(index,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,i=startRow||0,l=lines.length;l>i;i++)if(index-=lines[i].length+newlineLength,0>index)return{row:i,column:index+lines[i].length+newlineLength};return{row:l-1,column:lines[l-1].length}},this.positionToIndex=function(pos,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,index=0,row=Math.min(pos.row,lines.length),i=startRow||0;row>i;++i)index+=lines[i].length+newlineLength;return index+pos.column}}).call(Document.prototype),exports.Document=Document}),ace.define("ace/lib/lang",["require","exports","module"],function(acequire,exports){"use strict";exports.last=function(a){return a[a.length-1]},exports.stringReverse=function(string){return string.split("").reverse().join("")},exports.stringRepeat=function(string,count){for(var result="";count>0;)1&count&&(result+=string),(count>>=1)&&(string+=string);return result};var trimBeginRegexp=/^\\s\\s*/,trimEndRegexp=/\\s\\s*$/;exports.stringTrimLeft=function(string){return string.replace(trimBeginRegexp,"")},exports.stringTrimRight=function(string){return string.replace(trimEndRegexp,"")},exports.copyObject=function(obj){var copy={};for(var key in obj)copy[key]=obj[key];return copy},exports.copyArray=function(array){for(var copy=[],i=0,l=array.length;l>i;i++)copy[i]=array[i]&&"object"==typeof array[i]?this.copyObject(array[i]):array[i];return copy},exports.deepCopy=function deepCopy(obj){if("object"!=typeof obj||!obj)return obj;var copy;if(Array.isArray(obj)){copy=[];for(var key=0;obj.length>key;key++)copy[key]=deepCopy(obj[key]);return copy}if("[object Object]"!==Object.prototype.toString.call(obj))return obj;copy={};for(var key in obj)copy[key]=deepCopy(obj[key]);return copy},exports.arrayToMap=function(arr){for(var map={},i=0;arr.length>i;i++)map[arr[i]]=1;return map},exports.createMap=function(props){var map=Object.create(null);for(var i in props)map[i]=props[i];return map},exports.arrayRemove=function(array,value){for(var i=0;array.length>=i;i++)value===array[i]&&array.splice(i,1)},exports.escapeRegExp=function(str){return str.replace(/([.*+?^${}()|[\\]\\/\\\\])/g,"\\\\$1")},exports.escapeHTML=function(str){return str.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/\'/g,"&#39;").replace(/</g,"&#60;")},exports.getMatchOffsets=function(string,regExp){var matches=[];return string.replace(regExp,function(str){matches.push({offset:arguments[arguments.length-2],length:str.length})}),matches},exports.deferredCall=function(fcn){var timer=null,callback=function(){timer=null,fcn()},deferred=function(timeout){return deferred.cancel(),timer=setTimeout(callback,timeout||0),deferred};return deferred.schedule=deferred,deferred.call=function(){return this.cancel(),fcn(),deferred},deferred.cancel=function(){return clearTimeout(timer),timer=null,deferred},deferred.isPending=function(){return timer},deferred},exports.delayedCall=function(fcn,defaultTimeout){var timer=null,callback=function(){timer=null,fcn()},_self=function(timeout){null==timer&&(timer=setTimeout(callback,timeout||defaultTimeout))};return _self.delay=function(timeout){timer&&clearTimeout(timer),timer=setTimeout(callback,timeout||defaultTimeout)},_self.schedule=_self,_self.call=function(){this.cancel(),fcn()},_self.cancel=function(){timer&&clearTimeout(timer),timer=null},_self.isPending=function(){return timer},_self}}),ace.define("ace/worker/mirror",["require","exports","module","ace/range","ace/document","ace/lib/lang"],function(acequire,exports){"use strict";acequire("../range").Range;var Document=acequire("../document").Document,lang=acequire("../lib/lang"),Mirror=exports.Mirror=function(sender){this.sender=sender;var doc=this.doc=new Document(""),deferredUpdate=this.deferredUpdate=lang.delayedCall(this.onUpdate.bind(this)),_self=this;sender.on("change",function(e){var data=e.data;if(data[0].start)doc.applyDeltas(data);else for(var i=0;data.length>i;i+=2){if(Array.isArray(data[i+1]))var d={action:"insert",start:data[i],lines:data[i+1]};else var d={action:"remove",start:data[i],end:data[i+1]};doc.applyDelta(d,!0)}return _self.$timeout?deferredUpdate.schedule(_self.$timeout):(_self.onUpdate(),void 0)})};(function(){this.$timeout=500,this.setTimeout=function(timeout){this.$timeout=timeout},this.setValue=function(value){this.doc.setValue(value),this.deferredUpdate.schedule(this.$timeout)},this.getValue=function(callbackId){this.sender.callback(this.doc.getValue(),callbackId)},this.onUpdate=function(){},this.isPending=function(){return this.deferredUpdate.isPending()}}).call(Mirror.prototype)}),ace.define("ace/mode/json/json_parse",["require","exports","module"],function(){"use strict";var at,ch,text,value,escapee={\'"\':\'"\',"\\\\":"\\\\","/":"/",b:"\\b",f:"\\f",n:"\\n",r:"\\r",t:"\t"},error=function(m){throw{name:"SyntaxError",message:m,at:at,text:text}},next=function(c){return c&&c!==ch&&error("Expected \'"+c+"\' instead of \'"+ch+"\'"),ch=text.charAt(at),at+=1,ch},number=function(){var number,string="";for("-"===ch&&(string="-",next("-"));ch>="0"&&"9">=ch;)string+=ch,next();if("."===ch)for(string+=".";next()&&ch>="0"&&"9">=ch;)string+=ch;if("e"===ch||"E"===ch)for(string+=ch,next(),("-"===ch||"+"===ch)&&(string+=ch,next());ch>="0"&&"9">=ch;)string+=ch,next();return number=+string,isNaN(number)?(error("Bad number"),void 0):number},string=function(){var hex,i,uffff,string="";if(\'"\'===ch)for(;next();){if(\'"\'===ch)return next(),string;if("\\\\"===ch)if(next(),"u"===ch){for(uffff=0,i=0;4>i&&(hex=parseInt(next(),16),isFinite(hex));i+=1)uffff=16*uffff+hex;string+=String.fromCharCode(uffff)}else{if("string"!=typeof escapee[ch])break;string+=escapee[ch]}else string+=ch}error("Bad string")},white=function(){for(;ch&&" ">=ch;)next()},word=function(){switch(ch){case"t":return next("t"),next("r"),next("u"),next("e"),!0;case"f":return next("f"),next("a"),next("l"),next("s"),next("e"),!1;case"n":return next("n"),next("u"),next("l"),next("l"),null}error("Unexpected \'"+ch+"\'")},array=function(){var array=[];if("["===ch){if(next("["),white(),"]"===ch)return next("]"),array;for(;ch;){if(array.push(value()),white(),"]"===ch)return next("]"),array;next(","),white()}}error("Bad array")},object=function(){var key,object={};if("{"===ch){if(next("{"),white(),"}"===ch)return next("}"),object;for(;ch;){if(key=string(),white(),next(":"),Object.hasOwnProperty.call(object,key)&&error(\'Duplicate key "\'+key+\'"\'),object[key]=value(),white(),"}"===ch)return next("}"),object;next(","),white()}}error("Bad object")};return value=function(){switch(white(),ch){case"{":return object();case"[":return array();case\'"\':return string();case"-":return number();default:return ch>="0"&&"9">=ch?number():word()}},function(source,reviver){var result;return text=source,at=0,ch=" ",result=value(),white(),ch&&error("Syntax error"),"function"==typeof reviver?function walk(holder,key){var k,v,value=holder[key];if(value&&"object"==typeof value)for(k in value)Object.hasOwnProperty.call(value,k)&&(v=walk(value,k),void 0!==v?value[k]=v:delete value[k]);return reviver.call(holder,key,value)}({"":result},""):result}}),ace.define("ace/mode/json_worker",["require","exports","module","ace/lib/oop","ace/worker/mirror","ace/mode/json/json_parse"],function(acequire,exports){"use strict";var oop=acequire("../lib/oop"),Mirror=acequire("../worker/mirror").Mirror,parse=acequire("./json/json_parse"),JsonWorker=exports.JsonWorker=function(sender){Mirror.call(this,sender),this.setTimeout(200)};oop.inherits(JsonWorker,Mirror),function(){this.onUpdate=function(){var value=this.doc.getValue(),errors=[];try{value&&parse(value)}catch(e){var pos=this.doc.indexToPosition(e.at-1);errors.push({row:pos.row,column:pos.column,text:e.message,type:"error"})}this.sender.emit("annotate",errors)}}.call(JsonWorker.prototype)}),ace.define("ace/lib/es5-shim",["require","exports","module"],function(){function Empty(){}function doesDefinePropertyWork(object){try{return Object.defineProperty(object,"sentinel",{}),"sentinel"in object}catch(exception){}}function toInteger(n){return n=+n,n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n))),n}Function.prototype.bind||(Function.prototype.bind=function(that){var target=this;if("function"!=typeof target)throw new TypeError("Function.prototype.bind called on incompatible "+target);var args=slice.call(arguments,1),bound=function(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));return Object(result)===result?result:this}return target.apply(that,args.concat(slice.call(arguments)))};return target.prototype&&(Empty.prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null),bound});var defineGetter,defineSetter,lookupGetter,lookupSetter,supportsAccessors,call=Function.prototype.call,prototypeOfArray=Array.prototype,prototypeOfObject=Object.prototype,slice=prototypeOfArray.slice,_toString=call.bind(prototypeOfObject.toString),owns=call.bind(prototypeOfObject.hasOwnProperty);if((supportsAccessors=owns(prototypeOfObject,"__defineGetter__"))&&(defineGetter=call.bind(prototypeOfObject.__defineGetter__),defineSetter=call.bind(prototypeOfObject.__defineSetter__),lookupGetter=call.bind(prototypeOfObject.__lookupGetter__),lookupSetter=call.bind(prototypeOfObject.__lookupSetter__)),2!=[1,2].splice(0).length)if(function(){function makeArray(l){var a=Array(l+2);return a[0]=a[1]=0,a}var lengthBefore,array=[];return array.splice.apply(array,makeArray(20)),array.splice.apply(array,makeArray(26)),lengthBefore=array.length,array.splice(5,0,"XXX"),lengthBefore+1==array.length,lengthBefore+1==array.length?!0:void 0\n}()){var array_splice=Array.prototype.splice;Array.prototype.splice=function(start,deleteCount){return arguments.length?array_splice.apply(this,[void 0===start?0:start,void 0===deleteCount?this.length-start:deleteCount].concat(slice.call(arguments,2))):[]}}else Array.prototype.splice=function(pos,removeCount){var length=this.length;pos>0?pos>length&&(pos=length):void 0==pos?pos=0:0>pos&&(pos=Math.max(length+pos,0)),length>pos+removeCount||(removeCount=length-pos);var removed=this.slice(pos,pos+removeCount),insert=slice.call(arguments,2),add=insert.length;if(pos===length)add&&this.push.apply(this,insert);else{var remove=Math.min(removeCount,length-pos),tailOldPos=pos+remove,tailNewPos=tailOldPos+add-remove,tailCount=length-tailOldPos,lengthAfterRemove=length-remove;if(tailOldPos>tailNewPos)for(var i=0;tailCount>i;++i)this[tailNewPos+i]=this[tailOldPos+i];else if(tailNewPos>tailOldPos)for(i=tailCount;i--;)this[tailNewPos+i]=this[tailOldPos+i];if(add&&pos===lengthAfterRemove)this.length=lengthAfterRemove,this.push.apply(this,insert);else for(this.length=lengthAfterRemove+add,i=0;add>i;++i)this[pos+i]=insert[i]}return removed};Array.isArray||(Array.isArray=function(obj){return"[object Array]"==_toString(obj)});var boxedString=Object("a"),splitString="a"!=boxedString[0]||!(0 in boxedString);if(Array.prototype.forEach||(Array.prototype.forEach=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,thisp=arguments[1],i=-1,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError;for(;length>++i;)i in self&&fun.call(thisp,self[i],i,object)}),Array.prototype.map||(Array.prototype.map=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=Array(length),thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(result[i]=fun.call(thisp,self[i],i,object));return result}),Array.prototype.filter||(Array.prototype.filter=function(fun){var value,object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=[],thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(value=self[i],fun.call(thisp,value,i,object)&&result.push(value));return result}),Array.prototype.every||(Array.prototype.every=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&!fun.call(thisp,self[i],i,object))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&fun.call(thisp,self[i],i,object))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var result,i=0;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i++];break}if(++i>=length)throw new TypeError("reduce of empty array with no initial value")}for(;length>i;i++)i in self&&(result=fun.call(void 0,result,self[i],i,object));return result}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var result,i=length-1;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i--];break}if(0>--i)throw new TypeError("reduceRight of empty array with no initial value")}do i in this&&(result=fun.call(void 0,result,self[i],i,object));while(i--);return result}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=0;for(arguments.length>1&&(i=toInteger(arguments[1])),i=i>=0?i:Math.max(0,length+i);length>i;i++)if(i in self&&self[i]===sought)return i;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=length-1;for(arguments.length>1&&(i=Math.min(i,toInteger(arguments[1]))),i=i>=0?i:length-Math.abs(i);i>=0;i--)if(i in self&&sought===self[i])return i;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(object){return object.__proto__||(object.constructor?object.constructor.prototype:prototypeOfObject)}),!Object.getOwnPropertyDescriptor){var ERR_NON_OBJECT="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(object,property){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError(ERR_NON_OBJECT+object);if(owns(object,property)){var descriptor,getter,setter;if(descriptor={enumerable:!0,configurable:!0},supportsAccessors){var prototype=object.__proto__;object.__proto__=prototypeOfObject;var getter=lookupGetter(object,property),setter=lookupSetter(object,property);if(object.__proto__=prototype,getter||setter)return getter&&(descriptor.get=getter),setter&&(descriptor.set=setter),descriptor}return descriptor.value=object[property],descriptor}}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(object){return Object.keys(object)}),!Object.create){var createEmpty;createEmpty=null===Object.prototype.__proto__?function(){return{__proto__:null}}:function(){var empty={};for(var i in empty)empty[i]=null;return empty.constructor=empty.hasOwnProperty=empty.propertyIsEnumerable=empty.isPrototypeOf=empty.toLocaleString=empty.toString=empty.valueOf=empty.__proto__=null,empty},Object.create=function(prototype,properties){var object;if(null===prototype)object=createEmpty();else{if("object"!=typeof prototype)throw new TypeError("typeof prototype["+typeof prototype+"] != \'object\'");var Type=function(){};Type.prototype=prototype,object=new Type,object.__proto__=prototype}return void 0!==properties&&Object.defineProperties(object,properties),object}}if(Object.defineProperty){var definePropertyWorksOnObject=doesDefinePropertyWork({}),definePropertyWorksOnDom="undefined"==typeof document||doesDefinePropertyWork(document.createElement("div"));if(!definePropertyWorksOnObject||!definePropertyWorksOnDom)var definePropertyFallback=Object.defineProperty}if(!Object.defineProperty||definePropertyFallback){var ERR_NON_OBJECT_DESCRIPTOR="Property description must be an object: ",ERR_NON_OBJECT_TARGET="Object.defineProperty called on non-object: ",ERR_ACCESSORS_NOT_SUPPORTED="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(object,property,descriptor){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError(ERR_NON_OBJECT_TARGET+object);if("object"!=typeof descriptor&&"function"!=typeof descriptor||null===descriptor)throw new TypeError(ERR_NON_OBJECT_DESCRIPTOR+descriptor);if(definePropertyFallback)try{return definePropertyFallback.call(Object,object,property,descriptor)}catch(exception){}if(owns(descriptor,"value"))if(supportsAccessors&&(lookupGetter(object,property)||lookupSetter(object,property))){var prototype=object.__proto__;object.__proto__=prototypeOfObject,delete object[property],object[property]=descriptor.value,object.__proto__=prototype}else object[property]=descriptor.value;else{if(!supportsAccessors)throw new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);owns(descriptor,"get")&&defineGetter(object,property,descriptor.get),owns(descriptor,"set")&&defineSetter(object,property,descriptor.set)}return object}}Object.defineProperties||(Object.defineProperties=function(object,properties){for(var property in properties)owns(properties,property)&&Object.defineProperty(object,property,properties[property]);return object}),Object.seal||(Object.seal=function(object){return object}),Object.freeze||(Object.freeze=function(object){return object});try{Object.freeze(function(){})}catch(exception){Object.freeze=function(freezeObject){return function(object){return"function"==typeof object?object:freezeObject(object)}}(Object.freeze)}if(Object.preventExtensions||(Object.preventExtensions=function(object){return object}),Object.isSealed||(Object.isSealed=function(){return!1}),Object.isFrozen||(Object.isFrozen=function(){return!1}),Object.isExtensible||(Object.isExtensible=function(object){if(Object(object)===object)throw new TypeError;for(var name="";owns(object,name);)name+="?";object[name]=!0;var returnValue=owns(object,name);return delete object[name],returnValue}),!Object.keys){var hasDontEnumBug=!0,dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;for(var key in{toString:null})hasDontEnumBug=!1;Object.keys=function(object){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError("Object.keys called on a non-object");var keys=[];for(var name in object)owns(object,name)&&keys.push(name);if(hasDontEnumBug)for(var i=0,ii=dontEnumsLength;ii>i;i++){var dontEnum=dontEnums[i];owns(object,dontEnum)&&keys.push(dontEnum)}return keys}}Date.now||(Date.now=function(){return(new Date).getTime()});var ws="\t\\n\v\\f\\r   ᠎             　\\u2028\\u2029\ufeff";if(!String.prototype.trim||ws.trim()){ws="["+ws+"]";var trimBeginRegexp=RegExp("^"+ws+ws+"*"),trimEndRegexp=RegExp(ws+ws+"*$");String.prototype.trim=function(){return(this+"").replace(trimBeginRegexp,"").replace(trimEndRegexp,"")}}var toObject=function(o){if(null==o)throw new TypeError("can\'t convert "+o+" to object");return Object(o)}});'},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(15);var react_1=__webpack_require__(0);var useTimeoutFn_1=tslib_1.__importDefault(__webpack_require__(34));function useDebounce(fn,ms,deps){if(ms===void 0){ms=0}if(deps===void 0){deps=[]}var _a=useTimeoutFn_1.default(fn,ms),isReady=_a[0],cancel=_a[1],reset=_a[2];react_1.useEffect(reset,deps);return[isReady,cancel]}exports.default=useDebounce},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var react_1=__webpack_require__(0);function useTimeoutFn(fn,ms){if(ms===void 0){ms=0}var ready=react_1.useRef(false);var timeout=react_1.useRef();var callback=react_1.useRef(fn);var isReady=react_1.useCallback((function(){return ready.current}),[]);var set=react_1.useCallback((function(){ready.current=false;timeout.current&&clearTimeout(timeout.current);timeout.current=setTimeout((function(){ready.current=true;callback.current()}),ms)}),[ms]);var clear=react_1.useCallback((function(){ready.current=null;timeout.current&&clearTimeout(timeout.current)}),[]);react_1.useEffect((function(){callback.current=fn}),[fn]);react_1.useEffect((function(){set();return clear}),[ms]);return[isReady,clear,set]}exports.default=useTimeoutFn},function(module,exports,__webpack_require__){const moment=__webpack_require__(17);const unitsMap={ms:{weight:1,type:"fixed",base:1},s:{weight:2,type:"fixed",base:1e3},m:{weight:3,type:"mixed",base:1e3*60},h:{weight:4,type:"mixed",base:1e3*60*60},d:{weight:5,type:"mixed",base:1e3*60*60*24},w:{weight:6,type:"calendar",base:NaN},M:{weight:7,type:"calendar",base:NaN},y:{weight:9,type:"calendar",base:NaN}};const units=Object.keys(unitsMap).sort((a,b)=>unitsMap[b].weight-unitsMap[a].weight);const unitsDesc=[...units];const unitsAsc=[...units].reverse();const isDate=d=>Object.prototype.toString.call(d)==="[object Date]";const isValidDate=d=>isDate(d)&&!isNaN(d.valueOf());function parse(text,{roundUp:roundUp=false,momentInstance:momentInstance=moment,forceNow:forceNow}={}){if(!text)return undefined;if(momentInstance.isMoment(text))return text;if(isDate(text))return momentInstance(text);if(forceNow!==undefined&&!isValidDate(forceNow)){throw new Error("forceNow must be a valid Date")}let time;let mathString="";let index;let parseString;if(text.substring(0,3)==="now"){time=momentInstance(forceNow);mathString=text.substring("now".length)}else{index=text.indexOf("||");if(index===-1){parseString=text;mathString=""}else{parseString=text.substring(0,index);mathString=text.substring(index+2)}time=momentInstance(parseString)}if(!mathString.length){return time}return parseDateMath(mathString,time,roundUp)}function parseDateMath(mathString,time,roundUp){const dateTime=time;const len=mathString.length;let i=0;while(i<len){const c=mathString.charAt(i++);let type;let num;let unit;if(c==="/"){type=0}else if(c==="+"){type=1}else if(c==="-"){type=2}else{return}if(isNaN(mathString.charAt(i))){num=1}else if(mathString.length===2){num=mathString.charAt(i)}else{const numFrom=i;while(!isNaN(mathString.charAt(i))){i++;if(i>=len)return}num=parseInt(mathString.substring(numFrom,i),10)}if(type===0){if(num!==1){return}}unit=mathString.charAt(i++);for(let j=i;j<len;j++){const unitChar=mathString.charAt(i);if(/[a-z]/i.test(unitChar)){unit+=unitChar;i++}else{break}}if(units.indexOf(unit)===-1){return}else{if(type===0){if(roundUp)dateTime.endOf(unit);else dateTime.startOf(unit)}else if(type===1){dateTime.add(num,unit)}else if(type===2){dateTime.subtract(num,unit)}}}return dateTime}module.exports={parse:parse,unitsMap:Object.freeze(unitsMap),units:Object.freeze(units),unitsAsc:Object.freeze(unitsAsc),unitsDesc:Object.freeze(unitsDesc)}},function(module,exports){ace.define("ace/theme/github",["require","exports","module","ace/lib/dom"],(function(acequire,exports,module){exports.isDark=false;exports.cssClass="ace-github";exports.cssText='.ace-github .ace_gutter {background: #e8e8e8;color: #AAA;}.ace-github  {background: #fff;color: #000;}.ace-github .ace_keyword {font-weight: bold;}.ace-github .ace_string {color: #D14;}.ace-github .ace_variable.ace_class {color: teal;}.ace-github .ace_constant.ace_numeric {color: #099;}.ace-github .ace_constant.ace_buildin {color: #0086B3;}.ace-github .ace_support.ace_function {color: #0086B3;}.ace-github .ace_comment {color: #998;font-style: italic;}.ace-github .ace_variable.ace_language  {color: #0086B3;}.ace-github .ace_paren {font-weight: bold;}.ace-github .ace_boolean {font-weight: bold;}.ace-github .ace_string.ace_regexp {color: #009926;font-weight: normal;}.ace-github .ace_variable.ace_instance {color: teal;}.ace-github .ace_constant.ace_language {font-weight: bold;}.ace-github .ace_cursor {color: black;}.ace-github.ace_focus .ace_marker-layer .ace_active-line {background: rgb(255, 255, 204);}.ace-github .ace_marker-layer .ace_active-line {background: rgb(245, 245, 245);}.ace-github .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-github.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-github.ace_nobold .ace_line > span {font-weight: normal !important;}.ace-github .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-github .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-github .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-github .ace_gutter-active-line {background-color : rgba(0, 0, 0, 0.07);}.ace-github .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-github .ace_invisible {color: #BFBFBF}.ace-github .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-github .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}';var dom=acequire("../lib/dom");dom.importCssString(exports.cssText,exports.cssClass)}))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(15);var react_1=__webpack_require__(0);var useEffectOnce_1=tslib_1.__importDefault(__webpack_require__(22));var useUnmount=function(fn){var fnRef=react_1.useRef(fn);fnRef.current=fn;useEffectOnce_1.default((function(){return function(){return fnRef.current()}}))};exports.default=useUnmount},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",(function(){return DefaultEditor}));var public_0=__webpack_require__(23);var json=__webpack_require__(21);var external_kbnSharedDeps_React_=__webpack_require__(0);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var public_=__webpack_require__(14);var kibanaUtils_public_=__webpack_require__(16);var external_kbnSharedDeps_Lodash_=__webpack_require__(3);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(2);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(1);function DefaultEditorNavBar({setSelectedTab:setSelectedTab,optionTabs:optionTabs}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabs"],{className:"visEditorSidebar__nav",size:"s"},optionTabs.map(({name:name,title:title,isSelected:isSelected=false})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{key:name,isSelected:isSelected,"data-test-subj":`visEditorTab__${name}`,onClick:()=>setSelectedTab(name)},title)))}var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(5);var useDebounce=__webpack_require__(33);var useDebounce_default=__webpack_require__.n(useDebounce);var data_public_=__webpack_require__(13);let EditorStateActionTypes;(function(EditorStateActionTypes){EditorStateActionTypes["ADD_NEW_AGG"]="ADD_NEW_AGG";EditorStateActionTypes["DISCARD_CHANGES"]="DISCARD_CHANGES";EditorStateActionTypes["CHANGE_AGG_TYPE"]="CHANGE_AGG_TYPE";EditorStateActionTypes["SET_AGG_PARAM_VALUE"]="SET_AGG_PARAM_VALUE";EditorStateActionTypes["SET_STATE_PARAM_VALUE"]="SET_STATE_PARAM_VALUE";EditorStateActionTypes["TOGGLE_ENABLED_AGG"]="TOGGLE_ENABLED_AGG";EditorStateActionTypes["REMOVE_AGG"]="REMOVE_AGG";EditorStateActionTypes["REORDER_AGGS"]="REORDER_AGGS";EditorStateActionTypes["UPDATE_STATE_PARAMS"]="UPDATE_STATE_PARAMS"})(EditorStateActionTypes||(EditorStateActionTypes={}));const getSchemaByName=(schemas,schemaName)=>schemas.find(s=>s.name===schemaName)||{};const isAggRemovable=(agg,group,schemas)=>{const schema=getSchemaByName(schemas,agg.schema);const metricCount=group.reduce((count,aggregation)=>aggregation.schema===agg.schema?++count:count,0);return metricCount>schema.min};const getEnabledMetricAggsCount=group=>group.reduce((count,aggregation)=>aggregation.schema==="metric"&&aggregation.enabled?++count:count,0);const calcAggIsTooLow=(agg,aggIndex,group,schemas)=>{const schema=getSchemaByName(schemas,agg.schema);if(!schema.mustBeFirst){return false}const firstDifferentSchema=Object(external_kbnSharedDeps_Lodash_["findIndex"])(group,aggr=>aggr.schema!==agg.schema);if(firstDifferentSchema===-1){return false}return aggIndex>firstDifferentSchema};function isInvalidAggsTouched(aggsState){const invalidAggs=Object.values(aggsState).filter(agg=>!agg.valid);if(Object(external_kbnSharedDeps_Lodash_["isEmpty"])(invalidAggs)){return false}return invalidAggs.every(agg=>agg.touched)}function initEditorState(vis){return{...vis.clone()}}const createEditorStateReducer=({aggs:{createAggConfigs:createAggConfigs}})=>(state,action)=>{switch(action.type){case EditorStateActionTypes.ADD_NEW_AGG:{const{schema:schema}=action.payload;const defaultConfig=!state.data.aggs.aggs.find(agg=>agg.schema===schema.name)&&schema.defaults?schema.defaults.slice(0,schema.max):{schema:schema.name};const aggConfig=state.data.aggs.createAggConfig(defaultConfig,{addToAggConfigs:false});aggConfig.brandNew=true;const newAggs=[...state.data.aggs.aggs,aggConfig];return{...state,data:{...state.data,aggs:createAggConfigs(state.data.indexPattern,newAggs)}}}case EditorStateActionTypes.DISCARD_CHANGES:{return initEditorState(action.payload)}case EditorStateActionTypes.CHANGE_AGG_TYPE:{const{aggId:aggId,value:value}=action.payload;const newAggs=state.data.aggs.aggs.map(agg=>{if(agg.id===aggId){agg.type=value;return agg.toJSON()}return agg});return{...state,data:{...state.data,aggs:createAggConfigs(state.data.indexPattern,newAggs)}}}case EditorStateActionTypes.SET_AGG_PARAM_VALUE:{const{aggId:aggId,paramName:paramName,value:value}=action.payload;const newAggs=state.data.aggs.aggs.map(agg=>{if(agg.id===aggId){const parsedAgg=agg.toJSON();return{...parsedAgg,params:{...parsedAgg.params,[paramName]:value}}}return agg});return{...state,data:{...state.data,aggs:createAggConfigs(state.data.indexPattern,newAggs)}}}case EditorStateActionTypes.SET_STATE_PARAM_VALUE:{const{paramName:paramName,value:value}=action.payload;return{...state,params:{...state.params,[paramName]:value}}}case EditorStateActionTypes.REMOVE_AGG:{let isMetric=false;const newAggs=state.data.aggs.aggs.filter(({id:id,schema:schema})=>{if(id===action.payload.aggId){const schemaDef=action.payload.schemas.find(s=>s.name===schema);if(schemaDef&&schemaDef.group===data_public_["AggGroupNames"].Metrics){isMetric=true}return false}return true});if(isMetric&&getEnabledMetricAggsCount(newAggs)===0){const aggToEnable=newAggs.find(agg=>agg.schema==="metric");if(aggToEnable){aggToEnable.enabled=true}}return{...state,data:{...state.data,aggs:createAggConfigs(state.data.indexPattern,newAggs)}}}case EditorStateActionTypes.REORDER_AGGS:{const{sourceAgg:sourceAgg,destinationAgg:destinationAgg}=action.payload;const destinationIndex=state.data.aggs.aggs.indexOf(destinationAgg);const newAggs=[...state.data.aggs.aggs];newAggs.splice(destinationIndex,0,newAggs.splice(state.data.aggs.aggs.indexOf(sourceAgg),1)[0]);return{...state,data:{...state.data,aggs:createAggConfigs(state.data.indexPattern,newAggs)}}}case EditorStateActionTypes.TOGGLE_ENABLED_AGG:{const{aggId:aggId,enabled:enabled}=action.payload;const newAggs=state.data.aggs.aggs.map(agg=>{if(agg.id===aggId){const parsedAgg=agg.toJSON();return{...parsedAgg,enabled:enabled}}return agg});return{...state,data:{...state.data,aggs:createAggConfigs(state.data.indexPattern,newAggs)}}}case EditorStateActionTypes.UPDATE_STATE_PARAMS:{const{params:params}=action.payload;return{...state,params:Object(external_kbnSharedDeps_Lodash_["cloneDeep"])(params)}}}};const initialFormState={validity:{},touched:false,invalid:false};function useEditorFormState(){const[formState,setFormState]=Object(external_kbnSharedDeps_React_["useState"])(initialFormState);const setValidity=Object(external_kbnSharedDeps_React_["useCallback"])((modelName,value)=>{setFormState(model=>{const validity={...model.validity,[modelName]:value};return{...model,validity:validity,invalid:Object.values(validity).some(valid=>!valid)}})},[]);const resetValidity=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setFormState(initialFormState)},[]);const setTouched=Object(external_kbnSharedDeps_React_["useCallback"])(touched=>{setFormState(model=>({...model,touched:touched}))},[]);return{formState:formState,setValidity:setValidity,setTouched:setTouched,resetValidity:resetValidity}}const addNewAgg=schema=>({type:EditorStateActionTypes.ADD_NEW_AGG,payload:{schema:schema}});const discardChanges=vis=>({type:EditorStateActionTypes.DISCARD_CHANGES,payload:vis});const changeAggType=(aggId,value)=>({type:EditorStateActionTypes.CHANGE_AGG_TYPE,payload:{aggId:aggId,value:value}});const actions_setAggParamValue=(aggId,paramName,value)=>({type:EditorStateActionTypes.SET_AGG_PARAM_VALUE,payload:{aggId:aggId,paramName:paramName,value:value}});const actions_setStateParamValue=(paramName,value)=>({type:EditorStateActionTypes.SET_STATE_PARAM_VALUE,payload:{paramName:paramName,value:value}});const actions_removeAgg=(aggId,schemas)=>({type:EditorStateActionTypes.REMOVE_AGG,payload:{aggId:aggId,schemas:schemas}});const actions_reorderAggs=(sourceAgg,destinationAgg)=>({type:EditorStateActionTypes.REORDER_AGGS,payload:{sourceAgg:sourceAgg,destinationAgg:destinationAgg}});const toggleEnabledAgg=(aggId,enabled)=>({type:EditorStateActionTypes.TOGGLE_ENABLED_AGG,payload:{aggId:aggId,enabled:enabled}});const updateStateParams=params=>({type:EditorStateActionTypes.UPDATE_STATE_PARAMS,payload:{params:params}});function useEditorReducer(vis,eventEmitter){const{services:services}=Object(public_["useKibana"])();const[state,dispatch]=Object(external_kbnSharedDeps_React_["useReducer"])(createEditorStateReducer(services.data.search),vis,initEditorState);const wrappedDispatch=Object(external_kbnSharedDeps_React_["useCallback"])(action=>{dispatch(action);eventEmitter.emit("dirtyStateChange",{isDirty:action.type!==EditorStateActionTypes.DISCARD_CHANGES})},[eventEmitter]);return[state,wrappedDispatch]}function DefaultEditorControls({applyChanges:applyChanges,isDirty:isDirty,isInvalid:isInvalid,isTouched:isTouched,dispatch:dispatch,vis:vis}){const{enableAutoApply:enableAutoApply}=vis.type.editorConfig;const[autoApplyEnabled,setAutoApplyEnabled]=Object(external_kbnSharedDeps_React_["useState"])(false);const toggleAutoApply=Object(external_kbnSharedDeps_React_["useCallback"])(nextAutoApplyEnabled=>setAutoApplyEnabled(nextAutoApplyEnabled),[]);const onClickDiscard=Object(external_kbnSharedDeps_React_["useCallback"])(()=>dispatch(discardChanges(vis)),[dispatch,vis]);useDebounce_default()(()=>{if(autoApplyEnabled&&isDirty){applyChanges()}},300,[isDirty,autoApplyEnabled,applyChanges]);return external_kbnSharedDeps_React_default.a.createElement("div",{className:"visEditorSidebar__controls"},!autoApplyEnabled&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween",gutterSize:"none",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"visualizeEditorResetButton",disabled:!isDirty,iconType:"cross",onClick:onClickDiscard,size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.sidebar.discardChangesButtonLabel",defaultMessage:"Discard"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},isInvalid&&isTouched?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.sidebar.errorButtonTooltip",{defaultMessage:"Errors in the highlighted fields need to be resolved."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{color:"danger",iconType:"alert",size:"s",disabled:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.sidebar.updateChartButtonLabel",defaultMessage:"Update"}))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"visualizeEditorRenderButton",disabled:!isDirty,fill:true,iconType:"play",onClick:applyChanges,size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.sidebar.updateChartButtonLabel",defaultMessage:"Update"})))),enableAutoApply&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{title:autoApplyEnabled?external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.sidebar.autoApplyChangesOnLabel",{defaultMessage:"Auto apply is on"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.sidebar.autoApplyChangesOffLabel",{defaultMessage:"Auto apply is off"}),content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.sidebar.autoApplyChangesTooltip",{defaultMessage:"Auto updates the visualization on every change."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{className:"visEditorSidebar__autoApplyButton","data-test-subj":"visualizeEditorAutoButton",iconType:"refresh",color:autoApplyEnabled?"primary":"text",fill:true,onClick:()=>toggleAutoApply(!autoApplyEnabled),size:"s",minWidth:80,"aria-label":autoApplyEnabled?external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.sidebar.autoApplyChangesLabelOn",{defaultMessage:"Auto apply is on"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.sidebar.autoApplyChangesLabelOff",{defaultMessage:"Auto apply is off"})},autoApplyEnabled?external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.sidebar.autoApplyChangesOn",{defaultMessage:"On"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.sidebar.autoApplyChangesOff",{defaultMessage:"Off"}))))}function LinkedSearch({savedSearch:savedSearch,eventEmitter:eventEmitter}){const[showPopover,setShowPopover]=Object(external_kbnSharedDeps_React_["useState"])(false);const{services:{application:application}}=Object(public_["useKibana"])();const closePopover=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setShowPopover(false),[]);const onClickButtonLink=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setShowPopover(v=>!v),[]);const onClickUnlikFromSavedSearch=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setShowPopover(false);eventEmitter.emit("unlinkFromSavedSearch")},[eventEmitter]);const onClickViewInDiscover=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{application.navigateToApp("discover",{path:`#/view/${savedSearch.id}`})},[application,savedSearch.id]);const linkButtonAriaLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.sidebar.savedSearch.linkButtonAriaLabel",{defaultMessage:"Link to saved search. Click to learn more or break link."});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",className:"visEditorSidebar__titleContainer visEditorSidebar__linkedSearch",gutterSize:"xs",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"search"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,className:"eui-textTruncate"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xs",className:"eui-textTruncate"},external_kbnSharedDeps_React_default.a.createElement("h2",{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.sidebar.savedSearch.titleAriaLabel",{defaultMessage:"Saved search: {title}",values:{title:savedSearch.title}})},savedSearch.title))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{anchorPosition:"downRight",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:linkButtonAriaLabel},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"aria-label":linkButtonAriaLabel,"data-test-subj":"showUnlinkSavedSearchPopover",iconType:"link",onClick:onClickButtonLink})),isOpen:showPopover,closePopover:closePopover,panelPaddingSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverTitle"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.sidebar.savedSearch.popoverTitle",defaultMessage:"Linked to saved search"})),external_kbnSharedDeps_React_default.a.createElement("div",{style:{width:260}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"viewSavedSearch",flush:"left",onClick:onClickViewInDiscover,size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.sidebar.savedSearch.goToDiscoverButtonText",defaultMessage:"View this search in Discover"}))),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.sidebar.savedSearch.popoverHelpText",defaultMessage:"Subsequent modifications to this saved search are reflected in the visualization. To disable automatic updates, remove the link."})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{color:"danger","data-test-subj":"unlinkSavedSearch",fullWidth:true,onClick:onClickUnlikFromSavedSearch,size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.sidebar.savedSearch.unlinkSavedSearchButtonText",defaultMessage:"Remove link to saved search"}))))))))}function SidebarTitle({savedSearch:savedSearch,vis:vis,isLinkedSearch:isLinkedSearch,eventEmitter:eventEmitter}){return isLinkedSearch&&savedSearch?external_kbnSharedDeps_React_default.a.createElement(LinkedSearch,{savedSearch:savedSearch,eventEmitter:eventEmitter}):vis.type.options.showIndexSelection?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xs",className:"visEditorSidebar__titleContainer eui-textTruncate"},external_kbnSharedDeps_React_default.a.createElement("h2",{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.sidebar.indexPatternAriaLabel",{defaultMessage:"Index pattern: {title}",values:{title:vis.data.indexPattern.title}})},vis.data.indexPattern.title)):external_kbnSharedDeps_React_default.a.createElement("div",{className:"visEditorSidebar__indexPatternPlaceholder"})}var useUnmount=__webpack_require__(37);var useUnmount_default=__webpack_require__.n(useUnmount);let AGG_TYPE_ACTION_KEYS;(function(AGG_TYPE_ACTION_KEYS){AGG_TYPE_ACTION_KEYS["TOUCHED"]="aggTypeTouched";AGG_TYPE_ACTION_KEYS["VALID"]="aggTypeValid"})(AGG_TYPE_ACTION_KEYS||(AGG_TYPE_ACTION_KEYS={}));function aggTypeReducer(state,action){switch(action.type){case AGG_TYPE_ACTION_KEYS.TOUCHED:return{...state,touched:action.payload};case AGG_TYPE_ACTION_KEYS.VALID:return{...state,valid:action.payload};default:throw new Error}}let AGG_PARAMS_ACTION_KEYS;(function(AGG_PARAMS_ACTION_KEYS){AGG_PARAMS_ACTION_KEYS["TOUCHED"]="aggParamsTouched";AGG_PARAMS_ACTION_KEYS["VALID"]="aggParamsValid";AGG_PARAMS_ACTION_KEYS["RESET"]="aggParamsReset"})(AGG_PARAMS_ACTION_KEYS||(AGG_PARAMS_ACTION_KEYS={}));function aggParamsReducer(state,{type:type,paramName:paramName="",payload:payload}){const targetParam=state[paramName]||{valid:true,touched:false};switch(type){case AGG_PARAMS_ACTION_KEYS.TOUCHED:return{...state,[paramName]:{...targetParam,touched:payload}};case AGG_PARAMS_ACTION_KEYS.VALID:return{...state,[paramName]:{...targetParam,valid:payload}};case AGG_PARAMS_ACTION_KEYS.RESET:return{};default:throw new Error}}function initAggParamsState(params){const state=params.reduce((stateObj,param)=>{stateObj[param.aggParam.name]={valid:true,touched:false};return stateObj},{});return state}function DefaultEditorAggSelect({aggError:aggError,id:id,indexPattern:indexPattern,value:value,setValue:setValue,aggTypeOptions:aggTypeOptions,showValidation:showValidation,isSubAggregation:isSubAggregation,onChangeAggType:onChangeAggType}){const[isDirty,setIsDirty]=Object(external_kbnSharedDeps_React_["useState"])(false);const{services:services}=Object(public_["useKibana"])();const selectedOptions=value?[{label:value.title,target:value}]:[];const label=isSubAggregation?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.aggSelect.subAggregationLabel",defaultMessage:"Sub aggregation"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.aggSelect.aggregationLabel",defaultMessage:"Aggregation"});let aggHelpLink;if(Object(external_kbnSharedDeps_Lodash_["has"])(value,"name")){aggHelpLink=services.docLinks.links.aggs[value.name]}const helpLink=value&&aggHelpLink&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:aggHelpLink,target:"_blank",rel:"noopener"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.aggSelect.helpLinkLabel",defaultMessage:"{aggTitle} help",values:{aggTitle:value?value.title:""}})));const errors=aggError?[aggError]:[];if(!aggTypeOptions.length){errors.push(external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.aggSelect.noCompatibleAggsDescription",{defaultMessage:"The index pattern {indexPatternTitle} does not have any aggregatable fields.",values:{indexPatternTitle:indexPattern&&indexPattern.title}}))}const isValid=!!value&&!errors.length&&!isDirty;const onChange=Object(external_kbnSharedDeps_React_["useCallback"])(options=>{const selectedOption=Object(external_kbnSharedDeps_Lodash_["get"])(options,"0.target");if(selectedOption){setValue(selectedOption)}},[setValue]);const onSearchChange=Object(external_kbnSharedDeps_React_["useCallback"])(searchValue=>setIsDirty(Boolean(searchValue)),[]);const setTouched=Object(external_kbnSharedDeps_React_["useCallback"])(()=>onChangeAggType({type:AGG_TYPE_ACTION_KEYS.TOUCHED,payload:true}),[onChangeAggType]);const setValidity=Object(external_kbnSharedDeps_React_["useCallback"])(valid=>onChangeAggType({type:AGG_TYPE_ACTION_KEYS.VALID,payload:valid}),[onChangeAggType]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setValidity(isValid)},[isValid,setValidity]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(errors.length){setTouched()}},[errors.length,setTouched]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:label,labelAppend:helpLink,error:errors,isInvalid:showValidation?!isValid:false,fullWidth:true,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.aggSelect.selectAggPlaceholder",{defaultMessage:"Select an aggregation"}),id:`visDefaultEditorAggSelect${id}`,isDisabled:!aggTypeOptions.length,options:aggTypeOptions,selectedOptions:selectedOptions,singleSelection:{asPlainText:true},onBlur:setTouched,onChange:onChange,onSearchChange:onSearchChange,"data-test-subj":"defaultEditorAggSelect",isClearable:false,isInvalid:showValidation?!isValid:false,fullWidth:true,sortMatchesBy:"startsWith",compressed:true}))}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function DefaultEditorAggParam(props){const{agg:agg,aggParam:aggParam,paramEditor:ParamEditor,setAggParamValue:setAggParamValue,onChangeParamsState:onChangeParamsState,...rest}=props;const setValidity=Object(external_kbnSharedDeps_React_["useCallback"])(valid=>{onChangeParamsState({type:AGG_PARAMS_ACTION_KEYS.VALID,paramName:aggParam.name,payload:valid})},[onChangeParamsState,aggParam.name]);const setTouched=Object(external_kbnSharedDeps_React_["useCallback"])((isTouched=true)=>{onChangeParamsState({type:AGG_PARAMS_ACTION_KEYS.TOUCHED,paramName:aggParam.name,payload:isTouched})},[onChangeParamsState,aggParam.name]);const setValue=Object(external_kbnSharedDeps_React_["useCallback"])(value=>{if(props.value!==value){setAggParamValue(agg.id,aggParam.name,value)}},[setAggParamValue,agg.id,aggParam.name,props.value]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(aggParam.shouldShow&&!aggParam.shouldShow(agg)){setValidity(true)}},[agg,agg.params.field,aggParam,setValidity]);if(aggParam.shouldShow&&!aggParam.shouldShow(agg)){return null}return external_kbnSharedDeps_React_default.a.createElement(ParamEditor,_extends({agg:agg,aggParam:aggParam,setValidity:setValidity,setTouched:setTouched,setValue:setValue},rest))}const{propFilter:propFilter}=data_public_["search"].aggs;const filterByName=propFilter("name");const agg_type_filters_filters=[(aggType,indexPattern,aggConfig,aggFilter)=>{const doesSchemaAllowAggType=filterByName([aggType],aggFilter).length!==0;return doesSchemaAllowAggType},(aggType,indexPattern,aggConfig,aggFilter)=>{const aggRestrictions=indexPattern.getAggregationRestrictions();if(!aggRestrictions){return true}const aggName=aggType.name;return aggName==="count"||!!aggRestrictions&&Object.keys(aggRestrictions).includes(aggName)||false}];function filterAggTypes(aggTypes,indexPattern,aggConfig,aggFilter){const allowedAggTypes=aggTypes.filter(aggType=>{const isAggTypeAllowed=agg_type_filters_filters.every(filter=>filter(aggType,indexPattern,aggConfig,aggFilter));return isAggTypeAllowed});return allowedAggTypes}const agg_type_field_filters_filters=[(field,aggConfig)=>{const indexPattern=aggConfig.getIndexPattern();const aggRestrictions=indexPattern.getAggregationRestrictions();if(!aggRestrictions){return true}const aggName=aggConfig.type&&aggConfig.type.name;const aggFields=aggRestrictions[aggName];return!!aggFields&&!!aggFields[field.name]}];function filterAggTypeFields(fields,aggConfig){const allowedAggTypeFields=fields.filter(field=>{const isAggTypeFieldAllowed=agg_type_field_filters_filters.every(filter=>filter(field,aggConfig));return isAggTypeFieldAllowed});return allowedAggTypeFields}var utils=__webpack_require__(9);function AutoPrecisionParamEditor({value:value=false,setValue:setValue}){const label=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.changePrecisionLabel",{defaultMessage:"Change precision on map zoom"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{compressed:true,label:label,checked:value,onChange:ev=>setValue(ev.target.checked)}))}var elastic_datemath=__webpack_require__(35);var elastic_datemath_default=__webpack_require__.n(elastic_datemath);var useMount=__webpack_require__(18);var useMount_default=__webpack_require__.n(useMount);const FROM_PLACEHOLDER="−∞";const TO_PLACEHOLDER="+∞";const generateId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();const validateDateMath=(value="")=>{if(!value){return true}const moment=elastic_datemath_default.a.parse(value);return moment&&moment.isValid()};function DateRangesParamEditor({value:value=[],setValue:setValue,setValidity:setValidity}){const{services:services}=Object(public_["useKibana"])();const[ranges,setRanges]=Object(external_kbnSharedDeps_React_["useState"])(()=>value.map(range=>({...range,id:generateId()})));const hasInvalidRange=value.some(({from:from,to:to})=>!from&&!to||!validateDateMath(from)||!validateDateMath(to));const updateRanges=Object(external_kbnSharedDeps_React_["useCallback"])(rangeValues=>{setValue(rangeValues.map(range=>Object(external_kbnSharedDeps_Lodash_["omit"])(range,"id")));setRanges(rangeValues)},[setValue]);const onAddRange=Object(external_kbnSharedDeps_React_["useCallback"])(()=>updateRanges([...ranges,{id:generateId()}]),[ranges,updateRanges]);useMount_default()(()=>{if(!value.length){onAddRange()}});Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(value.length!==ranges.length||value.some((range,index)=>!Object(external_kbnSharedDeps_Lodash_["isEqual"])(range,Object(external_kbnSharedDeps_Lodash_["omit"])(ranges[index],"id")))){setRanges(value.map(range=>({...range,id:generateId()})))}},[ranges,value]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setValidity(!hasInvalidRange)},[hasInvalidRange,setValidity]);const onRemoveRange=id=>updateRanges(ranges.filter(range=>range.id!==id));const onChangeRange=(id,key,newValue)=>updateRanges(ranges.map(range=>range.id===id?{...range,[key]:newValue===""?undefined:newValue}:range));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{display:"rowCompressed",fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:services.docLinks.links.date.dateMath,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.controls.dateRanges.acceptedDateFormatsLinkText",defaultMessage:"Acceptable date formats"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),ranges.map(({from:from,to:to,id:id},index)=>{const deleteBtnTitle=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.dateRanges.removeRangeButtonAriaLabel",{defaultMessage:"Remove the range of {from} to {to}",values:{from:from||FROM_PLACEHOLDER,to:to||TO_PLACEHOLDER}});const areBothEmpty=!from&&!to;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],{key:id},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.dateRanges.fromColumnLabel",{defaultMessage:"From",description:"Beginning of a date range, e.g. *From* 2018-02-26 To 2018-02-28"}),compressed:true,fullWidth:true,isInvalid:areBothEmpty||!validateDateMath(from),placeholder:FROM_PLACEHOLDER,value:from||"",onChange:ev=>onChangeRange(id,"from",ev.target.value),"data-test-subj":`visEditorDateRange${index}__from`})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"sortRight",color:"subdued"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.dateRanges.toColumnLabel",{defaultMessage:"To",description:"End of a date range, e.g. From 2018-02-26 *To* 2018-02-28"}),"data-test-subj":`visEditorDateRange${index}__to`,compressed:true,fullWidth:true,isInvalid:areBothEmpty||!validateDateMath(to),placeholder:TO_PLACEHOLDER,value:to||"",onChange:ev=>onChangeRange(id,"to",ev.target.value)})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{title:deleteBtnTitle,"aria-label":deleteBtnTitle,disabled:value.length===1,color:"danger",iconType:"trash",onClick:()=>onRemoveRange(id)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}))}),hasInvalidRange&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormErrorText"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.controls.dateRanges.errorMessage",defaultMessage:"Each range should have at least one valid date."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{iconType:"plusInCircleFilled",onClick:onAddRange,size:"xs","data-test-subj":"visEditorAddDateRange"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.controls.dateRanges.addRangeButtonLabel",defaultMessage:"Add range"})))))}function SwitchParamEditor({value:value=false,setValue:setValue,dataTestSubj:dataTestSubj,displayToolTip:displayToolTip,displayLabel:displayLabel,disabled:disabled}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:displayToolTip,delay:"long",position:"right"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{compressed:true,label:displayLabel,checked:value,disabled:disabled,"data-test-subj":dataTestSubj,onChange:ev=>setValue(ev.target.checked)})))}function drop_partials_extends(){drop_partials_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return drop_partials_extends.apply(this,arguments)}function DropPartialsParamEditor(props){return external_kbnSharedDeps_React_default.a.createElement(SwitchParamEditor,drop_partials_extends({dataTestSubj:"dropPartialBucketsCheckbox",displayLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.dropPartialBucketsLabel",{defaultMessage:"Drop partial buckets"}),displayToolTip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.dropPartialBucketsTooltip",{defaultMessage:"Remove buckets that span time outside the time range so the histogram doesn't start and end with incomplete buckets."})},props))}var controls_utils=__webpack_require__(7);function areBoundsValid({min:min,max:max}){if(min===""||max===""){return false}return max>=min}function ExtendedBoundsParamEditor({value:value={},setValue:setValue,setValidity:setValidity,showValidation:showValidation,setTouched:setTouched}){const minLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.extendedBounds.minLabel",{defaultMessage:"Min"});const maxLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.extendedBounds.maxLabel",{defaultMessage:"Max"});const isValid=areBoundsValid(value);let error;if(!isValid){error=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.extendedBounds.errorMessage",{defaultMessage:"Min should be less than or equal to Max."})}Object(controls_utils["g"])(setValidity,isValid);const handleChange=(ev,name)=>{setValue({...value,[name]:ev.target.value===""?"":parseFloat(ev.target.value)})};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true,isInvalid:showValidation?!isValid:false,error:error},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{value:Object(external_kbnSharedDeps_Lodash_["isUndefined"])(value.min)?"":value.min,onChange:ev=>handleChange(ev,"min"),onBlur:setTouched,fullWidth:true,isInvalid:showValidation?!isValid:false,"aria-label":minLabel,prepend:minLabel,compressed:true})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{value:Object(external_kbnSharedDeps_Lodash_["isUndefined"])(value.max)?"":value.max,onChange:ev=>handleChange(ev,"max"),onBlur:setTouched,fullWidth:true,isInvalid:showValidation?!isValid:false,"aria-label":maxLabel,prepend:maxLabel,compressed:true}))))}const field_label=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.field.fieldLabel",{defaultMessage:"Field"});function FieldParamEditor({agg:agg,aggParam:aggParam,customError:customError,customLabel:customLabel,indexedFields:indexedFields=[],showValidation:showValidation,value:value,setTouched:setTouched,setValidity:setValidity,setValue:setValue}){const[isDirty,setIsDirty]=Object(external_kbnSharedDeps_React_["useState"])(false);const selectedOptions=value?[{label:value.displayName,target:value,key:value.name}]:[];const onChange=options=>{const selectedOption=Object(external_kbnSharedDeps_Lodash_["get"])(options,"0.target");if(!(aggParam.required&&!selectedOption)){setValue(selectedOption)}if(aggParam.onChange){aggParam.onChange(agg)}};const errors=customError?[customError]:[];if(!indexedFields.length){errors.push(external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.field.noCompatibleFieldsDescription",{defaultMessage:"The index pattern {indexPatternTitle} does not contain any of the following compatible field types: {fieldTypes}",values:{indexPatternTitle:agg.getIndexPattern&&agg.getIndexPattern().title,fieldTypes:getFieldTypesString(agg)}}))}const isValid=!!value&&!errors.length&&!isDirty;const showErrorMessage=(showValidation||!indexedFields.length)&&!isValid;Object(controls_utils["g"])(setValidity,isValid);useMount_default()(()=>{if(indexedFields.length!==1){return}const indexedField=indexedFields[0];if(!("options"in indexedField)){setValue(indexedField.target)}else if(indexedField.options.length===1){setValue(indexedField.options[0].target)}});const onSearchChange=Object(external_kbnSharedDeps_React_["useCallback"])(searchValue=>setIsDirty(Boolean(searchValue)),[]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:customLabel||field_label,isInvalid:showErrorMessage,fullWidth:true,error:errors,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{compressed:true,placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.field.selectFieldPlaceholder",{defaultMessage:"Select a field"}),options:indexedFields,isDisabled:!indexedFields.length,selectedOptions:selectedOptions,singleSelection:{asPlainText:true},isClearable:false,isInvalid:showErrorMessage,onChange:onChange,onBlur:setTouched,onSearchChange:onSearchChange,sortMatchesBy:"startsWith","data-test-subj":"visDefaultEditorField",fullWidth:true}))}function getFieldTypesString(agg){const param=Object(external_kbnSharedDeps_Lodash_["get"])(agg,"type.params",[]).find(p=>p.name==="field")||{};return Object(controls_utils["a"])(Object(controls_utils["c"])(param.filterFieldTypes),{inclusive:false})}function FilterRow({id:id,arrayIndex:arrayIndex,customLabel:customLabel,value:value,autoFocus:autoFocus,disableRemove:disableRemove,dataTestSubj:dataTestSubj,agg:agg,onChangeValue:onChangeValue,onRemoveFilter:onRemoveFilter}){const{services:services}=Object(public_["useKibana"])();const[showCustomLabel,setShowCustomLabel]=Object(external_kbnSharedDeps_React_["useState"])(false);const filterLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.filters.filterLabel",{defaultMessage:"Filter {index}",values:{index:arrayIndex+1}});const onBlur=()=>{if(value.query.length>0){services.data.query.addToQueryLog(services.appName,value)}};const FilterControl=external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:"tag","aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.filters.toggleFilterButtonAriaLabel",{defaultMessage:"Toggle filter label"}),"aria-expanded":showCustomLabel,"aria-controls":`visEditorFilterLabel${arrayIndex}`,onClick:()=>setShowCustomLabel(!showCustomLabel)}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:"trash",color:"danger",disabled:disableRemove,"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.filters.removeFilterButtonAriaLabel",{defaultMessage:"Remove this filter"}),onClick:()=>onRemoveFilter(id)}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiForm"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:`${filterLabel}${customLabel?` - ${customLabel}`:""}`,labelAppend:FilterControl,fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(data_public_["QueryStringInput"],{query:value,indexPatterns:[agg.getIndexPattern()],onChange:query=>onChangeValue(id,query,customLabel),onBlur:onBlur,disableAutoFocus:!autoFocus,dataTestSubj:dataTestSubj,bubbleSubmitEvent:true,languageSwitcherPopoverAnchorPosition:"leftDown",size:"s"})),showCustomLabel?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:`visEditorFilterLabel${arrayIndex}`,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.filters.definiteFilterLabel",{defaultMessage:"Filter {index} label",description:"'Filter {index}' represents the name of the filter as a noun, similar to 'label for filter 1'.",values:{index:arrayIndex+1}}),fullWidth:true,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{value:customLabel,placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.filters.labelPlaceholder",{defaultMessage:"Label"}),onChange:ev=>onChangeValue(id,value,ev.target.value),fullWidth:true,compressed:true})):null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}))}const filters_generateId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();function FiltersParamEditor({agg:agg,value:value=[],setValue:setValue}){const[filters,setFilters]=Object(external_kbnSharedDeps_React_["useState"])(()=>value.map(filter=>({...filter,id:filters_generateId()})));useMount_default()(()=>{setValue(filters.map(filter=>Object(external_kbnSharedDeps_Lodash_["omit"])({...filter,input:filter.input},"id")))});Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(value.length!==filters.length||value.some((filter,index)=>!Object(external_kbnSharedDeps_Lodash_["isEqual"])(filter,Object(external_kbnSharedDeps_Lodash_["omit"])(filters[index],"id")))){setFilters(value.map(filter=>({...filter,id:filters_generateId()})))}},[filters,value]);const updateFilters=updatedFilters=>{setValue(updatedFilters.map(filter=>Object(external_kbnSharedDeps_Lodash_["omit"])(filter,"id")));setFilters(updatedFilters)};const{services:services}=Object(public_["useKibana"])();const onAddFilter=()=>updateFilters([...filters,{input:services.data.query.queryString.getDefaultQuery(),label:"",id:filters_generateId()}]);const onRemoveFilter=id=>updateFilters(filters.filter(filter=>filter.id!==id));const onChangeValue=(id,query,label)=>updateFilters(filters.map(filter=>filter.id===id?{...filter,input:query,label:label}:filter));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),filters.map(({input:input,label:label,id:id},arrayIndex)=>external_kbnSharedDeps_React_default.a.createElement(FilterRow,{key:id,id:id,arrayIndex:arrayIndex,customLabel:label,value:input,autoFocus:arrayIndex===filters.length-1,disableRemove:arrayIndex===0&&filters.length===1,dataTestSubj:`visEditorFilterInput_${agg.id}_${arrayIndex}`,agg:agg,onChangeValue:onChangeValue,onRemoveFilter:onRemoveFilter})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{iconType:"plusInCircle",fill:true,fullWidth:true,onClick:onAddFilter,size:"s","data-test-subj":"visEditorAddFilterButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.controls.filters.addFilterButtonLabel",defaultMessage:"Add filter"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}))}function has_extended_bounds_extends(){has_extended_bounds_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return has_extended_bounds_extends.apply(this,arguments)}const{isType:isType}=data_public_["search"].aggs;function HasExtendedBoundsParamEditor(props){const{agg:agg,setValue:setValue,value:value}=props;const minDocCount=Object(external_kbnSharedDeps_React_["useRef"])(agg.params.min_doc_count);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(minDocCount.current!==agg.params.min_doc_count){minDocCount.current=agg.params.min_doc_count;setValue(value&&agg.params.min_doc_count)}},[agg.params.min_doc_count,setValue,value]);return external_kbnSharedDeps_React_default.a.createElement(SwitchParamEditor,has_extended_bounds_extends({},props,{displayLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.extendedBoundsLabel",{defaultMessage:"Extend bounds"}),displayToolTip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.extendedBoundsTooltip",{defaultMessage:"Min and Max do not filter the results, but rather extend the bounds of the result set."}),disabled:!props.agg.params.min_doc_count||!(isType("number")(props.agg)||isType("date")(props.agg))}))}function StringParamEditor({agg:agg,aggParam:aggParam,showValidation:showValidation,value:value,setValidity:setValidity,setValue:setValue,setTouched:setTouched}){const isValid=aggParam.required?!!value:true;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setValidity(isValid)},[isValid,setValidity]);const onChange=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>setValue(ev.target.value),[setValue]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{className:"visEditorAggParam__string",label:aggParam.displayName||aggParam.name,fullWidth:true,display:"rowCompressed",isInvalid:showValidation?!isValid:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{value:value||"","data-test-subj":`visEditorStringInput${agg.id}${aggParam.name}`,onChange:onChange,fullWidth:true,compressed:true,onBlur:setTouched,isInvalid:showValidation?!isValid:false}))}const _RE_NUMBER="(\\-?(?:\\d+(?:\\.\\d+)?|Infinity))";const RANGE_RE=new RegExp("^\\s*([\\[|\\(])\\s*"+_RE_NUMBER+"\\s*,\\s*"+_RE_NUMBER+"\\s*([\\]|\\)])\\s*$");class NumberListRange{constructor(minInclusive,min,max,maxInclusive){this.minInclusive=minInclusive;this.min=min;this.max=max;this.maxInclusive=maxInclusive}within(n){if(this.min===n&&!this.minInclusive||this.min>n)return false;if(this.max===n&&!this.maxInclusive||this.max<n)return false;return true}}function parseRange(input){const match=String(input).match(RANGE_RE);if(!match){throw new TypeError("expected input to be in interval notation e.g., (100, 200]")}const args=[match[1]==="[",parseFloat(match[2]),parseFloat(match[3]),match[4]==="]"];if(args[1]>args[2]){args.reverse()}const[minInclusive,min,max,maxInclusive]=args;return new NumberListRange(minInclusive,min,max,maxInclusive)}const EMPTY_STRING="";const defaultRange=parseRange("[0,Infinity)");const utils_generateId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();const defaultModel={value:0,id:utils_generateId(),isInvalid:false};function parse(value){const parsedValue=parseFloat(value);return isNaN(parsedValue)?EMPTY_STRING:parsedValue}function getRange(range){try{return range?parseRange(range):defaultRange}catch(e){throw new TypeError("Unable to parse range: "+e.message)}}function validateValue(value,numberRange){const result={isInvalid:false};if(value===EMPTY_STRING){result.isInvalid=true;result.error=EMPTY_STRING}else if(!numberRange.within(value)){result.isInvalid=true;result.error=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.numberList.invalidRangeErrorMessage",{defaultMessage:"The value should be in the range of {min} to {max}.",values:{min:numberRange.min,max:numberRange.max}})}return result}function validateValueAscending(inputValue,index,list){const result={isInvalidOrder:false};const previousModel=list[index-1];if(previousModel!==undefined&&inputValue!==undefined&&inputValue<=previousModel){result.isInvalidOrder=true;result.error=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.numberList.invalidAscOrderErrorMessage",{defaultMessage:"Value is not in ascending order."})}return result}function validateValueUnique(inputValue,index,list){const result={isDuplicate:false};if(inputValue!==EMPTY_STRING&&list.indexOf(inputValue)!==index){result.isDuplicate=true;result.error=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.numberList.duplicateValueErrorMessage",{defaultMessage:"Duplicate value."})}return result}function getNextModel(list,range){const lastValue=Object(external_kbnSharedDeps_Lodash_["last"])(list).value;let next=Number(lastValue)?Number(lastValue)+1:1;if(next>=range.max){next=range.max-1}return{id:utils_generateId(),value:next,isInvalid:false}}function getInitModelList(list){return list.length?list.map(num=>({value:num===undefined?EMPTY_STRING:num,id:utils_generateId(),isInvalid:false})):[defaultModel]}function getValidatedModels(numberList,modelList,numberRange,validateAscendingOrder=false,disallowDuplicates=false){if(!numberList.length){return[defaultModel]}return numberList.map((number,index)=>{const model=modelList[index]||{id:utils_generateId()};const newValue=number===undefined?EMPTY_STRING:number;const valueResult=numberRange?validateValue(newValue,numberRange):{isInvalid:false};const ascendingResult=validateAscendingOrder?validateValueAscending(newValue,index,numberList):{isInvalidOrder:false};const duplicationResult=disallowDuplicates?validateValueUnique(newValue,index,numberList):{isDuplicate:false};const allErrors=[valueResult.error,ascendingResult.error,duplicationResult.error].filter(Boolean).join(" ");return{...model,value:newValue,isInvalid:valueResult.isInvalid||ascendingResult.isInvalidOrder||duplicationResult.isDuplicate,error:allErrors===EMPTY_STRING?undefined:allErrors}})}function utils_hasInvalidValues(modelList){return!!modelList.find(({isInvalid:isInvalid})=>isInvalid)}function NumberRow({autoFocus:autoFocus,disableDelete:disableDelete,model:model,isInvalid:isInvalid,labelledbyId:labelledbyId,range:range,onBlur:onBlur,onDelete:onDelete,onChange:onChange}){const deleteBtnAriaLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.numberList.removeUnitButtonAriaLabel",{defaultMessage:"Remove the rank value of {value}",values:{value:model.value}});const onValueChanged=Object(external_kbnSharedDeps_React_["useCallback"])(event=>onChange({value:event.target.value,id:model.id}),[onChange,model.id]);const onDeleteFn=Object(external_kbnSharedDeps_React_["useCallback"])(()=>onDelete(model.id),[onDelete,model.id]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{"aria-labelledby":labelledbyId,autoFocus:autoFocus,compressed:true,isInvalid:isInvalid,placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.numberList.enterValuePlaceholder",{defaultMessage:"Enter a value"}),onChange:onValueChanged,value:model.value,fullWidth:true,min:range.min,max:range.max,onBlur:onBlur})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"aria-label":deleteBtnAriaLabel,title:deleteBtnAriaLabel,color:"danger",iconType:"trash",onClick:onDeleteFn,disabled:disableDelete})))}const simple_number_list_generateId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();function SimpleNumberList({agg:agg,aggParam:aggParam,value:value,setValue:setValue,setTouched:setTouched}){const[numbers,setNumbers]=Object(external_kbnSharedDeps_React_["useState"])(getInitModelList(value&&Object(external_kbnSharedDeps_Lodash_["isArray"])(value)?value:[EMPTY_STRING]));const numberRange=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getRange("[-Infinity,Infinity]"),[]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(Object(external_kbnSharedDeps_Lodash_["isArray"])(value)&&(value.length!==numbers.length||!value.every((numberValue,index)=>numberValue===numbers[index].value))){setNumbers(value.map(numberValue=>({id:simple_number_list_generateId(),value:numberValue,isInvalid:false})))}},[numbers,value]);const onUpdate=Object(external_kbnSharedDeps_React_["useCallback"])(numberList=>{setNumbers(numberList);setValue(numberList.map(({value:numberValue})=>numberValue))},[setValue]);const onChangeValue=Object(external_kbnSharedDeps_React_["useCallback"])(numberField=>{onUpdate(numbers.map(number=>number.id===numberField.id?{id:numberField.id,value:parse(numberField.value),isInvalid:false}:number))},[numbers,onUpdate]);const onAdd=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{const newArray=[...numbers,{id:simple_number_list_generateId(),value:EMPTY_STRING,isInvalid:false}];onUpdate(newArray)},[numbers,onUpdate]);const onDelete=Object(external_kbnSharedDeps_React_["useCallback"])(id=>onUpdate(numbers.filter(number=>number.id!==id)),[numbers,onUpdate]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{id:`${aggParam.name}-${agg.id}}`,label:aggParam.displayName||aggParam.name,fullWidth:true,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,numbers.map((number,arrayIndex)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],{key:number.id},external_kbnSharedDeps_React_default.a.createElement(NumberRow,{isInvalid:number.isInvalid,disableDelete:numbers.length===1,model:number,labelledbyId:`${aggParam.name}-${agg.id}-legend`,range:numberRange,onDelete:onDelete,onChange:onChangeValue,onBlur:setTouched,autoFocus:numbers.length!==1&&arrayIndex===numbers.length-1}),numbers.length-1!==arrayIndex&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{iconType:"plusInCircleFilled",onClick:onAdd,size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.controls.includeExclude.addUnitButtonLabel",defaultMessage:"Add value"})))))}function include_exclude_extends(){include_exclude_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return include_exclude_extends.apply(this,arguments)}const{isNumberType:isNumberType}=data_public_["search"].aggs;function IncludeExcludeParamEditor(props){const{agg:agg,value:value,setValue:setValue}=props;const isAggOfNumberType=isNumberType(agg);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(isAggOfNumberType&&!Array.isArray(value)&&value!==undefined){const numberArray=value.split("|").map(item=>parseFloat(item)).filter(number=>Number.isFinite(number));setValue(numberArray.length?numberArray:[""])}else if(!isAggOfNumberType&&Array.isArray(value)&&value!==undefined){setValue(value.filter(item=>item!=="").join("|"))}},[isAggOfNumberType,setValue,value]);return isAggOfNumberType?external_kbnSharedDeps_React_default.a.createElement(SimpleNumberList,include_exclude_extends({},props,{value:value})):external_kbnSharedDeps_React_default.a.createElement(StringParamEditor,include_exclude_extends({},props,{value:value}))}const input_list_generateId=Object(external_kbnSharedDeps_ElasticEui_["htmlIdGenerator"])();const input_list_validateValue=(inputValue,InputObject)=>{const result={model:inputValue||"",isInvalid:false};if(!inputValue){result.isInvalid=false;return result}try{result.model=new InputObject(inputValue).toString();result.isInvalid=false;return result}catch(e){result.isInvalid=true;return result}};function InputList({config:config,list:list,onChange:onChange,setValidity:setValidity}){const{defaultValue:defaultValue,getModelValue:getModelValue,modelNames:modelNames,onChangeFn:onChangeFn,validateClass:validateClass}=config;const[models,setModels]=Object(external_kbnSharedDeps_React_["useState"])(()=>list.map(item=>({id:input_list_generateId(),...getModelValue(item)})));const hasInvalidValues=models.some(config.hasInvalidValuesFn);const updateValues=Object(external_kbnSharedDeps_React_["useCallback"])(modelList=>{setModels(modelList);onChange(modelList.map(onChangeFn))},[onChangeFn,onChange]);const onChangeValue=Object(external_kbnSharedDeps_React_["useCallback"])((index,value,modelName)=>{const{model:model,isInvalid:isInvalid}=input_list_validateValue(value,validateClass);updateValues(models.map((range,arrayIndex)=>arrayIndex===index?{...range,[modelName]:{value:value,model:model,isInvalid:isInvalid}}:range))},[models,updateValues,validateClass]);const onDelete=Object(external_kbnSharedDeps_React_["useCallback"])(id=>updateValues(models.filter(model=>model.id!==id)),[models,updateValues]);const onAdd=Object(external_kbnSharedDeps_React_["useCallback"])(()=>updateValues([...models,{id:input_list_generateId(),...getModelValue()}]),[getModelValue,models,updateValues]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!list.length){updateValues([{id:input_list_generateId(),...defaultValue}])}},[defaultValue,list.length,updateValues]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setValidity(!hasInvalidValues)},[hasInvalidValues,setValidity]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(list.length!==models.length||list.some((item,index)=>{const model=Object(external_kbnSharedDeps_Lodash_["mapValues"])(Object(external_kbnSharedDeps_Lodash_["pick"])(models[index],modelNames),"model");return!Object(external_kbnSharedDeps_Lodash_["isEqual"])(item,Object(external_kbnSharedDeps_Lodash_["omitBy"])(model,external_kbnSharedDeps_Lodash_["isEmpty"]))})){setModels(list.map(item=>({id:input_list_generateId(),...getModelValue(item)})))}},[getModelValue,list,modelNames,models]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,models.map((item,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],{key:item.id},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"xs",alignItems:"center",responsive:false},config.renderInputRow(item,index,onChangeValue),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"aria-label":config.getRemoveBtnAriaLabel(item),title:config.getRemoveBtnAriaLabel(item),disabled:models.length===1,color:"danger",iconType:"trash",onClick:()=>onDelete(item.id)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{iconType:"plusInCircleFilled",onClick:onAdd,size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.controls.ipRanges.addRangeButtonLabel",defaultMessage:"Add range"}))))}function from_to_list_extends(){from_to_list_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return from_to_list_extends.apply(this,arguments)}const from_to_list_EMPTY_STRING="";const defaultConfig={defaultValue:{from:{value:"0.0.0.0",model:"0.0.0.0",isInvalid:false},to:{value:"255.255.255.255",model:"255.255.255.255",isInvalid:false}},validateClass:data_public_["search"].aggs.Ipv4Address,getModelValue:(item={})=>({from:{value:item.from||from_to_list_EMPTY_STRING,model:item.from||from_to_list_EMPTY_STRING,isInvalid:false},to:{value:item.to||from_to_list_EMPTY_STRING,model:item.to||from_to_list_EMPTY_STRING,isInvalid:false}}),getRemoveBtnAriaLabel:item=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.ipRanges.removeRangeAriaLabel",{defaultMessage:"Remove the range of {from} to {to}",values:{from:item.from.value||"*",to:item.to.value||"*"}}),onChangeFn:({from:from,to:to})=>{const result={};if(from.model){result.from=from.model}if(to.model){result.to=to.model}return result},hasInvalidValuesFn:({from:from,to:to})=>from.isInvalid||to.isInvalid,modelNames:["from","to"]};function FromToList({showValidation:showValidation,onBlur:onBlur,...rest}){const renderInputRow=Object(external_kbnSharedDeps_React_["useCallback"])((item,index,onChangeValue)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.ipRanges.ipRangeFromAriaLabel",{defaultMessage:"IP range from: {value}",values:{value:item.from.value||"*"}}),compressed:true,isInvalid:showValidation?item.from.isInvalid:false,placeholder:"*",onChange:ev=>{onChangeValue(index,ev.target.value,"from")},value:item.from.value,onBlur:onBlur})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"sortRight",color:"subdued"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.ipRanges.ipRangeToAriaLabel",{defaultMessage:"IP range to: {value}",values:{value:item.to.value||"*"}}),compressed:true,isInvalid:showValidation?item.to.isInvalid:false,placeholder:"*",onChange:ev=>{onChangeValue(index,ev.target.value,"to")},value:item.to.value,onBlur:onBlur}))),[onBlur,showValidation]);const fromToListConfig={...defaultConfig,renderInputRow:renderInputRow};return external_kbnSharedDeps_React_default.a.createElement(InputList,from_to_list_extends({config:fromToListConfig},rest))}function mask_list_extends(){mask_list_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return mask_list_extends.apply(this,arguments)}const mask_list_EMPTY_STRING="";const mask_list_defaultConfig={defaultValue:{mask:{model:"0.0.0.0/1",value:"0.0.0.0/1",isInvalid:false}},validateClass:data_public_["search"].aggs.CidrMask,getModelValue:(item={})=>({mask:{model:item.mask||mask_list_EMPTY_STRING,value:item.mask||mask_list_EMPTY_STRING,isInvalid:false}}),getRemoveBtnAriaLabel:item=>item.mask.value?external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.ipRanges.removeCidrMaskButtonAriaLabel",{defaultMessage:"Remove the CIDR mask value of {mask}",values:{mask:item.mask.value}}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.ipRanges.removeEmptyCidrMaskButtonAriaLabel",{defaultMessage:"Remove the CIDR mask default value"}),onChangeFn:({mask:mask})=>{if(mask.model){return{mask:mask.model}}return{}},hasInvalidValuesFn:({mask:mask})=>mask.isInvalid,modelNames:"mask"};function MaskList({showValidation:showValidation,onBlur:onBlur,...rest}){const renderInputRow=Object(external_kbnSharedDeps_React_["useCallback"])(({mask:mask},index,onChangeValue)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.ipRanges.cidrMaskAriaLabel",{defaultMessage:"CIDR mask: {mask}",values:{mask:mask.value||"*"}}),compressed:true,fullWidth:true,isInvalid:showValidation?mask.isInvalid:false,placeholder:"*",onChange:ev=>{onChangeValue(index,ev.target.value,"mask")},value:mask.value,onBlur:onBlur})),[onBlur,showValidation]);const maskListConfig={...mask_list_defaultConfig,renderInputRow:renderInputRow};return external_kbnSharedDeps_React_default.a.createElement(InputList,mask_list_extends({config:maskListConfig},rest))}var IpRangeTypes;(function(IpRangeTypes){IpRangeTypes["MASK"]="mask";IpRangeTypes["FROM_TO"]="fromTo"})(IpRangeTypes||(IpRangeTypes={}));function IpRangeTypeParamEditor({agg:agg,value:value,setValue:setValue}){const options=[{id:`visEditorIpRangeFromToLabel${agg.id}`,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.ipRanges.fromToButtonLabel",{defaultMessage:"From/to"})},{id:`visEditorIpRangeCidrLabel${agg.id}`,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.ipRanges.cidrMasksButtonLabel",{defaultMessage:"CIDR masks"})}];const onClick=optionId=>{setValue(optionId===options[0].id?IpRangeTypes.FROM_TO:IpRangeTypes.MASK)};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonGroup"],{isFullWidth:true,onChange:onClick,idSelected:value===IpRangeTypes.FROM_TO?options[0].id:options[1].id,options:options,legend:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.ipRangesAriaLabel",{defaultMessage:"IP ranges"})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}))}function IpRangesParamEditor({agg:agg,value:value={fromTo:[],mask:[]},setTouched:setTouched,setValue:setValue,setValidity:setValidity,showValidation:showValidation}){const handleMaskListChange=Object(external_kbnSharedDeps_React_["useCallback"])(items=>setValue({...value,[IpRangeTypes.MASK]:items}),[setValue,value]);const handleFromToListChange=Object(external_kbnSharedDeps_React_["useCallback"])(items=>setValue({...value,[IpRangeTypes.FROM_TO]:items}),[setValue,value]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true,id:`visEditorIpRange${agg.id}`,display:"rowCompressed"},agg.params.ipRangeType===IpRangeTypes.MASK?external_kbnSharedDeps_React_default.a.createElement(MaskList,{list:value.mask,showValidation:showValidation,onBlur:setTouched,onChange:handleMaskListChange,setValidity:setValidity}):external_kbnSharedDeps_React_default.a.createElement(FromToList,{list:value.fromTo,showValidation:showValidation,onBlur:setTouched,onChange:handleFromToListChange,setValidity:setValidity}))}function is_filtered_by_collar_extends(){is_filtered_by_collar_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return is_filtered_by_collar_extends.apply(this,arguments)}function IsFilteredByCollarParamEditor(props){return external_kbnSharedDeps_React_default.a.createElement(SwitchParamEditor,is_filtered_by_collar_extends({displayLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.onlyRequestDataAroundMapExtentLabel",{defaultMessage:"Only request data around map extent"}),displayToolTip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.onlyRequestDataAroundMapExtentTooltip",{defaultMessage:"Apply geo_bounding_box filter aggregation to narrow the subject area to the map view box with collar"}),dataTestSubj:"isFilteredByCollarCheckbox"},props))}const metric_agg_aggFilter=["!top_hits","!percentiles","!percentile_ranks","!median","!std_dev"];const EMPTY_VALUE="EMPTY_VALUE";const DEFAULT_OPTIONS=[{text:"",value:EMPTY_VALUE,hidden:true}];function MetricAggParamEditor({agg:agg,value:value,showValidation:showValidation,setValue:setValue,setValidity:setValidity,setTouched:setTouched,metricAggs:metricAggs=[]}){const label=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.metricLabel",{defaultMessage:"Metric"});const isValid=!!value;Object(controls_utils["g"])(setValidity,isValid);Object(controls_utils["e"])(setValue,metric_agg_aggFilter,metricAggs,value);const filteredMetrics=Object(external_kbnSharedDeps_React_["useMemo"])(()=>metricAggs.filter(respAgg=>respAgg.type.name!==agg.type.name),[metricAggs,agg.type.name]);const options=Object(controls_utils["d"])(metric_agg_aggFilter,filteredMetrics,DEFAULT_OPTIONS);const onChange=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>setValue(ev.target.value),[setValue]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:label,fullWidth:true,isInvalid:showValidation&&!isValid,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{compressed:true,fullWidth:true,options:options,value:value||EMPTY_VALUE,onChange:onChange,isInvalid:showValidation&&!isValid,onBlur:setTouched,"data-test-subj":`visEditorSubAggMetric${agg.id}`}))}function min_doc_count_extends(){min_doc_count_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return min_doc_count_extends.apply(this,arguments)}function MinDocCountParamEditor(props){return external_kbnSharedDeps_React_default.a.createElement(SwitchParamEditor,min_doc_count_extends({displayLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.showEmptyBucketsLabel",{defaultMessage:"Show empty buckets"}),displayToolTip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.showEmptyBucketsTooltip",{defaultMessage:"Show all buckets, not only the buckets with results"})},props))}function missing_bucket_extends(){missing_bucket_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return missing_bucket_extends.apply(this,arguments)}function MissingBucketParamEditor(props){const fieldTypeIsNotString=!data_public_["search"].aggs.isStringType(props.agg);const{setValue:setValue}=props;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(fieldTypeIsNotString){setValue(false)}},[fieldTypeIsNotString,setValue]);return external_kbnSharedDeps_React_default.a.createElement(SwitchParamEditor,missing_bucket_extends({},props,{dataTestSubj:"missingBucketSwitch",displayLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.otherBucket.showMissingValuesLabel",{defaultMessage:"Show missing values"}),displayToolTip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.otherBucket.showMissingValuesTooltip",{defaultMessage:'Only works for fields of type "string". When enabled, include documents with missing '+"values in the search. If this bucket is in the top N, it appears in the chart. "+'If not in the top N, and you enable "Group other values in separate bucket", '+'Elasticsearch adds the missing values to the "other" bucket.'}),disabled:fieldTypeIsNotString}))}const number_interval_label=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.controls.numberInterval.minimumIntervalLabel",defaultMessage:"Minimum interval"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{position:"right",content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.controls.numberInterval.minimumIntervalTooltip",defaultMessage:"Interval will be automatically scaled in the event that the provided value creates more buckets than specified by Advanced Setting's {histogramMaxBars}",values:{histogramMaxBars:data_public_["UI_SETTINGS"].HISTOGRAM_MAX_BARS}}),type:"questionInCircle"}));const autoInterval="auto";const isAutoInterval=value=>value===autoInterval;const selectIntervalPlaceholder=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.numberInterval.selectIntervalPlaceholder",{defaultMessage:"Enter an interval"});const autoIntervalIsUsedPlaceholder=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.numberInterval.autoInteralIsUsed",{defaultMessage:"Auto interval is used"});const useAutoIntervalLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.useAutoInterval",{defaultMessage:"Use auto interval"});function NumberIntervalParamEditor({agg:agg,editorConfig:editorConfig,showValidation:showValidation,value:value,setTouched:setTouched,setValidity:setValidity,setValue:setValue}){const isAutoChecked=isAutoInterval(value);const base=Object(external_kbnSharedDeps_Lodash_["get"])(editorConfig,"interval.base");const min=base||0;const isValid=value!==""&&value!==undefined&&(isAutoInterval(value)||Number(value)>=min);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setValidity(isValid)},[isValid,setValidity]);const onChange=Object(external_kbnSharedDeps_React_["useCallback"])(({target:target})=>setValue(isNaN(target.valueAsNumber)?"":target.valueAsNumber),[setValue]);const onAutoSwitchChange=Object(external_kbnSharedDeps_React_["useCallback"])(e=>{const isAutoSwitchChecked=e.target.checked;setValue(isAutoSwitchChecked?autoInterval:"")},[setValue]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{display:"rowCompressed",label:number_interval_label,fullWidth:true,isInvalid:showValidation&&!isValid,helpText:Object(external_kbnSharedDeps_Lodash_["get"])(editorConfig,"interval.help")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",responsive:false,direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{label:useAutoIntervalLabel,onChange:onAutoSwitchChange,checked:isAutoChecked,compressed:true,"data-test-subj":`visEditorIntervalSwitch${agg.id}`})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{value:!isAutoChecked?value:"",min:min,step:base||"any","data-test-subj":`visEditorInterval${agg.id}`,isInvalid:showValidation&&!isValid,onChange:onChange,onBlur:setTouched,disabled:isAutoChecked,fullWidth:true,compressed:true,placeholder:isAutoChecked?autoIntervalIsUsedPlaceholder:selectIntervalPlaceholder}))))}const{termsAggFilter:termsAggFilter}=data_public_["search"].aggs;const DEFAULT_VALUE="_key";const order_by_DEFAULT_OPTIONS=[{text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.orderAgg.alphabeticalLabel",{defaultMessage:"Alphabetical"}),value:DEFAULT_VALUE}];const isCompatibleAgg=Object(controls_utils["b"])(termsAggFilter);function OrderByParamEditor({agg:agg,value:value,showValidation:showValidation,setValue:setValue,setValidity:setValidity,setTouched:setTouched,metricAggs:metricAggs}){const label=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.orderAgg.orderByLabel",{defaultMessage:"Order by"});const isValid=!!value;Object(controls_utils["g"])(setValidity,isValid);useMount_default()(()=>{if(!value){let respAgg={id:DEFAULT_VALUE};if(metricAggs){respAgg=metricAggs.filter(isCompatibleAgg)[0]||respAgg}setValue(respAgg.id)}});Object(controls_utils["e"])(setValue,termsAggFilter,metricAggs,value,DEFAULT_VALUE);const options=Object(controls_utils["d"])(termsAggFilter,metricAggs,order_by_DEFAULT_OPTIONS);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:label,fullWidth:true,isInvalid:showValidation&&!isValid,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{options:options,value:value,onChange:ev=>setValue(ev.target.value),fullWidth:true,compressed:true,isInvalid:showValidation&&!isValid,onBlur:setTouched,"data-test-subj":`visEditorOrderBy${agg.id}`}))}function other_bucket_extends(){other_bucket_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return other_bucket_extends.apply(this,arguments)}function OtherBucketParamEditor(props){return external_kbnSharedDeps_React_default.a.createElement(SwitchParamEditor,other_bucket_extends({dataTestSubj:"otherBucketSwitch",displayLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.otherBucket.groupValuesLabel",{defaultMessage:"Group other values in separate bucket"}),displayToolTip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.otherBucket.groupValuesTooltip",{defaultMessage:"Values not in the top N are grouped in this bucket. "+"To include documents with missing values, enable 'Show missing values'."})},props))}function OrderAggParamEditor({agg:agg,aggParam:aggParam,formIsTouched:formIsTouched,value:value,metricAggs:metricAggs,state:state,setValue:setValue,setValidity:setValidity,setTouched:setTouched,schemas:schemas}){const orderBy=agg.params.orderBy;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(orderBy==="custom"&&!value){setValue(aggParam.makeAgg(agg))}if(orderBy!=="custom"&&value){setValue(undefined)}},[agg,aggParam,orderBy,setValue,value]);const{onAggTypeChange:onAggTypeChange,setAggParamValue:setAggParamValue}=Object(controls_utils["f"])(agg,aggParam,value,setValue);if(!agg.params.orderAgg){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(DefaultEditorAggParams,{agg:value,allowedAggs:aggParam.allowedAggs,hideCustomLabel:true,groupName:data_public_["AggGroupNames"].Metrics,className:"visEditorAgg__subAgg",formIsTouched:formIsTouched,indexPattern:agg.getIndexPattern(),metricAggs:metricAggs,state:state,setAggParamValue:setAggParamValue,onAggTypeChange:onAggTypeChange,setValidity:setValidity,setTouched:setTouched,schemas:schemas}))}function NumberList({labelledbyId:labelledbyId,numberArray:numberArray,range:range,showValidation:showValidation,unitName:unitName,validateAscendingOrder:validateAscendingOrder=false,disallowDuplicates:disallowDuplicates=false,onChange:onChange,setTouched:setTouched,setValidity:setValidity}){const numberRange=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getRange(range),[range]);const[models,setModels]=Object(external_kbnSharedDeps_React_["useState"])(getInitModelList(numberArray));Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setModels(state=>getValidatedModels(numberArray,state,numberRange,validateAscendingOrder,disallowDuplicates))},[numberArray,numberRange,validateAscendingOrder,disallowDuplicates]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!numberArray.length){onChange([models[0].value])}},[models,numberArray.length,onChange]);const isValid=!utils_hasInvalidValues(models);Object(controls_utils["g"])(setValidity,isValid);const onUpdate=Object(external_kbnSharedDeps_React_["useCallback"])(modelList=>{setModels(modelList);onChange(modelList.map(({value:value})=>value===EMPTY_STRING?undefined:value))},[onChange]);const onChangeValue=Object(external_kbnSharedDeps_React_["useCallback"])(({id:id,value:value})=>{const parsedValue=parse(value);onUpdate(models.map(model=>{if(model.id===id){return{id:id,value:parsedValue,isInvalid:false}}return model}))},[models,onUpdate]);const onAdd=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{const newArray=[...models,getNextModel(models,numberRange)];onUpdate(newArray)},[models,numberRange,onUpdate]);const onDelete=Object(external_kbnSharedDeps_React_["useCallback"])(id=>{const newArray=models.filter(model=>model.id!==id);onUpdate(newArray)},[models,onUpdate]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,models.map((model,arrayIndex)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],{key:model.id},external_kbnSharedDeps_React_default.a.createElement(NumberRow,{isInvalid:showValidation?model.isInvalid:false,disableDelete:models.length===1,model:model,labelledbyId:labelledbyId,range:numberRange,onDelete:onDelete,onChange:onChangeValue,onBlur:setTouched,autoFocus:models.length!==1&&arrayIndex===models.length-1}),showValidation&&model.isInvalid&&model.error&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormErrorText"],null,model.error),models.length-1!==arrayIndex&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{iconType:"plusInCircleFilled",onClick:onAdd,size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.controls.numberList.addUnitButtonLabel",defaultMessage:"Add {unitName}",values:{unitName:unitName}}))))}function PercentilesEditor({agg:agg,showValidation:showValidation,value:value=[],setTouched:setTouched,setValidity:setValidity,setValue:setValue}){const label=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.percentiles.percentsLabel",{defaultMessage:"Percents"});const[isValid,setIsValid]=Object(external_kbnSharedDeps_React_["useState"])(true);const setModelValidity=Object(external_kbnSharedDeps_React_["useCallback"])(isListValid=>{setIsValid(isListValid);setValidity(isListValid)},[setValidity]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:label,labelType:"legend",fullWidth:true,id:`visEditorPercentileLabel${agg.id}`,isInvalid:showValidation?!isValid:false,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(NumberList,{labelledbyId:`visEditorPercentileLabel${agg.id}-legend`,numberArray:value,range:"[0,100]",disallowDuplicates:true,unitName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.percentileRanks.percentUnitNameText",{defaultMessage:"percent"}),showValidation:showValidation,onChange:setValue,setTouched:setTouched,setValidity:setModelValidity}))}function PercentileRanksEditor({agg:agg,showValidation:showValidation,value:value=[],setTouched:setTouched,setValidity:setValidity,setValue:setValue}){const label=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.percentileRanks.valuesLabel",{defaultMessage:"Values"});const[isValid,setIsValid]=Object(external_kbnSharedDeps_React_["useState"])(true);const setModelValidity=Object(external_kbnSharedDeps_React_["useCallback"])(isListValid=>{setIsValid(isListValid);setValidity(isListValid)},[setValidity]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:label,labelType:"legend",fullWidth:true,id:`visEditorPercentileRanksLabel${agg.id}`,isInvalid:showValidation?!isValid:false,display:"rowCompressed","data-test-subj":"visEditorPercentileRanks"},external_kbnSharedDeps_React_default.a.createElement(NumberList,{labelledbyId:`visEditorPercentileRanksLabel${agg.id}-legend`,numberArray:value,range:"[-Infinity,Infinity]",unitName:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.percentileRanks.valueUnitNameText",{defaultMessage:"value"}),validateAscendingOrder:true,showValidation:showValidation,onChange:setValue,setTouched:setTouched,setValidity:setModelValidity}))}function PrecisionParamEditor({agg:agg,value:value,setValue:setValue}){const{services:services}=Object(public_["useKibana"])();const label=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.precisionLabel",{defaultMessage:"Precision"});if(agg.params.autoPrecision){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:label,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiRange"],{min:1,max:services.uiSettings.get("visualization:tileMap:maxPrecision"),value:value||"",onChange:ev=>setValue(Number(ev.currentTarget.value)),"data-test-subj":`visEditorMapPrecision${agg.id}`,showValue:true,compressed:true}))}var controls_ranges=__webpack_require__(4);const RangesControl=props=>external_kbnSharedDeps_React_default.a.createElement(controls_ranges["b"],{value:props.value,setValue:props.setValue});var github=__webpack_require__(36);function RawJsonParamEditor({showValidation:showValidation,value:value="",setValidity:setValidity,setValue:setValue,setTouched:setTouched}){const[isFieldValid,setFieldValidity]=Object(external_kbnSharedDeps_React_["useState"])(true);const[editorReady,setEditorReady]=Object(external_kbnSharedDeps_React_["useState"])(false);const editorTooltipText=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.jsonInputTooltip",{defaultMessage:"Any JSON formatted properties you add here will be merged with the elasticsearch aggregation definition for this section. For example 'shard_size' on a terms aggregation."}),[]);const jsonEditorLabelText=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.jsonInputLabel",{defaultMessage:"JSON input"}),[]);const label=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,jsonEditorLabelText," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{position:"right",content:editorTooltipText,type:"questionInCircle"})),[jsonEditorLabelText,editorTooltipText]);const onEditorValidate=Object(external_kbnSharedDeps_React_["useCallback"])(annotations=>{if(editorReady){const validity=annotations.length===0;setFieldValidity(validity);setValidity(validity)}else{setEditorReady(true)}},[setValidity,editorReady]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:label,isInvalid:showValidation?!isFieldValid:false,fullWidth:true,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCodeEditor"],{mode:"json",theme:"github",width:"100%",height:"250px",value:value,onValidate:onEditorValidate,setOptions:{fontSize:"14px"},onChange:setValue,onBlur:setTouched,"aria-label":jsonEditorLabelText,"aria-describedby":"jsonEditorDescription"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiScreenReaderOnly"],null,external_kbnSharedDeps_React_default.a.createElement("p",{id:"jsonEditorDescription"},editorTooltipText))))}function scale_metrics_extends(){scale_metrics_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return scale_metrics_extends.apply(this,arguments)}function ScaleMetricsParamEditor(props){return external_kbnSharedDeps_React_default.a.createElement(SwitchParamEditor,scale_metrics_extends({dataTestSubj:"scaleMetricsSwitch",displayLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.scaleMetricsLabel",{defaultMessage:"Scale metric values (deprecated)"}),displayToolTip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.scaleMetricsTooltip",{defaultMessage:"If you select a manual minimum interval and a larger interval will be used, enabling this will "+"cause count and sum metrics to be scaled to the manual selected interval."})},props))}function SizeParamEditor({disabled:disabled,iconTip:iconTip,value:value,setValue:setValue,showValidation:showValidation,setValidity:setValidity,setTouched:setTouched}){const label=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.controls.sizeLabel",defaultMessage:"Size"}),iconTip);const isValid=disabled||Number(value)>0;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setValidity(isValid)},[isValid,setValidity]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:label,fullWidth:true,isInvalid:showValidation?!isValid:false,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{value:Object(external_kbnSharedDeps_Lodash_["isUndefined"])(value)?"":value,onChange:ev=>setValue(ev.target.value===""?"":parseFloat(ev.target.value)),fullWidth:true,compressed:true,isInvalid:showValidation?!isValid:false,onBlur:setTouched,min:1,disabled:disabled,"data-test-subj":"sizeParamEditor"}))}function SubAggParamEditor({agg:agg,aggParam:aggParam,formIsTouched:formIsTouched,metricAggs:metricAggs,state:state,setValue:setValue,setValidity:setValidity,setTouched:setTouched,schemas:schemas}){Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(agg.params.metricAgg!=="custom"){setValue(undefined)}else if(!agg.params.customMetric){setValue(aggParam.makeAgg(agg))}},[metricAggs,agg,setValue,aggParam]);const{onAggTypeChange:onAggTypeChange,setAggParamValue:setAggParamValue}=Object(controls_utils["f"])(agg,aggParam,agg.params.customMetric,setValue);if(agg.params.metricAgg!=="custom"||!agg.params.customMetric){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(DefaultEditorAggParams,{agg:agg.params.customMetric,allowedAggs:aggParam.allowedAggs,groupName:data_public_["AggGroupNames"].Metrics,className:"visEditorAgg__subAgg",formIsTouched:formIsTouched,indexPattern:agg.getIndexPattern(),metricAggs:metricAggs,state:state,setAggParamValue:setAggParamValue,onAggTypeChange:onAggTypeChange,setValidity:setValidity,setTouched:setTouched,schemas:schemas,hideCustomLabel:true}))}function SubMetricParamEditor({agg:agg,aggParam:aggParam,formIsTouched:formIsTouched,metricAggs:metricAggs,state:state,setValue:setValue,setValidity:setValidity,setTouched:setTouched,schemas:schemas}){const metricTitle=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.metrics.metricTitle",{defaultMessage:"Metric"});const bucketTitle=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.metrics.bucketTitle",{defaultMessage:"Bucket"});const type=aggParam.name;const isCustomMetric=type==="customMetric";const aggTitle=isCustomMetric?metricTitle:bucketTitle;const aggGroup=isCustomMetric?data_public_["AggGroupNames"].Metrics:data_public_["AggGroupNames"].Buckets;useMount_default()(()=>{if(agg.params[type]){setValue(agg.params[type])}else{setValue(aggParam.makeAgg(agg))}});const{onAggTypeChange:onAggTypeChange,setAggParamValue:setAggParamValue}=Object(controls_utils["f"])(agg,aggParam,agg.params[type],setValue);if(!agg.params[type]){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,aggTitle),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(DefaultEditorAggParams,{agg:agg.params[type],allowedAggs:aggParam.allowedAggs,groupName:aggGroup,className:"visEditorAgg__subAgg",formIsTouched:formIsTouched,indexPattern:agg.getIndexPattern(),metricAggs:metricAggs,state:state,setAggParamValue:setAggParamValue,onAggTypeChange:onAggTypeChange,setValidity:setValidity,setTouched:setTouched,schemas:schemas,hideCustomLabel:!isCustomMetric}))}const{parseEsInterval:parseEsInterval,InvalidEsCalendarIntervalError:InvalidEsCalendarIntervalError}=data_public_["search"].aggs;function isValidCalendarInterval(interval){if(interval==="0ms"){return{isValidCalendarValue:true}}try{parseEsInterval(interval);return{isValidCalendarValue:true}}catch(e){if(e instanceof InvalidEsCalendarIntervalError){return{isValidCalendarValue:false,error:e.message}}return{isValidCalendarValue:true}}}const errorMessage=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.timeInterval.invalidFormatErrorMessage",{defaultMessage:"Invalid interval format."});const time_interval_autoInterval="auto";function validateInterval(agg,value,definedOption,timeBase){var _agg$buckets2;if(definedOption){var _agg$buckets;return{isValid:true,interval:(_agg$buckets=agg.buckets)===null||_agg$buckets===void 0?void 0:_agg$buckets.getInterval()}}if(!value||value===time_interval_autoInterval&&!definedOption){return{isValid:false}}if(!timeBase){const{isValidCalendarValue:isValidCalendarValue,error:error}=isValidCalendarInterval(value);if(!isValidCalendarValue){return{isValid:false,error:error}}}const isValid=data_public_["search"].aggs.isValidInterval(value,timeBase);if(!isValid){return{isValid:false,error:errorMessage}}const interval=(_agg$buckets2=agg.buckets)===null||_agg$buckets2===void 0?void 0:_agg$buckets2.getInterval();const{isValidCalendarValue:isValidCalendarValue,error:error}=isValidCalendarInterval(interval.expression);if(!isValidCalendarValue){return{isValid:false,error:error}}return{isValid:isValid,interval:interval}}function TimeIntervalParamEditor({agg:agg,aggParam:aggParam,editorConfig:editorConfig,value:value,setValue:setValue,showValidation:showValidation,setTouched:setTouched,setValidity:setValidity}){const timeBase=Object(external_kbnSharedDeps_Lodash_["get"])(editorConfig,"interval.timeBase");const options=timeBase?[]:(aggParam.options||[]).reduce((filtered,option)=>{if(option.enabled?option.enabled(agg):true){filtered.push({label:option.display,key:option.val})}return filtered},[]);let selectedOptions=[];let definedOption;if(value){definedOption=Object(external_kbnSharedDeps_Lodash_["find"])(options,{key:value});selectedOptions=definedOption?[definedOption]:value===time_interval_autoInterval?[]:[{label:value,key:"custom"}]}const{isValid:isValid,error:error,interval:interval}=validateInterval(agg,value,definedOption,timeBase);const scaledHelpText=interval&&interval.scaled?external_kbnSharedDeps_React_default.a.createElement("strong",{"data-test-subj":"currentlyScaledText",className:"eui-displayBlock"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.controls.timeInterval.scaledHelpText",defaultMessage:"Currently scaled to {bucketDescription}",values:{bucketDescription:Object(external_kbnSharedDeps_Lodash_["get"])(interval,"description")||""}})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{position:"right",type:"questionInCircle",content:interval.scale<=1?tooManyBucketsTooltip:tooLargeBucketsTooltip})):null;const helpText=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,scaledHelpText,Object(external_kbnSharedDeps_Lodash_["get"])(editorConfig,"interval.help")||selectOptionHelpText);const onCustomInterval=customValue=>setValue(customValue.trim());const onChange=opts=>{const selectedOpt=Object(external_kbnSharedDeps_Lodash_["get"])(opts,"0");setValue(selectedOpt?selectedOpt.key:"")};Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setValidity(isValid)},[isValid,setValidity]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{display:"rowCompressed",error:error,fullWidth:true,helpText:helpText,isInvalid:showValidation&&!isValid,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.timeInterval.minimumIntervalLabel",{defaultMessage:"Minimum interval"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{compressed:true,fullWidth:true,"data-test-subj":"visEditorInterval",isInvalid:showValidation&&!isValid,noSuggestions:!!timeBase,onChange:onChange,onCreateOption:onCustomInterval,options:options,selectedOptions:selectedOptions,singleSelection:{asPlainText:true},placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.timeInterval.selectIntervalPlaceholder",{defaultMessage:"Select an interval"}),onBlur:setTouched}))}const tooManyBucketsTooltip=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.controls.timeInterval.createsTooManyBucketsTooltip",defaultMessage:"This interval creates too many buckets to show in the selected time range, so it has been scaled up."});const tooLargeBucketsTooltip=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.controls.timeInterval.createsTooLargeBucketsTooltip",defaultMessage:"This interval creates buckets that are too large to show in the selected time range, so it has been scaled down."});const selectOptionHelpText=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.controls.timeInterval.selectOptionHelpText",defaultMessage:"Select an option or create a custom value. Examples: 30s, 20m, 24h, 2d, 1w, 1M"});function getCompatibleAggs(agg){const{options:options=[]}=agg.getAggParams().find(({name:name})=>name==="aggregate");return options.filter(option=>option.isCompatible(agg))}function TopAggregateParamEditor({agg:agg,aggParam:aggParam,value:value,showValidation:showValidation,setValue:setValue,setValidity:setValidity,setTouched:setTouched}){const isFirstRun=Object(external_kbnSharedDeps_React_["useRef"])(true);const fieldType=agg.params.field&&agg.params.field.type;const emptyValue={text:"",value:"EMPTY_VALUE",disabled:true,hidden:true};const filteredOptions=getCompatibleAggs(agg).map(({text:text,value:val})=>({text:text,value:val})).sort((a,b)=>a.text.toLowerCase().localeCompare(b.text.toLowerCase()));const options=[emptyValue,...filteredOptions];const disabled=fieldType&&!filteredOptions.length;const isValid=disabled||!!value;const label=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.controls.aggregateWithLabel",defaultMessage:"Aggregate with"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{position:"right",type:"questionInCircle",content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.aggregateWithTooltip",{defaultMessage:"Choose a strategy for combining multiple hits or a multi-valued field into a single metric."})}));Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setValidity(isValid)},[isValid,setValidity]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(isFirstRun.current){isFirstRun.current=false;return}if(value){if(aggParam.options.find(opt=>opt.value===value.value)){return}setValue()}if(filteredOptions.length===1){setValue(aggParam.options.find(opt=>opt.value===filteredOptions[0].value))}},[aggParam.options,fieldType,filteredOptions,setValue,value]);const handleChange=event=>{if(event.target.value===emptyValue.value){setValue()}else{setValue(aggParam.options.find(opt=>opt.value===event.target.value))}};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:label,fullWidth:true,isInvalid:showValidation?!isValid:false,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{options:options,value:value?value.value:emptyValue.value,onChange:handleChange,fullWidth:true,compressed:true,isInvalid:showValidation?!isValid:false,disabled:disabled,onBlur:setTouched,"data-test-subj":"visDefaultEditorAggregateWith"}))}function top_field_extends(){top_field_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return top_field_extends.apply(this,arguments)}function TopFieldParamEditor(props){const compatibleAggs=getCompatibleAggs(props.agg);let customError;if(props.value&&!compatibleAggs.length){customError=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.aggregateWith.noAggsErrorTooltip",{defaultMessage:"The chosen field has no compatible aggregations."})}return external_kbnSharedDeps_React_default.a.createElement(FieldParamEditor,top_field_extends({},props,{customError:customError}))}function top_size_extends(){top_size_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return top_size_extends.apply(this,arguments)}function TopSizeParamEditor(props){const iconTip=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{position:"right",content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.sizeTooltip",{defaultMessage:"Request top-K hits. Multiple hits will be combined via 'aggregate with'."}),type:"questionInCircle"}));const fieldType=props.agg.params.field&&props.agg.params.field.type;const disabled=fieldType&&!getCompatibleAggs(props.agg).length;return external_kbnSharedDeps_React_default.a.createElement(SizeParamEditor,top_size_extends({},props,{iconTip:iconTip,disabled:disabled}))}function top_sort_field_extends(){top_sort_field_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return top_sort_field_extends.apply(this,arguments)}function TopSortFieldParamEditor(props){const customLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.sortOnLabel",{defaultMessage:"Sort on"});return external_kbnSharedDeps_React_default.a.createElement(FieldParamEditor,top_sort_field_extends({},props,{customLabel:customLabel}))}function OrderParamEditor({aggParam:aggParam,value:value,showValidation:showValidation,setValue:setValue,setValidity:setValidity,setTouched:setTouched}){const label=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.orderLabel",{defaultMessage:"Order"});const isValid=!!value;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setValidity(isValid)},[isValid,setValidity]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:label,fullWidth:true,isInvalid:showValidation?!isValid:false,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{options:aggParam.options,value:value&&value.value,onChange:ev=>setValue(aggParam.options.find(opt=>opt.value===ev.target.value)),fullWidth:true,compressed:true,isInvalid:showValidation?!isValid:false,onBlur:setTouched}))}function UseGeocentroidParamEditor({value:value=false,setValue:setValue}){const label=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.placeMarkersOffGridLabel",{defaultMessage:"Place markers off grid (use geocentroid)"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{compressed:true,label:label,checked:value,onChange:ev=>setValue(ev.target.checked)}))}const autoPlaceholder=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.maxBars.autoPlaceholder",{defaultMessage:"Auto"});const max_bars_label=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.controls.maxBars.maxBarsLabel",defaultMessage:"Max bars"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{position:"right",content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.controls.maxBars.maxBarsHelpText",defaultMessage:"Intervals will be selected automatically based on the available data. The maximum number of bars can never be greater than the Advanced Setting's {histogramMaxBars}",values:{histogramMaxBars:data_public_["UI_SETTINGS"].HISTOGRAM_MAX_BARS}}),type:"questionInCircle"}));function MaxBarsParamEditor({disabled:disabled,iconTip:iconTip,value:value,setValue:setValue,showValidation:showValidation,setValidity:setValidity,setTouched:setTouched}){var _services$uiSettings;const{services:services}=Object(public_["useKibana"])();const uiSettingMaxBars=(_services$uiSettings=services.uiSettings)===null||_services$uiSettings===void 0?void 0:_services$uiSettings.get(data_public_["UI_SETTINGS"].HISTOGRAM_MAX_BARS);const isValid=disabled||value===undefined||value===""||Number(value)>0||value<uiSettingMaxBars;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setValidity(isValid)},[isValid,setValidity]);const onChange=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>setValue(ev.target.value===""?"":parseFloat(ev.target.value)),[setValue]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:max_bars_label,fullWidth:true,isInvalid:showValidation?!isValid:false,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{value:value||"",placeholder:autoPlaceholder,onChange:onChange,min:1,fullWidth:true,compressed:true,max:uiSettingMaxBars,isInvalid:showValidation?!isValid:false,onBlur:setTouched,disabled:disabled,"data-test-subj":"maxBarsParamEditor"}))}const{siblingPipelineType:siblingPipelineType,parentPipelineType:parentPipelineType}=data_public_["search"].aggs;const buckets={[data_public_["BUCKET_TYPES"].DATE_HISTOGRAM]:{scaleMetricValues:ScaleMetricsParamEditor,interval:TimeIntervalParamEditor,drop_partials:DropPartialsParamEditor},[data_public_["BUCKET_TYPES"].DATE_RANGE]:{ranges:DateRangesParamEditor},[data_public_["BUCKET_TYPES"].FILTERS]:{filters:FiltersParamEditor},[data_public_["BUCKET_TYPES"].GEOHASH_GRID]:{autoPrecision:AutoPrecisionParamEditor,precision:PrecisionParamEditor,useGeocentroid:UseGeocentroidParamEditor,isFilteredByCollar:IsFilteredByCollarParamEditor},[data_public_["BUCKET_TYPES"].HISTOGRAM]:{interval:NumberIntervalParamEditor,maxBars:MaxBarsParamEditor,min_doc_count:MinDocCountParamEditor,has_extended_bounds:HasExtendedBoundsParamEditor,extended_bounds:ExtendedBoundsParamEditor},[data_public_["BUCKET_TYPES"].IP_RANGE]:{ipRangeType:IpRangeTypeParamEditor,ranges:IpRangesParamEditor},[data_public_["BUCKET_TYPES"].RANGE]:{ranges:RangesControl},[data_public_["BUCKET_TYPES"].SIGNIFICANT_TERMS]:{size:SizeParamEditor},[data_public_["BUCKET_TYPES"].TERMS]:{include:IncludeExcludeParamEditor,exclude:IncludeExcludeParamEditor,orderBy:OrderByParamEditor,orderAgg:OrderAggParamEditor,order:Object(controls_utils["h"])(OrderParamEditor),size:Object(controls_utils["h"])(SizeParamEditor),otherBucket:OtherBucketParamEditor,missingBucket:MissingBucketParamEditor}};const metrics={[data_public_["METRIC_TYPES"].TOP_HITS]:{field:TopFieldParamEditor,aggregate:Object(controls_utils["h"])(TopAggregateParamEditor),size:Object(controls_utils["h"])(TopSizeParamEditor),sortField:TopSortFieldParamEditor,sortOrder:OrderParamEditor},[data_public_["METRIC_TYPES"].PERCENTILES]:{percents:PercentilesEditor},[data_public_["METRIC_TYPES"].PERCENTILE_RANKS]:{values:PercentileRanksEditor}};const aggParamsMap={common:{string:StringParamEditor,json:RawJsonParamEditor,field:FieldParamEditor},[siblingPipelineType]:{customBucket:SubMetricParamEditor,customMetric:SubMetricParamEditor},[parentPipelineType]:{metricAgg:MetricAggParamEditor,customMetric:SubAggParamEditor},[data_public_["AggGroupNames"].Buckets]:buckets,[data_public_["AggGroupNames"].Metrics]:metrics};function getAggParamsToRender({agg:agg,editorConfig:editorConfig,metricAggs:metricAggs,state:state,schemas:schemas,hideCustomLabel:hideCustomLabel}){const params={basic:[],advanced:[]};const paramsToRender=agg.type&&agg.type.params.filter(param=>!Object(external_kbnSharedDeps_Lodash_["get"])(editorConfig,[param.name,"hidden"],false))||[];const schema=getSchemaByName(schemas,agg.schema);paramsToRender.forEach((param,index)=>{let indexedFields=[];let fields;if(hideCustomLabel&&param.name==="customLabel"){return}if(param.type==="field"){let availableFields=param.getAvailableFields(agg);if(agg.type.name==="top_hits"&&param.name==="field"){const allowStrings=Object(external_kbnSharedDeps_Lodash_["get"])(schema,`aggSettings[${agg.type.name}].allowStrings`,false);if(!allowStrings){availableFields=availableFields.filter(field=>field.type==="number")}}fields=filterAggTypeFields(availableFields,agg);indexedFields=Object(utils["a"])(fields,"type","displayName","name");if(fields&&!indexedFields.length&&index>0){return}}const type=param.advanced?"advanced":"basic";let paramEditor;if(agg.type.subtype&&aggParamsMap[agg.type.subtype]){paramEditor=Object(external_kbnSharedDeps_Lodash_["get"])(aggParamsMap,[agg.type.subtype,param.name])}else{const aggType=agg.type.type;const aggName=agg.type.name;const aggParams=Object(external_kbnSharedDeps_Lodash_["get"])(aggParamsMap,[aggType,aggName],{});paramEditor=Object(external_kbnSharedDeps_Lodash_["get"])(aggParams,param.name)}if(!paramEditor){paramEditor=Object(external_kbnSharedDeps_Lodash_["get"])(aggParamsMap,["common",param.type])}if(paramEditor){params[type].push({agg:agg,aggParam:param,editorConfig:editorConfig,indexedFields:indexedFields,paramEditor:paramEditor,metricAggs:metricAggs,state:state,value:agg.params[param.name],schemas:schemas,hideCustomLabel:hideCustomLabel})}});return params}function getAggTypeOptions(aggTypes,agg,indexPattern,groupName,allowedAggs){const aggTypeOptions=filterAggTypes(aggTypes[groupName],indexPattern,agg,allowedAggs);return Object(utils["a"])(aggTypeOptions,"subtype","title")}function isInvalidParamsTouched(aggType,aggTypeState,aggParams){if(!aggType){return aggTypeState.touched}const invalidParams=Object.values(aggParams).filter(param=>!param.valid);if(Object(external_kbnSharedDeps_Lodash_["isEmpty"])(invalidParams)){return false}return invalidParams.every(param=>param.touched)}function buildAggDescription(agg){let description="";if(agg.type&&agg.type.makeLabel){try{description=agg.type.makeLabel(agg)}catch(e){}}return description}function getEditorConfig(indexPattern,aggTypeName,fieldName){const aggRestrictions=indexPattern.getAggregationRestrictions();if(!aggRestrictions||!aggTypeName||!fieldName){return{}}if(aggTypeName==="terms"){return{otherBucket:{hidden:true},missingBucket:{hidden:true}}}const fieldAgg=aggRestrictions[aggTypeName]&&aggRestrictions[aggTypeName][fieldName];if(!fieldAgg){return{}}if(aggTypeName==="histogram"){const interval=fieldAgg.interval;return interval?{intervalBase:{fixedValue:interval},interval:{base:interval,help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.editorConfig.histogram.interval.helpText",{defaultMessage:"Must be a multiple of configuration interval: {interval}",values:{interval:interval}})}}:{}}if(aggTypeName==="date_histogram"){const interval=fieldAgg.calendar_interval||fieldAgg.fixed_interval;return{useNormalizedEsInterval:{fixedValue:false},interval:{default:interval,timeBase:interval,help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.editorConfig.dateHistogram.customInterval.helpText",{defaultMessage:"Must be a multiple of configuration interval: {interval}",values:{interval:interval}})}}}return{}}function agg_params_extends(){agg_params_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return agg_params_extends.apply(this,arguments)}const FIXED_VALUE_PROP="fixedValue";const DEFAULT_PROP="default";function DefaultEditorAggParams({agg:agg,aggError:aggError,aggIndex:aggIndex=0,aggIsTooLow:aggIsTooLow=false,className:className,disabledParams:disabledParams,groupName:groupName,formIsTouched:formIsTouched,indexPattern:indexPattern,metricAggs:metricAggs,state:state,setAggParamValue:setAggParamValue,onAggTypeChange:onAggTypeChange,setTouched:setTouched,setValidity:setValidity,schemas:schemas,allowedAggs:allowedAggs=[],hideCustomLabel:hideCustomLabel=false}){var _agg$type,_agg$params,_agg$params$field;const schema=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getSchemaByName(schemas,agg.schema),[agg.schema,schemas]);const aggFilter=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[...allowedAggs,...schema.aggFilter||[]],[allowedAggs,schema.aggFilter]);const{services:services}=Object(public_["useKibana"])();const aggTypes=Object(external_kbnSharedDeps_React_["useMemo"])(()=>services.data.search.aggs.types.getAll(),[services.data.search.aggs.types]);const groupedAggTypeOptions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getAggTypeOptions(aggTypes,agg,indexPattern,groupName,aggFilter),[aggTypes,agg,indexPattern,groupName,aggFilter]);const error=aggIsTooLow?external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.aggParams.errors.aggWrongRunOrderErrorMessage",{defaultMessage:'"{schema}" aggs must run before all other buckets!',values:{schema:schema.title}}):"";const aggTypeName=(_agg$type=agg.type)===null||_agg$type===void 0?void 0:_agg$type.name;const fieldName=(_agg$params=agg.params)===null||_agg$params===void 0?void 0:(_agg$params$field=_agg$params.field)===null||_agg$params$field===void 0?void 0:_agg$params$field.name;const editorConfig=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getEditorConfig(indexPattern,aggTypeName,fieldName),[indexPattern,aggTypeName,fieldName]);const params=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getAggParamsToRender({agg:agg,editorConfig:editorConfig,metricAggs:metricAggs,state:state,schemas:schemas,hideCustomLabel:hideCustomLabel}),[agg,editorConfig,metricAggs,state,schemas,hideCustomLabel]);const allParams=[...params.basic,...params.advanced];const[paramsState,onChangeParamsState]=Object(external_kbnSharedDeps_React_["useReducer"])(aggParamsReducer,allParams,initAggParamsState);const[aggType,onChangeAggType]=Object(external_kbnSharedDeps_React_["useReducer"])(aggTypeReducer,{touched:false,valid:true});const isFormValid=!error&&aggType.valid&&Object.entries(paramsState).every(([,paramState])=>paramState.valid);const isAllInvalidParamsTouched=!!error||isInvalidParamsTouched(agg.type,aggType,paramsState);const onAggSelect=Object(external_kbnSharedDeps_React_["useCallback"])(value=>{if(agg.type!==value){onAggTypeChange(agg.id,value);onChangeParamsState({type:AGG_PARAMS_ACTION_KEYS.RESET})}},[onAggTypeChange,agg]);useUnmount_default()(()=>setValidity(true));Object(external_kbnSharedDeps_React_["useEffect"])(()=>{Object.entries(editorConfig).forEach(([param,paramConfig])=>{const paramOptions=agg.type.params.find(paramOption=>paramOption.name===param);const hasFixedValue=paramConfig.hasOwnProperty(FIXED_VALUE_PROP);const hasDefault=paramConfig.hasOwnProperty(DEFAULT_PROP);if(hasFixedValue||hasDefault){let newValue;let property=FIXED_VALUE_PROP;let typedParamConfig=paramConfig;if(hasDefault){property=DEFAULT_PROP;typedParamConfig=paramConfig}if(paramOptions&&paramOptions.deserialize){newValue=paramOptions.deserialize(typedParamConfig[property])}else{newValue=typedParamConfig[property]}if(agg.params[param]!==newValue){setAggParamValue(agg.id,param,newValue)}}})},[editorConfig]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setTouched(false)},[agg.type,setTouched]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setValidity(isFormValid)},[isFormValid,agg.type,setValidity]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setTouched(isAllInvalidParamsTouched)},[isAllInvalidParamsTouched,setTouched]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiForm"],{className:className,isInvalid:!!error,error:error,"data-test-subj":"visAggEditorParams"},external_kbnSharedDeps_React_default.a.createElement(DefaultEditorAggSelect,{aggError:aggError,id:agg.id,indexPattern:indexPattern,value:agg.type,aggTypeOptions:groupedAggTypeOptions,isSubAggregation:aggIndex>=1&&groupName===data_public_["AggGroupNames"].Buckets,showValidation:formIsTouched||aggType.touched,setValue:onAggSelect,onChangeAggType:onChangeAggType}),params.basic.map(param=>{const model=paramsState[param.aggParam.name]||{touched:false,valid:true};return external_kbnSharedDeps_React_default.a.createElement(DefaultEditorAggParam,agg_params_extends({key:`${param.aggParam.name}${agg.type?agg.type.name:""}`,disabled:disabledParams&&disabledParams.includes(param.aggParam.name),formIsTouched:formIsTouched,showValidation:formIsTouched||model.touched,setAggParamValue:setAggParamValue,onChangeParamsState:onChangeParamsState},param))}),params.advanced.length?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAccordion"],{id:"advancedAccordion","data-test-subj":`advancedParams-${agg.id}`,buttonContent:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.advancedToggle.advancedLinkLabel",{defaultMessage:"Advanced"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),params.advanced.map(param=>{const model=paramsState[param.aggParam.name]||{touched:false,valid:true};return external_kbnSharedDeps_React_default.a.createElement(DefaultEditorAggParam,agg_params_extends({key:`${param.aggParam.name}${agg.type?agg.type.name:""}`,disabled:disabledParams&&disabledParams.includes(param.aggParam.name),formIsTouched:formIsTouched,showValidation:formIsTouched||model.touched,setAggParamValue:setAggParamValue,onChangeParamsState:onChangeParamsState},param))}))):null)}let AGGS_ACTION_KEYS;(function(AGGS_ACTION_KEYS){AGGS_ACTION_KEYS["TOUCHED"]="aggsTouched";AGGS_ACTION_KEYS["VALID"]="aggsValid"})(AGGS_ACTION_KEYS||(AGGS_ACTION_KEYS={}));function aggGroupReducer(state,action){const aggState=state[action.aggId]||{touched:false,valid:true};switch(action.type){case AGGS_ACTION_KEYS.TOUCHED:return{...state,[action.aggId]:{...aggState,touched:action.payload}};case AGGS_ACTION_KEYS.VALID:return{...state,[action.aggId]:{...aggState,valid:action.payload}};default:throw new Error}}function initAggsState(group){return group.reduce((state,agg)=>{state[agg.id]={touched:false,valid:true};return state},{})}const PARAMS={NAME:"row",ROWS:"visEditorSplitBy__true",COLUMNS:"visEditorSplitBy__false"};function RowsOrColumnsControl({editorStateParams:editorStateParams,setStateParamValue:setStateParamValue}){if(editorStateParams.row===undefined){setStateParamValue(PARAMS.NAME,true)}const idSelected=`visEditorSplitBy__${editorStateParams.row}`;const options=[{id:PARAMS.ROWS,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.rowsLabel",{defaultMessage:"Rows"}),"data-test-subj":"visEditorSplitBy-Rows"},{id:PARAMS.COLUMNS,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.columnsLabel",{defaultMessage:"Columns"}),"data-test-subj":"visEditorSplitBy-Columns"}];const onChange=Object(external_kbnSharedDeps_React_["useCallback"])(optionId=>setStateParamValue(PARAMS.NAME,optionId===PARAMS.ROWS),[setStateParamValue]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{display:"rowCompressed",fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonGroup"],{"data-test-subj":"visEditorSplitBy",legend:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.splitByLegend",{defaultMessage:"Split chart by rows or columns."}),options:options,isFullWidth:true,idSelected:idSelected,onChange:onChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}))}const radius_ratio_option_DEFAULT_VALUE=50;const PARAM_NAME="radiusRatio";function RadiusRatioOptionControl({editorStateParams:editorStateParams,setStateParamValue:setStateParamValue}){const label=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.controls.dotSizeRatioLabel",defaultMessage:"Dot size ratio"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{content:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.controls.dotSizeRatioHelpText",{defaultMessage:"Change the ratio of the radius of the smallest point to the largest point."}),position:"right"}));useMount_default()(()=>{if(!editorStateParams.radiusRatio){setStateParamValue(PARAM_NAME,radius_ratio_option_DEFAULT_VALUE)}});const onChange=Object(external_kbnSharedDeps_React_["useCallback"])(e=>setStateParamValue(PARAM_NAME,parseFloat(e.currentTarget.value)),[setStateParamValue]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true,label:label,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiRange"],{compressed:true,fullWidth:true,min:1,max:100,value:editorStateParams.radiusRatio||radius_ratio_option_DEFAULT_VALUE,onChange:onChange,showRange:true,showValue:true,valueAppend:"%"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}))}function DefaultEditorAgg({agg:agg,aggIndex:aggIndex,aggIsTooLow:aggIsTooLow,dragHandleProps:dragHandleProps,formIsTouched:formIsTouched,groupName:groupName,isDisabled:isDisabled,isDraggable:isDraggable,isLastBucket:isLastBucket,isRemovable:isRemovable,metricAggs:metricAggs,lastParentPipelineAggTitle:lastParentPipelineAggTitle,state:state,setAggParamValue:setAggParamValue,setStateParamValue:setStateParamValue,onAggTypeChange:onAggTypeChange,onToggleEnableAgg:onToggleEnableAgg,removeAgg:removeAgg,setAggsState:setAggsState,schemas:schemas,timeRange:timeRange}){var _agg$type;const[isEditorOpen,setIsEditorOpen]=Object(external_kbnSharedDeps_React_["useState"])(agg.brandNew);const[validState,setValidState]=Object(external_kbnSharedDeps_React_["useState"])(true);const showDescription=!isEditorOpen&&validState;const showError=!isEditorOpen&&!validState;const aggName=(_agg$type=agg.type)===null||_agg$type===void 0?void 0:_agg$type.name;const schemaTitle=getSchemaByName(schemas,agg.schema).title;let disabledParams;let aggError;const isLastBucketAgg=isLastBucket&&lastParentPipelineAggTitle&&agg.type;let SchemaComponent;if(agg.schema==="split"){SchemaComponent=RowsOrColumnsControl}if(agg.schema==="radius"){SchemaComponent=RadiusRatioOptionControl}if(isLastBucketAgg){if(["date_histogram","histogram"].includes(aggName)){disabledParams=["min_doc_count"]}else{aggError=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.metrics.wrongLastBucketTypeErrorMessage",{defaultMessage:'Last bucket aggregation must be "Date Histogram" or "Histogram" when using "{type}" metric aggregation.',values:{type:lastParentPipelineAggTitle},description:"Date Histogram and Histogram should not be translated"})}}const[aggDescription,setAggDescription]=Object(external_kbnSharedDeps_React_["useState"])(buildAggDescription(agg));Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(timeRange&&aggName==="date_histogram"){agg.aggConfigs.setTimeRange(timeRange)}setAggDescription(buildAggDescription(agg))},[agg,aggName,timeRange]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(isLastBucketAgg&&["date_histogram","histogram"].includes(aggName)){setAggParamValue(agg.id,"min_doc_count",aggName==="histogram"?true:0)}},[aggName,isLastBucketAgg,agg.id,setAggParamValue]);const setTouched=Object(external_kbnSharedDeps_React_["useCallback"])(touched=>{setAggsState({type:AGGS_ACTION_KEYS.TOUCHED,payload:touched,aggId:agg.id})},[agg.id,setAggsState]);const setValidity=Object(external_kbnSharedDeps_React_["useCallback"])(isValid=>{setAggsState({type:AGGS_ACTION_KEYS.VALID,payload:isValid,aggId:agg.id});setValidState(isValid)},[agg.id,setAggsState]);const onToggle=Object(external_kbnSharedDeps_React_["useCallback"])(isOpen=>{setIsEditorOpen(isOpen);if(!isOpen){setTouched(true)}},[setTouched]);const renderAggButtons=()=>{var _agg$type2,_agg$type2$title;const actionIcons=[];const aggTitle=(_agg$type2=agg.type)===null||_agg$type2===void 0?void 0:(_agg$type2$title=_agg$type2.title)===null||_agg$type2$title===void 0?void 0:_agg$type2$title.toLowerCase();if(showError){actionIcons.push({id:"hasErrors",color:"danger",type:"alert",tooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.agg.errorsAriaLabel",{defaultMessage:"{schemaTitle} {aggTitle} aggregation has errors",values:{aggTitle:aggTitle,schemaTitle:schemaTitle}}),dataTestSubj:"hasErrorsAggregationIcon"})}if(agg.enabled&&isRemovable){actionIcons.push({id:"disableAggregation",color:"text",disabled:isDisabled,type:"eye",onClick:()=>onToggleEnableAgg(agg.id,false),tooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.agg.disableAggButtonTooltip",{defaultMessage:"Disable {schemaTitle} {aggTitle} aggregation",values:{aggTitle:aggTitle,schemaTitle:schemaTitle}}),dataTestSubj:"toggleDisableAggregationBtn disable"})}if(!agg.enabled){actionIcons.push({id:"enableAggregation",color:"text",type:"eyeClosed",onClick:()=>onToggleEnableAgg(agg.id,true),tooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.agg.enableAggButtonTooltip",{defaultMessage:"Enable {schemaTitle} {aggTitle} aggregation",values:{aggTitle:aggTitle,schemaTitle:schemaTitle}}),dataTestSubj:"toggleDisableAggregationBtn enable"})}if(isDraggable){actionIcons.push({id:"dragHandle",type:"grab",tooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.agg.modifyPriorityButtonTooltip",{defaultMessage:"Modify priority of {schemaTitle} {aggTitle} by dragging",values:{aggTitle:aggTitle,schemaTitle:schemaTitle}}),dataTestSubj:"dragHandleBtn"})}if(isRemovable){actionIcons.push({id:"removeDimension",color:"danger",type:"cross",onClick:()=>removeAgg(agg.id),tooltip:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.agg.removeDimensionButtonTooltip",{defaultMessage:"Remove {schemaTitle} {aggTitle} aggregation",values:{aggTitle:aggTitle,schemaTitle:schemaTitle}}),dataTestSubj:"removeDimensionBtn"})}return external_kbnSharedDeps_React_default.a.createElement("div",dragHandleProps,actionIcons.map(icon=>{if(icon.id==="dragHandle"){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{key:icon.id,type:icon.type,content:icon.tooltip,iconProps:{["aria-label"]:icon.tooltip,["data-test-subj"]:icon.dataTestSubj},position:"bottom"})}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{key:icon.id,position:"bottom",content:icon.tooltip},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{disabled:icon.disabled,iconType:icon.type,color:icon.color,onClick:icon.onClick,"aria-label":icon.tooltip,"data-test-subj":icon.dataTestSubj}))}))};const buttonContent=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,schemaTitle||agg.schema," ",showDescription&&external_kbnSharedDeps_React_default.a.createElement("span",null,aggDescription));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAccordion"],{id:`visEditorAggAccordion${agg.id}`,initialIsOpen:isEditorOpen,buttonContent:buttonContent,buttonClassName:"eui-textTruncate",buttonContentClassName:"visEditorSidebar__aggGroupAccordionButtonContent eui-textTruncate",className:"visEditorSidebar__section visEditorSidebar__collapsible visEditorSidebar__collapsible--marginBottom","aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.agg.toggleEditorButtonAriaLabel",{defaultMessage:"Toggle {schema} editor",values:{schema:schemaTitle||agg.schema}}),"data-test-subj":`visEditorAggAccordion${agg.id}`,extraAction:renderAggButtons(),onToggle:onToggle},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),SchemaComponent&&external_kbnSharedDeps_React_default.a.createElement(SchemaComponent,{agg:agg,editorStateParams:state.params,setAggParamValue:setAggParamValue,setStateParamValue:setStateParamValue}),external_kbnSharedDeps_React_default.a.createElement(DefaultEditorAggParams,{agg:agg,aggError:aggError,aggIndex:aggIndex,aggIsTooLow:aggIsTooLow,disabledParams:disabledParams,formIsTouched:formIsTouched,groupName:groupName,indexPattern:agg.getIndexPattern(),metricAggs:metricAggs,state:state,setAggParamValue:setAggParamValue,onAggTypeChange:onAggTypeChange,setTouched:setTouched,setValidity:setValidity,schemas:schemas})))}function DefaultEditorAggAdd({group:group=[],groupName:groupName,schemas:schemas,addSchema:addSchema,stats:stats}){const[isPopoverOpen,setIsPopoverOpen]=Object(external_kbnSharedDeps_React_["useState"])(false);const onSelectSchema=schema=>{setIsPopoverOpen(false);addSchema(schema)};const groupNameLabel=groupName===data_public_["AggGroupNames"].Buckets?external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.aggAdd.bucketLabel",{defaultMessage:"bucket"}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.aggAdd.metricLabel",{defaultMessage:"metric"});const addButton=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{size:"xs",iconType:"plusInCircleFilled","data-test-subj":`visEditorAdd_${groupName}`,onClick:()=>setIsPopoverOpen(!isPopoverOpen),"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.aggAdd.addGroupButtonLabel",{defaultMessage:"Add {groupNameLabel}",values:{groupNameLabel:groupNameLabel}})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.aggAdd.addButtonLabel",defaultMessage:"Add"}));const isMaxedCount=schema=>{const count=group.filter(agg=>agg.schema===schema.name).length;return count>=schema.max};const isSchemaDisabled=(schema,maxedCount)=>{var _schema$disabled;return(_schema$disabled=schema.disabled)!==null&&_schema$disabled!==void 0?_schema$disabled:maxedCount};const maxTooltipText=external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.aggAdd.maxBuckets",{defaultMessage:"Max {groupNameLabel} count reached",values:{groupNameLabel:groupNameLabel}});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"center",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:`addGroupButtonPopover_${groupName}`,button:addButton,isOpen:isPopoverOpen,panelPaddingSize:"none",repositionOnScroll:true,closePopover:()=>setIsPopoverOpen(false)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverTitle"],null,(groupName!==data_public_["AggGroupNames"].Buckets||!stats.count)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.aggAdd.addGroupButtonLabel",defaultMessage:"Add {groupNameLabel}",values:{groupNameLabel:groupNameLabel}}),groupName===data_public_["AggGroupNames"].Buckets&&stats.count>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"visDefaultEditor.aggAdd.addSubGroupButtonLabel",defaultMessage:"Add sub-{groupNameLabel}",values:{groupNameLabel:groupNameLabel}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuPanel"],{items:schemas.map(schema=>{var _schema$tooltip;const maxedCount=isMaxedCount(schema);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:`${schema.name}_${schema.title}`,"data-test-subj":`visEditorAdd_${groupName}_${schema.title}`,disabled:isPopoverOpen&&isSchemaDisabled(schema,maxedCount),onClick:()=>onSelectSchema(schema),toolTipContent:(_schema$tooltip=schema.tooltip)!==null&&_schema$tooltip!==void 0?_schema$tooltip:maxedCount?maxTooltipText:undefined},schema.title)})}))))}function DefaultEditorAggGroup({formIsTouched:formIsTouched,groupName:groupName,lastParentPipelineAggTitle:lastParentPipelineAggTitle,metricAggs:metricAggs,state:state,schemas:schemas=[],addSchema:addSchema,setAggParamValue:setAggParamValue,setStateParamValue:setStateParamValue,onAggTypeChange:onAggTypeChange,onToggleEnableAgg:onToggleEnableAgg,removeAgg:removeAgg,reorderAggs:reorderAggs,setTouched:setTouched,setValidity:setValidity,timeRange:timeRange}){const groupNameLabel=data_public_["AggGroupLabels"][groupName];const schemaNames=schemas.map(s=>s.name);const group=Object(external_kbnSharedDeps_React_["useMemo"])(()=>state.data.aggs.aggs.filter(agg=>agg.schema&&schemaNames.includes(agg.schema))||[],[state.data.aggs,schemaNames]);const stats={max:0,count:group.length};schemas.forEach(schema=>{stats.max+=schema.max});const[aggsState,setAggsState]=Object(external_kbnSharedDeps_React_["useReducer"])(aggGroupReducer,group,initAggsState);const bucketsError=lastParentPipelineAggTitle&&groupName===data_public_["AggGroupNames"].Buckets&&!group.length?external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.buckets.mustHaveBucketErrorMessage",{defaultMessage:'Add a bucket with "Date Histogram" or "Histogram" aggregation.',description:"Date Histogram and Histogram should not be translated"}):undefined;const isGroupValid=!bucketsError&&Object.values(aggsState).every(item=>item.valid);const isAllAggsTouched=isInvalidAggsTouched(aggsState);const isMetricAggregationDisabled=Object(external_kbnSharedDeps_React_["useMemo"])(()=>groupName===data_public_["AggGroupNames"].Metrics&&getEnabledMetricAggsCount(group)===1,[groupName,group]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setTouched(isAllAggsTouched)},[isAllAggsTouched,setTouched]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(formIsTouched&&!isAllAggsTouched){Object.keys(aggsState).map(([aggId])=>{setAggsState({type:AGGS_ACTION_KEYS.TOUCHED,payload:true,aggId:aggId})})}},[formIsTouched]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setValidity(`aggGroup__${groupName}`,isGroupValid)},[groupName,isGroupValid,setValidity]);const onDragEnd=Object(external_kbnSharedDeps_React_["useCallback"])(({source:source,destination:destination})=>{if(source&&destination){reorderAggs(group[source.index],group[destination.index])}},[reorderAggs,group]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDragDropContext"],{onDragEnd:onDragEnd},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],{"data-test-subj":`${groupName}AggGroup`,paddingSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,groupNameLabel)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),bucketsError&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormErrorText"],{"data-test-subj":"bucketsError"},bucketsError),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDroppable"],{droppableId:`agg_group_dnd_${groupName}`},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,group.map((agg,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDraggable"],{key:agg.id,index:index,draggableId:`agg_group_dnd_${groupName}_${agg.id}`,customDragHandle:true},provided=>external_kbnSharedDeps_React_default.a.createElement(DefaultEditorAgg,{agg:agg,aggIndex:index,aggIsTooLow:calcAggIsTooLow(agg,index,group,schemas),dragHandleProps:provided.dragHandleProps||null,formIsTouched:aggsState[agg.id]?aggsState[agg.id].touched:false,groupName:groupName,isDraggable:stats.count>1,isLastBucket:groupName===data_public_["AggGroupNames"].Buckets&&index===group.length-1,isRemovable:isAggRemovable(agg,group,schemas),isDisabled:agg.schema==="metric"&&isMetricAggregationDisabled,lastParentPipelineAggTitle:lastParentPipelineAggTitle,metricAggs:metricAggs,state:state,setAggParamValue:setAggParamValue,setStateParamValue:setStateParamValue,onAggTypeChange:onAggTypeChange,onToggleEnableAgg:onToggleEnableAgg,removeAgg:removeAgg,setAggsState:setAggsState,schemas:schemas,timeRange:timeRange}))))),stats.max>stats.count&&external_kbnSharedDeps_React_default.a.createElement(DefaultEditorAggAdd,{group:group,groupName:groupName,schemas:schemas,stats:stats,addSchema:addSchema})))}function data_tab_extends(){data_tab_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return data_tab_extends.apply(this,arguments)}function DefaultEditorDataTab({dispatch:dispatch,formIsTouched:formIsTouched,metricAggs:metricAggs,schemas:schemas,state:state,setTouched:setTouched,setValidity:setValidity,setStateValue:setStateValue,timeRange:timeRange}){const lastParentPipelineAgg=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(external_kbnSharedDeps_Lodash_["findLast"])(metricAggs,({type:type})=>type.subtype===data_public_["search"].aggs.parentPipelineType),[metricAggs]);const lastParentPipelineAggTitle=lastParentPipelineAgg&&lastParentPipelineAgg.type.title;const addSchema=Object(external_kbnSharedDeps_React_["useCallback"])(schema=>dispatch(addNewAgg(schema)),[dispatch]);const onAggRemove=Object(external_kbnSharedDeps_React_["useCallback"])(aggId=>dispatch(actions_removeAgg(aggId,schemas.all||[])),[dispatch,schemas]);const onReorderAggs=Object(external_kbnSharedDeps_React_["useCallback"])((...props)=>dispatch(actions_reorderAggs(...props)),[dispatch]);const onAggParamValueChange=Object(external_kbnSharedDeps_React_["useCallback"])((...props)=>dispatch(actions_setAggParamValue(...props)),[dispatch]);const onAggTypeChange=Object(external_kbnSharedDeps_React_["useCallback"])((...props)=>dispatch(changeAggType(...props)),[dispatch]);const onToggleEnableAgg=Object(external_kbnSharedDeps_React_["useCallback"])((...props)=>dispatch(toggleEnabledAgg(...props)),[dispatch]);const commonProps={addSchema:addSchema,formIsTouched:formIsTouched,lastParentPipelineAggTitle:lastParentPipelineAggTitle,metricAggs:metricAggs,state:state,reorderAggs:onReorderAggs,setAggParamValue:onAggParamValueChange,setStateParamValue:setStateValue,onAggTypeChange:onAggTypeChange,onToggleEnableAgg:onToggleEnableAgg,setValidity:setValidity,setTouched:setTouched,removeAgg:onAggRemove};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(DefaultEditorAggGroup,data_tab_extends({groupName:data_public_["AggGroupNames"].Metrics,schemas:schemas.metrics},commonProps)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(DefaultEditorAggGroup,data_tab_extends({groupName:data_public_["AggGroupNames"].Buckets,schemas:schemas.buckets,timeRange:timeRange},commonProps)))}const useOptionTabs=({type:visType})=>{const[optionTabs,setOptionTabs]=Object(external_kbnSharedDeps_React_["useState"])(()=>{var _visType$schemas$buck,_visType$schemas$metr;const tabs=[...(_visType$schemas$buck=visType.schemas.buckets)!==null&&_visType$schemas$buck!==void 0&&_visType$schemas$buck.length||(_visType$schemas$metr=visType.schemas.metrics)!==null&&_visType$schemas$metr!==void 0&&_visType$schemas$metr.length?[{name:"data",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.sidebar.tabs.dataLabel",{defaultMessage:"Data"}),editor:DefaultEditorDataTab}]:[],...!visType.editorConfig.optionTabs&&visType.editorConfig.optionsTemplate?[{name:"options",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.sidebar.tabs.optionsLabel",{defaultMessage:"Options"}),editor:visType.editorConfig.optionsTemplate}]:visType.editorConfig.optionTabs];tabs[0].isSelected=true;return tabs});const setSelectedTab=Object(external_kbnSharedDeps_React_["useCallback"])(name=>{setOptionTabs(tabs=>tabs.map(tab=>({...tab,isSelected:tab.name===name})))},[]);return[optionTabs,setSelectedTab]};function sidebar_extends(){sidebar_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return sidebar_extends.apply(this,arguments)}function DefaultEditorSideBar({embeddableHandler:embeddableHandler,isCollapsed:isCollapsed,onClickCollapse:onClickCollapse,uiState:uiState,vis:vis,isLinkedSearch:isLinkedSearch,eventEmitter:eventEmitter,savedSearch:savedSearch,timeRange:timeRange}){const[isDirty,setDirty]=Object(external_kbnSharedDeps_React_["useState"])(false);const[state,dispatch]=useEditorReducer(vis,eventEmitter);const{formState:formState,setTouched:setTouched,setValidity:setValidity,resetValidity:resetValidity}=useEditorFormState();const[optionTabs,setSelectedTab]=useOptionTabs(vis);const responseAggs=Object(external_kbnSharedDeps_React_["useMemo"])(()=>state.data.aggs?state.data.aggs.getResponseAggs():[],[state.data.aggs]);const metricSchemas=(vis.type.schemas.metrics||[]).map(s=>s.name);const metricAggs=Object(external_kbnSharedDeps_React_["useMemo"])(()=>responseAggs.filter(agg=>agg.schema&&metricSchemas.includes(agg.schema)),[responseAggs,metricSchemas]);const hasHistogramAgg=Object(external_kbnSharedDeps_React_["useMemo"])(()=>responseAggs.some(agg=>agg.type.name==="histogram"),[responseAggs]);const setStateValidity=Object(external_kbnSharedDeps_React_["useCallback"])(value=>{setValidity("visOptions",value)},[setValidity]);const setStateValue=Object(external_kbnSharedDeps_React_["useCallback"])((paramName,value)=>{const shouldUpdate=!Object(external_kbnSharedDeps_Lodash_["isEqual"])(state.params[paramName],value);if(shouldUpdate){dispatch(actions_setStateParamValue(paramName,value))}},[dispatch,state.params]);const applyChanges=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(formState.invalid||!isDirty){setTouched(true);return}vis.setState({...vis.serialize(),params:state.params,data:{aggs:state.data.aggs?state.data.aggs.aggs.map(agg=>agg.toJSON()):[]}});embeddableHandler.reload();eventEmitter.emit("dirtyStateChange",{isDirty:false});setTouched(false)},[vis,state,formState.invalid,setTouched,isDirty,eventEmitter,embeddableHandler]);const onSubmit=Object(external_kbnSharedDeps_React_["useCallback"])(event=>{if(event.ctrlKey&&event.key===external_kbnSharedDeps_ElasticEui_["keys"].ENTER){event.preventDefault();event.stopPropagation();applyChanges()}},[applyChanges]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const changeHandler=({isDirty:dirty})=>{setDirty(dirty);if(!dirty){resetValidity()}};eventEmitter.on("dirtyStateChange",changeHandler);return()=>{eventEmitter.off("dirtyStateChange",changeHandler)}},[resetValidity,eventEmitter]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const resetHandler=()=>dispatch(discardChanges(vis));eventEmitter.on("updateEditor",resetHandler);return()=>{eventEmitter.off("updateEditor",resetHandler)}},[dispatch,vis,eventEmitter]);const dataTabProps={dispatch:dispatch,formIsTouched:formState.touched,metricAggs:metricAggs,state:state,schemas:vis.type.schemas,setValidity:setValidity,setTouched:setTouched,setStateValue:setStateValue};const optionTabProps={aggs:state.data.aggs,hasHistogramAgg:hasHistogramAgg,stateParams:state.params,vis:vis,uiState:uiState,setValue:setStateValue,setValidity:setStateValidity,setTouched:setTouched};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{className:"visEditorSidebar",direction:"column",justifyContent:"spaceBetween",gutterSize:"none",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{className:"visEditorSidebar__formWrapper"},external_kbnSharedDeps_React_default.a.createElement("form",{className:"visEditorSidebar__form",name:"visualizeEditor",onKeyDownCapture:onSubmit},vis.type.requiresSearch&&external_kbnSharedDeps_React_default.a.createElement(SidebarTitle,{isLinkedSearch:isLinkedSearch,savedSearch:savedSearch,vis:vis,eventEmitter:eventEmitter}),optionTabs.length>1&&external_kbnSharedDeps_React_default.a.createElement(DefaultEditorNavBar,{optionTabs:optionTabs,setSelectedTab:setSelectedTab}),optionTabs.map(({editor:Editor,name:name,isSelected:isSelected=false})=>external_kbnSharedDeps_React_default.a.createElement("div",{key:name,className:`visEditorSidebar__config ${isSelected?"":"visEditorSidebar__config-isHidden"}`},external_kbnSharedDeps_React_default.a.createElement(Editor,sidebar_extends({isTabSelected:isSelected},name==="data"?dataTabProps:optionTabProps,{timeRange:timeRange})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(DefaultEditorControls,{applyChanges:applyChanges,dispatch:dispatch,isDirty:isDirty,isTouched:formState.touched,isInvalid:formState.invalid,vis:vis}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"aria-expanded":!isCollapsed,"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("visDefaultEditor.sidebar.collapseButtonAriaLabel",{defaultMessage:"Toggle sidebar"}),className:"visEditor__collapsibleSidebarButton","data-test-subj":"collapseSideBarButton",color:"text",iconType:isCollapsed?"menuLeft":"menuRight",onClick:onClickCollapse}))}var editor_size=__webpack_require__(8);const localStorage=new kibanaUtils_public_["Storage"](window.localStorage);function DefaultEditor({core:core,data:data,vis:vis,uiState:uiState,timeRange:timeRange,filters:filters,query:query,embeddableHandler:embeddableHandler,eventEmitter:eventEmitter,linked:linked,savedSearch:savedSearch}){const visRef=Object(external_kbnSharedDeps_React_["useRef"])(null);const[isCollapsed,setIsCollapsed]=Object(external_kbnSharedDeps_React_["useState"])(false);const onClickCollapse=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setIsCollapsed(value=>!value)},[]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!visRef.current){return}embeddableHandler.render(visRef.current);setTimeout(()=>{eventEmitter.emit("embeddableRendered")});return()=>embeddableHandler.destroy()},[embeddableHandler,eventEmitter]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{embeddableHandler.updateInput({timeRange:timeRange,filters:filters,query:query})},[embeddableHandler,timeRange,filters,query]);const editorInitialWidth=Object(editor_size["b"])(vis.type.editorConfig.defaultSize);return external_kbnSharedDeps_React_default.a.createElement(core.i18n.Context,null,external_kbnSharedDeps_React_default.a.createElement(public_["KibanaContextProvider"],{services:{appName:"vis_default_editor",storage:localStorage,data:data,...core}},external_kbnSharedDeps_React_default.a.createElement(public_["PanelsContainer"],{className:"visEditor--default",resizerClassName:`visEditor__resizer ${isCollapsed?"visEditor__resizer-isHidden":""}`},external_kbnSharedDeps_React_default.a.createElement(public_["Panel"],{className:"visEditor__visualization",initialWidth:100-editorInitialWidth},external_kbnSharedDeps_React_default.a.createElement("div",{className:"visEditor__canvas",ref:visRef,"data-shared-items-container":true})),external_kbnSharedDeps_React_default.a.createElement(public_["Panel"],{className:`visEditor__collapsibleSidebar ${isCollapsed?"visEditor__collapsibleSidebar-isClosed":""}`,initialWidth:editorInitialWidth},external_kbnSharedDeps_React_default.a.createElement(DefaultEditorSideBar,{embeddableHandler:embeddableHandler,isCollapsed:isCollapsed,onClickCollapse:onClickCollapse,vis:vis,uiState:uiState,isLinkedSearch:linked,savedSearch:savedSearch,timeRange:timeRange,eventEmitter:eventEmitter})))))}}])]);