/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window["triggersActionsUi_bundle_jsonpfunction"]=window["triggersActionsUi_bundle_jsonpfunction"]||[]).push([[24],{265:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",(function(){return IndexActionConnectorFields}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var _elastic_eui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2);var _elastic_eui__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__);var _kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8);var _kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_3__);var _common_lib_get_time_options__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(21);var _common_index_controls__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(37);var _common_lib_kibana__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(34);const IndexActionConnectorFields=({action:action,editActionConfig:editActionConfig,errors:errors,readOnly:readOnly})=>{const{http:http,docLinks:docLinks}=Object(_common_lib_kibana__WEBPACK_IMPORTED_MODULE_6__["b"])().services;const{index:index,refresh:refresh,executionTimeField:executionTimeField}=action.config;const[hasTimeFieldCheckbox,setTimeFieldCheckboxState]=Object(react__WEBPACK_IMPORTED_MODULE_0__["useState"])(executionTimeField!=null);const[indexPatterns,setIndexPatterns]=Object(react__WEBPACK_IMPORTED_MODULE_0__["useState"])([]);const[indexOptions,setIndexOptions]=Object(react__WEBPACK_IMPORTED_MODULE_0__["useState"])([]);const[timeFieldOptions,setTimeFieldOptions]=Object(react__WEBPACK_IMPORTED_MODULE_0__["useState"])([_common_index_controls__WEBPACK_IMPORTED_MODULE_5__["a"]]);const[isIndiciesLoading,setIsIndiciesLoading]=Object(react__WEBPACK_IMPORTED_MODULE_0__["useState"])(false);Object(react__WEBPACK_IMPORTED_MODULE_0__["useEffect"])(()=>{const indexPatternsFunction=async()=>{setIndexPatterns(await Object(_common_index_controls__WEBPACK_IMPORTED_MODULE_5__["d"])());if(index){const currentEsFields=await Object(_common_index_controls__WEBPACK_IMPORTED_MODULE_5__["b"])(http,[index]);const timeFields=Object(_common_lib_get_time_options__WEBPACK_IMPORTED_MODULE_4__["a"])(currentEsFields);setTimeFieldOptions([_common_index_controls__WEBPACK_IMPORTED_MODULE_5__["a"],...timeFields])}};indexPatternsFunction()},[]);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiTitle"],{size:"s"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("h5",null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"],{defaultMessage:"Write to index",id:"xpack.triggersActionsUI.components.builtinActionTypes.indexAction.connectorSectionTitle"}))),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiSpacer"],{size:"m"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiFormRow"],{id:"indexConnectorSelectSearchBox",fullWidth:true,label:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"],{id:"xpack.triggersActionsUI.components.builtinActionTypes.indexAction.indicesToQueryLabel",defaultMessage:"Index"}),isInvalid:errors.index.length>0&&index!==undefined,error:errors.index,helpText:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"],{id:"xpack.triggersActionsUI.components.builtinActionTypes.indexAction.howToBroadenSearchQueryDescription",defaultMessage:"Use * to broaden your query."}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiSpacer"],{size:"s"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiLink"],{href:docLinks.links.alerting.indexAction,target:"_blank"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"],{id:"xpack.triggersActionsUI.components.builtinActionTypes.indexAction.configureIndexHelpLabel",defaultMessage:"Configuring index connector."})))},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiComboBox"],{fullWidth:true,singleSelection:{asPlainText:true},async:true,isLoading:isIndiciesLoading,isInvalid:errors.index.length>0&&index!==undefined,noSuggestions:!indexOptions.length,options:indexOptions,"data-test-subj":"connectorIndexesComboBox",selectedOptions:index?[{value:index,label:index}]:[],isDisabled:readOnly,onChange:async selected=>{editActionConfig("index",selected.length>0?selected[0].value:"");const indices=selected.map(s=>s.value);if(indices.length===0){setTimeFieldOptions([]);return}const currentEsFields=await Object(_common_index_controls__WEBPACK_IMPORTED_MODULE_5__["b"])(http,indices);const timeFields=Object(_common_lib_get_time_options__WEBPACK_IMPORTED_MODULE_4__["a"])(currentEsFields);setTimeFieldOptions([_common_index_controls__WEBPACK_IMPORTED_MODULE_5__["a"],...timeFields])},onSearchChange:async search=>{setIsIndiciesLoading(true);setIndexOptions(await Object(_common_index_controls__WEBPACK_IMPORTED_MODULE_5__["c"])(http,search,indexPatterns));setIsIndiciesLoading(false)},onBlur:()=>{if(!index){editActionConfig("index","")}}})),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiSpacer"],{size:"m"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiSwitch"],{"data-test-subj":"indexRefreshCheckbox",checked:refresh||false,disabled:readOnly,onChange:e=>{editActionConfig("refresh",e.target.checked)},label:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"],{id:"xpack.triggersActionsUI.components.builtinActionTypes.indexAction.refreshLabel",defaultMessage:"Refresh index"})," ",react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiIconTip"],{position:"right",type:"questionInCircle",content:_kbn_i18n__WEBPACK_IMPORTED_MODULE_3__["i18n"].translate("xpack.triggersActionsUI.components.builtinActionTypes.indexAction.refreshTooltip",{defaultMessage:"Refresh the affected shards to make this operation visible to search."})}))}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiSpacer"],{size:"m"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiSwitch"],{"data-test-subj":"hasTimeFieldCheckbox",checked:hasTimeFieldCheckbox||false,disabled:readOnly,onChange:()=>{setTimeFieldCheckboxState(!hasTimeFieldCheckbox);if(hasTimeFieldCheckbox){editActionConfig("executionTimeField",null)}},label:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"],{id:"xpack.triggersActionsUI.components.builtinActionTypes.indexAction.defineTimeFieldLabel",defaultMessage:"Define time field for each document"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiIconTip"],{position:"right",type:"questionInCircle",content:_kbn_i18n__WEBPACK_IMPORTED_MODULE_3__["i18n"].translate("xpack.triggersActionsUI.components.builtinActionTypes.indexAction.definedateFieldTooltip",{defaultMessage:`Automatically add a time field to each document when it's indexed.`})}))}),hasTimeFieldCheckbox?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiSpacer"],{size:"m"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiFormRow"],{id:"executionTimeField",fullWidth:true,label:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"],{id:"xpack.triggersActionsUI.components.builtinActionTypes.indexAction.executionTimeFieldLabel",defaultMessage:"Time field"})},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiSelect"],{options:timeFieldOptions,fullWidth:true,name:"executionTimeField","data-test-subj":"executionTimeFieldSelect",value:executionTimeField!==null&&executionTimeField!==void 0?executionTimeField:"",onChange:e=>{editActionConfig("executionTimeField",nullableString(e.target.value))},onBlur:()=>{if(executionTimeField===undefined){editActionConfig("executionTimeField",null)}}}))):null)};function nullableString(str){if(str==null||str.trim()==="")return null;return str}}}]);