/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window["securitySolution_bundle_jsonpfunction"]=window["securitySolution_bundle_jsonpfunction"]||[]).push([[10],{1084:function(module,exports,__webpack_require__){var baseIsEqual=__webpack_require__(474);function isEqual(value,other){return baseIsEqual(value,other)}module.exports=isEqual},1085:function(module,exports){module.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMSAwSDB2OGg4VjdIMVYweiIgZmlsbD0iI0QzREFFNiIvPjwvc3ZnPg=="},1086:function(module,exports,__webpack_require__){"use strict";function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}var xtend=__webpack_require__(216);var unified=__webpack_require__(1087);var parse=__webpack_require__(1099);var PropTypes=__webpack_require__(325);var addListMetadata=__webpack_require__(1155);var naiveHtml=__webpack_require__(1157);var disallowNode=__webpack_require__(1158);var astToReact=__webpack_require__(1159);var wrapTableRows=__webpack_require__(1160);var getDefinitions=__webpack_require__(1161);var uriTransformer=__webpack_require__(1162);var defaultRenderers=__webpack_require__(1163);var symbols=__webpack_require__(1164);var allTypes=Object.keys(defaultRenderers);var ReactMarkdown=function ReactMarkdown(props){var src=props.source||props.children||"";var parserOptions=props.parserOptions;if(props.allowedTypes&&props.disallowedTypes){throw new Error("Only one of `allowedTypes` and `disallowedTypes` should be defined")}var renderers=xtend(defaultRenderers,props.renderers);var plugins=[[parse,parserOptions]].concat(props.plugins||[]);var parser=plugins.reduce(applyParserPlugin,unified());var rawAst=parser.parse(src);var renderProps=xtend(props,{renderers:renderers,definitions:getDefinitions(rawAst)});var astPlugins=determineAstPlugins(props);var transformedAst=parser.runSync(rawAst);var ast=astPlugins.reduce((function(node,plugin){return plugin(node,renderProps)}),transformedAst);return astToReact(ast,renderProps)};function applyParserPlugin(parser,plugin){return Array.isArray(plugin)?parser.use.apply(parser,_toConsumableArray(plugin)):parser.use(plugin)}function determineAstPlugins(props){var plugins=[wrapTableRows,addListMetadata()];var disallowedTypes=props.disallowedTypes;if(props.allowedTypes){disallowedTypes=allTypes.filter((function(type){return type!=="root"&&props.allowedTypes.indexOf(type)===-1}))}var removalMethod=props.unwrapDisallowed?"unwrap":"remove";if(disallowedTypes&&disallowedTypes.length>0){plugins.push(disallowNode.ofType(disallowedTypes,removalMethod))}if(props.allowNode){plugins.push(disallowNode.ifNotMatch(props.allowNode,removalMethod))}var renderHtml=!props.escapeHtml&&!props.skipHtml;var hasHtmlParser=(props.astPlugins||[]).some((function(item){var plugin=Array.isArray(item)?item[0]:item;return plugin.identity===symbols.HtmlParser}));if(renderHtml&&!hasHtmlParser){plugins.push(naiveHtml)}return props.astPlugins?plugins.concat(props.astPlugins):plugins}ReactMarkdown.defaultProps={renderers:{},escapeHtml:true,skipHtml:false,sourcePos:false,rawSourcePos:false,transformLinkUri:uriTransformer,astPlugins:[],plugins:[],parserOptions:{}};ReactMarkdown.propTypes={className:PropTypes.string,source:PropTypes.string,children:PropTypes.string,sourcePos:PropTypes.bool,rawSourcePos:PropTypes.bool,escapeHtml:PropTypes.bool,skipHtml:PropTypes.bool,allowNode:PropTypes.func,allowedTypes:PropTypes.arrayOf(PropTypes.oneOf(allTypes)),disallowedTypes:PropTypes.arrayOf(PropTypes.oneOf(allTypes)),transformLinkUri:PropTypes.oneOfType([PropTypes.func,PropTypes.bool]),linkTarget:PropTypes.oneOfType([PropTypes.func,PropTypes.string]),transformImageUri:PropTypes.func,astPlugins:PropTypes.arrayOf(PropTypes.func),unwrapDisallowed:PropTypes.bool,renderers:PropTypes.object,plugins:PropTypes.array,parserOptions:PropTypes.object};ReactMarkdown.types=allTypes;ReactMarkdown.renderers=defaultRenderers;ReactMarkdown.uriTransformer=uriTransformer;module.exports=ReactMarkdown},1087:function(module,exports,__webpack_require__){"use strict";var extend=__webpack_require__(1088);var bail=__webpack_require__(1089);var vfile=__webpack_require__(1090);var trough=__webpack_require__(1095);var string=__webpack_require__(1096);var func=__webpack_require__(1097);var plain=__webpack_require__(1098);module.exports=unified().freeze();var slice=[].slice;var own={}.hasOwnProperty;var pipeline=trough().use(pipelineParse).use(pipelineRun).use(pipelineStringify);function pipelineParse(p,ctx){ctx.tree=p.parse(ctx.file)}function pipelineRun(p,ctx,next){p.run(ctx.tree,ctx.file,done);function done(err,tree,file){if(err){next(err)}else{ctx.tree=tree;ctx.file=file;next()}}}function pipelineStringify(p,ctx){ctx.file.contents=p.stringify(ctx.tree,ctx.file)}function unified(){var attachers=[];var transformers=trough();var namespace={};var frozen=false;var freezeIndex=-1;processor.data=data;processor.freeze=freeze;processor.attachers=attachers;processor.use=use;processor.parse=parse;processor.stringify=stringify;processor.run=run;processor.runSync=runSync;processor.process=process;processor.processSync=processSync;return processor;function processor(){var destination=unified();var length=attachers.length;var index=-1;while(++index<length){destination.use.apply(null,attachers[index])}destination.data(extend(true,{},namespace));return destination}function freeze(){var values;var plugin;var options;var transformer;if(frozen){return processor}while(++freezeIndex<attachers.length){values=attachers[freezeIndex];plugin=values[0];options=values[1];transformer=null;if(options===false){continue}if(options===true){values[1]=undefined}transformer=plugin.apply(processor,values.slice(1));if(func(transformer)){transformers.use(transformer)}}frozen=true;freezeIndex=Infinity;return processor}function data(key,value){if(string(key)){if(arguments.length===2){assertUnfrozen("data",frozen);namespace[key]=value;return processor}return own.call(namespace,key)&&namespace[key]||null}if(key){assertUnfrozen("data",frozen);namespace=key;return processor}return namespace}function use(value){var settings;assertUnfrozen("use",frozen);if(value===null||value===undefined){}else if(func(value)){addPlugin.apply(null,arguments)}else if(typeof value==="object"){if("length"in value){addList(value)}else{addPreset(value)}}else{throw new Error("Expected usable value, not `"+value+"`")}if(settings){namespace.settings=extend(namespace.settings||{},settings)}return processor;function addPreset(result){addList(result.plugins);if(result.settings){settings=extend(settings||{},result.settings)}}function add(value){if(func(value)){addPlugin(value)}else if(typeof value==="object"){if("length"in value){addPlugin.apply(null,value)}else{addPreset(value)}}else{throw new Error("Expected usable value, not `"+value+"`")}}function addList(plugins){var length;var index;if(plugins===null||plugins===undefined){}else if(typeof plugins==="object"&&"length"in plugins){length=plugins.length;index=-1;while(++index<length){add(plugins[index])}}else{throw new Error("Expected a list of plugins, not `"+plugins+"`")}}function addPlugin(plugin,value){var entry=find(plugin);if(entry){if(plain(entry[1])&&plain(value)){value=extend(entry[1],value)}entry[1]=value}else{attachers.push(slice.call(arguments))}}}function find(plugin){var length=attachers.length;var index=-1;var entry;while(++index<length){entry=attachers[index];if(entry[0]===plugin){return entry}}}function parse(doc){var file=vfile(doc);var Parser;freeze();Parser=processor.Parser;assertParser("parse",Parser);if(newable(Parser)){return new Parser(String(file),file).parse()}return Parser(String(file),file)}function run(node,file,cb){assertNode(node);freeze();if(!cb&&func(file)){cb=file;file=null}if(!cb){return new Promise(executor)}executor(null,cb);function executor(resolve,reject){transformers.run(node,vfile(file),done);function done(err,tree,file){tree=tree||node;if(err){reject(err)}else if(resolve){resolve(tree)}else{cb(null,tree,file)}}}}function runSync(node,file){var complete=false;var result;run(node,file,done);assertDone("runSync","run",complete);return result;function done(err,tree){complete=true;bail(err);result=tree}}function stringify(node,doc){var file=vfile(doc);var Compiler;freeze();Compiler=processor.Compiler;assertCompiler("stringify",Compiler);assertNode(node);if(newable(Compiler)){return new Compiler(node,file).compile()}return Compiler(node,file)}function process(doc,cb){freeze();assertParser("process",processor.Parser);assertCompiler("process",processor.Compiler);if(!cb){return new Promise(executor)}executor(null,cb);function executor(resolve,reject){var file=vfile(doc);pipeline.run(processor,{file:file},done);function done(err){if(err){reject(err)}else if(resolve){resolve(file)}else{cb(null,file)}}}}function processSync(doc){var complete=false;var file;freeze();assertParser("processSync",processor.Parser);assertCompiler("processSync",processor.Compiler);file=vfile(doc);process(file,done);assertDone("processSync","process",complete);return file;function done(err){complete=true;bail(err)}}}function newable(value){return func(value)&&keys(value.prototype)}function keys(value){var key;for(key in value){return true}return false}function assertParser(name,Parser){if(!func(Parser)){throw new Error("Cannot `"+name+"` without `Parser`")}}function assertCompiler(name,Compiler){if(!func(Compiler)){throw new Error("Cannot `"+name+"` without `Compiler`")}}function assertUnfrozen(name,frozen){if(frozen){throw new Error("Cannot invoke `"+name+"` on a frozen processor.\n"+"Create a new processor first, by invoking it: "+"use `processor()` instead of `processor`.")}}function assertNode(node){if(!node||!string(node.type)){throw new Error("Expected node, got `"+node+"`")}}function assertDone(name,asyncName,complete){if(!complete){throw new Error("`"+name+"` finished async. Use `"+asyncName+"` instead")}}},1088:function(module,exports,__webpack_require__){"use strict";var hasOwn=Object.prototype.hasOwnProperty;var toStr=Object.prototype.toString;var defineProperty=Object.defineProperty;var gOPD=Object.getOwnPropertyDescriptor;var isArray=function isArray(arr){if(typeof Array.isArray==="function"){return Array.isArray(arr)}return toStr.call(arr)==="[object Array]"};var isPlainObject=function isPlainObject(obj){if(!obj||toStr.call(obj)!=="[object Object]"){return false}var hasOwnConstructor=hasOwn.call(obj,"constructor");var hasIsPrototypeOf=obj.constructor&&obj.constructor.prototype&&hasOwn.call(obj.constructor.prototype,"isPrototypeOf");if(obj.constructor&&!hasOwnConstructor&&!hasIsPrototypeOf){return false}var key;for(key in obj){}return typeof key==="undefined"||hasOwn.call(obj,key)};var setProperty=function setProperty(target,options){if(defineProperty&&options.name==="__proto__"){defineProperty(target,options.name,{enumerable:true,configurable:true,value:options.newValue,writable:true})}else{target[options.name]=options.newValue}};var getProperty=function getProperty(obj,name){if(name==="__proto__"){if(!hasOwn.call(obj,name)){return void 0}else if(gOPD){return gOPD(obj,name).value}}return obj[name]};module.exports=function extend(){var options,name,src,copy,copyIsArray,clone;var target=arguments[0];var i=1;var length=arguments.length;var deep=false;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i=2}if(target==null||typeof target!=="object"&&typeof target!=="function"){target={}}for(;i<length;++i){options=arguments[i];if(options!=null){for(name in options){src=getProperty(target,name);copy=getProperty(options,name);if(target!==copy){if(deep&&copy&&(isPlainObject(copy)||(copyIsArray=isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&isArray(src)?src:[]}else{clone=src&&isPlainObject(src)?src:{}}setProperty(target,{name:name,newValue:extend(deep,clone,copy)})}else if(typeof copy!=="undefined"){setProperty(target,{name:name,newValue:copy})}}}}}return target}},1089:function(module,exports,__webpack_require__){"use strict";module.exports=bail;function bail(err){if(err){throw err}}},1090:function(module,exports,__webpack_require__){"use strict";var VMessage=__webpack_require__(1091);var VFile=__webpack_require__(1093);module.exports=VFile;var proto=VFile.prototype;proto.message=message;proto.info=info;proto.fail=fail;proto.warn=message;function message(reason,position,origin){var filePath=this.path;var message=new VMessage(reason,position,origin);if(filePath){message.name=filePath+":"+message.name;message.file=filePath}message.fatal=false;this.messages.push(message);return message}function fail(){var message=this.message.apply(this,arguments);message.fatal=true;throw message}function info(){var message=this.message.apply(this,arguments);message.fatal=null;return message}},1091:function(module,exports,__webpack_require__){"use strict";var stringify=__webpack_require__(1092);module.exports=VMessage;function VMessagePrototype(){}VMessagePrototype.prototype=Error.prototype;VMessage.prototype=new VMessagePrototype;var proto=VMessage.prototype;proto.file="";proto.name="";proto.reason="";proto.message="";proto.stack="";proto.fatal=null;proto.column=null;proto.line=null;function VMessage(reason,position,origin){var parts;var range;var location;if(typeof position==="string"){origin=position;position=null}parts=parseOrigin(origin);range=stringify(position)||"1:1";location={start:{line:null,column:null},end:{line:null,column:null}};if(position&&position.position){position=position.position}if(position){if(position.start){location=position;position=position.start}else{location.start=position}}if(reason.stack){this.stack=reason.stack;reason=reason.message}this.message=reason;this.name=range;this.reason=reason;this.line=position?position.line:null;this.column=position?position.column:null;this.location=location;this.source=parts[0];this.ruleId=parts[1]}function parseOrigin(origin){var result=[null,null];var index;if(typeof origin==="string"){index=origin.indexOf(":");if(index===-1){result[1]=origin}else{result[0]=origin.slice(0,index);result[1]=origin.slice(index+1)}}return result}},1092:function(module,exports,__webpack_require__){"use strict";var own={}.hasOwnProperty;module.exports=stringify;function stringify(value){if(!value||typeof value!=="object"){return null}if(own.call(value,"position")||own.call(value,"type")){return location(value.position)}if(own.call(value,"start")||own.call(value,"end")){return location(value)}if(own.call(value,"line")||own.call(value,"column")){return position(value)}return null}function position(pos){if(!pos||typeof pos!=="object"){pos={}}return index(pos.line)+":"+index(pos.column)}function location(loc){if(!loc||typeof loc!=="object"){loc={}}return position(loc.start)+"-"+position(loc.end)}function index(value){return value&&typeof value==="number"?value:1}},1093:function(module,exports,__webpack_require__){"use strict";(function(process){var path=__webpack_require__(496);var replace=__webpack_require__(1094);var buffer=__webpack_require__(720);module.exports=VFile;var own={}.hasOwnProperty;var proto=VFile.prototype;proto.toString=toString;var order=["history","path","basename","stem","extname","dirname"];function VFile(options){var prop;var index;var length;if(!options){options={}}else if(typeof options==="string"||buffer(options)){options={contents:options}}else if("message"in options&&"messages"in options){return options}if(!(this instanceof VFile)){return new VFile(options)}this.data={};this.messages=[];this.history=[];this.cwd=process.cwd();index=-1;length=order.length;while(++index<length){prop=order[index];if(own.call(options,prop)){this[prop]=options[prop]}}for(prop in options){if(order.indexOf(prop)===-1){this[prop]=options[prop]}}}Object.defineProperty(proto,"path",{get:function(){return this.history[this.history.length-1]},set:function(path){assertNonEmpty(path,"path");if(path!==this.path){this.history.push(path)}}});Object.defineProperty(proto,"dirname",{get:function(){return typeof this.path==="string"?path.dirname(this.path):undefined},set:function(dirname){assertPath(this.path,"dirname");this.path=path.join(dirname||"",this.basename)}});Object.defineProperty(proto,"basename",{get:function(){return typeof this.path==="string"?path.basename(this.path):undefined},set:function(basename){assertNonEmpty(basename,"basename");assertPart(basename,"basename");this.path=path.join(this.dirname||"",basename)}});Object.defineProperty(proto,"extname",{get:function(){return typeof this.path==="string"?path.extname(this.path):undefined},set:function(extname){var ext=extname||"";assertPart(ext,"extname");assertPath(this.path,"extname");if(ext){if(ext.charAt(0)!=="."){throw new Error("`extname` must start with `.`")}if(ext.indexOf(".",1)!==-1){throw new Error("`extname` cannot contain multiple dots")}}this.path=replace(this.path,ext)}});Object.defineProperty(proto,"stem",{get:function(){return typeof this.path==="string"?path.basename(this.path,this.extname):undefined},set:function(stem){assertNonEmpty(stem,"stem");assertPart(stem,"stem");this.path=path.join(this.dirname||"",stem+(this.extname||""))}});function toString(encoding){var value=this.contents||"";return buffer(value)?value.toString(encoding):String(value)}function assertPart(part,name){if(part.indexOf(path.sep)!==-1){throw new Error("`"+name+"` cannot be a path: did not expect `"+path.sep+"`")}}function assertNonEmpty(part,name){if(!part){throw new Error("`"+name+"` cannot be empty")}}function assertPath(path,name){if(!path){throw new Error("Setting `"+name+"` requires `path` to be set too")}}}).call(this,__webpack_require__(220))},1094:function(module,exports,__webpack_require__){"use strict";var path=__webpack_require__(496);function replaceExt(npath,ext){if(typeof npath!=="string"){return npath}if(npath.length===0){return npath}var nFileName=path.basename(npath,path.extname(npath))+ext;return path.join(path.dirname(npath),nFileName)}module.exports=replaceExt},1095:function(module,exports,__webpack_require__){"use strict";module.exports=trough;var slice=[].slice;function trough(){var fns=[];var middleware={};middleware.run=run;middleware.use=use;return middleware;function run(){var index=-1;var input=slice.call(arguments,0,-1);var done=arguments[arguments.length-1];if(typeof done!=="function"){throw new Error("Expected function as last argument, not "+done)}next.apply(null,[null].concat(input));function next(err){var fn=fns[++index];var params=slice.call(arguments,0);var values=params.slice(1);var length=input.length;var pos=-1;if(err){done(err);return}while(++pos<length){if(values[pos]===null||values[pos]===undefined){values[pos]=input[pos]}}input=values;if(fn){wrap(fn,next).apply(null,input)}else{done.apply(null,[null].concat(input))}}}function use(fn){if(typeof fn!=="function"){throw new Error("Expected `fn` to be a function, not "+fn)}fns.push(fn);return middleware}}function wrap(fn,next){var invoked;return wrapped;function wrapped(){var params=slice.call(arguments,0);var callback=fn.length>params.length;var result;if(callback){params.push(done)}try{result=fn.apply(null,params)}catch(err){if(callback&&invoked){throw err}return done(err)}if(!callback){if(result&&typeof result.then==="function"){result.then(then,done)}else if(result instanceof Error){done(result)}else{then(result)}}}function done(){if(!invoked){invoked=true;next.apply(null,arguments)}}function then(value){done(null,value)}}},1096:function(module,exports){var toString=Object.prototype.toString;module.exports=isString;function isString(obj){return toString.call(obj)==="[object String]"}},1097:function(module,exports){module.exports=function isFunction(fn){return Object.prototype.toString.call(fn)==="[object Function]"}},1098:function(module,exports,__webpack_require__){"use strict";var toString=Object.prototype.toString;module.exports=function(x){var prototype;return toString.call(x)==="[object Object]"&&(prototype=Object.getPrototypeOf(x),prototype===null||prototype===Object.getPrototypeOf({}))}},1099:function(module,exports,__webpack_require__){"use strict";var unherit=__webpack_require__(1100);var xtend=__webpack_require__(216);var Parser=__webpack_require__(1102);module.exports=parse;parse.Parser=Parser;function parse(options){var Local=unherit(Parser);Local.prototype.options=xtend(Local.prototype.options,this.data("settings"),options);this.Parser=Local}},1100:function(module,exports,__webpack_require__){"use strict";
/**
 * @author Titus Wormer
 * @copyright 2015 Titus Wormer
 * @license MIT
 * @module unherit
 * @fileoverview Create a custom constructor which can be modified
 *   without affecting the original class.
 */var xtend=__webpack_require__(216);var inherits=__webpack_require__(1101);module.exports=unherit;function unherit(Super){var result;var key;var value;inherits(Of,Super);inherits(From,Of);result=Of.prototype;for(key in result){value=result[key];if(value&&typeof value==="object"){result[key]="concat"in value?value.concat():xtend(value)}}return Of;function From(parameters){return Super.apply(this,parameters)}function Of(){if(!(this instanceof Of)){return new From(arguments)}return Super.apply(this,arguments)}}},1101:function(module,exports){if(typeof Object.create==="function"){module.exports=function inherits(ctor,superCtor){if(superCtor){ctor.super_=superCtor;ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}})}}}else{module.exports=function inherits(ctor,superCtor){if(superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor;ctor.prototype.constructor=ctor}}}},1102:function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(216);var toggle=__webpack_require__(1103);var vfileLocation=__webpack_require__(1104);var unescape=__webpack_require__(1105);var decode=__webpack_require__(1106);var tokenizer=__webpack_require__(1112);module.exports=Parser;function Parser(doc,file){this.file=file;this.offset={};this.options=xtend(this.options);this.setOptions({});this.inList=false;this.inBlock=false;this.inLink=false;this.atStart=true;this.toOffset=vfileLocation(file).toOffset;this.unescape=unescape(this,"escape");this.decode=decode(this)}var proto=Parser.prototype;proto.setOptions=__webpack_require__(1113);proto.parse=__webpack_require__(1116);proto.options=__webpack_require__(735);proto.exitStart=toggle("atStart",true);proto.enterList=toggle("inList",false);proto.enterLink=toggle("inLink",false);proto.enterBlock=toggle("inBlock",false);proto.interruptParagraph=[["thematicBreak"],["atxHeading"],["fencedCode"],["blockquote"],["html"],["setextHeading",{commonmark:false}],["definition",{commonmark:false}],["footnote",{commonmark:false}]];proto.interruptList=[["atxHeading",{pedantic:false}],["fencedCode",{pedantic:false}],["thematicBreak",{pedantic:false}],["definition",{commonmark:false}],["footnote",{commonmark:false}]];proto.interruptBlockquote=[["indentedCode",{commonmark:true}],["fencedCode",{commonmark:true}],["atxHeading",{commonmark:true}],["setextHeading",{commonmark:true}],["thematicBreak",{commonmark:true}],["html",{commonmark:true}],["list",{commonmark:true}],["definition",{commonmark:false}],["footnote",{commonmark:false}]];proto.blockTokenizers={newline:__webpack_require__(1120),indentedCode:__webpack_require__(1121),fencedCode:__webpack_require__(1122),blockquote:__webpack_require__(1123),atxHeading:__webpack_require__(1124),thematicBreak:__webpack_require__(1125),list:__webpack_require__(1126),setextHeading:__webpack_require__(1128),html:__webpack_require__(1129),footnote:__webpack_require__(1130),definition:__webpack_require__(1132),table:__webpack_require__(1133),paragraph:__webpack_require__(1134)};proto.inlineTokenizers={escape:__webpack_require__(1135),autoLink:__webpack_require__(1137),url:__webpack_require__(1138),html:__webpack_require__(1140),link:__webpack_require__(1141),reference:__webpack_require__(1142),strong:__webpack_require__(1143),emphasis:__webpack_require__(1145),deletion:__webpack_require__(1148),code:__webpack_require__(1150),break:__webpack_require__(1152),text:__webpack_require__(1154)};proto.blockMethods=keys(proto.blockTokenizers);proto.inlineMethods=keys(proto.inlineTokenizers);proto.tokenizeBlock=tokenizer("block");proto.tokenizeInline=tokenizer("inline");proto.tokenizeFactory=tokenizer;function keys(value){var result=[];var key;for(key in value){result.push(key)}return result}},1103:function(module,exports,__webpack_require__){"use strict";
/**
 * @author Titus Wormer
 * @copyright 2016 Titus Wormer
 * @license MIT
 * @module state-toggle
 * @fileoverview Enter/exit a state.
 */module.exports=factory;function factory(key,state,ctx){return function(){var context=ctx||this;var current=context[key];context[key]=!state;return function(){context[key]=current}}}},1104:function(module,exports,__webpack_require__){"use strict";module.exports=factory;function factory(file){var contents=indices(String(file));return{toPosition:offsetToPositionFactory(contents),toOffset:positionToOffsetFactory(contents)}}function offsetToPositionFactory(indices){return offsetToPosition;function offsetToPosition(offset){var index=-1;var length=indices.length;if(offset<0){return{}}while(++index<length){if(indices[index]>offset){return{line:index+1,column:offset-(indices[index-1]||0)+1,offset:offset}}}return{}}}function positionToOffsetFactory(indices){return positionToOffset;function positionToOffset(position){var line=position&&position.line;var column=position&&position.column;if(!isNaN(line)&&!isNaN(column)&&line-1 in indices){return(indices[line-2]||0)+column-1||0}return-1}}function indices(value){var result=[];var index=value.indexOf("\n");while(index!==-1){result.push(index+1);index=value.indexOf("\n",index+1)}result.push(value.length+1);return result}},1105:function(module,exports,__webpack_require__){"use strict";module.exports=factory;function factory(ctx,key){return unescape;function unescape(value){var prev=0;var index=value.indexOf("\\");var escape=ctx[key];var queue=[];var character;while(index!==-1){queue.push(value.slice(prev,index));prev=index+1;character=value.charAt(prev);if(!character||escape.indexOf(character)===-1){queue.push("\\")}index=value.indexOf("\\",prev)}queue.push(value.slice(prev));return queue.join("")}}},1106:function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(216);var entities=__webpack_require__(497);module.exports=factory;function factory(ctx){decoder.raw=decodeRaw;return decoder;function normalize(position){var offsets=ctx.offset;var line=position.line;var result=[];while(++line){if(!(line in offsets)){break}result.push((offsets[line]||0)+1)}return{start:position,indent:result}}function handleWarning(reason,position,code){if(code===3){return}ctx.file.message(reason,position)}function decoder(value,position,handler){entities(value,{position:normalize(position),warning:handleWarning,text:handler,reference:handler,textContext:ctx,referenceContext:ctx})}function decodeRaw(value,position,options){return entities(value,xtend(options,{position:normalize(position),warning:handleWarning}))}}},1107:function(module){module.exports=JSON.parse('{"AElig":"Æ","AMP":"&","Aacute":"Á","Acirc":"Â","Agrave":"À","Aring":"Å","Atilde":"Ã","Auml":"Ä","COPY":"©","Ccedil":"Ç","ETH":"Ð","Eacute":"É","Ecirc":"Ê","Egrave":"È","Euml":"Ë","GT":">","Iacute":"Í","Icirc":"Î","Igrave":"Ì","Iuml":"Ï","LT":"<","Ntilde":"Ñ","Oacute":"Ó","Ocirc":"Ô","Ograve":"Ò","Oslash":"Ø","Otilde":"Õ","Ouml":"Ö","QUOT":"\\"","REG":"®","THORN":"Þ","Uacute":"Ú","Ucirc":"Û","Ugrave":"Ù","Uuml":"Ü","Yacute":"Ý","aacute":"á","acirc":"â","acute":"´","aelig":"æ","agrave":"à","amp":"&","aring":"å","atilde":"ã","auml":"ä","brvbar":"¦","ccedil":"ç","cedil":"¸","cent":"¢","copy":"©","curren":"¤","deg":"°","divide":"÷","eacute":"é","ecirc":"ê","egrave":"è","eth":"ð","euml":"ë","frac12":"½","frac14":"¼","frac34":"¾","gt":">","iacute":"í","icirc":"î","iexcl":"¡","igrave":"ì","iquest":"¿","iuml":"ï","laquo":"«","lt":"<","macr":"¯","micro":"µ","middot":"·","nbsp":" ","not":"¬","ntilde":"ñ","oacute":"ó","ocirc":"ô","ograve":"ò","ordf":"ª","ordm":"º","oslash":"ø","otilde":"õ","ouml":"ö","para":"¶","plusmn":"±","pound":"£","quot":"\\"","raquo":"»","reg":"®","sect":"§","shy":"­","sup1":"¹","sup2":"²","sup3":"³","szlig":"ß","thorn":"þ","times":"×","uacute":"ú","ucirc":"û","ugrave":"ù","uml":"¨","uuml":"ü","yacute":"ý","yen":"¥","yuml":"ÿ"}')},1108:function(module){module.exports=JSON.parse('{"0":"�","128":"€","130":"‚","131":"ƒ","132":"„","133":"…","134":"†","135":"‡","136":"ˆ","137":"‰","138":"Š","139":"‹","140":"Œ","142":"Ž","145":"‘","146":"’","147":"“","148":"”","149":"•","150":"–","151":"—","152":"˜","153":"™","154":"š","155":"›","156":"œ","158":"ž","159":"Ÿ"}')},1109:function(module,exports,__webpack_require__){"use strict";module.exports=hexadecimal;function hexadecimal(character){var code=typeof character==="string"?character.charCodeAt(0):character;return code>=97&&code<=102||code>=65&&code<=70||code>=48&&code<=57}},1110:function(module,exports,__webpack_require__){"use strict";var alphabetical=__webpack_require__(734);var decimal=__webpack_require__(396);module.exports=alphanumerical;function alphanumerical(character){return alphabetical(character)||decimal(character)}},1111:function(module,exports,__webpack_require__){"use strict";var el;module.exports=decodeEntity;function decodeEntity(characters){var entity="&"+characters+";";var char;el=el||document.createElement("i");el.innerHTML=entity;char=el.textContent;if(char.slice(-1)===";"&&characters!=="semi"){return false}return char===entity?false:char}},1112:function(module,exports,__webpack_require__){"use strict";module.exports=factory;var MERGEABLE_NODES={text:mergeText,blockquote:mergeBlockquote};function mergeable(node){var start;var end;if(node.type!=="text"||!node.position){return true}start=node.position.start;end=node.position.end;return start.line!==end.line||end.column-start.column===node.value.length}function mergeText(prev,node){prev.value+=node.value;return prev}function mergeBlockquote(prev,node){if(this.options.commonmark){return node}prev.children=prev.children.concat(node.children);return prev}function factory(type){return tokenize;function tokenize(value,location){var self=this;var offset=self.offset;var tokens=[];var methods=self[type+"Methods"];var tokenizers=self[type+"Tokenizers"];var line=location.line;var column=location.column;var index;var length;var method;var name;var matched;var valueLength;if(!value){return tokens}eat.now=now;eat.file=self.file;updatePosition("");while(value){index=-1;length=methods.length;matched=false;while(++index<length){name=methods[index];method=tokenizers[name];if(method&&(!method.onlyAtStart||self.atStart)&&(!method.notInList||!self.inList)&&(!method.notInBlock||!self.inBlock)&&(!method.notInLink||!self.inLink)){valueLength=value.length;method.apply(self,[eat,value]);matched=valueLength!==value.length;if(matched){break}}}if(!matched){self.file.fail(new Error("Infinite loop"),eat.now())}}self.eof=now();return tokens;function updatePosition(subvalue){var lastIndex=-1;var index=subvalue.indexOf("\n");while(index!==-1){line++;lastIndex=index;index=subvalue.indexOf("\n",index+1)}if(lastIndex===-1){column+=subvalue.length}else{column=subvalue.length-lastIndex}if(line in offset){if(lastIndex!==-1){column+=offset[line]}else if(column<=offset[line]){column=offset[line]+1}}}function getOffset(){var indentation=[];var pos=line+1;return function(){var last=line+1;while(pos<last){indentation.push((offset[pos]||0)+1);pos++}return indentation}}function now(){var pos={line:line,column:column};pos.offset=self.toOffset(pos);return pos}function Position(start){this.start=start;this.end=now()}function validateEat(subvalue){if(value.substring(0,subvalue.length)!==subvalue){self.file.fail(new Error("Incorrectly eaten value: please report this "+"warning on http://git.io/vg5Ft"),now())}}function position(){var before=now();return update;function update(node,indent){var prev=node.position;var start=prev?prev.start:before;var combined=[];var n=prev&&prev.end.line;var l=before.line;node.position=new Position(start);if(prev&&indent&&prev.indent){combined=prev.indent;if(n<l){while(++n<l){combined.push((offset[n]||0)+1)}combined.push(before.column)}indent=combined.concat(indent)}node.position.indent=indent||[];return node}}function add(node,parent){var children=parent?parent.children:tokens;var prev=children[children.length-1];if(prev&&node.type===prev.type&&node.type in MERGEABLE_NODES&&mergeable(prev)&&mergeable(node)){node=MERGEABLE_NODES[node.type].call(self,prev,node)}if(node!==prev){children.push(node)}if(self.atStart&&tokens.length!==0){self.exitStart()}return node}function eat(subvalue){var indent=getOffset();var pos=position();var current=now();validateEat(subvalue);apply.reset=reset;reset.test=test;apply.test=test;value=value.substring(subvalue.length);updatePosition(subvalue);indent=indent();return apply;function apply(node,parent){return pos(add(pos(node),parent),indent)}function reset(){var node=apply.apply(null,arguments);line=current.line;column=current.column;value=subvalue+value;return node}function test(){var result=pos({});line=current.line;column=current.column;value=subvalue+value;return result.position}}}}},1113:function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(216);var escapes=__webpack_require__(1114);var defaults=__webpack_require__(735);module.exports=setOptions;function setOptions(options){var self=this;var current=self.options;var key;var value;if(options==null){options={}}else if(typeof options==="object"){options=xtend(options)}else{throw new Error("Invalid value `"+options+"` "+"for setting `options`")}for(key in defaults){value=options[key];if(value==null){value=current[key]}if(key!=="blocks"&&typeof value!=="boolean"||key==="blocks"&&typeof value!=="object"){throw new Error("Invalid value `"+value+"` for setting `options."+key+"`")}options[key]=value}self.options=options;self.escape=escapes(options);return self}},1114:function(module,exports,__webpack_require__){"use strict";module.exports=escapes;var defaults=["\\","`","*","{","}","[","]","(",")","#","+","-",".","!","_",">"];var gfm=defaults.concat(["~","|"]);var commonmark=gfm.concat(["\n",'"',"$","%","&","'",",","/",":",";","<","=","?","@","^"]);escapes.default=defaults;escapes.gfm=gfm;escapes.commonmark=commonmark;function escapes(options){var settings=options||{};if(settings.commonmark){return commonmark}return settings.gfm?gfm:defaults}},1115:function(module){module.exports=JSON.parse('["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","iframe","legend","li","link","main","menu","menuitem","meta","nav","noframes","ol","optgroup","option","p","param","pre","section","source","title","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"]')},1116:function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(216);var removePosition=__webpack_require__(1117);module.exports=parse;var C_NEWLINE="\n";var EXPRESSION_LINE_BREAKS=/\r\n|\r/g;function parse(){var self=this;var value=String(self.file);var start={line:1,column:1,offset:0};var content=xtend(start);var node;value=value.replace(EXPRESSION_LINE_BREAKS,C_NEWLINE);if(value.charCodeAt(0)===65279){value=value.slice(1);content.column++;content.offset++}node={type:"root",children:self.tokenizeBlock(value,content),position:{start:start,end:self.eof||xtend(start)}};if(!self.options.position){removePosition(node,true)}return node}},1117:function(module,exports,__webpack_require__){"use strict";var visit=__webpack_require__(397);module.exports=removePosition;function removePosition(node,force){visit(node,force?hard:soft);return node}function hard(node){delete node.position}function soft(node){node.position=undefined}},1118:function(module,exports,__webpack_require__){"use strict";module.exports=visitParents;var convert=__webpack_require__(1119);var CONTINUE=true;var SKIP="skip";var EXIT=false;visitParents.CONTINUE=CONTINUE;visitParents.SKIP=SKIP;visitParents.EXIT=EXIT;function visitParents(tree,test,visitor,reverse){var is;if(typeof test==="function"&&typeof visitor!=="function"){reverse=visitor;visitor=test;test=null}is=convert(test);one(tree,null,[]);function one(node,index,parents){var result=[];var subresult;if(!test||is(node,index,parents[parents.length-1]||null)){result=toResult(visitor(node,parents));if(result[0]===EXIT){return result}}if(node.children&&result[0]!==SKIP){subresult=toResult(all(node.children,parents.concat(node)));return subresult[0]===EXIT?subresult:result}return result}function all(children,parents){var min=-1;var step=reverse?-1:1;var index=(reverse?children.length:min)+step;var result;while(index>min&&index<children.length){result=one(children[index],index,parents);if(result[0]===EXIT){return result}index=typeof result[1]==="number"?result[1]:index+step}}}function toResult(value){if(value!==null&&typeof value==="object"&&"length"in value){return value}if(typeof value==="number"){return[CONTINUE,value]}return[value]}},1119:function(module,exports,__webpack_require__){"use strict";module.exports=convert;function convert(test){if(typeof test==="string"){return typeFactory(test)}if(test===null||test===undefined){return ok}if(typeof test==="object"){return("length"in test?anyFactory:matchesFactory)(test)}if(typeof test==="function"){return test}throw new Error("Expected function, string, or object as test")}function convertAll(tests){var results=[];var length=tests.length;var index=-1;while(++index<length){results[index]=convert(tests[index])}return results}function matchesFactory(test){return matches;function matches(node){var key;for(key in test){if(node[key]!==test[key]){return false}}return true}}function anyFactory(tests){var checks=convertAll(tests);var length=checks.length;return matches;function matches(){var index=-1;while(++index<length){if(checks[index].apply(this,arguments)){return true}}return false}}function typeFactory(test){return type;function type(node){return Boolean(node&&node.type===test)}}function ok(){return true}},1120:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(171);module.exports=newline;function newline(eat,value,silent){var character=value.charAt(0);var length;var subvalue;var queue;var index;if(character!=="\n"){return}if(silent){return true}index=1;length=value.length;subvalue=character;queue="";while(index<length){character=value.charAt(index);if(!whitespace(character)){break}queue+=character;if(character==="\n"){subvalue+=queue;queue=""}index++}eat(subvalue)}},1121:function(module,exports,__webpack_require__){"use strict";var repeat=__webpack_require__(498);var trim=__webpack_require__(499);module.exports=indentedCode;var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var CODE_INDENT_COUNT=4;var CODE_INDENT=repeat(C_SPACE,CODE_INDENT_COUNT);function indentedCode(eat,value,silent){var index=-1;var length=value.length;var subvalue="";var content="";var subvalueQueue="";var contentQueue="";var character;var blankQueue;var indent;while(++index<length){character=value.charAt(index);if(indent){indent=false;subvalue+=subvalueQueue;content+=contentQueue;subvalueQueue="";contentQueue="";if(character===C_NEWLINE){subvalueQueue=character;contentQueue=character}else{subvalue+=character;content+=character;while(++index<length){character=value.charAt(index);if(!character||character===C_NEWLINE){contentQueue=character;subvalueQueue=character;break}subvalue+=character;content+=character}}}else if(character===C_SPACE&&value.charAt(index+1)===character&&value.charAt(index+2)===character&&value.charAt(index+3)===character){subvalueQueue+=CODE_INDENT;index+=3;indent=true}else if(character===C_TAB){subvalueQueue+=character;indent=true}else{blankQueue="";while(character===C_TAB||character===C_SPACE){blankQueue+=character;character=value.charAt(++index)}if(character!==C_NEWLINE){break}subvalueQueue+=blankQueue+character;contentQueue+=character}}if(content){if(silent){return true}return eat(subvalue)({type:"code",lang:null,value:trim(content)})}}},1122:function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(499);module.exports=fencedCode;var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var C_TILDE="~";var C_TICK="`";var MIN_FENCE_COUNT=3;var CODE_INDENT_COUNT=4;function fencedCode(eat,value,silent){var self=this;var settings=self.options;var length=value.length+1;var index=0;var subvalue="";var fenceCount;var marker;var character;var flag;var queue;var content;var exdentedContent;var closing;var exdentedClosing;var indent;var now;if(!settings.gfm){return}while(index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){break}subvalue+=character;index++}indent=index;character=value.charAt(index);if(character!==C_TILDE&&character!==C_TICK){return}index++;marker=character;fenceCount=1;subvalue+=character;while(index<length){character=value.charAt(index);if(character!==marker){break}subvalue+=character;fenceCount++;index++}if(fenceCount<MIN_FENCE_COUNT){return}while(index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){break}subvalue+=character;index++}flag="";queue="";while(index<length){character=value.charAt(index);if(character===C_NEWLINE||character===C_TILDE||character===C_TICK){break}if(character===C_SPACE||character===C_TAB){queue+=character}else{flag+=queue+character;queue=""}index++}character=value.charAt(index);if(character&&character!==C_NEWLINE){return}if(silent){return true}now=eat.now();now.column+=subvalue.length;now.offset+=subvalue.length;subvalue+=flag;flag=self.decode.raw(self.unescape(flag),now);if(queue){subvalue+=queue}queue="";closing="";exdentedClosing="";content="";exdentedContent="";while(index<length){character=value.charAt(index);content+=closing;exdentedContent+=exdentedClosing;closing="";exdentedClosing="";if(character!==C_NEWLINE){content+=character;exdentedClosing+=character;index++;continue}if(content){closing+=character;exdentedClosing+=character}else{subvalue+=character}queue="";index++;while(index<length){character=value.charAt(index);if(character!==C_SPACE){break}queue+=character;index++}closing+=queue;exdentedClosing+=queue.slice(indent);if(queue.length>=CODE_INDENT_COUNT){continue}queue="";while(index<length){character=value.charAt(index);if(character!==marker){break}queue+=character;index++}closing+=queue;exdentedClosing+=queue;if(queue.length<fenceCount){continue}queue="";while(index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){break}closing+=character;exdentedClosing+=character;index++}if(!character||character===C_NEWLINE){break}}subvalue+=content+closing;return eat(subvalue)({type:"code",lang:flag||null,value:trim(exdentedContent)})}},1123:function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(279);var interrupt=__webpack_require__(500);module.exports=blockquote;var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var C_GT=">";function blockquote(eat,value,silent){var self=this;var offsets=self.offset;var tokenizers=self.blockTokenizers;var interruptors=self.interruptBlockquote;var now=eat.now();var currentLine=now.line;var length=value.length;var values=[];var contents=[];var indents=[];var add;var index=0;var character;var rest;var nextIndex;var content;var line;var startIndex;var prefixed;var exit;while(index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){break}index++}if(value.charAt(index)!==C_GT){return}if(silent){return true}index=0;while(index<length){nextIndex=value.indexOf(C_NEWLINE,index);startIndex=index;prefixed=false;if(nextIndex===-1){nextIndex=length}while(index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){break}index++}if(value.charAt(index)===C_GT){index++;prefixed=true;if(value.charAt(index)===C_SPACE){index++}}else{index=startIndex}content=value.slice(index,nextIndex);if(!prefixed&&!trim(content)){index=startIndex;break}if(!prefixed){rest=value.slice(index);if(interrupt(interruptors,tokenizers,self,[eat,rest,true])){break}}line=startIndex===index?content:value.slice(startIndex,nextIndex);indents.push(index-startIndex);values.push(line);contents.push(content);index=nextIndex+1}index=-1;length=indents.length;add=eat(values.join(C_NEWLINE));while(++index<length){offsets[currentLine]=(offsets[currentLine]||0)+indents[index];currentLine++}exit=self.enterBlock();contents=self.tokenizeBlock(contents.join(C_NEWLINE),now);exit();return add({type:"blockquote",children:contents})}},1124:function(module,exports,__webpack_require__){"use strict";module.exports=atxHeading;var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var C_HASH="#";var MAX_ATX_COUNT=6;function atxHeading(eat,value,silent){var self=this;var settings=self.options;var length=value.length+1;var index=-1;var now=eat.now();var subvalue="";var content="";var character;var queue;var depth;while(++index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){index--;break}subvalue+=character}depth=0;while(++index<=length){character=value.charAt(index);if(character!==C_HASH){index--;break}subvalue+=character;depth++}if(depth>MAX_ATX_COUNT){return}if(!depth||!settings.pedantic&&value.charAt(index+1)===C_HASH){return}length=value.length+1;queue="";while(++index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){index--;break}queue+=character}if(!settings.pedantic&&queue.length===0&&character&&character!==C_NEWLINE){return}if(silent){return true}subvalue+=queue;queue="";content="";while(++index<length){character=value.charAt(index);if(!character||character===C_NEWLINE){break}if(character!==C_SPACE&&character!==C_TAB&&character!==C_HASH){content+=queue+character;queue="";continue}while(character===C_SPACE||character===C_TAB){queue+=character;character=value.charAt(++index)}while(character===C_HASH){queue+=character;character=value.charAt(++index)}while(character===C_SPACE||character===C_TAB){queue+=character;character=value.charAt(++index)}index--}now.column+=subvalue.length;now.offset+=subvalue.length;subvalue+=content+queue;return eat(subvalue)({type:"heading",depth:depth,children:self.tokenizeInline(content,now)})}},1125:function(module,exports,__webpack_require__){"use strict";module.exports=thematicBreak;var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var C_ASTERISK="*";var C_UNDERSCORE="_";var C_DASH="-";var THEMATIC_BREAK_MARKER_COUNT=3;function thematicBreak(eat,value,silent){var index=-1;var length=value.length+1;var subvalue="";var character;var marker;var markerCount;var queue;while(++index<length){character=value.charAt(index);if(character!==C_TAB&&character!==C_SPACE){break}subvalue+=character}if(character!==C_ASTERISK&&character!==C_DASH&&character!==C_UNDERSCORE){return}marker=character;subvalue+=character;markerCount=1;queue="";while(++index<length){character=value.charAt(index);if(character===marker){markerCount++;subvalue+=queue+marker;queue=""}else if(character===C_SPACE){queue+=character}else if(markerCount>=THEMATIC_BREAK_MARKER_COUNT&&(!character||character===C_NEWLINE)){subvalue+=queue;if(silent){return true}return eat(subvalue)({type:"thematicBreak"})}else{return}}}},1126:function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(279);var repeat=__webpack_require__(498);var decimal=__webpack_require__(396);var getIndent=__webpack_require__(736);var removeIndent=__webpack_require__(1127);var interrupt=__webpack_require__(500);module.exports=list;var C_ASTERISK="*";var C_UNDERSCORE="_";var C_PLUS="+";var C_DASH="-";var C_DOT=".";var C_SPACE=" ";var C_NEWLINE="\n";var C_TAB="\t";var C_PAREN_CLOSE=")";var C_X_LOWER="x";var TAB_SIZE=4;var EXPRESSION_LOOSE_LIST_ITEM=/\n\n(?!\s*$)/;var EXPRESSION_TASK_ITEM=/^\[([ \t]|x|X)][ \t]/;var EXPRESSION_BULLET=/^([ \t]*)([*+-]|\d+[.)])( {1,4}(?! )| |\t|$|(?=\n))([^\n]*)/;var EXPRESSION_PEDANTIC_BULLET=/^([ \t]*)([*+-]|\d+[.)])([ \t]+)/;var EXPRESSION_INITIAL_INDENT=/^( {1,4}|\t)?/gm;var LIST_UNORDERED_MARKERS={};LIST_UNORDERED_MARKERS[C_ASTERISK]=true;LIST_UNORDERED_MARKERS[C_PLUS]=true;LIST_UNORDERED_MARKERS[C_DASH]=true;var LIST_ORDERED_MARKERS={};LIST_ORDERED_MARKERS[C_DOT]=true;var LIST_ORDERED_COMMONMARK_MARKERS={};LIST_ORDERED_COMMONMARK_MARKERS[C_DOT]=true;LIST_ORDERED_COMMONMARK_MARKERS[C_PAREN_CLOSE]=true;function list(eat,value,silent){var self=this;var commonmark=self.options.commonmark;var pedantic=self.options.pedantic;var tokenizers=self.blockTokenizers;var interuptors=self.interruptList;var markers;var index=0;var length=value.length;var start=null;var size=0;var queue;var ordered;var character;var marker;var nextIndex;var startIndex;var prefixed;var currentMarker;var content;var line;var prevEmpty;var empty;var items;var allLines;var emptyLines;var item;var enterTop;var exitBlockquote;var isLoose;var node;var now;var end;var indented;while(index<length){character=value.charAt(index);if(character===C_TAB){size+=TAB_SIZE-size%TAB_SIZE}else if(character===C_SPACE){size++}else{break}index++}if(size>=TAB_SIZE){return}character=value.charAt(index);markers=commonmark?LIST_ORDERED_COMMONMARK_MARKERS:LIST_ORDERED_MARKERS;if(LIST_UNORDERED_MARKERS[character]===true){marker=character;ordered=false}else{ordered=true;queue="";while(index<length){character=value.charAt(index);if(!decimal(character)){break}queue+=character;index++}character=value.charAt(index);if(!queue||markers[character]!==true){return}start=parseInt(queue,10);marker=character}character=value.charAt(++index);if(character!==C_SPACE&&character!==C_TAB){return}if(silent){return true}index=0;items=[];allLines=[];emptyLines=[];while(index<length){nextIndex=value.indexOf(C_NEWLINE,index);startIndex=index;prefixed=false;indented=false;if(nextIndex===-1){nextIndex=length}end=index+TAB_SIZE;size=0;while(index<length){character=value.charAt(index);if(character===C_TAB){size+=TAB_SIZE-size%TAB_SIZE}else if(character===C_SPACE){size++}else{break}index++}if(size>=TAB_SIZE){indented=true}if(item&&size>=item.indent){indented=true}character=value.charAt(index);currentMarker=null;if(!indented){if(LIST_UNORDERED_MARKERS[character]===true){currentMarker=character;index++;size++}else{queue="";while(index<length){character=value.charAt(index);if(!decimal(character)){break}queue+=character;index++}character=value.charAt(index);index++;if(queue&&markers[character]===true){currentMarker=character;size+=queue.length+1}}if(currentMarker){character=value.charAt(index);if(character===C_TAB){size+=TAB_SIZE-size%TAB_SIZE;index++}else if(character===C_SPACE){end=index+TAB_SIZE;while(index<end){if(value.charAt(index)!==C_SPACE){break}index++;size++}if(index===end&&value.charAt(index)===C_SPACE){index-=TAB_SIZE-1;size-=TAB_SIZE-1}}else if(character!==C_NEWLINE&&character!==""){currentMarker=null}}}if(currentMarker){if(!pedantic&&marker!==currentMarker){break}prefixed=true}else{if(!commonmark&&!indented&&value.charAt(startIndex)===C_SPACE){indented=true}else if(commonmark&&item){indented=size>=item.indent||size>TAB_SIZE}prefixed=false;index=startIndex}line=value.slice(startIndex,nextIndex);content=startIndex===index?line:value.slice(index,nextIndex);if(currentMarker===C_ASTERISK||currentMarker===C_UNDERSCORE||currentMarker===C_DASH){if(tokenizers.thematicBreak.call(self,eat,line,true)){break}}prevEmpty=empty;empty=!trim(content).length;if(indented&&item){item.value=item.value.concat(emptyLines,line);allLines=allLines.concat(emptyLines,line);emptyLines=[]}else if(prefixed){if(emptyLines.length!==0){item.value.push("");item.trail=emptyLines.concat()}item={value:[line],indent:size,trail:[]};items.push(item);allLines=allLines.concat(emptyLines,line);emptyLines=[]}else if(empty){if(prevEmpty){break}emptyLines.push(line)}else{if(prevEmpty){break}if(interrupt(interuptors,tokenizers,self,[eat,line,true])){break}item.value=item.value.concat(emptyLines,line);allLines=allLines.concat(emptyLines,line);emptyLines=[]}index=nextIndex+1}node=eat(allLines.join(C_NEWLINE)).reset({type:"list",ordered:ordered,start:start,loose:null,children:[]});enterTop=self.enterList();exitBlockquote=self.enterBlock();isLoose=false;index=-1;length=items.length;while(++index<length){item=items[index].value.join(C_NEWLINE);now=eat.now();item=eat(item)(listItem(self,item,now),node);if(item.loose){isLoose=true}item=items[index].trail.join(C_NEWLINE);if(index!==length-1){item+=C_NEWLINE}eat(item)}enterTop();exitBlockquote();node.loose=isLoose;return node}function listItem(ctx,value,position){var offsets=ctx.offset;var fn=ctx.options.pedantic?pedanticListItem:normalListItem;var checked=null;var task;var indent;value=fn.apply(null,arguments);if(ctx.options.gfm){task=value.match(EXPRESSION_TASK_ITEM);if(task){indent=task[0].length;checked=task[1].toLowerCase()===C_X_LOWER;offsets[position.line]+=indent;value=value.slice(indent)}}return{type:"listItem",loose:EXPRESSION_LOOSE_LIST_ITEM.test(value)||value.charAt(value.length-1)===C_NEWLINE,checked:checked,children:ctx.tokenizeBlock(value,position)}}function pedanticListItem(ctx,value,position){var offsets=ctx.offset;var line=position.line;value=value.replace(EXPRESSION_PEDANTIC_BULLET,replacer);line=position.line;return value.replace(EXPRESSION_INITIAL_INDENT,replacer);function replacer($0){offsets[line]=(offsets[line]||0)+$0.length;line++;return""}}function normalListItem(ctx,value,position){var offsets=ctx.offset;var line=position.line;var max;var bullet;var rest;var lines;var trimmedLines;var index;var length;value=value.replace(EXPRESSION_BULLET,replacer);lines=value.split(C_NEWLINE);trimmedLines=removeIndent(value,getIndent(max).indent).split(C_NEWLINE);trimmedLines[0]=rest;offsets[line]=(offsets[line]||0)+bullet.length;line++;index=0;length=lines.length;while(++index<length){offsets[line]=(offsets[line]||0)+lines[index].length-trimmedLines[index].length;line++}return trimmedLines.join(C_NEWLINE);function replacer($0,$1,$2,$3,$4){bullet=$1+$2+$3;rest=$4;if(Number($2)<10&&bullet.length%2===1){$2=C_SPACE+$2}max=$1+repeat(C_SPACE,$2.length)+$3;return max+rest}}},1127:function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(279);var repeat=__webpack_require__(498);var getIndent=__webpack_require__(736);module.exports=indentation;var C_SPACE=" ";var C_NEWLINE="\n";var C_TAB="\t";function indentation(value,maximum){var values=value.split(C_NEWLINE);var position=values.length+1;var minIndent=Infinity;var matrix=[];var index;var indentation;var stops;var padding;values.unshift(repeat(C_SPACE,maximum)+"!");while(position--){indentation=getIndent(values[position]);matrix[position]=indentation.stops;if(trim(values[position]).length===0){continue}if(indentation.indent){if(indentation.indent>0&&indentation.indent<minIndent){minIndent=indentation.indent}}else{minIndent=Infinity;break}}if(minIndent!==Infinity){position=values.length;while(position--){stops=matrix[position];index=minIndent;while(index&&!(index in stops)){index--}if(trim(values[position]).length!==0&&minIndent&&index!==minIndent){padding=C_TAB}else{padding=""}values[position]=padding+values[position].slice(index in stops?stops[index]+1:0)}}values.shift();return values.join(C_NEWLINE)}},1128:function(module,exports,__webpack_require__){"use strict";module.exports=setextHeading;var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var C_EQUALS="=";var C_DASH="-";var MAX_HEADING_INDENT=3;var SETEXT_MARKERS={};SETEXT_MARKERS[C_EQUALS]=1;SETEXT_MARKERS[C_DASH]=2;function setextHeading(eat,value,silent){var self=this;var now=eat.now();var length=value.length;var index=-1;var subvalue="";var content;var queue;var character;var marker;var depth;while(++index<length){character=value.charAt(index);if(character!==C_SPACE||index>=MAX_HEADING_INDENT){index--;break}subvalue+=character}content="";queue="";while(++index<length){character=value.charAt(index);if(character===C_NEWLINE){index--;break}if(character===C_SPACE||character===C_TAB){queue+=character}else{content+=queue+character;queue=""}}now.column+=subvalue.length;now.offset+=subvalue.length;subvalue+=content+queue;character=value.charAt(++index);marker=value.charAt(++index);if(character!==C_NEWLINE||!SETEXT_MARKERS[marker]){return}subvalue+=character;queue=marker;depth=SETEXT_MARKERS[marker];while(++index<length){character=value.charAt(index);if(character!==marker){if(character!==C_NEWLINE){return}index--;break}queue+=character}if(silent){return true}return eat(subvalue+queue)({type:"heading",depth:depth,children:self.tokenizeInline(content,now)})}},1129:function(module,exports,__webpack_require__){"use strict";var openCloseTag=__webpack_require__(737).openCloseTag;module.exports=blockHTML;var C_TAB="\t";var C_SPACE=" ";var C_NEWLINE="\n";var C_LT="<";function blockHTML(eat,value,silent){var self=this;var blocks=self.options.blocks;var length=value.length;var index=0;var next;var line;var offset;var character;var count;var sequence;var subvalue;var sequences=[[/^<(script|pre|style)(?=(\s|>|$))/i,/<\/(script|pre|style)>/i,true],[/^<!--/,/-->/,true],[/^<\?/,/\?>/,true],[/^<![A-Za-z]/,/>/,true],[/^<!\[CDATA\[/,/\]\]>/,true],[new RegExp("^</?("+blocks.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,true],[new RegExp(openCloseTag.source+"\\s*$"),/^$/,false]];while(index<length){character=value.charAt(index);if(character!==C_TAB&&character!==C_SPACE){break}index++}if(value.charAt(index)!==C_LT){return}next=value.indexOf(C_NEWLINE,index+1);next=next===-1?length:next;line=value.slice(index,next);offset=-1;count=sequences.length;while(++offset<count){if(sequences[offset][0].test(line)){sequence=sequences[offset];break}}if(!sequence){return}if(silent){return sequence[2]}index=next;if(!sequence[1].test(line)){while(index<length){next=value.indexOf(C_NEWLINE,index+1);next=next===-1?length:next;line=value.slice(index+1,next);if(sequence[1].test(line)){if(line){index=next}break}index=next}}subvalue=value.slice(0,index);return eat(subvalue)({type:"html",value:subvalue})}},1130:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(171);var normalize=__webpack_require__(501);module.exports=footnoteDefinition;footnoteDefinition.notInList=true;footnoteDefinition.notInBlock=true;var C_BACKSLASH="\\";var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var C_BRACKET_OPEN="[";var C_BRACKET_CLOSE="]";var C_CARET="^";var C_COLON=":";var EXPRESSION_INITIAL_TAB=/^( {4}|\t)?/gm;function footnoteDefinition(eat,value,silent){var self=this;var offsets=self.offset;var index;var length;var subvalue;var now;var currentLine;var content;var queue;var subqueue;var character;var identifier;var add;var exit;if(!self.options.footnotes){return}index=0;length=value.length;subvalue="";now=eat.now();currentLine=now.line;while(index<length){character=value.charAt(index);if(!whitespace(character)){break}subvalue+=character;index++}if(value.charAt(index)!==C_BRACKET_OPEN||value.charAt(index+1)!==C_CARET){return}subvalue+=C_BRACKET_OPEN+C_CARET;index=subvalue.length;queue="";while(index<length){character=value.charAt(index);if(character===C_BRACKET_CLOSE){break}else if(character===C_BACKSLASH){queue+=character;index++;character=value.charAt(index)}queue+=character;index++}if(!queue||value.charAt(index)!==C_BRACKET_CLOSE||value.charAt(index+1)!==C_COLON){return}if(silent){return true}identifier=normalize(queue);subvalue+=queue+C_BRACKET_CLOSE+C_COLON;index=subvalue.length;while(index<length){character=value.charAt(index);if(character!==C_TAB&&character!==C_SPACE){break}subvalue+=character;index++}now.column+=subvalue.length;now.offset+=subvalue.length;queue="";content="";subqueue="";while(index<length){character=value.charAt(index);if(character===C_NEWLINE){subqueue=character;index++;while(index<length){character=value.charAt(index);if(character!==C_NEWLINE){break}subqueue+=character;index++}queue+=subqueue;subqueue="";while(index<length){character=value.charAt(index);if(character!==C_SPACE){break}subqueue+=character;index++}if(subqueue.length===0){break}queue+=subqueue}if(queue){content+=queue;queue=""}content+=character;index++}subvalue+=content;content=content.replace(EXPRESSION_INITIAL_TAB,(function(line){offsets[currentLine]=(offsets[currentLine]||0)+line.length;currentLine++;return""}));add=eat(subvalue);exit=self.enterBlock();content=self.tokenizeBlock(content,now);exit();return add({type:"footnoteDefinition",identifier:identifier,children:content})}},1131:function(module,exports,__webpack_require__){"use strict";module.exports=collapse;function collapse(value){return String(value).replace(/\s+/g," ")}},1132:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(171);var normalize=__webpack_require__(501);module.exports=definition;definition.notInList=true;definition.notInBlock=true;var C_DOUBLE_QUOTE='"';var C_SINGLE_QUOTE="'";var C_BACKSLASH="\\";var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var C_BRACKET_OPEN="[";var C_BRACKET_CLOSE="]";var C_PAREN_OPEN="(";var C_PAREN_CLOSE=")";var C_COLON=":";var C_LT="<";var C_GT=">";function definition(eat,value,silent){var self=this;var commonmark=self.options.commonmark;var index=0;var length=value.length;var subvalue="";var beforeURL;var beforeTitle;var queue;var character;var test;var identifier;var url;var title;while(index<length){character=value.charAt(index);if(character!==C_SPACE&&character!==C_TAB){break}subvalue+=character;index++}character=value.charAt(index);if(character!==C_BRACKET_OPEN){return}index++;subvalue+=character;queue="";while(index<length){character=value.charAt(index);if(character===C_BRACKET_CLOSE){break}else if(character===C_BACKSLASH){queue+=character;index++;character=value.charAt(index)}queue+=character;index++}if(!queue||value.charAt(index)!==C_BRACKET_CLOSE||value.charAt(index+1)!==C_COLON){return}identifier=queue;subvalue+=queue+C_BRACKET_CLOSE+C_COLON;index=subvalue.length;queue="";while(index<length){character=value.charAt(index);if(character!==C_TAB&&character!==C_SPACE&&character!==C_NEWLINE){break}subvalue+=character;index++}character=value.charAt(index);queue="";beforeURL=subvalue;if(character===C_LT){index++;while(index<length){character=value.charAt(index);if(!isEnclosedURLCharacter(character)){break}queue+=character;index++}character=value.charAt(index);if(character===isEnclosedURLCharacter.delimiter){subvalue+=C_LT+queue+character;index++}else{if(commonmark){return}index-=queue.length+1;queue=""}}if(!queue){while(index<length){character=value.charAt(index);if(!isUnclosedURLCharacter(character)){break}queue+=character;index++}subvalue+=queue}if(!queue){return}url=queue;queue="";while(index<length){character=value.charAt(index);if(character!==C_TAB&&character!==C_SPACE&&character!==C_NEWLINE){break}queue+=character;index++}character=value.charAt(index);test=null;if(character===C_DOUBLE_QUOTE){test=C_DOUBLE_QUOTE}else if(character===C_SINGLE_QUOTE){test=C_SINGLE_QUOTE}else if(character===C_PAREN_OPEN){test=C_PAREN_CLOSE}if(!test){queue="";index=subvalue.length}else if(queue){subvalue+=queue+character;index=subvalue.length;queue="";while(index<length){character=value.charAt(index);if(character===test){break}if(character===C_NEWLINE){index++;character=value.charAt(index);if(character===C_NEWLINE||character===test){return}queue+=C_NEWLINE}queue+=character;index++}character=value.charAt(index);if(character!==test){return}beforeTitle=subvalue;subvalue+=queue+character;index++;title=queue;queue=""}else{return}while(index<length){character=value.charAt(index);if(character!==C_TAB&&character!==C_SPACE){break}subvalue+=character;index++}character=value.charAt(index);if(!character||character===C_NEWLINE){if(silent){return true}beforeURL=eat(beforeURL).test().end;url=self.decode.raw(self.unescape(url),beforeURL,{nonTerminated:false});if(title){beforeTitle=eat(beforeTitle).test().end;title=self.decode.raw(self.unescape(title),beforeTitle)}return eat(subvalue)({type:"definition",identifier:normalize(identifier),title:title||null,url:url})}}function isEnclosedURLCharacter(character){return character!==C_GT&&character!==C_BRACKET_OPEN&&character!==C_BRACKET_CLOSE}isEnclosedURLCharacter.delimiter=C_GT;function isUnclosedURLCharacter(character){return character!==C_BRACKET_OPEN&&character!==C_BRACKET_CLOSE&&!whitespace(character)}},1133:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(171);module.exports=table;var C_BACKSLASH="\\";var C_TICK="`";var C_DASH="-";var C_PIPE="|";var C_COLON=":";var C_SPACE=" ";var C_NEWLINE="\n";var C_TAB="\t";var MIN_TABLE_COLUMNS=1;var MIN_TABLE_ROWS=2;var TABLE_ALIGN_LEFT="left";var TABLE_ALIGN_CENTER="center";var TABLE_ALIGN_RIGHT="right";var TABLE_ALIGN_NONE=null;function table(eat,value,silent){var self=this;var index;var alignments;var alignment;var subvalue;var row;var length;var lines;var queue;var character;var hasDash;var align;var cell;var preamble;var count;var opening;var now;var position;var lineCount;var line;var rows;var table;var lineIndex;var pipeIndex;var first;if(!self.options.gfm){return}index=0;lineCount=0;length=value.length+1;lines=[];while(index<length){lineIndex=value.indexOf(C_NEWLINE,index);pipeIndex=value.indexOf(C_PIPE,index+1);if(lineIndex===-1){lineIndex=value.length}if(pipeIndex===-1||pipeIndex>lineIndex){if(lineCount<MIN_TABLE_ROWS){return}break}lines.push(value.slice(index,lineIndex));lineCount++;index=lineIndex+1}subvalue=lines.join(C_NEWLINE);alignments=lines.splice(1,1)[0]||[];index=0;length=alignments.length;lineCount--;alignment=false;align=[];while(index<length){character=alignments.charAt(index);if(character===C_PIPE){hasDash=null;if(alignment===false){if(first===false){return}}else{align.push(alignment);alignment=false}first=false}else if(character===C_DASH){hasDash=true;alignment=alignment||TABLE_ALIGN_NONE}else if(character===C_COLON){if(alignment===TABLE_ALIGN_LEFT){alignment=TABLE_ALIGN_CENTER}else if(hasDash&&alignment===TABLE_ALIGN_NONE){alignment=TABLE_ALIGN_RIGHT}else{alignment=TABLE_ALIGN_LEFT}}else if(!whitespace(character)){return}index++}if(alignment!==false){align.push(alignment)}if(align.length<MIN_TABLE_COLUMNS){return}if(silent){return true}position=-1;rows=[];table=eat(subvalue).reset({type:"table",align:align,children:rows});while(++position<lineCount){line=lines[position];row={type:"tableRow",children:[]};if(position){eat(C_NEWLINE)}eat(line).reset(row,table);length=line.length+1;index=0;queue="";cell="";preamble=true;count=null;opening=null;while(index<length){character=line.charAt(index);if(character===C_TAB||character===C_SPACE){if(cell){queue+=character}else{eat(character)}index++;continue}if(character===""||character===C_PIPE){if(preamble){eat(character)}else{if(character&&opening){queue+=character;index++;continue}if((cell||character)&&!preamble){subvalue=cell;if(queue.length>1){if(character){subvalue+=queue.slice(0,queue.length-1);queue=queue.charAt(queue.length-1)}else{subvalue+=queue;queue=""}}now=eat.now();eat(subvalue)({type:"tableCell",children:self.tokenizeInline(cell,now)},row)}eat(queue+character);queue="";cell=""}}else{if(queue){cell+=queue;queue=""}cell+=character;if(character===C_BACKSLASH&&index!==length-2){cell+=line.charAt(index+1);index++}if(character===C_TICK){count=1;while(line.charAt(index+1)===character){cell+=character;index++;count++}if(!opening){opening=count}else if(count>=opening){opening=0}}}preamble=false;index++}if(!position){eat(C_NEWLINE+alignments)}}return table}},1134:function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(279);var decimal=__webpack_require__(396);var trimTrailingLines=__webpack_require__(499);var interrupt=__webpack_require__(500);module.exports=paragraph;var C_NEWLINE="\n";var C_TAB="\t";var C_SPACE=" ";var TAB_SIZE=4;function paragraph(eat,value,silent){var self=this;var settings=self.options;var commonmark=settings.commonmark;var gfm=settings.gfm;var tokenizers=self.blockTokenizers;var interruptors=self.interruptParagraph;var index=value.indexOf(C_NEWLINE);var length=value.length;var position;var subvalue;var character;var size;var now;while(index<length){if(index===-1){index=length;break}if(value.charAt(index+1)===C_NEWLINE){break}if(commonmark){size=0;position=index+1;while(position<length){character=value.charAt(position);if(character===C_TAB){size=TAB_SIZE;break}else if(character===C_SPACE){size++}else{break}position++}if(size>=TAB_SIZE){index=value.indexOf(C_NEWLINE,index+1);continue}}subvalue=value.slice(index+1);if(interrupt(interruptors,tokenizers,self,[eat,subvalue,true])){break}if(tokenizers.list.call(self,eat,subvalue,true)&&(self.inList||commonmark||gfm&&!decimal(trim.left(subvalue).charAt(0)))){break}position=index;index=value.indexOf(C_NEWLINE,index+1);if(index!==-1&&trim(value.slice(position,index))===""){index=position;break}}subvalue=value.slice(0,index);if(trim(subvalue)===""){eat(subvalue);return null}if(silent){return true}now=eat.now();subvalue=trimTrailingLines(subvalue);return eat(subvalue)({type:"paragraph",children:self.tokenizeInline(subvalue,now)})}},1135:function(module,exports,__webpack_require__){"use strict";var locate=__webpack_require__(1136);module.exports=escape;escape.locator=locate;function escape(eat,value,silent){var self=this;var character;var node;if(value.charAt(0)==="\\"){character=value.charAt(1);if(self.escape.indexOf(character)!==-1){if(silent){return true}if(character==="\n"){node={type:"break"}}else{node={type:"text",value:character}}return eat("\\"+character)(node)}}}},1136:function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){return value.indexOf("\\",fromIndex)}},1137:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(171);var decode=__webpack_require__(497);var locate=__webpack_require__(738);module.exports=autoLink;autoLink.locator=locate;autoLink.notInLink=true;var C_LT="<";var C_GT=">";var C_AT_SIGN="@";var C_SLASH="/";var MAILTO="mailto:";var MAILTO_LENGTH=MAILTO.length;function autoLink(eat,value,silent){var self;var subvalue;var length;var index;var queue;var character;var hasAtCharacter;var link;var now;var content;var tokenizers;var exit;if(value.charAt(0)!==C_LT){return}self=this;subvalue="";length=value.length;index=0;queue="";hasAtCharacter=false;link="";index++;subvalue=C_LT;while(index<length){character=value.charAt(index);if(whitespace(character)||character===C_GT||character===C_AT_SIGN||character===":"&&value.charAt(index+1)===C_SLASH){break}queue+=character;index++}if(!queue){return}link+=queue;queue="";character=value.charAt(index);link+=character;index++;if(character===C_AT_SIGN){hasAtCharacter=true}else{if(character!==":"||value.charAt(index+1)!==C_SLASH){return}link+=C_SLASH;index++}while(index<length){character=value.charAt(index);if(whitespace(character)||character===C_GT){break}queue+=character;index++}character=value.charAt(index);if(!queue||character!==C_GT){return}if(silent){return true}link+=queue;content=link;subvalue+=link+character;now=eat.now();now.column++;now.offset++;if(hasAtCharacter){if(link.slice(0,MAILTO_LENGTH).toLowerCase()===MAILTO){content=content.substr(MAILTO_LENGTH);now.column+=MAILTO_LENGTH;now.offset+=MAILTO_LENGTH}else{link=MAILTO+link}}tokenizers=self.inlineTokenizers;self.inlineTokenizers={text:tokenizers.text};exit=self.enterLink();content=self.tokenizeInline(content,now);self.inlineTokenizers=tokenizers;exit();return eat(subvalue)({type:"link",title:null,url:decode(link,{nonTerminated:false}),children:content})}},1138:function(module,exports,__webpack_require__){"use strict";var decode=__webpack_require__(497);var whitespace=__webpack_require__(171);var locate=__webpack_require__(1139);module.exports=url;url.locator=locate;url.notInLink=true;var C_BRACKET_OPEN="[";var C_BRACKET_CLOSE="]";var C_PAREN_OPEN="(";var C_PAREN_CLOSE=")";var C_LT="<";var C_AT_SIGN="@";var HTTP_PROTOCOL="http://";var HTTPS_PROTOCOL="https://";var MAILTO_PROTOCOL="mailto:";var PROTOCOLS=[HTTP_PROTOCOL,HTTPS_PROTOCOL,MAILTO_PROTOCOL];var PROTOCOLS_LENGTH=PROTOCOLS.length;function url(eat,value,silent){var self=this;var subvalue;var content;var character;var index;var position;var protocol;var match;var length;var queue;var parenCount;var nextCharacter;var exit;if(!self.options.gfm){return}subvalue="";index=-1;length=PROTOCOLS_LENGTH;while(++index<length){protocol=PROTOCOLS[index];match=value.slice(0,protocol.length);if(match.toLowerCase()===protocol){subvalue=match;break}}if(!subvalue){return}index=subvalue.length;length=value.length;queue="";parenCount=0;while(index<length){character=value.charAt(index);if(whitespace(character)||character===C_LT){break}if(character==="."||character===","||character===":"||character===";"||character==='"'||character==="'"||character===")"||character==="]"){nextCharacter=value.charAt(index+1);if(!nextCharacter||whitespace(nextCharacter)){break}}if(character===C_PAREN_OPEN||character===C_BRACKET_OPEN){parenCount++}if(character===C_PAREN_CLOSE||character===C_BRACKET_CLOSE){parenCount--;if(parenCount<0){break}}queue+=character;index++}if(!queue){return}subvalue+=queue;content=subvalue;if(protocol===MAILTO_PROTOCOL){position=queue.indexOf(C_AT_SIGN);if(position===-1||position===length-1){return}content=content.substr(MAILTO_PROTOCOL.length)}if(silent){return true}exit=self.enterLink();content=self.tokenizeInline(content,eat.now());exit();return eat(subvalue)({type:"link",title:null,url:decode(subvalue,{nonTerminated:false}),children:content})}},1139:function(module,exports,__webpack_require__){"use strict";module.exports=locate;var PROTOCOLS=["https://","http://","mailto:"];function locate(value,fromIndex){var length=PROTOCOLS.length;var index=-1;var min=-1;var position;if(!this.options.gfm){return-1}while(++index<length){position=value.indexOf(PROTOCOLS[index],fromIndex);if(position!==-1&&(position<min||min===-1)){min=position}}return min}},1140:function(module,exports,__webpack_require__){"use strict";var alphabetical=__webpack_require__(734);var locate=__webpack_require__(738);var tag=__webpack_require__(737).tag;module.exports=inlineHTML;inlineHTML.locator=locate;var EXPRESSION_HTML_LINK_OPEN=/^<a /i;var EXPRESSION_HTML_LINK_CLOSE=/^<\/a>/i;function inlineHTML(eat,value,silent){var self=this;var length=value.length;var character;var subvalue;if(value.charAt(0)!=="<"||length<3){return}character=value.charAt(1);if(!alphabetical(character)&&character!=="?"&&character!=="!"&&character!=="/"){return}subvalue=value.match(tag);if(!subvalue){return}if(silent){return true}subvalue=subvalue[0];if(!self.inLink&&EXPRESSION_HTML_LINK_OPEN.test(subvalue)){self.inLink=true}else if(self.inLink&&EXPRESSION_HTML_LINK_CLOSE.test(subvalue)){self.inLink=false}return eat(subvalue)({type:"html",value:subvalue})}},1141:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(171);var locate=__webpack_require__(739);module.exports=link;link.locator=locate;var own={}.hasOwnProperty;var C_BACKSLASH="\\";var C_BRACKET_OPEN="[";var C_BRACKET_CLOSE="]";var C_PAREN_OPEN="(";var C_PAREN_CLOSE=")";var C_LT="<";var C_GT=">";var C_TICK="`";var C_DOUBLE_QUOTE='"';var C_SINGLE_QUOTE="'";var LINK_MARKERS={};LINK_MARKERS[C_DOUBLE_QUOTE]=C_DOUBLE_QUOTE;LINK_MARKERS[C_SINGLE_QUOTE]=C_SINGLE_QUOTE;var COMMONMARK_LINK_MARKERS={};COMMONMARK_LINK_MARKERS[C_DOUBLE_QUOTE]=C_DOUBLE_QUOTE;COMMONMARK_LINK_MARKERS[C_SINGLE_QUOTE]=C_SINGLE_QUOTE;COMMONMARK_LINK_MARKERS[C_PAREN_OPEN]=C_PAREN_CLOSE;function link(eat,value,silent){var self=this;var subvalue="";var index=0;var character=value.charAt(0);var pedantic=self.options.pedantic;var commonmark=self.options.commonmark;var gfm=self.options.gfm;var closed;var count;var opening;var beforeURL;var beforeTitle;var subqueue;var hasMarker;var markers;var isImage;var content;var marker;var length;var title;var depth;var queue;var url;var now;var exit;var node;if(character==="!"){isImage=true;subvalue=character;character=value.charAt(++index)}if(character!==C_BRACKET_OPEN){return}if(!isImage&&self.inLink){return}subvalue+=character;queue="";index++;length=value.length;now=eat.now();depth=0;now.column+=index;now.offset+=index;while(index<length){character=value.charAt(index);subqueue=character;if(character===C_TICK){count=1;while(value.charAt(index+1)===C_TICK){subqueue+=character;index++;count++}if(!opening){opening=count}else if(count>=opening){opening=0}}else if(character===C_BACKSLASH){index++;subqueue+=value.charAt(index)}else if((!opening||gfm)&&character===C_BRACKET_OPEN){depth++}else if((!opening||gfm)&&character===C_BRACKET_CLOSE){if(depth){depth--}else{if(!pedantic){while(index<length){character=value.charAt(index+1);if(!whitespace(character)){break}subqueue+=character;index++}}if(value.charAt(index+1)!==C_PAREN_OPEN){return}subqueue+=C_PAREN_OPEN;closed=true;index++;break}}queue+=subqueue;subqueue="";index++}if(!closed){return}content=queue;subvalue+=queue+subqueue;index++;while(index<length){character=value.charAt(index);if(!whitespace(character)){break}subvalue+=character;index++}character=value.charAt(index);markers=commonmark?COMMONMARK_LINK_MARKERS:LINK_MARKERS;queue="";beforeURL=subvalue;if(character===C_LT){index++;beforeURL+=C_LT;while(index<length){character=value.charAt(index);if(character===C_GT){break}if(commonmark&&character==="\n"){return}queue+=character;index++}if(value.charAt(index)!==C_GT){return}subvalue+=C_LT+queue+C_GT;url=queue;index++}else{character=null;subqueue="";while(index<length){character=value.charAt(index);if(subqueue&&own.call(markers,character)){break}if(whitespace(character)){if(!pedantic){break}subqueue+=character}else{if(character===C_PAREN_OPEN){depth++}else if(character===C_PAREN_CLOSE){if(depth===0){break}depth--}queue+=subqueue;subqueue="";if(character===C_BACKSLASH){queue+=C_BACKSLASH;character=value.charAt(++index)}queue+=character}index++}subvalue+=queue;url=queue;index=subvalue.length}queue="";while(index<length){character=value.charAt(index);if(!whitespace(character)){break}queue+=character;index++}character=value.charAt(index);subvalue+=queue;if(queue&&own.call(markers,character)){index++;subvalue+=character;queue="";marker=markers[character];beforeTitle=subvalue;if(commonmark){while(index<length){character=value.charAt(index);if(character===marker){break}if(character===C_BACKSLASH){queue+=C_BACKSLASH;character=value.charAt(++index)}index++;queue+=character}character=value.charAt(index);if(character!==marker){return}title=queue;subvalue+=queue+character;index++;while(index<length){character=value.charAt(index);if(!whitespace(character)){break}subvalue+=character;index++}}else{subqueue="";while(index<length){character=value.charAt(index);if(character===marker){if(hasMarker){queue+=marker+subqueue;subqueue=""}hasMarker=true}else if(!hasMarker){queue+=character}else if(character===C_PAREN_CLOSE){subvalue+=queue+marker+subqueue;title=queue;break}else if(whitespace(character)){subqueue+=character}else{queue+=marker+subqueue+character;subqueue="";hasMarker=false}index++}}}if(value.charAt(index)!==C_PAREN_CLOSE){return}if(silent){return true}subvalue+=C_PAREN_CLOSE;url=self.decode.raw(self.unescape(url),eat(beforeURL).test().end,{nonTerminated:false});if(title){beforeTitle=eat(beforeTitle).test().end;title=self.decode.raw(self.unescape(title),beforeTitle)}node={type:isImage?"image":"link",title:title||null,url:url};if(isImage){node.alt=self.decode.raw(self.unescape(content),now)||null}else{exit=self.enterLink();node.children=self.tokenizeInline(content,now);exit()}return eat(subvalue)(node)}},1142:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(171);var locate=__webpack_require__(739);var normalize=__webpack_require__(501);module.exports=reference;reference.locator=locate;var T_LINK="link";var T_IMAGE="image";var T_FOOTNOTE="footnote";var REFERENCE_TYPE_SHORTCUT="shortcut";var REFERENCE_TYPE_COLLAPSED="collapsed";var REFERENCE_TYPE_FULL="full";var C_CARET="^";var C_BACKSLASH="\\";var C_BRACKET_OPEN="[";var C_BRACKET_CLOSE="]";function reference(eat,value,silent){var self=this;var character=value.charAt(0);var index=0;var length=value.length;var subvalue="";var intro="";var type=T_LINK;var referenceType=REFERENCE_TYPE_SHORTCUT;var content;var identifier;var now;var node;var exit;var queue;var bracketed;var depth;if(character==="!"){type=T_IMAGE;intro=character;character=value.charAt(++index)}if(character!==C_BRACKET_OPEN){return}index++;intro+=character;queue="";if(self.options.footnotes&&value.charAt(index)===C_CARET){if(type===T_IMAGE){return}intro+=C_CARET;index++;type=T_FOOTNOTE}depth=0;while(index<length){character=value.charAt(index);if(character===C_BRACKET_OPEN){bracketed=true;depth++}else if(character===C_BRACKET_CLOSE){if(!depth){break}depth--}if(character===C_BACKSLASH){queue+=C_BACKSLASH;character=value.charAt(++index)}queue+=character;index++}subvalue=queue;content=queue;character=value.charAt(index);if(character!==C_BRACKET_CLOSE){return}index++;subvalue+=character;queue="";while(index<length){character=value.charAt(index);if(!whitespace(character)){break}queue+=character;index++}character=value.charAt(index);if(type!==T_FOOTNOTE&&character===C_BRACKET_OPEN){identifier="";queue+=character;index++;while(index<length){character=value.charAt(index);if(character===C_BRACKET_OPEN||character===C_BRACKET_CLOSE){break}if(character===C_BACKSLASH){identifier+=C_BACKSLASH;character=value.charAt(++index)}identifier+=character;index++}character=value.charAt(index);if(character===C_BRACKET_CLOSE){referenceType=identifier?REFERENCE_TYPE_FULL:REFERENCE_TYPE_COLLAPSED;queue+=identifier+character;index++}else{identifier=""}subvalue+=queue;queue=""}else{if(!content){return}identifier=content}if(referenceType!==REFERENCE_TYPE_FULL&&bracketed){return}subvalue=intro+subvalue;if(type===T_LINK&&self.inLink){return null}if(silent){return true}if(type===T_FOOTNOTE&&content.indexOf(" ")!==-1){return eat(subvalue)({type:"footnote",children:this.tokenizeInline(content,eat.now())})}now=eat.now();now.column+=intro.length;now.offset+=intro.length;identifier=referenceType===REFERENCE_TYPE_FULL?identifier:content;node={type:type+"Reference",identifier:normalize(identifier)};if(type===T_LINK||type===T_IMAGE){node.referenceType=referenceType}if(type===T_LINK){exit=self.enterLink();node.children=self.tokenizeInline(content,now);exit()}else if(type===T_IMAGE){node.alt=self.decode.raw(self.unescape(content),now)||null}return eat(subvalue)(node)}},1143:function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(279);var whitespace=__webpack_require__(171);var locate=__webpack_require__(1144);module.exports=strong;strong.locator=locate;var C_ASTERISK="*";var C_UNDERSCORE="_";function strong(eat,value,silent){var self=this;var index=0;var character=value.charAt(index);var now;var pedantic;var marker;var queue;var subvalue;var length;var prev;if(character!==C_ASTERISK&&character!==C_UNDERSCORE||value.charAt(++index)!==character){return}pedantic=self.options.pedantic;marker=character;subvalue=marker+marker;length=value.length;index++;queue="";character="";if(pedantic&&whitespace(value.charAt(index))){return}while(index<length){prev=character;character=value.charAt(index);if(character===marker&&value.charAt(index+1)===marker&&(!pedantic||!whitespace(prev))){character=value.charAt(index+2);if(character!==marker){if(!trim(queue)){return}if(silent){return true}now=eat.now();now.column+=2;now.offset+=2;return eat(subvalue+queue+subvalue)({type:"strong",children:self.tokenizeInline(queue,now)})}}if(!pedantic&&character==="\\"){queue+=character;character=value.charAt(++index)}queue+=character;index++}}},1144:function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){var asterisk=value.indexOf("**",fromIndex);var underscore=value.indexOf("__",fromIndex);if(underscore===-1){return asterisk}if(asterisk===-1){return underscore}return underscore<asterisk?underscore:asterisk}},1145:function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(279);var word=__webpack_require__(1146);var whitespace=__webpack_require__(171);var locate=__webpack_require__(1147);module.exports=emphasis;emphasis.locator=locate;var C_ASTERISK="*";var C_UNDERSCORE="_";function emphasis(eat,value,silent){var self=this;var index=0;var character=value.charAt(index);var now;var pedantic;var marker;var queue;var subvalue;var length;var prev;if(character!==C_ASTERISK&&character!==C_UNDERSCORE){return}pedantic=self.options.pedantic;subvalue=character;marker=character;length=value.length;index++;queue="";character="";if(pedantic&&whitespace(value.charAt(index))){return}while(index<length){prev=character;character=value.charAt(index);if(character===marker&&(!pedantic||!whitespace(prev))){character=value.charAt(++index);if(character!==marker){if(!trim(queue)||prev===marker){return}if(!pedantic&&marker===C_UNDERSCORE&&word(character)){queue+=marker;continue}if(silent){return true}now=eat.now();now.column++;now.offset++;return eat(subvalue+queue+marker)({type:"emphasis",children:self.tokenizeInline(queue,now)})}queue+=marker}if(!pedantic&&character==="\\"){queue+=character;character=value.charAt(++index)}queue+=character;index++}}},1146:function(module,exports,__webpack_require__){"use strict";module.exports=wordCharacter;var fromCode=String.fromCharCode;var re=/\w/;function wordCharacter(character){return re.test(typeof character==="number"?fromCode(character):character.charAt(0))}},1147:function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){var asterisk=value.indexOf("*",fromIndex);var underscore=value.indexOf("_",fromIndex);if(underscore===-1){return asterisk}if(asterisk===-1){return underscore}return underscore<asterisk?underscore:asterisk}},1148:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(171);var locate=__webpack_require__(1149);module.exports=strikethrough;strikethrough.locator=locate;var C_TILDE="~";var DOUBLE="~~";function strikethrough(eat,value,silent){var self=this;var character="";var previous="";var preceding="";var subvalue="";var index;var length;var now;if(!self.options.gfm||value.charAt(0)!==C_TILDE||value.charAt(1)!==C_TILDE||whitespace(value.charAt(2))){return}index=1;length=value.length;now=eat.now();now.column+=2;now.offset+=2;while(++index<length){character=value.charAt(index);if(character===C_TILDE&&previous===C_TILDE&&(!preceding||!whitespace(preceding))){if(silent){return true}return eat(DOUBLE+subvalue+DOUBLE)({type:"delete",children:self.tokenizeInline(subvalue,now)})}subvalue+=previous;preceding=previous;previous=character}}},1149:function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){return value.indexOf("~~",fromIndex)}},1150:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(171);var locate=__webpack_require__(1151);module.exports=inlineCode;inlineCode.locator=locate;var C_TICK="`";function inlineCode(eat,value,silent){var length=value.length;var index=0;var queue="";var tickQueue="";var contentQueue;var subqueue;var count;var openingCount;var subvalue;var character;var found;var next;while(index<length){if(value.charAt(index)!==C_TICK){break}queue+=C_TICK;index++}if(!queue){return}subvalue=queue;openingCount=index;queue="";next=value.charAt(index);count=0;while(index<length){character=next;next=value.charAt(index+1);if(character===C_TICK){count++;tickQueue+=character}else{count=0;queue+=character}if(count&&next!==C_TICK){if(count===openingCount){subvalue+=queue+tickQueue;found=true;break}queue+=tickQueue;tickQueue=""}index++}if(!found){if(openingCount%2!==0){return}queue=""}if(silent){return true}contentQueue="";subqueue="";length=queue.length;index=-1;while(++index<length){character=queue.charAt(index);if(whitespace(character)){subqueue+=character;continue}if(subqueue){if(contentQueue){contentQueue+=subqueue}subqueue=""}contentQueue+=character}return eat(subvalue)({type:"inlineCode",value:contentQueue})}},1151:function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){return value.indexOf("`",fromIndex)}},1152:function(module,exports,__webpack_require__){"use strict";var locate=__webpack_require__(1153);module.exports=hardBreak;hardBreak.locator=locate;var MIN_BREAK_LENGTH=2;function hardBreak(eat,value,silent){var length=value.length;var index=-1;var queue="";var character;while(++index<length){character=value.charAt(index);if(character==="\n"){if(index<MIN_BREAK_LENGTH){return}if(silent){return true}queue+=character;return eat(queue)({type:"break"})}if(character!==" "){return}queue+=character}}},1153:function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){var index=value.indexOf("\n",fromIndex);while(index>fromIndex){if(value.charAt(index-1)!==" "){break}index--}return index}},1154:function(module,exports,__webpack_require__){"use strict";module.exports=text;function text(eat,value,silent){var self=this;var methods;var tokenizers;var index;var length;var subvalue;var position;var tokenizer;var name;var min;var now;if(silent){return true}methods=self.inlineMethods;length=methods.length;tokenizers=self.inlineTokenizers;index=-1;min=value.length;while(++index<length){name=methods[index];if(name==="text"||!tokenizers[name]){continue}tokenizer=tokenizers[name].locator;if(!tokenizer){eat.file.fail("Missing locator: `"+name+"`")}position=tokenizer.call(self,value,1);if(position!==-1&&position<min){min=position}}subvalue=value.slice(0,min);now=eat.now();self.decode(subvalue,now,(function(content,position,source){eat(source||content)({type:"text",value:content})}))}},1155:function(module,exports,__webpack_require__){var visitWithParents=__webpack_require__(1156);function addListMetadata(){return function(ast){visitWithParents(ast,"list",(function(listNode,parents){var depth=0,i,n;for(i=0,n=parents.length;i<n;i++){if(parents[i].type==="list")depth+=1}for(i=0,n=listNode.children.length;i<n;i++){var child=listNode.children[i];child.index=i;child.ordered=listNode.ordered}listNode.depth=depth}));return ast}}module.exports=addListMetadata},1156:function(module,exports,__webpack_require__){"use strict";module.exports=visitParents;function visitParents(tree,type,visitor){var stack=[];if(typeof type==="function"){visitor=type;type=null}one(tree);function one(node){var result;if(!type||node.type===type){result=visitor(node,stack.concat())}if(node.children&&result!==false){return all(node.children,node)}return result}function all(children,parent){var length=children.length;var index=-1;var child;stack.push(parent);while(++index<length){child=children[index];if(child&&one(child)===false){return false}}stack.pop();return true}}},1157:function(module,exports,__webpack_require__){"use strict";var visit=__webpack_require__(397);var type="virtualHtml";var selfClosingRe=/^<(area|base|br|col|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)\s*\/?>$/i;var simpleTagRe=/^<(\/?)([a-z]+)\s*>$/;module.exports=function(tree){var open;var currentParent;visit(tree,"html",(function(node,index,parent){if(currentParent!==parent){open=[];currentParent=parent}var selfClosing=getSelfClosing(node);if(selfClosing){parent.children.splice(index,1,{type:type,tag:selfClosing,position:node.position});return true}var current=getSimpleTag(node,parent);if(!current){return true}var matching=findAndPull(open,current.tag);if(matching){parent.children.splice(index,0,virtual(current,matching,parent))}else if(!current.opening){open.push(current)}return true}),true);return tree};function findAndPull(open,matchingTag){var i=open.length;while(i--){if(open[i].tag===matchingTag){return open.splice(i,1)[0]}}return false}function getSimpleTag(node,parent){var match=node.value.match(simpleTagRe);return match?{tag:match[2],opening:!match[1],node:node}:false}function getSelfClosing(node){var match=node.value.match(selfClosingRe);return match?match[1]:false}function virtual(fromNode,toNode,parent){var fromIndex=parent.children.indexOf(fromNode.node);var toIndex=parent.children.indexOf(toNode.node);var extracted=parent.children.splice(fromIndex,toIndex-fromIndex+1);var children=extracted.slice(1,-1);return{type:type,children:children,tag:fromNode.tag,position:{start:fromNode.node.position.start,end:toNode.node.position.end,indent:[]}}}},1158:function(module,exports,__webpack_require__){"use strict";var visit=__webpack_require__(397);exports.ofType=function(types,mode){return function(node){types.forEach((function(type){return visit(node,type,disallow,true)}));return node};function disallow(node,index,parent){if(parent){untangle(node,index,parent,mode)}}};exports.ifNotMatch=function(allowNode,mode){return function(node){visit(node,disallow,true);return node};function disallow(node,index,parent){if(parent&&!allowNode(node,index,parent)){untangle(node,index,parent,mode)}}};function untangle(node,index,parent,mode){if(mode==="remove"){parent.children.splice(index,1)}else if(mode==="unwrap"){var args=[index,1];if(node.children){args=args.concat(node.children)}Array.prototype.splice.apply(parent.children,args)}}},1159:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(6);var xtend=__webpack_require__(216);var ReactIs=__webpack_require__(414);var defaultNodePosition={start:{line:1,column:1,offset:0},end:{line:1,column:1,offset:0}};function astToReact(node,options){var parent=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var index=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var renderer=options.renderers[node.type];if(node.position===undefined){node.position=parent.node&&parent.node.position||defaultNodePosition}var pos=node.position.start;var key=[node.type,pos.line,pos.column,index].join("-");if(!ReactIs.isValidElementType(renderer)){throw new Error("Renderer for type `".concat(node.type,"` not defined or is not renderable"))}var nodeProps=getNodeProps(node,key,options,renderer,parent,index);return React.createElement(renderer,nodeProps,nodeProps.children||resolveChildren()||undefined);function resolveChildren(){return node.children&&node.children.map((function(childNode,i){return astToReact(childNode,options,{node:node,props:nodeProps},i)}))}}function getNodeProps(node,key,opts,renderer,parent,index){var props={key:key};var isTagRenderer=typeof renderer==="string";if(opts.sourcePos&&node.position){props["data-sourcepos"]=flattenPosition(node.position)}if(opts.rawSourcePos&&!isTagRenderer){props.sourcePosition=node.position}if(opts.includeNodeIndex&&parent.node&&parent.node.children&&!isTagRenderer){props.index=parent.node.children.indexOf(node);props.parentChildCount=parent.node.children.length}var ref=node.identifier!==null&&node.identifier!==undefined?opts.definitions[node.identifier]||{}:null;switch(node.type){case"root":assignDefined(props,{className:opts.className});break;case"text":props.nodeKey=key;props.children=node.value;break;case"heading":props.level=node.depth;break;case"list":props.start=node.start;props.ordered=node.ordered;props.tight=!node.loose;props.depth=node.depth;break;case"listItem":props.checked=node.checked;props.tight=!node.loose;props.ordered=node.ordered;props.index=node.index;props.children=getListItemChildren(node,parent).map((function(childNode,i){return astToReact(childNode,opts,{node:node,props:props},i)}));break;case"definition":assignDefined(props,{identifier:node.identifier,title:node.title,url:node.url});break;case"code":assignDefined(props,{language:node.lang&&node.lang.split(/\s/,1)[0]});break;case"inlineCode":props.children=node.value;props.inline=true;break;case"link":assignDefined(props,{title:node.title||undefined,target:typeof opts.linkTarget==="function"?opts.linkTarget(node.url,node.children,node.title):opts.linkTarget,href:opts.transformLinkUri?opts.transformLinkUri(node.url,node.children,node.title):node.url});break;case"image":assignDefined(props,{alt:node.alt||undefined,title:node.title||undefined,src:opts.transformImageUri?opts.transformImageUri(node.url,node.children,node.title,node.alt):node.url});break;case"linkReference":assignDefined(props,xtend(ref,{href:opts.transformLinkUri?opts.transformLinkUri(ref.href):ref.href}));break;case"imageReference":assignDefined(props,{src:opts.transformImageUri&&ref.href?opts.transformImageUri(ref.href,node.children,ref.title,node.alt):ref.href,title:ref.title||undefined,alt:node.alt||undefined});break;case"table":case"tableHead":case"tableBody":props.columnAlignment=node.align;break;case"tableRow":props.isHeader=parent.node.type==="tableHead";props.columnAlignment=parent.props.columnAlignment;break;case"tableCell":assignDefined(props,{isHeader:parent.props.isHeader,align:parent.props.columnAlignment[index]});break;case"virtualHtml":props.tag=node.tag;break;case"html":props.isBlock=node.position.start.line!==node.position.end.line;props.escapeHtml=opts.escapeHtml;props.skipHtml=opts.skipHtml;break;case"parsedHtml":{var parsedChildren;if(node.children){parsedChildren=node.children.map((function(child,i){return astToReact(child,opts,{node:node,props:props},i)}))}props.escapeHtml=opts.escapeHtml;props.skipHtml=opts.skipHtml;props.element=mergeNodeChildren(node,parsedChildren);break}default:assignDefined(props,xtend(node,{type:undefined,position:undefined,children:undefined}))}if(!isTagRenderer&&node.value){props.value=node.value}return props}function assignDefined(target,attrs){for(var key in attrs){if(typeof attrs[key]!=="undefined"){target[key]=attrs[key]}}}function mergeNodeChildren(node,parsedChildren){var el=node.element;if(Array.isArray(el)){var Fragment=React.Fragment||"div";return React.createElement(Fragment,null,el)}if(el.props.children||parsedChildren){var children=React.Children.toArray(el.props.children).concat(parsedChildren);return React.cloneElement(el,null,children)}return React.cloneElement(el,null)}function flattenPosition(pos){return[pos.start.line,":",pos.start.column,"-",pos.end.line,":",pos.end.column].map(String).join("")}function getListItemChildren(node,parent){if(node.loose){return node.children}if(parent.node&&node.index>0&&parent.node.children[node.index-1].loose){return node.children}return unwrapParagraphs(node)}function unwrapParagraphs(node){return node.children.reduce((function(array,child){return array.concat(child.type==="paragraph"?child.children||[]:[child])}),[])}module.exports=astToReact},1160:function(module,exports,__webpack_require__){"use strict";var visit=__webpack_require__(397);module.exports=function(node){visit(node,"table",wrap);return node};function wrap(table){var children=table.children;table.children=[{type:"tableHead",align:table.align,children:[children[0]],position:children[0].position}];if(children.length>1){table.children.push({type:"tableBody",align:table.align,children:children.slice(1),position:{start:children[1].position.start,end:children[children.length-1].position.end}})}}},1161:function(module,exports,__webpack_require__){"use strict";module.exports=function getDefinitions(node){var defs=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return(node.children||[]).reduce((function(definitions,child){if(child.type==="definition"){definitions[child.identifier]={href:child.url,title:child.title}}return getDefinitions(child,definitions)}),defs)}},1162:function(module,exports,__webpack_require__){"use strict";var protocols=["http","https","mailto","tel"];module.exports=function uriTransformer(uri){var url=(uri||"").trim();var first=url.charAt(0);if(first==="#"||first==="/"){return url}var colon=url.indexOf(":");if(colon===-1){return url}var length=protocols.length;var index=-1;while(++index<length){var protocol=protocols[index];if(colon===protocol.length&&url.slice(0,protocol.length).toLowerCase()===protocol){return url}}index=url.indexOf("?");if(index!==-1&&colon>index){return url}index=url.indexOf("#");if(index!==-1&&colon>index){return url}return"javascript:void(0)"}},1163:function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(216);var React=__webpack_require__(6);var supportsStringRender=parseInt((React.version||"16").slice(0,2),10)>=16;var createElement=React.createElement;module.exports={break:"br",paragraph:"p",emphasis:"em",strong:"strong",thematicBreak:"hr",blockquote:"blockquote",delete:"del",link:"a",image:"img",linkReference:"a",imageReference:"img",table:SimpleRenderer.bind(null,"table"),tableHead:SimpleRenderer.bind(null,"thead"),tableBody:SimpleRenderer.bind(null,"tbody"),tableRow:SimpleRenderer.bind(null,"tr"),tableCell:TableCell,root:Root,text:TextRenderer,list:List,listItem:ListItem,definition:NullRenderer,heading:Heading,inlineCode:InlineCode,code:CodeBlock,html:Html,virtualHtml:VirtualHtml,parsedHtml:ParsedHtml};function TextRenderer(props){return supportsStringRender?props.children:createElement("span",null,props.children)}function Root(props){var useFragment=!props.className;var root=useFragment?React.Fragment||"div":"div";return createElement(root,useFragment?null:props,props.children)}function SimpleRenderer(tag,props){return createElement(tag,getCoreProps(props),props.children)}function TableCell(props){var style=props.align?{textAlign:props.align}:undefined;var coreProps=getCoreProps(props);return createElement(props.isHeader?"th":"td",style?xtend({style:style},coreProps):coreProps,props.children)}function Heading(props){return createElement("h".concat(props.level),getCoreProps(props),props.children)}function List(props){var attrs=getCoreProps(props);if(props.start!==null&&props.start!==1&&props.start!==undefined){attrs.start=props.start.toString()}return createElement(props.ordered?"ol":"ul",attrs,props.children)}function ListItem(props){var checkbox=null;if(props.checked!==null&&props.checked!==undefined){var checked=props.checked;checkbox=createElement("input",{type:"checkbox",checked:checked,readOnly:true})}return createElement("li",getCoreProps(props),checkbox,props.children)}function CodeBlock(props){var className=props.language&&"language-".concat(props.language);var code=createElement("code",className?{className:className}:null,props.value);return createElement("pre",getCoreProps(props),code)}function InlineCode(props){return createElement("code",getCoreProps(props),props.children)}function Html(props){if(props.skipHtml){return null}var tag=props.isBlock?"div":"span";if(props.escapeHtml){var comp=React.Fragment||tag;return createElement(comp,null,props.value)}var nodeProps={dangerouslySetInnerHTML:{__html:props.value}};return createElement(tag,nodeProps)}function ParsedHtml(props){return props["data-sourcepos"]?React.cloneElement(props.element,{"data-sourcepos":props["data-sourcepos"]}):props.element}function VirtualHtml(props){return createElement(props.tag,getCoreProps(props),props.children)}function NullRenderer(){return null}function getCoreProps(props){return props["data-sourcepos"]?{"data-sourcepos":props["data-sourcepos"]}:{}}},1164:function(module,exports,__webpack_require__){"use strict";var HtmlParser="__RMD_HTML_PARSER__";exports.HtmlParser=typeof Symbol==="undefined"?HtmlParser:Symbol(HtmlParser)},1165:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */(function defineMustache(global,factory){if(true&&exports&&typeof exports.nodeName!=="string"){factory(exports)}else if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__=[exports],__WEBPACK_AMD_DEFINE_FACTORY__=factory,__WEBPACK_AMD_DEFINE_RESULT__=typeof __WEBPACK_AMD_DEFINE_FACTORY__==="function"?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}else{}})(this,(function mustacheFactory(mustache){var objectToString=Object.prototype.toString;var isArray=Array.isArray||function isArrayPolyfill(object){return objectToString.call(object)==="[object Array]"};function isFunction(object){return typeof object==="function"}function typeStr(obj){return isArray(obj)?"array":typeof obj}function escapeRegExp(string){return string.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function hasProperty(obj,propName){return obj!=null&&typeof obj==="object"&&propName in obj}var regExpTest=RegExp.prototype.test;function testRegExp(re,string){return regExpTest.call(re,string)}var nonSpaceRe=/\S/;function isWhitespace(string){return!testRegExp(nonSpaceRe,string)}var entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function escapeHtml(string){return String(string).replace(/[&<>"'`=\/]/g,(function fromEntityMap(s){return entityMap[s]}))}var whiteRe=/\s*/;var spaceRe=/\s+/;var equalsRe=/\s*=/;var curlyRe=/\s*\}/;var tagRe=/#|\^|\/|>|\{|&|=|!/;function parseTemplate(template,tags){if(!template)return[];var sections=[];var tokens=[];var spaces=[];var hasTag=false;var nonSpace=false;function stripSpace(){if(hasTag&&!nonSpace){while(spaces.length)delete tokens[spaces.pop()]}else{spaces=[]}hasTag=false;nonSpace=false}var openingTagRe,closingTagRe,closingCurlyRe;function compileTags(tagsToCompile){if(typeof tagsToCompile==="string")tagsToCompile=tagsToCompile.split(spaceRe,2);if(!isArray(tagsToCompile)||tagsToCompile.length!==2)throw new Error("Invalid tags: "+tagsToCompile);openingTagRe=new RegExp(escapeRegExp(tagsToCompile[0])+"\\s*");closingTagRe=new RegExp("\\s*"+escapeRegExp(tagsToCompile[1]));closingCurlyRe=new RegExp("\\s*"+escapeRegExp("}"+tagsToCompile[1]))}compileTags(tags||mustache.tags);var scanner=new Scanner(template);var start,type,value,chr,token,openSection;while(!scanner.eos()){start=scanner.pos;value=scanner.scanUntil(openingTagRe);if(value){for(var i=0,valueLength=value.length;i<valueLength;++i){chr=value.charAt(i);if(isWhitespace(chr)){spaces.push(tokens.length)}else{nonSpace=true}tokens.push(["text",chr,start,start+1]);start+=1;if(chr==="\n")stripSpace()}}if(!scanner.scan(openingTagRe))break;hasTag=true;type=scanner.scan(tagRe)||"name";scanner.scan(whiteRe);if(type==="="){value=scanner.scanUntil(equalsRe);scanner.scan(equalsRe);scanner.scanUntil(closingTagRe)}else if(type==="{"){value=scanner.scanUntil(closingCurlyRe);scanner.scan(curlyRe);scanner.scanUntil(closingTagRe);type="&"}else{value=scanner.scanUntil(closingTagRe)}if(!scanner.scan(closingTagRe))throw new Error("Unclosed tag at "+scanner.pos);token=[type,value,start,scanner.pos];tokens.push(token);if(type==="#"||type==="^"){sections.push(token)}else if(type==="/"){openSection=sections.pop();if(!openSection)throw new Error('Unopened section "'+value+'" at '+start);if(openSection[1]!==value)throw new Error('Unclosed section "'+openSection[1]+'" at '+start)}else if(type==="name"||type==="{"||type==="&"){nonSpace=true}else if(type==="="){compileTags(value)}}openSection=sections.pop();if(openSection)throw new Error('Unclosed section "'+openSection[1]+'" at '+scanner.pos);return nestTokens(squashTokens(tokens))}function squashTokens(tokens){var squashedTokens=[];var token,lastToken;for(var i=0,numTokens=tokens.length;i<numTokens;++i){token=tokens[i];if(token){if(token[0]==="text"&&lastToken&&lastToken[0]==="text"){lastToken[1]+=token[1];lastToken[3]=token[3]}else{squashedTokens.push(token);lastToken=token}}}return squashedTokens}function nestTokens(tokens){var nestedTokens=[];var collector=nestedTokens;var sections=[];var token,section;for(var i=0,numTokens=tokens.length;i<numTokens;++i){token=tokens[i];switch(token[0]){case"#":case"^":collector.push(token);sections.push(token);collector=token[4]=[];break;case"/":section=sections.pop();section[5]=token[2];collector=sections.length>0?sections[sections.length-1][4]:nestedTokens;break;default:collector.push(token)}}return nestedTokens}function Scanner(string){this.string=string;this.tail=string;this.pos=0}Scanner.prototype.eos=function eos(){return this.tail===""};Scanner.prototype.scan=function scan(re){var match=this.tail.match(re);if(!match||match.index!==0)return"";var string=match[0];this.tail=this.tail.substring(string.length);this.pos+=string.length;return string};Scanner.prototype.scanUntil=function scanUntil(re){var index=this.tail.search(re),match;switch(index){case-1:match=this.tail;this.tail="";break;case 0:match="";break;default:match=this.tail.substring(0,index);this.tail=this.tail.substring(index)}this.pos+=match.length;return match};function Context(view,parentContext){this.view=view;this.cache={".":this.view};this.parent=parentContext}Context.prototype.push=function push(view){return new Context(view,this)};Context.prototype.lookup=function lookup(name){var cache=this.cache;var value;if(cache.hasOwnProperty(name)){value=cache[name]}else{var context=this,names,index,lookupHit=false;while(context){if(name.indexOf(".")>0){value=context.view;names=name.split(".");index=0;while(value!=null&&index<names.length){if(index===names.length-1)lookupHit=hasProperty(value,names[index]);value=value[names[index++]]}}else{value=context.view[name];lookupHit=hasProperty(context.view,name)}if(lookupHit)break;context=context.parent}cache[name]=value}if(isFunction(value))value=value.call(this.view);return value};function Writer(){this.cache={}}Writer.prototype.clearCache=function clearCache(){this.cache={}};Writer.prototype.parse=function parse(template,tags){var cache=this.cache;var tokens=cache[template];if(tokens==null)tokens=cache[template]=parseTemplate(template,tags);return tokens};Writer.prototype.render=function render(template,view,partials){var tokens=this.parse(template);var context=view instanceof Context?view:new Context(view);return this.renderTokens(tokens,context,partials,template)};Writer.prototype.renderTokens=function renderTokens(tokens,context,partials,originalTemplate){var buffer="";var token,symbol,value;for(var i=0,numTokens=tokens.length;i<numTokens;++i){value=undefined;token=tokens[i];symbol=token[0];if(symbol==="#")value=this.renderSection(token,context,partials,originalTemplate);else if(symbol==="^")value=this.renderInverted(token,context,partials,originalTemplate);else if(symbol===">")value=this.renderPartial(token,context,partials,originalTemplate);else if(symbol==="&")value=this.unescapedValue(token,context);else if(symbol==="name")value=this.escapedValue(token,context);else if(symbol==="text")value=this.rawValue(token);if(value!==undefined)buffer+=value}return buffer};Writer.prototype.renderSection=function renderSection(token,context,partials,originalTemplate){var self=this;var buffer="";var value=context.lookup(token[1]);function subRender(template){return self.render(template,context,partials)}if(!value)return;if(isArray(value)){for(var j=0,valueLength=value.length;j<valueLength;++j){buffer+=this.renderTokens(token[4],context.push(value[j]),partials,originalTemplate)}}else if(typeof value==="object"||typeof value==="string"||typeof value==="number"){buffer+=this.renderTokens(token[4],context.push(value),partials,originalTemplate)}else if(isFunction(value)){if(typeof originalTemplate!=="string")throw new Error("Cannot use higher-order sections without the original template");value=value.call(context.view,originalTemplate.slice(token[3],token[5]),subRender);if(value!=null)buffer+=value}else{buffer+=this.renderTokens(token[4],context,partials,originalTemplate)}return buffer};Writer.prototype.renderInverted=function renderInverted(token,context,partials,originalTemplate){var value=context.lookup(token[1]);if(!value||isArray(value)&&value.length===0)return this.renderTokens(token[4],context,partials,originalTemplate)};Writer.prototype.renderPartial=function renderPartial(token,context,partials){if(!partials)return;var value=isFunction(partials)?partials(token[1]):partials[token[1]];if(value!=null)return this.renderTokens(this.parse(value),context,partials,value)};Writer.prototype.unescapedValue=function unescapedValue(token,context){var value=context.lookup(token[1]);if(value!=null)return value};Writer.prototype.escapedValue=function escapedValue(token,context){var value=context.lookup(token[1]);if(value!=null)return mustache.escape(value)};Writer.prototype.rawValue=function rawValue(token){return token[1]};mustache.name="mustache.js";mustache.version="2.3.2";mustache.tags=["{{","}}"];var defaultWriter=new Writer;mustache.clearCache=function clearCache(){return defaultWriter.clearCache()};mustache.parse=function parse(template,tags){return defaultWriter.parse(template,tags)};mustache.render=function render(template,view,partials){if(typeof template!=="string"){throw new TypeError('Invalid template! Template should be a "string" '+'but "'+typeStr(template)+'" was given as the first '+"argument for mustache#render(template, view, partials)")}return defaultWriter.render(template,view,partials)};mustache.to_html=function to_html(template,view,partials,send){var result=mustache.render(template,view,partials);if(isFunction(send)){send(result)}else{return result}};mustache.escape=escapeHtml;mustache.Scanner=Scanner;mustache.Context=Context;mustache.Writer=Writer;return mustache}))},1166:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(80);var react_1=__webpack_require__(6);var useMap=function(initialMap){if(initialMap===void 0){initialMap={}}var _a=react_1.useState(initialMap),map=_a[0],set=_a[1];var stableActions=react_1.useMemo((function(){return{set:function(key,entry){set((function(prevMap){var _a;return tslib_1.__assign(tslib_1.__assign({},prevMap),(_a={},_a[key]=entry,_a))}))},setAll:function(newMap){set(newMap)},remove:function(key){set((function(prevMap){var _a=prevMap,_b=key,omit=_a[_b],rest=tslib_1.__rest(_a,[typeof _b==="symbol"?_b:_b+""]);return rest}))},reset:function(){return set(initialMap)}}}),[set]);var utils=tslib_1.__assign({get:react_1.useCallback((function(key){return map[key]}),[map])},stableActions);return[map,utils]};exports.default=useMap},1167:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var react_1=__webpack_require__(6);var useEffectOnce=function(effect){react_1.useEffect(effect,[])};exports.default=useEffectOnce},1168:function(module,exports,__webpack_require__){module.exports=minimatch;minimatch.Minimatch=Minimatch;var path={sep:"/"};try{path=__webpack_require__(496)}catch(er){}var GLOBSTAR=minimatch.GLOBSTAR=Minimatch.GLOBSTAR={};var expand=__webpack_require__(1169);var plTypes={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}};var qmark="[^/]";var star=qmark+"*?";var twoStarDot="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?";var twoStarNoDot="(?:(?!(?:\\/|^)\\.).)*?";var reSpecials=charSet("().*{}+?[]^$\\!");function charSet(s){return s.split("").reduce((function(set,c){set[c]=true;return set}),{})}var slashSplit=/\/+/;minimatch.filter=filter;function filter(pattern,options){options=options||{};return function(p,i,list){return minimatch(p,pattern,options)}}function ext(a,b){a=a||{};b=b||{};var t={};Object.keys(b).forEach((function(k){t[k]=b[k]}));Object.keys(a).forEach((function(k){t[k]=a[k]}));return t}minimatch.defaults=function(def){if(!def||!Object.keys(def).length)return minimatch;var orig=minimatch;var m=function minimatch(p,pattern,options){return orig.minimatch(p,pattern,ext(def,options))};m.Minimatch=function Minimatch(pattern,options){return new orig.Minimatch(pattern,ext(def,options))};return m};Minimatch.defaults=function(def){if(!def||!Object.keys(def).length)return Minimatch;return minimatch.defaults(def).Minimatch};function minimatch(p,pattern,options){if(typeof pattern!=="string"){throw new TypeError("glob pattern string required")}if(!options)options={};if(!options.nocomment&&pattern.charAt(0)==="#"){return false}if(pattern.trim()==="")return p==="";return new Minimatch(pattern,options).match(p)}function Minimatch(pattern,options){if(!(this instanceof Minimatch)){return new Minimatch(pattern,options)}if(typeof pattern!=="string"){throw new TypeError("glob pattern string required")}if(!options)options={};pattern=pattern.trim();if(path.sep!=="/"){pattern=pattern.split(path.sep).join("/")}this.options=options;this.set=[];this.pattern=pattern;this.regexp=null;this.negate=false;this.comment=false;this.empty=false;this.make()}Minimatch.prototype.debug=function(){};Minimatch.prototype.make=make;function make(){if(this._made)return;var pattern=this.pattern;var options=this.options;if(!options.nocomment&&pattern.charAt(0)==="#"){this.comment=true;return}if(!pattern){this.empty=true;return}this.parseNegate();var set=this.globSet=this.braceExpand();if(options.debug)this.debug=console.error;this.debug(this.pattern,set);set=this.globParts=set.map((function(s){return s.split(slashSplit)}));this.debug(this.pattern,set);set=set.map((function(s,si,set){return s.map(this.parse,this)}),this);this.debug(this.pattern,set);set=set.filter((function(s){return s.indexOf(false)===-1}));this.debug(this.pattern,set);this.set=set}Minimatch.prototype.parseNegate=parseNegate;function parseNegate(){var pattern=this.pattern;var negate=false;var options=this.options;var negateOffset=0;if(options.nonegate)return;for(var i=0,l=pattern.length;i<l&&pattern.charAt(i)==="!";i++){negate=!negate;negateOffset++}if(negateOffset)this.pattern=pattern.substr(negateOffset);this.negate=negate}minimatch.braceExpand=function(pattern,options){return braceExpand(pattern,options)};Minimatch.prototype.braceExpand=braceExpand;function braceExpand(pattern,options){if(!options){if(this instanceof Minimatch){options=this.options}else{options={}}}pattern=typeof pattern==="undefined"?this.pattern:pattern;if(typeof pattern==="undefined"){throw new TypeError("undefined pattern")}if(options.nobrace||!pattern.match(/\{.*\}/)){return[pattern]}return expand(pattern)}Minimatch.prototype.parse=parse;var SUBPARSE={};function parse(pattern,isSub){if(pattern.length>1024*64){throw new TypeError("pattern is too long")}var options=this.options;if(!options.noglobstar&&pattern==="**")return GLOBSTAR;if(pattern==="")return"";var re="";var hasMagic=!!options.nocase;var escaping=false;var patternListStack=[];var negativeLists=[];var stateChar;var inClass=false;var reClassStart=-1;var classStart=-1;var patternStart=pattern.charAt(0)==="."?"":options.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)";var self=this;function clearStateChar(){if(stateChar){switch(stateChar){case"*":re+=star;hasMagic=true;break;case"?":re+=qmark;hasMagic=true;break;default:re+="\\"+stateChar;break}self.debug("clearStateChar %j %j",stateChar,re);stateChar=false}}for(var i=0,len=pattern.length,c;i<len&&(c=pattern.charAt(i));i++){this.debug("%s\t%s %s %j",pattern,i,re,c);if(escaping&&reSpecials[c]){re+="\\"+c;escaping=false;continue}switch(c){case"/":return false;case"\\":clearStateChar();escaping=true;continue;case"?":case"*":case"+":case"@":case"!":this.debug("%s\t%s %s %j <-- stateChar",pattern,i,re,c);if(inClass){this.debug("  in class");if(c==="!"&&i===classStart+1)c="^";re+=c;continue}self.debug("call clearStateChar %j",stateChar);clearStateChar();stateChar=c;if(options.noext)clearStateChar();continue;case"(":if(inClass){re+="(";continue}if(!stateChar){re+="\\(";continue}patternListStack.push({type:stateChar,start:i-1,reStart:re.length,open:plTypes[stateChar].open,close:plTypes[stateChar].close});re+=stateChar==="!"?"(?:(?!(?:":"(?:";this.debug("plType %j %j",stateChar,re);stateChar=false;continue;case")":if(inClass||!patternListStack.length){re+="\\)";continue}clearStateChar();hasMagic=true;var pl=patternListStack.pop();re+=pl.close;if(pl.type==="!"){negativeLists.push(pl)}pl.reEnd=re.length;continue;case"|":if(inClass||!patternListStack.length||escaping){re+="\\|";escaping=false;continue}clearStateChar();re+="|";continue;case"[":clearStateChar();if(inClass){re+="\\"+c;continue}inClass=true;classStart=i;reClassStart=re.length;re+=c;continue;case"]":if(i===classStart+1||!inClass){re+="\\"+c;escaping=false;continue}if(inClass){var cs=pattern.substring(classStart+1,i);try{RegExp("["+cs+"]")}catch(er){var sp=this.parse(cs,SUBPARSE);re=re.substr(0,reClassStart)+"\\["+sp[0]+"\\]";hasMagic=hasMagic||sp[1];inClass=false;continue}}hasMagic=true;inClass=false;re+=c;continue;default:clearStateChar();if(escaping){escaping=false}else if(reSpecials[c]&&!(c==="^"&&inClass)){re+="\\"}re+=c}}if(inClass){cs=pattern.substr(classStart+1);sp=this.parse(cs,SUBPARSE);re=re.substr(0,reClassStart)+"\\["+sp[0];hasMagic=hasMagic||sp[1]}for(pl=patternListStack.pop();pl;pl=patternListStack.pop()){var tail=re.slice(pl.reStart+pl.open.length);this.debug("setting tail",re,pl);tail=tail.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(_,$1,$2){if(!$2){$2="\\"}return $1+$1+$2+"|"}));this.debug("tail=%j\n   %s",tail,tail,pl,re);var t=pl.type==="*"?star:pl.type==="?"?qmark:"\\"+pl.type;hasMagic=true;re=re.slice(0,pl.reStart)+t+"\\("+tail}clearStateChar();if(escaping){re+="\\\\"}var addPatternStart=false;switch(re.charAt(0)){case".":case"[":case"(":addPatternStart=true}for(var n=negativeLists.length-1;n>-1;n--){var nl=negativeLists[n];var nlBefore=re.slice(0,nl.reStart);var nlFirst=re.slice(nl.reStart,nl.reEnd-8);var nlLast=re.slice(nl.reEnd-8,nl.reEnd);var nlAfter=re.slice(nl.reEnd);nlLast+=nlAfter;var openParensBefore=nlBefore.split("(").length-1;var cleanAfter=nlAfter;for(i=0;i<openParensBefore;i++){cleanAfter=cleanAfter.replace(/\)[+*?]?/,"")}nlAfter=cleanAfter;var dollar="";if(nlAfter===""&&isSub!==SUBPARSE){dollar="$"}var newRe=nlBefore+nlFirst+nlAfter+dollar+nlLast;re=newRe}if(re!==""&&hasMagic){re="(?=.)"+re}if(addPatternStart){re=patternStart+re}if(isSub===SUBPARSE){return[re,hasMagic]}if(!hasMagic){return globUnescape(pattern)}var flags=options.nocase?"i":"";try{var regExp=new RegExp("^"+re+"$",flags)}catch(er){return new RegExp("$.")}regExp._glob=pattern;regExp._src=re;return regExp}minimatch.makeRe=function(pattern,options){return new Minimatch(pattern,options||{}).makeRe()};Minimatch.prototype.makeRe=makeRe;function makeRe(){if(this.regexp||this.regexp===false)return this.regexp;var set=this.set;if(!set.length){this.regexp=false;return this.regexp}var options=this.options;var twoStar=options.noglobstar?star:options.dot?twoStarDot:twoStarNoDot;var flags=options.nocase?"i":"";var re=set.map((function(pattern){return pattern.map((function(p){return p===GLOBSTAR?twoStar:typeof p==="string"?regExpEscape(p):p._src})).join("\\/")})).join("|");re="^(?:"+re+")$";if(this.negate)re="^(?!"+re+").*$";try{this.regexp=new RegExp(re,flags)}catch(ex){this.regexp=false}return this.regexp}minimatch.match=function(list,pattern,options){options=options||{};var mm=new Minimatch(pattern,options);list=list.filter((function(f){return mm.match(f)}));if(mm.options.nonull&&!list.length){list.push(pattern)}return list};Minimatch.prototype.match=match;function match(f,partial){this.debug("match",f,this.pattern);if(this.comment)return false;if(this.empty)return f==="";if(f==="/"&&partial)return true;var options=this.options;if(path.sep!=="/"){f=f.split(path.sep).join("/")}f=f.split(slashSplit);this.debug(this.pattern,"split",f);var set=this.set;this.debug(this.pattern,"set",set);var filename;var i;for(i=f.length-1;i>=0;i--){filename=f[i];if(filename)break}for(i=0;i<set.length;i++){var pattern=set[i];var file=f;if(options.matchBase&&pattern.length===1){file=[filename]}var hit=this.matchOne(file,pattern,partial);if(hit){if(options.flipNegate)return true;return!this.negate}}if(options.flipNegate)return false;return this.negate}Minimatch.prototype.matchOne=function(file,pattern,partial){var options=this.options;this.debug("matchOne",{this:this,file:file,pattern:pattern});this.debug("matchOne",file.length,pattern.length);for(var fi=0,pi=0,fl=file.length,pl=pattern.length;fi<fl&&pi<pl;fi++,pi++){this.debug("matchOne loop");var p=pattern[pi];var f=file[fi];this.debug(pattern,p,f);if(p===false)return false;if(p===GLOBSTAR){this.debug("GLOBSTAR",[pattern,p,f]);var fr=fi;var pr=pi+1;if(pr===pl){this.debug("** at the end");for(;fi<fl;fi++){if(file[fi]==="."||file[fi]===".."||!options.dot&&file[fi].charAt(0)===".")return false}return true}while(fr<fl){var swallowee=file[fr];this.debug("\nglobstar while",file,fr,pattern,pr,swallowee);if(this.matchOne(file.slice(fr),pattern.slice(pr),partial)){this.debug("globstar found match!",fr,fl,swallowee);return true}else{if(swallowee==="."||swallowee===".."||!options.dot&&swallowee.charAt(0)==="."){this.debug("dot detected!",file,fr,pattern,pr);break}this.debug("globstar swallow a segment, and continue");fr++}}if(partial){this.debug("\n>>> no match, partial?",file,fr,pattern,pr);if(fr===fl)return true}return false}var hit;if(typeof p==="string"){if(options.nocase){hit=f.toLowerCase()===p.toLowerCase()}else{hit=f===p}this.debug("string match",p,f,hit)}else{hit=f.match(p);this.debug("pattern match",p,f,hit)}if(!hit)return false}if(fi===fl&&pi===pl){return true}else if(fi===fl){return partial}else if(pi===pl){var emptyFileEnd=fi===fl-1&&file[fi]==="";return emptyFileEnd}throw new Error("wtf?")};function globUnescape(s){return s.replace(/\\(.)/g,"$1")}function regExpEscape(s){return s.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}},1169:function(module,exports,__webpack_require__){var concatMap=__webpack_require__(1170);var balanced=__webpack_require__(1171);module.exports=expandTop;var escSlash="\0SLASH"+Math.random()+"\0";var escOpen="\0OPEN"+Math.random()+"\0";var escClose="\0CLOSE"+Math.random()+"\0";var escComma="\0COMMA"+Math.random()+"\0";var escPeriod="\0PERIOD"+Math.random()+"\0";function numeric(str){return parseInt(str,10)==str?parseInt(str,10):str.charCodeAt(0)}function escapeBraces(str){return str.split("\\\\").join(escSlash).split("\\{").join(escOpen).split("\\}").join(escClose).split("\\,").join(escComma).split("\\.").join(escPeriod)}function unescapeBraces(str){return str.split(escSlash).join("\\").split(escOpen).join("{").split(escClose).join("}").split(escComma).join(",").split(escPeriod).join(".")}function parseCommaParts(str){if(!str)return[""];var parts=[];var m=balanced("{","}",str);if(!m)return str.split(",");var pre=m.pre;var body=m.body;var post=m.post;var p=pre.split(",");p[p.length-1]+="{"+body+"}";var postParts=parseCommaParts(post);if(post.length){p[p.length-1]+=postParts.shift();p.push.apply(p,postParts)}parts.push.apply(parts,p);return parts}function expandTop(str){if(!str)return[];if(str.substr(0,2)==="{}"){str="\\{\\}"+str.substr(2)}return expand(escapeBraces(str),true).map(unescapeBraces)}function identity(e){return e}function embrace(str){return"{"+str+"}"}function isPadded(el){return/^-?0\d/.test(el)}function lte(i,y){return i<=y}function gte(i,y){return i>=y}function expand(str,isTop){var expansions=[];var m=balanced("{","}",str);if(!m||/\$$/.test(m.pre))return[str];var isNumericSequence=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(m.body);var isAlphaSequence=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(m.body);var isSequence=isNumericSequence||isAlphaSequence;var isOptions=m.body.indexOf(",")>=0;if(!isSequence&&!isOptions){if(m.post.match(/,.*\}/)){str=m.pre+"{"+m.body+escClose+m.post;return expand(str)}return[str]}var n;if(isSequence){n=m.body.split(/\.\./)}else{n=parseCommaParts(m.body);if(n.length===1){n=expand(n[0],false).map(embrace);if(n.length===1){var post=m.post.length?expand(m.post,false):[""];return post.map((function(p){return m.pre+n[0]+p}))}}}var pre=m.pre;var post=m.post.length?expand(m.post,false):[""];var N;if(isSequence){var x=numeric(n[0]);var y=numeric(n[1]);var width=Math.max(n[0].length,n[1].length);var incr=n.length==3?Math.abs(numeric(n[2])):1;var test=lte;var reverse=y<x;if(reverse){incr*=-1;test=gte}var pad=n.some(isPadded);N=[];for(var i=x;test(i,y);i+=incr){var c;if(isAlphaSequence){c=String.fromCharCode(i);if(c==="\\")c=""}else{c=String(i);if(pad){var need=width-c.length;if(need>0){var z=new Array(need+1).join("0");if(i<0)c="-"+z+c.slice(1);else c=z+c}}}N.push(c)}}else{N=concatMap(n,(function(el){return expand(el,false)}))}for(var j=0;j<N.length;j++){for(var k=0;k<post.length;k++){var expansion=pre+N[j]+post[k];if(!isTop||isSequence||expansion)expansions.push(expansion)}}return expansions}},1170:function(module,exports){module.exports=function(xs,fn){var res=[];for(var i=0;i<xs.length;i++){var x=fn(xs[i],i);if(isArray(x))res.push.apply(res,x);else res.push(x)}return res};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"}},1171:function(module,exports,__webpack_require__){"use strict";module.exports=balanced;function balanced(a,b,str){if(a instanceof RegExp)a=maybeMatch(a,str);if(b instanceof RegExp)b=maybeMatch(b,str);var r=range(a,b,str);return r&&{start:r[0],end:r[1],pre:str.slice(0,r[0]),body:str.slice(r[0]+a.length,r[1]),post:str.slice(r[1]+b.length)}}function maybeMatch(reg,str){var m=str.match(reg);return m?m[0]:null}balanced.range=range;function range(a,b,str){var begs,beg,left,right,result;var ai=str.indexOf(a);var bi=str.indexOf(b,ai+1);var i=ai;if(ai>=0&&bi>0){begs=[];left=str.length;while(i>=0&&!result){if(i==ai){begs.push(i);ai=str.indexOf(a,i+1)}else if(begs.length==1){result=[begs.pop(),bi]}else{beg=begs.pop();if(beg<left){left=beg;right=bi}bi=str.indexOf(b,i+1)}i=ai<bi&&ai>=0?ai:bi}if(begs.length){result=[left,right]}}return result}},1179:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"subPluginClasses",(function(){return subPluginClasses}));var local_storage=__webpack_require__(355);var types_timeline=__webpack_require__(106);var external_kbnSharedDeps_React_=__webpack_require__(6);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ReactRouterDom_=__webpack_require__(75);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(72);var external_kbnSharedDeps_StyledComponents_=__webpack_require__(73);var external_kbnSharedDeps_StyledComponents_default=__webpack_require__.n(external_kbnSharedDeps_StyledComponents_);var api=__webpack_require__(155);var toasters=__webpack_require__(111);var transforms=__webpack_require__(305);var translations=__webpack_require__(209);const useUpdateRule=()=>{const[rule,setRule]=Object(external_kbnSharedDeps_React_["useState"])(null);const[isSaved,setIsSaved]=Object(external_kbnSharedDeps_React_["useState"])(false);const[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_["useState"])(false);const[,dispatchToaster]=Object(toasters["h"])();Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;const abortCtrl=new AbortController;setIsSaved(false);const saveRule=async()=>{if(rule!=null){try{setIsLoading(true);await Object(api["p"])({rule:Object(transforms["b"])(rule),signal:abortCtrl.signal});if(isSubscribed){setIsSaved(true)}}catch(error){if(isSubscribed){Object(toasters["g"])({title:translations["g"],error:error,dispatchToaster:dispatchToaster})}}if(isSubscribed){setIsLoading(false)}}};saveRule();return()=>{isSubscribed=false;abortCtrl.abort()}},[rule,dispatchToaster]);return[{isLoading:isLoading,isSaved:isSaved},setRule]};const useCreateRule=()=>{const[rule,setRule]=Object(external_kbnSharedDeps_React_["useState"])(null);const[isSaved,setIsSaved]=Object(external_kbnSharedDeps_React_["useState"])(false);const[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_["useState"])(false);const[,dispatchToaster]=Object(toasters["h"])();Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;const abortCtrl=new AbortController;setIsSaved(false);const saveRule=async()=>{if(rule!=null){try{setIsLoading(true);await Object(api["b"])({rule:Object(transforms["b"])(rule),signal:abortCtrl.signal});if(isSubscribed){setIsSaved(true)}}catch(error){if(isSubscribed){Object(toasters["g"])({title:translations["g"],error:error,dispatchToaster:dispatchToaster})}}if(isSubscribed){setIsLoading(false)}}};saveRule();return()=>{isSubscribed=false;abortCtrl.abort()}},[rule,dispatchToaster]);return[{isLoading:isLoading,isSaved:isSaved},setRule]};var lib=__webpack_require__(0);var schemas=__webpack_require__(28);var types=__webpack_require__(504);const types_action=lib["exact"](lib["type"]({group:lib["string"],id:lib["string"],action_type_id:lib["string"],params:lib["record"](lib["string"],lib["any"])}));const MetaRule=lib["intersection"]([lib["type"]({from:lib["string"]}),lib["partial"]({throttle:lib["string"],kibana_siem_app_url:lib["string"]})]);const StatusTypes=lib["union"]([lib["literal"]("succeeded"),lib["literal"]("failed"),lib["literal"]("going to run"),lib["literal"]("partial failure"),lib["literal"]("warning")]);const RuleSchema=lib["intersection"]([lib["type"]({author:schemas["b"],created_at:lib["string"],created_by:lib["string"],description:lib["string"],enabled:lib["boolean"],false_positives:lib["array"](lib["string"]),from:lib["string"],id:lib["string"],interval:lib["string"],immutable:lib["boolean"],name:lib["string"],max_signals:lib["number"],references:lib["array"](lib["string"]),risk_score:lib["number"],risk_score_mapping:schemas["i"],rule_id:lib["string"],severity:lib["string"],severity_mapping:schemas["l"],tags:lib["array"](lib["string"]),type:schemas["t"],to:lib["string"],threat:schemas["p"],updated_at:lib["string"],updated_by:lib["string"],actions:lib["array"](types_action),throttle:lib["union"]([lib["string"],lib["null"]])}),lib["partial"]({building_block_type:schemas["c"],anomaly_threshold:lib["number"],filters:lib["array"](lib["unknown"]),index:lib["array"](lib["string"]),language:lib["string"],license:schemas["f"],last_failure_at:lib["string"],last_failure_message:lib["string"],last_success_message:lib["string"],last_success_at:lib["string"],meta:MetaRule,machine_learning_job_id:lib["string"],output_index:lib["string"],query:lib["string"],rule_name_override:schemas["k"],saved_id:lib["string"],status:StatusTypes,status_date:lib["string"],threshold:schemas["q"],threat_query:types["i"],threat_filters:types["d"],threat_index:types["e"],threat_indicator_path:types["f"],threat_mapping:types["h"],threat_language:types["g"],timeline_id:lib["string"],timeline_title:lib["string"],timestamp_override:schemas["s"],note:lib["string"],exceptions_list:types["b"],version:lib["number"]})]);const RulesSchema=lib["array"](RuleSchema);const useRule=id=>{const[rule,setRule]=Object(external_kbnSharedDeps_React_["useState"])(null);const[loading,setLoading]=Object(external_kbnSharedDeps_React_["useState"])(true);const[,dispatchToaster]=Object(toasters["h"])();Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;const abortCtrl=new AbortController;const fetchData=async idToFetch=>{try{setLoading(true);const ruleResponse=Object(transforms["a"])(await Object(api["g"])({id:idToFetch,signal:abortCtrl.signal}));if(isSubscribed){setRule(ruleResponse)}}catch(error){if(isSubscribed){setRule(null);Object(toasters["g"])({title:translations["h"],error:error,dispatchToaster:dispatchToaster})}}if(isSubscribed){setLoading(false)}};if(id!=null){fetchData(id)}return()=>{isSubscribed=false;abortCtrl.abort()}},[id,dispatchToaster]);return[loading,rule]};const createRulesTableFacade=dispatch=>({setRules:(newRules,newPagination)=>{dispatch({type:"setRules",rules:newRules,pagination:newPagination})},updateRules:rules=>{dispatch({type:"updateRules",rules:rules})},updateOptions:(filter,pagination)=>{dispatch({type:"updateFilterOptions",filterOptions:filter,pagination:pagination})},actionStarted:(actionType,ruleIds)=>{dispatch({type:"loadingRuleIds",actionType:actionType,ids:ruleIds})},actionStopped:()=>{dispatch({type:"loadingRuleIds",actionType:null,ids:[]})},setShowIdleModal:show=>{dispatch({type:"setShowIdleModal",show:show})},setLastRefreshDate:()=>{dispatch({type:"setLastRefreshDate"})},setAutoRefreshOn:on=>{dispatch({type:"setAutoRefreshOn",on:on})},setIsRefreshing:isRefreshing=>{dispatch({type:"setIsRefreshing",isRefreshing:isRefreshing})}});const createRulesTableReducer=tableRef=>{const rulesTableReducer=(state,action)=>{switch(action.type){case"setRules":{var _tableRef$current;if((tableRef===null||tableRef===void 0?void 0:(_tableRef$current=tableRef.current)===null||_tableRef$current===void 0?void 0:_tableRef$current.changeSelection)!=null){window.setTimeout(()=>{var _tableRef$current2;return tableRef===null||tableRef===void 0?void 0:(_tableRef$current2=tableRef.current)===null||_tableRef$current2===void 0?void 0:_tableRef$current2.changeSelection([])},0)}return{...state,rules:action.rules,selectedRuleIds:[],loadingRuleIds:[],loadingRulesAction:null,pagination:{...state.pagination,...action.pagination}}}case"updateRules":{const ruleIds=state.rules.map(r=>r.id);const updatedRules=action.rules.reduce((rules,updatedRule)=>{let newRules=rules;if(ruleIds.includes(updatedRule.id)){newRules=newRules.map(r=>updatedRule.id===r.id?updatedRule:r)}else{newRules=[...newRules,updatedRule]}return newRules},state.rules);const updatedRuleIds=action.rules.map(r=>r.id);const newLoadingRuleIds=state.loadingRuleIds.filter(id=>!updatedRuleIds.includes(id));return{...state,rules:updatedRules,loadingRuleIds:newLoadingRuleIds,loadingRulesAction:newLoadingRuleIds.length===0?null:state.loadingRulesAction}}case"updateFilterOptions":{return{...state,filterOptions:{...state.filterOptions,...action.filterOptions},pagination:{...state.pagination,...action.pagination}}}case"loadingRuleIds":{return{...state,loadingRuleIds:action.actionType==null?[]:[...state.loadingRuleIds,...action.ids],loadingRulesAction:action.actionType}}case"selectedRuleIds":{return{...state,selectedRuleIds:action.ids}}case"exportRuleIds":{return{...state,loadingRuleIds:action.ids,loadingRulesAction:"export",exportRuleIds:action.ids}}case"setLastRefreshDate":{return{...state,lastUpdated:Date.now()}}case"setAutoRefreshOn":{return{...state,isRefreshOn:action.on}}case"setIsRefreshing":{return{...state,isRefreshing:action.isRefreshing}}case"setShowIdleModal":{return{...state,showIdleModal:action.show,isRefreshOn:!action.show}}case"failure":{return{...state,rules:[]}}default:{return state}}};return rulesTableReducer};const useRules=({pagination:pagination,filterOptions:filterOptions,dispatchRulesInReducer:dispatchRulesInReducer})=>{const[rules,setRules]=Object(external_kbnSharedDeps_React_["useState"])(null);const reFetchRules=Object(external_kbnSharedDeps_React_["useRef"])(()=>Promise.resolve());const[loading,setLoading]=Object(external_kbnSharedDeps_React_["useState"])(true);const[,dispatchToaster]=Object(toasters["h"])();const filterTags=filterOptions.tags.sort().join();Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;const abortCtrl=new AbortController;const fetchData=async()=>{try{setLoading(true);const fetchRulesResult=await Object(api["h"])({filterOptions:filterOptions,pagination:pagination,signal:abortCtrl.signal});if(isSubscribed){setRules(fetchRulesResult);if(dispatchRulesInReducer!=null){dispatchRulesInReducer(fetchRulesResult.data,{page:fetchRulesResult.page,perPage:fetchRulesResult.perPage,total:fetchRulesResult.total})}}}catch(error){if(isSubscribed){Object(toasters["g"])({title:translations["h"],error:error,dispatchToaster:dispatchToaster});if(dispatchRulesInReducer!=null){dispatchRulesInReducer([],{})}}}if(isSubscribed){setLoading(false)}};fetchData();reFetchRules.current=()=>fetchData();return()=>{isSubscribed=false;abortCtrl.abort()}},[pagination.page,pagination.perPage,filterOptions.filter,filterOptions.sortField,filterOptions.sortOrder,filterTags,filterOptions.showCustomRules,filterOptions.showElasticRules]);return[loading,rules,reFetchRules.current]};const INITIAL_SORT_FIELD="enabled";const initialStateDefaults={rules:[],pagination:{page:1,perPage:20,total:0},filterOptions:{filter:"",sortField:INITIAL_SORT_FIELD,sortOrder:"desc",tags:[],showCustomRules:false,showElasticRules:false},loadingRulesAction:null,loadingRuleIds:[],selectedRuleIds:[],exportRuleIds:[],lastUpdated:0,isRefreshOn:true,isRefreshing:false,showIdleModal:false};const useRulesTable=params=>{const{tableRef:tableRef,initialStateOverride:initialStateOverride}=params;const initialState={...initialStateDefaults,lastUpdated:Date.now(),...initialStateOverride};const reducer=Object(external_kbnSharedDeps_React_["useMemo"])(()=>createRulesTableReducer(tableRef),[tableRef]);const[state,dispatch]=Object(external_kbnSharedDeps_React_["useReducer"])(reducer,initialState);const facade=Object(external_kbnSharedDeps_React_["useRef"])(createRulesTableFacade(dispatch));const reFetchRules=Object(external_kbnSharedDeps_React_["useRef"])(()=>Promise.resolve());const[,dispatchToaster]=Object(toasters["h"])();const{pagination:pagination,filterOptions:filterOptions}=state;const filterTags=filterOptions.tags.sort().join();Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;const abortCtrl=new AbortController;const fetchData=async()=>{try{facade.current.actionStarted("load",[]);const fetchRulesResult=await Object(api["h"])({filterOptions:filterOptions,pagination:pagination,signal:abortCtrl.signal});if(isSubscribed){facade.current.setRules(fetchRulesResult.data,{page:fetchRulesResult.page,perPage:fetchRulesResult.perPage,total:fetchRulesResult.total})}}catch(error){if(isSubscribed){Object(toasters["g"])({title:translations["h"],error:error,dispatchToaster:dispatchToaster});facade.current.setRules([],{})}}if(isSubscribed){facade.current.actionStopped()}};fetchData();reFetchRules.current=()=>fetchData();return()=>{isSubscribed=false;abortCtrl.abort()}},[pagination.page,pagination.perPage,filterOptions.filter,filterOptions.sortField,filterOptions.sortOrder,filterTags,filterOptions.showCustomRules,filterOptions.showElasticRules]);return{state:state,dispatch:dispatch,...facade.current,reFetchRules:reFetchRules.current}};var elastic_datemath=__webpack_require__(43);var elastic_datemath_default=__webpack_require__.n(elastic_datemath);var external_kbnSharedDeps_Moment_=__webpack_require__(27);var external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_);var memoize_one_cjs=__webpack_require__(222);var memoize_one_cjs_default=__webpack_require__.n(memoize_one_cjs);var utils=__webpack_require__(162);var utility_types=__webpack_require__(191);const transformRuleToAlertAction=({group:group,id:id,action_type_id:action_type_id,params:params})=>({group:group,id:id,params:params,actionTypeId:action_type_id});const transformAlertToRuleAction=({group:group,id:id,actionTypeId:actionTypeId,params:params})=>({group:group,id:id,params:params,action_type_id:actionTypeId});var shared_imports=__webpack_require__(110);var external_kbnSharedDeps_Theme_euiLightVars_=__webpack_require__(85);var external_kbnSharedDeps_Theme_euiLightVars_default=__webpack_require__.n(external_kbnSharedDeps_Theme_euiLightVars_);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);const ADVANCED_SETTINGS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.advancedSettingsButton",{defaultMessage:"Advanced settings"});const ADD_REFERENCE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addReferenceDescription",{defaultMessage:"Add reference URL"});const ADD_FALSE_POSITIVE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addFalsePositiveDescription",{defaultMessage:"Add false positive example"});const GLOBAL_ENDPOINT_EXCEPTION_LIST=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.endpointExceptionListLabel",{defaultMessage:"Elastic Endpoint exceptions"});const BUILDING_BLOCK=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.buildingBlockLabel",{defaultMessage:"Building block"});const LOW=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionLowDescription",{defaultMessage:"Low"});const MEDIUM=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionMediumDescription",{defaultMessage:"Medium"});const HIGH=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionHighDescription",{defaultMessage:"High"});const CRITICAL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionCriticalDescription",{defaultMessage:"Critical"});const URL_FORMAT_INVALID=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.referencesUrlInvalidError",{defaultMessage:"Url is invalid format"});const ADD_RULE_NOTE_HELP_TEXT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutrule.noteHelpText",{defaultMessage:"Add rule investigation guide..."});const StyledEuiHealth=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiHealth"]).withConfig({displayName:"StyledEuiHealth",componentId:"sc-1mv5h4i-0"})(["line-height:inherit;"]);const severityOptions=[{value:"low",inputDisplay:external_kbnSharedDeps_React_default.a.createElement(StyledEuiHealth,{color:external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis0},LOW)},{value:"medium",inputDisplay:external_kbnSharedDeps_React_default.a.createElement(StyledEuiHealth,{color:external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis5},MEDIUM)},{value:"high",inputDisplay:external_kbnSharedDeps_React_default.a.createElement(StyledEuiHealth,{color:external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis7},HIGH)},{value:"critical",inputDisplay:external_kbnSharedDeps_React_default.a.createElement(StyledEuiHealth,{color:external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis9},CRITICAL)}];const defaultRiskScoreBySeverity={low:21,medium:47,high:73,critical:99};const getStepsData=({rule:rule,detailsView:detailsView=false})=>{const defineRuleData=getDefineStepsData(rule);const aboutRuleData=getAboutStepsData(rule,detailsView);const modifiedAboutRuleDetailsData=getModifiedAboutDetailsData(rule);const scheduleRuleData=getScheduleStepsData(rule);const ruleActionsData=getActionsStepsData(rule);return{aboutRuleData:aboutRuleData,modifiedAboutRuleDetailsData:modifiedAboutRuleDetailsData,defineRuleData:defineRuleData,scheduleRuleData:scheduleRuleData,ruleActionsData:ruleActionsData}};const getActionsStepsData=rule=>{const{enabled:enabled,throttle:throttle,meta:meta,actions:actions=[]}=rule;return{actions:actions===null||actions===void 0?void 0:actions.map(transformRuleToAlertAction),throttle:throttle,kibanaSiemAppUrl:meta===null||meta===void 0?void 0:meta.kibana_siem_app_url,enabled:enabled}};const getDefineStepsData=rule=>{var _rule$anomaly_thresho,_rule$machine_learnin,_rule$index,_rule$threat_index,_rule$threat_query,_rule$threat_language,_rule$threat_filters,_rule$threat_mapping,_rule$query,_rule$language,_rule$filters,_rule$timeline_id,_rule$timeline_title,_rule$threshold,_rule$threshold2,_rule$threshold3,_rule$threshold3$card;return{ruleType:rule.type,anomalyThreshold:(_rule$anomaly_thresho=rule.anomaly_threshold)!==null&&_rule$anomaly_thresho!==void 0?_rule$anomaly_thresho:50,machineLearningJobId:(_rule$machine_learnin=rule.machine_learning_job_id)!==null&&_rule$machine_learnin!==void 0?_rule$machine_learnin:"",index:(_rule$index=rule.index)!==null&&_rule$index!==void 0?_rule$index:[],threatIndex:(_rule$threat_index=rule.threat_index)!==null&&_rule$threat_index!==void 0?_rule$threat_index:[],threatQueryBar:{query:{query:(_rule$threat_query=rule.threat_query)!==null&&_rule$threat_query!==void 0?_rule$threat_query:"",language:(_rule$threat_language=rule.threat_language)!==null&&_rule$threat_language!==void 0?_rule$threat_language:""},filters:(_rule$threat_filters=rule.threat_filters)!==null&&_rule$threat_filters!==void 0?_rule$threat_filters:[],saved_id:undefined},threatMapping:(_rule$threat_mapping=rule.threat_mapping)!==null&&_rule$threat_mapping!==void 0?_rule$threat_mapping:[],queryBar:{query:{query:(_rule$query=rule.query)!==null&&_rule$query!==void 0?_rule$query:"",language:(_rule$language=rule.language)!==null&&_rule$language!==void 0?_rule$language:""},filters:(_rule$filters=rule.filters)!==null&&_rule$filters!==void 0?_rule$filters:[],saved_id:rule.saved_id},timeline:{id:(_rule$timeline_id=rule.timeline_id)!==null&&_rule$timeline_id!==void 0?_rule$timeline_id:null,title:(_rule$timeline_title=rule.timeline_title)!==null&&_rule$timeline_title!==void 0?_rule$timeline_title:null},threshold:{field:Object(utils["h"])((_rule$threshold=rule.threshold)===null||_rule$threshold===void 0?void 0:_rule$threshold.field),value:`${((_rule$threshold2=rule.threshold)===null||_rule$threshold2===void 0?void 0:_rule$threshold2.value)||100}`,...(_rule$threshold3=rule.threshold)!==null&&_rule$threshold3!==void 0&&(_rule$threshold3$card=_rule$threshold3.cardinality)!==null&&_rule$threshold3$card!==void 0&&_rule$threshold3$card.length?{cardinality:{field:[`${rule.threshold.cardinality[0].field}`],value:`${rule.threshold.cardinality[0].value}`}}:{}}}};const getScheduleStepsData=rule=>{const{interval:interval,from:from}=rule;const fromHumanizedValue=getHumanizedDuration(from,interval);return{interval:interval,from:fromHumanizedValue}};const getHumanizedDuration=(from,interval)=>{var _dateMath$parse,_dateMath$parse2;const fromValue=(_dateMath$parse=elastic_datemath_default.a.parse(from))!==null&&_dateMath$parse!==void 0?_dateMath$parse:external_kbnSharedDeps_Moment_default()();const intervalValue=(_dateMath$parse2=elastic_datemath_default.a.parse(`now-${interval}`))!==null&&_dateMath$parse2!==void 0?_dateMath$parse2:external_kbnSharedDeps_Moment_default()();const fromDuration=external_kbnSharedDeps_Moment_default.a.duration(intervalValue.diff(fromValue));const intervalDuration=Math.floor(fromDuration.asSeconds());if(intervalDuration===0){return`0s`}if(intervalDuration%3600===0){return`${intervalDuration/3600}h`}else if(intervalDuration%60===0){return`${intervalDuration/60}m`}else{return`${intervalDuration}s`}};const getAboutStepsData=(rule,detailsView)=>{var _exceptionsList$some;const{name:name,description:description,note:note}=determineDetailsValue(rule,detailsView);const{author:author,building_block_type:buildingBlockType,exceptions_list:exceptionsList,license:license,risk_score_mapping:riskScoreMapping,rule_name_override:ruleNameOverride,severity_mapping:severityMapping,timestamp_override:timestampOverride,references:references,severity:severity,false_positives:falsePositives,risk_score:riskScore,tags:tags,threat:threat,threat_indicator_path:threatIndicatorPath}=rule;return{author:author,isAssociatedToEndpointList:(_exceptionsList$some=exceptionsList===null||exceptionsList===void 0?void 0:exceptionsList.some(({id:id})=>id===shared_imports["a"]))!==null&&_exceptionsList$some!==void 0?_exceptionsList$some:false,isBuildingBlock:buildingBlockType!==undefined,license:license!==null&&license!==void 0?license:"",ruleNameOverride:ruleNameOverride!==null&&ruleNameOverride!==void 0?ruleNameOverride:"",timestampOverride:timestampOverride!==null&&timestampOverride!==void 0?timestampOverride:"",name:name,description:description,note:note,references:references,severity:{value:severity,mapping:fillEmptySeverityMappings(severityMapping),isMappingChecked:severityMapping.length>0},tags:tags,riskScore:{value:riskScore,mapping:riskScoreMapping,isMappingChecked:riskScoreMapping.length>0},falsePositives:falsePositives,threat:threat,threatIndicatorPath:threatIndicatorPath}};const severitySortMapping={low:0,medium:1,high:2,critical:3};const fillEmptySeverityMappings=mappings=>{const missingMappings=severityOptions.flatMap(so=>mappings.find(mapping=>mapping.severity===so.value)==null?[{field:"",value:"",operator:"equals",severity:so.value}]:[]);return[...mappings,...missingMappings].sort((a,b)=>severitySortMapping[a.severity]-severitySortMapping[b.severity])};const determineDetailsValue=(rule,detailsView)=>{const{name:name,description:description,note:note}=rule;if(detailsView){return{name:"",description:"",note:""}}return{name:name,description:description,note:note!==null&&note!==void 0?note:""}};const getModifiedAboutDetailsData=rule=>{var _rule$note;return{note:(_rule$note=rule.note)!==null&&_rule$note!==void 0?_rule$note:"",description:rule.description}};const useQuery=()=>new URLSearchParams(Object(external_kbnSharedDeps_ReactRouterDom_["useLocation"])().search);const getPrePackagedRuleStatus=(rulesInstalled,rulesNotInstalled,rulesNotUpdated)=>{if(rulesNotInstalled!=null&&rulesInstalled===0&&rulesNotInstalled>0&&rulesNotUpdated===0){return"ruleNotInstalled"}else if(rulesInstalled!=null&&rulesInstalled>0&&rulesNotInstalled===0&&rulesNotUpdated===0){return"ruleInstalled"}else if(rulesInstalled!=null&&rulesNotInstalled!=null&&rulesInstalled>0&&rulesNotInstalled>0&&rulesNotUpdated===0){return"someRuleUninstall"}else if(rulesInstalled!=null&&rulesNotInstalled!=null&&rulesNotUpdated!=null&&rulesInstalled>0&&rulesNotInstalled>=0&&rulesNotUpdated>0){return"ruleNeedUpdate"}return"unknown"};const getPrePackagedTimelineStatus=(timelinesInstalled,timelinesNotInstalled,timelinesNotUpdated)=>{if(timelinesNotInstalled!=null&&timelinesInstalled===0&&timelinesNotInstalled>0&&timelinesNotUpdated===0){return"timelinesNotInstalled"}else if(timelinesInstalled!=null&&timelinesInstalled>0&&timelinesNotInstalled===0&&timelinesNotUpdated===0){return"timelinesInstalled"}else if(timelinesInstalled!=null&&timelinesNotInstalled!=null&&timelinesInstalled>0&&timelinesNotInstalled>0&&timelinesNotUpdated===0){return"someTimelineUninstall"}else if(timelinesInstalled!=null&&timelinesNotInstalled!=null&&timelinesNotUpdated!=null&&timelinesInstalled>0&&timelinesNotInstalled>=0&&timelinesNotUpdated>0){return"timelineNeedUpdate"}return"unknown"};const redirectToDetections=(isSignalIndexExists,isAuthenticated,hasEncryptionKey,needsListsConfiguration)=>isSignalIndexExists===false||isAuthenticated===false||hasEncryptionKey===false||needsListsConfiguration;const getRuleSpecificRuleParamKeys=ruleType=>{const queryRuleParams=["index","filters","language","query","saved_id"];switch(ruleType){case"machine_learning":return["anomaly_threshold","machine_learning_job_id"];case"threshold":return["threshold",...queryRuleParams];case"threat_match":case"query":case"saved_query":case"eql":return queryRuleParams}Object(utility_types["a"])(ruleType)};const getActionMessageRuleParams=ruleType=>{const commonRuleParamsKeys=["id","name","description","false_positives","rule_id","max_signals","risk_score","output_index","references","severity","timeline_id","timeline_title","threat","type","version"];const ruleParamsKeys=[...commonRuleParamsKeys,...getRuleSpecificRuleParamKeys(ruleType)].sort();return ruleParamsKeys};const getActionMessageParams=memoize_one_cjs_default()(ruleType=>{if(!ruleType){return{state:[],params:[]}}const actionMessageRuleParams=getActionMessageRuleParams(ruleType);return{state:[{name:"signals_count",description:"state.signals_count"}],params:[],context:[{name:"results_link",description:"context.results_link",useWithTripleBracesInTemplates:true},{name:"alerts",description:"context.alerts"},...actionMessageRuleParams.map(param=>{const extendedParam=`rule.${param}`;return{name:extendedParam,description:`context.${extendedParam}`}})]}});const helpers_userHasNoPermissions=canUserCRUD=>canUserCRUD!=null?!canUserCRUD:false;const MaxWidthEuiFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MaxWidthEuiFlexItem",componentId:"sc-97v502-0"})(["max-width:1000px;overflow:hidden;"]);const usePrePackagedRules=({canUserCRUD:canUserCRUD,hasIndexWrite:hasIndexWrite,isAuthenticated:isAuthenticated,hasEncryptionKey:hasEncryptionKey,isSignalIndexExists:isSignalIndexExists})=>{const[prepackagedDataStatus,setPrepackagedDataStatus]=Object(external_kbnSharedDeps_React_["useState"])({createPrePackagedRules:null,refetchPrePackagedRulesStatus:null,rulesCustomInstalled:null,rulesInstalled:null,rulesNotInstalled:null,rulesNotUpdated:null,timelinesInstalled:null,timelinesNotInstalled:null,timelinesNotUpdated:null});const[loadingCreatePrePackagedRules,setLoadingCreatePrePackagedRules]=Object(external_kbnSharedDeps_React_["useState"])(false);const[loading,setLoading]=Object(external_kbnSharedDeps_React_["useState"])(true);const[,dispatchToaster]=Object(toasters["h"])();const getSuccessToastMessage=result=>{const{rules_installed:rulesInstalled,rules_updated:rulesUpdated,timelines_installed:timelinesInstalled,timelines_updated:timelinesUpdated}=result;if(rulesInstalled===0&&(timelinesInstalled>0||timelinesUpdated>0)){return translations["m"]}else if((rulesInstalled>0||rulesUpdated>0)&&timelinesInstalled===0){return translations["k"]}else{return translations["j"]}};Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;const abortCtrl=new AbortController;const fetchPrePackagedRules=async()=>{try{setLoading(true);const prePackagedRuleStatusResponse=await Object(api["j"])({signal:abortCtrl.signal});if(isSubscribed){setPrepackagedDataStatus({createPrePackagedRules:createElasticRules,refetchPrePackagedRulesStatus:fetchPrePackagedRules,rulesCustomInstalled:prePackagedRuleStatusResponse.rules_custom_installed,rulesInstalled:prePackagedRuleStatusResponse.rules_installed,rulesNotInstalled:prePackagedRuleStatusResponse.rules_not_installed,rulesNotUpdated:prePackagedRuleStatusResponse.rules_not_updated,timelinesInstalled:prePackagedRuleStatusResponse.timelines_installed,timelinesNotInstalled:prePackagedRuleStatusResponse.timelines_not_installed,timelinesNotUpdated:prePackagedRuleStatusResponse.timelines_not_updated})}}catch(error){if(isSubscribed){setPrepackagedDataStatus({createPrePackagedRules:null,refetchPrePackagedRulesStatus:null,rulesCustomInstalled:null,rulesInstalled:null,rulesNotInstalled:null,rulesNotUpdated:null,timelinesInstalled:null,timelinesNotInstalled:null,timelinesNotUpdated:null});Object(toasters["g"])({title:translations["h"],error:error,dispatchToaster:dispatchToaster})}}if(isSubscribed){setLoading(false)}};const createElasticRules=async()=>new Promise(async resolve=>{try{if(canUserCRUD&&hasIndexWrite&&isAuthenticated&&hasEncryptionKey&&isSignalIndexExists){setLoadingCreatePrePackagedRules(true);const result=await Object(api["a"])({signal:abortCtrl.signal});if(isSubscribed){let iterationTryOfFetchingPrePackagedCount=0;let timeoutId=-1;const stopTimeOut=()=>{if(timeoutId!==-1){window.clearTimeout(timeoutId)}};const reFetch=()=>window.setTimeout(async()=>{iterationTryOfFetchingPrePackagedCount=iterationTryOfFetchingPrePackagedCount+1;const prePackagedRuleStatusResponse=await Object(api["j"])({signal:abortCtrl.signal});if(isSubscribed&&(prePackagedRuleStatusResponse.rules_not_installed===0&&prePackagedRuleStatusResponse.rules_not_updated===0&&prePackagedRuleStatusResponse.timelines_not_installed===0&&prePackagedRuleStatusResponse.timelines_not_updated===0||iterationTryOfFetchingPrePackagedCount>100)){setLoadingCreatePrePackagedRules(false);setPrepackagedDataStatus({createPrePackagedRules:createElasticRules,refetchPrePackagedRulesStatus:fetchPrePackagedRules,rulesCustomInstalled:prePackagedRuleStatusResponse.rules_custom_installed,rulesInstalled:prePackagedRuleStatusResponse.rules_installed,rulesNotInstalled:prePackagedRuleStatusResponse.rules_not_installed,rulesNotUpdated:prePackagedRuleStatusResponse.rules_not_updated,timelinesInstalled:prePackagedRuleStatusResponse.timelines_installed,timelinesNotInstalled:prePackagedRuleStatusResponse.timelines_not_installed,timelinesNotUpdated:prePackagedRuleStatusResponse.timelines_not_updated});Object(toasters["e"])(getSuccessToastMessage(result),dispatchToaster);stopTimeOut();resolve(true)}else{timeoutId=reFetch()}},300);timeoutId=reFetch()}}else{resolve(false)}}catch(error){if(isSubscribed){setLoadingCreatePrePackagedRules(false);Object(toasters["g"])({title:translations["i"],error:error,dispatchToaster:dispatchToaster});resolve(false)}}});fetchPrePackagedRules();return()=>{isSubscribed=false;abortCtrl.abort()}},[canUserCRUD,hasIndexWrite,isAuthenticated,hasEncryptionKey,isSignalIndexExists,dispatchToaster]);const prePackagedRuleStatus=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getPrePackagedRuleStatus(prepackagedDataStatus.rulesInstalled,prepackagedDataStatus.rulesNotInstalled,prepackagedDataStatus.rulesNotUpdated),[prepackagedDataStatus.rulesInstalled,prepackagedDataStatus.rulesNotInstalled,prepackagedDataStatus.rulesNotUpdated]);const prePackagedTimelineStatus=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getPrePackagedTimelineStatus(prepackagedDataStatus.timelinesInstalled,prepackagedDataStatus.timelinesNotInstalled,prepackagedDataStatus.timelinesNotUpdated),[prepackagedDataStatus.timelinesInstalled,prepackagedDataStatus.timelinesNotInstalled,prepackagedDataStatus.timelinesNotUpdated]);const getLoadPrebuiltRulesAndTemplatesButton=Object(external_kbnSharedDeps_React_["useCallback"])(({isDisabled:isDisabled,onClick:onClick,fill:fill,"data-test-subj":dataTestSubj="loadPrebuiltRulesBtn"})=>(prePackagedRuleStatus==="ruleNotInstalled"||prePackagedTimelineStatus==="timelinesNotInstalled")&&prePackagedRuleStatus!=="someRuleUninstall"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:fill,iconType:"indexOpen",isLoading:loadingCreatePrePackagedRules,isDisabled:isDisabled,onClick:onClick,"data-test-subj":dataTestSubj},prePackagedRuleStatus==="ruleNotInstalled"&&prePackagedTimelineStatus==="timelinesNotInstalled"&&translations["b"],prePackagedRuleStatus==="ruleNotInstalled"&&prePackagedTimelineStatus!=="timelinesNotInstalled"&&translations["a"],prePackagedRuleStatus!=="ruleNotInstalled"&&prePackagedTimelineStatus==="timelinesNotInstalled"&&translations["c"]):null,[loadingCreatePrePackagedRules,prePackagedRuleStatus,prePackagedTimelineStatus]);const getMissingRulesOrTimelinesButtonTitle=Object(external_kbnSharedDeps_React_["useCallback"])((missingRules,missingTimelines)=>{if(missingRules>0&&missingTimelines===0)return translations["d"](missingRules);else if(missingRules===0&&missingTimelines>0)return translations["f"](missingTimelines);else if(missingRules>0&&missingTimelines>0)return translations["e"](missingRules,missingTimelines)},[]);const getReloadPrebuiltRulesAndTemplatesButton=Object(external_kbnSharedDeps_React_["useCallback"])(({isDisabled:isDisabled,onClick:onClick,fill:fill=false})=>{var _prepackagedDataStatu,_prepackagedDataStatu2;return prePackagedRuleStatus==="someRuleUninstall"||prePackagedTimelineStatus==="someTimelineUninstall"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:fill,iconType:"plusInCircle",isLoading:loadingCreatePrePackagedRules,isDisabled:isDisabled,onClick:onClick,"data-test-subj":"reloadPrebuiltRulesBtn"},getMissingRulesOrTimelinesButtonTitle((_prepackagedDataStatu=prepackagedDataStatus.rulesNotInstalled)!==null&&_prepackagedDataStatu!==void 0?_prepackagedDataStatu:0,(_prepackagedDataStatu2=prepackagedDataStatus.timelinesNotInstalled)!==null&&_prepackagedDataStatu2!==void 0?_prepackagedDataStatu2:0)):null},[getMissingRulesOrTimelinesButtonTitle,loadingCreatePrePackagedRules,prePackagedRuleStatus,prePackagedTimelineStatus,prepackagedDataStatus.rulesNotInstalled,prepackagedDataStatus.timelinesNotInstalled]);return{loading:loading,loadingCreatePrePackagedRules:loadingCreatePrePackagedRules,...prepackagedDataStatus,getLoadPrebuiltRulesAndTemplatesButton:getLoadPrebuiltRulesAndTemplatesButton,getReloadPrebuiltRulesAndTemplatesButton:getReloadPrebuiltRulesAndTemplatesButton}};const useRuleStatus=id=>{const[ruleStatus,setRuleStatus]=Object(external_kbnSharedDeps_React_["useState"])(null);const fetchRuleStatus=Object(external_kbnSharedDeps_React_["useRef"])(null);const[loading,setLoading]=Object(external_kbnSharedDeps_React_["useState"])(true);const[,dispatchToaster]=Object(toasters["h"])();Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;const abortCtrl=new AbortController;const fetchData=async idToFetch=>{try{setLoading(true);const ruleStatusResponse=await Object(api["k"])({id:idToFetch,signal:abortCtrl.signal});if(isSubscribed){setRuleStatus(ruleStatusResponse[id!==null&&id!==void 0?id:""])}}catch(error){if(isSubscribed){setRuleStatus(null);Object(toasters["g"])({title:translations["h"],error:error,dispatchToaster:dispatchToaster})}}if(isSubscribed){setLoading(false)}};if(id!=null){fetchData(id)}fetchRuleStatus.current=fetchData;return()=>{isSubscribed=false;abortCtrl.abort()}},[id,dispatchToaster]);return[loading,ruleStatus,fetchRuleStatus.current]};const useRulesStatuses=rules=>{const[rulesStatuses,setRuleStatuses]=Object(external_kbnSharedDeps_React_["useState"])([]);const[loading,setLoading]=Object(external_kbnSharedDeps_React_["useState"])(false);const[,dispatchToaster]=Object(toasters["h"])();Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;const abortCtrl=new AbortController;const fetchData=async ids=>{try{setLoading(true);const ruleStatusesResponse=await Object(api["l"])({ids:ids,signal:abortCtrl.signal});if(isSubscribed){setRuleStatuses(rules.map(rule=>({id:rule.id,activate:rule.enabled,name:rule.name,...ruleStatusesResponse[rule.id]})))}}catch(error){if(isSubscribed){setRuleStatuses([]);Object(toasters["g"])({title:translations["h"],error:error,dispatchToaster:dispatchToaster})}}if(isSubscribed){setLoading(false)}};if(rules.length>0){fetchData(rules.map(r=>r.id))}return()=>{isSubscribed=false;abortCtrl.abort()}},[rules,dispatchToaster]);return{loading:loading,rulesStatuses:rulesStatuses}};var lib_kibana=__webpack_require__(104);var utils_api=__webpack_require__(340);const LISTS_INDEX_FETCH_FAILURE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.containers.detectionEngine.alerts.fetchListsIndex.errorDescription",{defaultMessage:"Failed to retrieve the lists index"});const LISTS_INDEX_CREATE_FAILURE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.containers.detectionEngine.alerts.createListsIndex.errorDescription",{defaultMessage:"Failed to create the lists index"});const LISTS_PRIVILEGES_READ_FAILURE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.containers.detectionEngine.alerts.readListsPrivileges.errorDescription",{defaultMessage:"Failed to retrieve lists privileges"});var use_app_toasts=__webpack_require__(143);const useListsIndex=()=>{const[indexExists,setIndexExists]=Object(external_kbnSharedDeps_React_["useState"])(null);const[error,setError]=Object(external_kbnSharedDeps_React_["useState"])(null);const{lists:lists}=Object(lib_kibana["h"])().services;const http=Object(lib_kibana["g"])();const{addError:addError}=Object(use_app_toasts["a"])();const{loading:readLoading,start:readListIndex,...readListIndexState}=Object(shared_imports["M"])();const{loading:createLoading,start:createListIndex,...createListIndexState}=Object(shared_imports["C"])();const loading=readLoading||createLoading;const readIndex=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(lists){readListIndex({http:http})}},[http,lists,readListIndex]);const createIndex=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(lists){createListIndex({http:http})}},[createListIndex,http,lists]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!readLoading&&!error&&indexExists===null){readIndex()}},[error,indexExists,readIndex,readLoading]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(readListIndexState.result!=null){setIndexExists(readListIndexState.result.list_index&&readListIndexState.result.list_item_index)}},[readListIndexState.result]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(createListIndexState.result!=null){readIndex()}},[createListIndexState.result,readIndex]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const err=readListIndexState.error;if(err!=null){if(Object(utils_api["b"])(err)&&err.body.status_code===404){setIndexExists(false)}else{setError(err);addError(err,{title:LISTS_INDEX_FETCH_FAILURE})}}},[addError,readListIndexState.error]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const err=createListIndexState.error;if(err!=null){setError(err);addError(err,{title:LISTS_INDEX_CREATE_FAILURE})}},[addError,createListIndexState.error]);return{createIndex:createIndex,error:error,indexExists:indexExists,loading:loading}};const use_lists_privileges_canManageIndex=indexPrivileges=>{const[indexName]=Object.keys(indexPrivileges);const privileges=indexPrivileges[indexName];if(privileges==null){return false}return privileges.manage};const use_lists_privileges_canWriteIndex=indexPrivileges=>{const[indexName]=Object.keys(indexPrivileges);const privileges=indexPrivileges[indexName];if(privileges==null){return false}return privileges.create||privileges.create_doc||privileges.index||privileges.write};const useListsPrivileges=()=>{const[state,setState]=Object(external_kbnSharedDeps_React_["useState"])({isAuthenticated:null,canManageIndex:null,canWriteIndex:null});const{lists:lists}=Object(lib_kibana["h"])().services;const http=Object(lib_kibana["g"])();const{addError:addError}=Object(use_app_toasts["a"])();const{loading:loading,start:readListPrivileges,...readState}=Object(shared_imports["N"])();const readPrivileges=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(lists){readListPrivileges({http:http})}},[http,lists,readListPrivileges]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!loading&&!readState.error&&state.isAuthenticated===null){readPrivileges()}},[loading,readState.error,readPrivileges,state.isAuthenticated]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(readState.result!=null){try{const{is_authenticated:isAuthenticated,lists:{index:listsPrivileges},listItems:{index:listItemsPrivileges}}=readState.result;setState({isAuthenticated:isAuthenticated,canManageIndex:use_lists_privileges_canManageIndex(listsPrivileges)&&use_lists_privileges_canManageIndex(listItemsPrivileges),canWriteIndex:use_lists_privileges_canWriteIndex(listsPrivileges)&&use_lists_privileges_canWriteIndex(listItemsPrivileges)})}catch(e){setState({isAuthenticated:null,canManageIndex:false,canWriteIndex:false})}}},[readState.result]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const error=readState.error;if(error!=null){setState({isAuthenticated:false,canManageIndex:false,canWriteIndex:false});addError(error,{title:LISTS_PRIVILEGES_READ_FAILURE})}},[addError,readState.error]);return{loading:loading,...state}};const useListsConfig=()=>{const{createIndex:createIndex,indexExists:indexExists,loading:indexLoading,error:indexError}=useListsIndex();const{canManageIndex:canManageIndex,canWriteIndex:canWriteIndex,loading:privilegesLoading}=useListsPrivileges();const{lists:lists}=Object(lib_kibana["h"])().services;const enabled=lists!=null;const loading=indexLoading||privilegesLoading;const needsIndex=indexExists===false;const hasIndexError=indexError!=null;const needsIndexConfiguration=needsIndex&&(canManageIndex===false||canManageIndex===true&&hasIndexError);const needsConfiguration=!enabled||needsIndexConfiguration;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(needsIndex&&canManageIndex){createIndex()}},[canManageIndex,createIndex,needsIndex]);return{canManageIndex:canManageIndex,canWriteIndex:canWriteIndex,enabled:enabled,loading:loading,needsConfiguration:needsConfiguration}};var redirect_to_detection_engine=__webpack_require__(154);var wrapper_page=__webpack_require__(138);var spy_routes=__webpack_require__(136);var user_info=__webpack_require__(173);var external_kbnSharedDeps_Theme_euiDarkVars_=__webpack_require__(89);var external_kbnSharedDeps_Theme_euiDarkVars_default=__webpack_require__.n(external_kbnSharedDeps_Theme_euiDarkVars_);var constants=__webpack_require__(2);const useEuiTheme=()=>{const[darkMode]=Object(lib_kibana["l"])(constants["q"]);return darkMode?external_kbnSharedDeps_Theme_euiDarkVars_default.a:external_kbnSharedDeps_Theme_euiLightVars_default.a};const RuleStatusIconStyled=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"RuleStatusIconStyled",componentId:"sc-1sbrlhw-0"})(["position:relative;svg{position:absolute;top:8px;left:9px;}"]);const RuleStatusIconComponent=({name:name,type:type})=>{const theme=useEuiTheme();const color=type==="passive"?theme.euiColorLightestShade:theme.euiColorPrimary;return external_kbnSharedDeps_React_default.a.createElement(RuleStatusIconStyled,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAvatar"],{color:color,name:type==="valid"?"":name,size:"l"}),type==="valid"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"check",color:theme.euiColorEmptyShade,size:"l"}):null)};const RuleStatusIcon=Object(external_kbnSharedDeps_React_["memo"])(RuleStatusIconComponent);const AccordionTitleComponent=({name:name,title:title,type:type})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"m",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(RuleStatusIcon,{name:name,type:type})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"s",className:"euiAccordionForm__title"},external_kbnSharedDeps_React_default.a.createElement("h6",null,title))));const AccordionTitle=external_kbnSharedDeps_React_default.a.memo(AccordionTitleComponent);var isEqual=__webpack_require__(1084);var isEqual_default=__webpack_require__.n(isEqual);var timeline_translations=__webpack_require__(261);var helpers=__webpack_require__(213);var has_ml_admin_permissions=__webpack_require__(389);var has_ml_license=__webpack_require__(273);var use_ml_capabilities=__webpack_require__(166);var external_kbnSharedDeps_LodashFp_=__webpack_require__(7);var cjs=__webpack_require__(268);var cjs_default=__webpack_require__.n(cjs);const getTimeTypeValue=time=>{const timeObj={unit:"",value:0};const filterTimeVal=time.match(/\d+/g);const filterTimeType=time.match(/[a-zA-Z]+/g);if(!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(filterTimeVal)&&filterTimeVal!=null&&!isNaN(Number(filterTimeVal[0]))){timeObj.value=Number(filterTimeVal[0])}if(!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(filterTimeType)&&filterTimeType!=null&&["s","m","h"].includes(filterTimeType[0])){timeObj.unit=filterTimeType[0]}return timeObj};const stepIsValid=formData=>!!(formData!==null&&formData!==void 0&&formData.isValid)&&!!formData.data;const isDefineStep=input=>Object(external_kbnSharedDeps_LodashFp_["has"])("data.ruleType",input);const isAboutStep=input=>Object(external_kbnSharedDeps_LodashFp_["has"])("data.name",input);const isScheduleStep=input=>Object(external_kbnSharedDeps_LodashFp_["has"])("data.interval",input);const isActionsStep=input=>Object(external_kbnSharedDeps_LodashFp_["has"])("data.actions",input);const isMlFields=fields=>Object(external_kbnSharedDeps_LodashFp_["has"])("anomalyThreshold",fields);const isThresholdFields=fields=>Object(external_kbnSharedDeps_LodashFp_["has"])("threshold",fields);const isThreatMatchFields=fields=>Object(external_kbnSharedDeps_LodashFp_["has"])("threatIndex",fields);const filterRuleFieldsForType=(fields,type)=>{switch(type){case"machine_learning":const{index:index,queryBar:queryBar,threshold:threshold,threatIndex:threatIndex,threatQueryBar:threatQueryBar,threatMapping:threatMapping,...mlRuleFields}=fields;return mlRuleFields;case"threshold":const{anomalyThreshold:anomalyThreshold,machineLearningJobId:machineLearningJobId,threatIndex:_removedThreatIndex,threatQueryBar:_removedThreatQueryBar,threatMapping:_removedThreatMapping,...thresholdRuleFields}=fields;return thresholdRuleFields;case"threat_match":const{anomalyThreshold:_removedAnomalyThreshold,machineLearningJobId:_removedMachineLearningJobId,threshold:_removedThreshold,...threatMatchRuleFields}=fields;return threatMatchRuleFields;case"query":case"saved_query":case"eql":const{anomalyThreshold:_a,machineLearningJobId:_m,threshold:_t,threatIndex:__removedThreatIndex,threatQueryBar:__removedThreatQueryBar,threatMapping:__removedThreatMapping,...queryRuleFields}=fields;return queryRuleFields}Object(utility_types["a"])(type)};function trimThreatsWithNoName(filterable){return filterable.filter(item=>item.name!=="none")}const filterEmptyThreats=threats=>threats.filter(singleThreat=>singleThreat.tactic.name!=="none").map(threat=>{var _threat$technique;return{...threat,technique:trimThreatsWithNoName((_threat$technique=threat.technique)!==null&&_threat$technique!==void 0?_threat$technique:[]).map(technique=>({...technique,subtechnique:technique.subtechnique!=null?trimThreatsWithNoName(technique.subtechnique):[]}))}});const formatDefineStepData=defineStepData=>{var _ruleFields$queryBar,_ruleFields$queryBar2,_ruleFields$queryBar3,_ruleFields$queryBar4,_ruleFields$queryBar5,_ruleFields$queryBar6,_ruleFields$threshold,_ruleFields$threshold2,_parseInt,_ruleFields$threshold3,_ruleFields$threshold4,_ruleFields$threshold5,_ruleFields$queryBar7,_ruleFields$queryBar8,_ruleFields$queryBar9,_ruleFields$queryBar10,_ruleFields$queryBar11,_ruleFields$queryBar12,_ruleFields$threatQue,_ruleFields$threatQue2,_ruleFields$threatQue3,_ruleFields$threatQue4,_ruleFields$threatQue5,_ruleFields$queryBar13,_ruleFields$queryBar14,_ruleFields$queryBar15,_ruleFields$queryBar16,_ruleFields$queryBar17,_ruleFields$queryBar18,_ruleFields$queryBar19;const ruleFields=filterRuleFieldsForType(defineStepData,defineStepData.ruleType);const{ruleType:ruleType,timeline:timeline}=ruleFields;const baseFields={type:ruleType,...timeline.id!=null&&timeline.title!=null&&{timeline_id:timeline.id,timeline_title:timeline.title}};const typeFields=isMlFields(ruleFields)?{anomaly_threshold:ruleFields.anomalyThreshold,machine_learning_job_id:ruleFields.machineLearningJobId}:isThresholdFields(ruleFields)?{index:ruleFields.index,filters:(_ruleFields$queryBar=ruleFields.queryBar)===null||_ruleFields$queryBar===void 0?void 0:_ruleFields$queryBar.filters,language:(_ruleFields$queryBar2=ruleFields.queryBar)===null||_ruleFields$queryBar2===void 0?void 0:(_ruleFields$queryBar3=_ruleFields$queryBar2.query)===null||_ruleFields$queryBar3===void 0?void 0:_ruleFields$queryBar3.language,query:(_ruleFields$queryBar4=ruleFields.queryBar)===null||_ruleFields$queryBar4===void 0?void 0:(_ruleFields$queryBar5=_ruleFields$queryBar4.query)===null||_ruleFields$queryBar5===void 0?void 0:_ruleFields$queryBar5.query,saved_id:(_ruleFields$queryBar6=ruleFields.queryBar)===null||_ruleFields$queryBar6===void 0?void 0:_ruleFields$queryBar6.saved_id,...ruleType==="threshold"&&{threshold:{field:(_ruleFields$threshold=(_ruleFields$threshold2=ruleFields.threshold)===null||_ruleFields$threshold2===void 0?void 0:_ruleFields$threshold2.field)!==null&&_ruleFields$threshold!==void 0?_ruleFields$threshold:[],value:(_parseInt=parseInt((_ruleFields$threshold3=ruleFields.threshold)===null||_ruleFields$threshold3===void 0?void 0:_ruleFields$threshold3.value,10))!==null&&_parseInt!==void 0?_parseInt:0,cardinality:!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])((_ruleFields$threshold4=ruleFields.threshold.cardinality)===null||_ruleFields$threshold4===void 0?void 0:_ruleFields$threshold4.field)&&((_ruleFields$threshold5=ruleFields.threshold.cardinality)===null||_ruleFields$threshold5===void 0?void 0:_ruleFields$threshold5.value)!=null?[{field:ruleFields.threshold.cardinality.field[0],value:parseInt(ruleFields.threshold.cardinality.value,10)}]:[]}}}:isThreatMatchFields(ruleFields)?{index:ruleFields.index,filters:(_ruleFields$queryBar7=ruleFields.queryBar)===null||_ruleFields$queryBar7===void 0?void 0:_ruleFields$queryBar7.filters,language:(_ruleFields$queryBar8=ruleFields.queryBar)===null||_ruleFields$queryBar8===void 0?void 0:(_ruleFields$queryBar9=_ruleFields$queryBar8.query)===null||_ruleFields$queryBar9===void 0?void 0:_ruleFields$queryBar9.language,query:(_ruleFields$queryBar10=ruleFields.queryBar)===null||_ruleFields$queryBar10===void 0?void 0:(_ruleFields$queryBar11=_ruleFields$queryBar10.query)===null||_ruleFields$queryBar11===void 0?void 0:_ruleFields$queryBar11.query,saved_id:(_ruleFields$queryBar12=ruleFields.queryBar)===null||_ruleFields$queryBar12===void 0?void 0:_ruleFields$queryBar12.saved_id,threat_index:ruleFields.threatIndex,threat_query:(_ruleFields$threatQue=ruleFields.threatQueryBar)===null||_ruleFields$threatQue===void 0?void 0:(_ruleFields$threatQue2=_ruleFields$threatQue.query)===null||_ruleFields$threatQue2===void 0?void 0:_ruleFields$threatQue2.query,threat_filters:(_ruleFields$threatQue3=ruleFields.threatQueryBar)===null||_ruleFields$threatQue3===void 0?void 0:_ruleFields$threatQue3.filters,threat_mapping:ruleFields.threatMapping,threat_language:(_ruleFields$threatQue4=ruleFields.threatQueryBar)===null||_ruleFields$threatQue4===void 0?void 0:(_ruleFields$threatQue5=_ruleFields$threatQue4.query)===null||_ruleFields$threatQue5===void 0?void 0:_ruleFields$threatQue5.language}:{index:ruleFields.index,filters:(_ruleFields$queryBar13=ruleFields.queryBar)===null||_ruleFields$queryBar13===void 0?void 0:_ruleFields$queryBar13.filters,language:(_ruleFields$queryBar14=ruleFields.queryBar)===null||_ruleFields$queryBar14===void 0?void 0:(_ruleFields$queryBar15=_ruleFields$queryBar14.query)===null||_ruleFields$queryBar15===void 0?void 0:_ruleFields$queryBar15.language,query:(_ruleFields$queryBar16=ruleFields.queryBar)===null||_ruleFields$queryBar16===void 0?void 0:(_ruleFields$queryBar17=_ruleFields$queryBar16.query)===null||_ruleFields$queryBar17===void 0?void 0:_ruleFields$queryBar17.query,saved_id:(_ruleFields$queryBar18=ruleFields.queryBar)===null||_ruleFields$queryBar18===void 0?void 0:_ruleFields$queryBar18.saved_id,...ruleType==="query"&&((_ruleFields$queryBar19=ruleFields.queryBar)===null||_ruleFields$queryBar19===void 0?void 0:_ruleFields$queryBar19.saved_id)&&{type:"saved_query"}};return{...baseFields,...typeFields}};const formatScheduleStepData=scheduleData=>{const{...formatScheduleData}=scheduleData;if(!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(formatScheduleData.interval)&&!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(formatScheduleData.from)){const{unit:intervalUnit,value:intervalValue}=getTimeTypeValue(formatScheduleData.interval);const{unit:fromUnit,value:fromValue}=getTimeTypeValue(formatScheduleData.from);const duration=external_kbnSharedDeps_Moment_default.a.duration(intervalValue,intervalUnit);duration.add(fromValue,fromUnit);formatScheduleData.from=`now-${duration.asSeconds()}s`;formatScheduleData.to="now"}return{...formatScheduleData,meta:{from:scheduleData.from}}};const formatAboutStepData=(aboutStepData,exceptionsList)=>{const{author:author,falsePositives:falsePositives,references:references,riskScore:riskScore,severity:severity,threat:threat,isAssociatedToEndpointList:isAssociatedToEndpointList,isBuildingBlock:isBuildingBlock,note:note,ruleNameOverride:ruleNameOverride,threatIndicatorPath:threatIndicatorPath,timestampOverride:timestampOverride,...rest}=aboutStepData;const detectionExceptionLists=exceptionsList!=null?exceptionsList.filter(list=>list.type!=="endpoint"):[];const resp={author:author.filter(item=>!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(item)),...isBuildingBlock?{building_block_type:"default"}:{},...isAssociatedToEndpointList?{exceptions_list:[{id:shared_imports["a"],list_id:shared_imports["a"],namespace_type:"agnostic",type:"endpoint"},...detectionExceptionLists]}:exceptionsList!=null?{exceptions_list:[...detectionExceptionLists]}:{},false_positives:falsePositives.filter(item=>!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(item)),references:references.filter(item=>!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(item)),risk_score:riskScore.value,risk_score_mapping:riskScore.isMappingChecked?riskScore.mapping.filter(m=>m.field!=null&&m.field!==""):[],rule_name_override:ruleNameOverride!==""?ruleNameOverride:undefined,severity:severity.value,severity_mapping:severity.isMappingChecked?severity.mapping.filter(m=>m.field!=null&&m.field!==""&&m.value!=null):[],threat:filterEmptyThreats(threat).map(singleThreat=>({...singleThreat,framework:"MITRE ATT&CK"})),threat_indicator_path:threatIndicatorPath,timestamp_override:timestampOverride!==""?timestampOverride:undefined,...!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(note)?{note:note}:{},...rest};return resp};const formatActionsStepData=actionsStepData=>{const{actions:actions=[],enabled:enabled,kibanaSiemAppUrl:kibanaSiemAppUrl,throttle:throttle=constants["X"]}=actionsStepData;return{actions:actions.map(transformAlertToRuleAction),enabled:enabled,throttle:actions.length?throttle:constants["X"],meta:{kibana_siem_app_url:kibanaSiemAppUrl}}};const formatRule=(defineStepData,aboutStepData,scheduleData,actionsData,rule)=>cjs_default.a.all([formatDefineStepData(defineStepData),formatAboutStepData(aboutStepData,rule===null||rule===void 0?void 0:rule.exceptions_list),formatScheduleStepData(scheduleData),formatActionsStepData(actionsData)]);var rules_types=__webpack_require__(250);var public_=__webpack_require__(77);const FIELD=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.threatMatch.fieldDescription",{defaultMessage:"Field"});const THREAT_FIELD=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.threatMatch.threatFieldDescription",{defaultMessage:"Indicator index field"});const FIELD_PLACEHOLDER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.threatMatch.fieldPlaceholderDescription",{defaultMessage:"Search"});const MATCHES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.threatMatch.matchesLabel",{defaultMessage:"MATCHES"});const AND=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.threatMatch.andDescription",{defaultMessage:"AND"});const OR=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.threatMatch.orDescription",{defaultMessage:"OR"});const SEVERITY=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.severityMapping.severityTitle",{defaultMessage:"Default severity"});const DEFAULT_SEVERITY=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.severityMapping.defaultSeverityTitle",{defaultMessage:"Severity"});const SOURCE_FIELD=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.severityMapping.sourceFieldTitle",{defaultMessage:"Source field"});const SOURCE_VALUE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.severityMapping.sourceValueTitle",{defaultMessage:"Source value"});const SEVERITY_MAPPING=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.severityMapping.severityMappingTitle",{defaultMessage:"Severity override"});const SEVERITY_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.severityMapping.defaultDescriptionLabel",{defaultMessage:"Select a severity level for all alerts generated by this rule."});const SEVERITY_MAPPING_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.severityMapping.mappingDescriptionLabel",{defaultMessage:"Use source event values to override the default severity."});const SEVERITY_MAPPING_DETAILS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.severityMapping.mappingDetailsLabel",{defaultMessage:"For multiple matches the highest severity match will apply. If no match is found, the default severity will be used."});const RISK_SCORE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreTitle",{defaultMessage:"Risk score"});const DEFAULT_RISK_SCORE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.riskScoreMapping.defaultRiskScoreTitle",{defaultMessage:"Default risk score"});const RISK_SCORE_FIELD=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreFieldTitle",{defaultMessage:"signal.rule.risk_score"});const translations_SOURCE_FIELD=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.riskScoreMapping.sourceFieldTitle",{defaultMessage:"Source field"});const RISK_SCORE_MAPPING=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreMappingTitle",{defaultMessage:"Risk score override"});const RISK_SCORE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.riskScoreMapping.defaultDescriptionLabel",{defaultMessage:"Select a risk score for all alerts generated by this rule."});const RISK_SCORE_MAPPING_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDescriptionLabel",{defaultMessage:"Use a source event value to override the default risk score."});const RISK_SCORE_MAPPING_DETAILS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDetailsLabel",{defaultMessage:"If value is out of bounds, or field is not present, the default risk score will be used."});const tactics=[{name:"Collection",id:"TA0009",reference:"https://attack.mitre.org/tactics/TA0009"},{name:"Command and Control",id:"TA0011",reference:"https://attack.mitre.org/tactics/TA0011"},{name:"Credential Access",id:"TA0006",reference:"https://attack.mitre.org/tactics/TA0006"},{name:"Defense Evasion",id:"TA0005",reference:"https://attack.mitre.org/tactics/TA0005"},{name:"Discovery",id:"TA0007",reference:"https://attack.mitre.org/tactics/TA0007"},{name:"Execution",id:"TA0002",reference:"https://attack.mitre.org/tactics/TA0002"},{name:"Exfiltration",id:"TA0010",reference:"https://attack.mitre.org/tactics/TA0010"},{name:"Impact",id:"TA0040",reference:"https://attack.mitre.org/tactics/TA0040"},{name:"Initial Access",id:"TA0001",reference:"https://attack.mitre.org/tactics/TA0001"},{name:"Lateral Movement",id:"TA0008",reference:"https://attack.mitre.org/tactics/TA0008"},{name:"Persistence",id:"TA0003",reference:"https://attack.mitre.org/tactics/TA0003"},{name:"Privilege Escalation",id:"TA0004",reference:"https://attack.mitre.org/tactics/TA0004"},{name:"Reconnaissance",id:"TA0043",reference:"https://attack.mitre.org/tactics/TA0043"},{name:"Resource Development",id:"TA0042",reference:"https://attack.mitre.org/tactics/TA0042"}];const tacticsOptions=[{id:"TA0009",name:"Collection",reference:"https://attack.mitre.org/tactics/TA0009",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.collectionDescription",{defaultMessage:"Collection (TA0009)"}),value:"collection"},{id:"TA0011",name:"Command and Control",reference:"https://attack.mitre.org/tactics/TA0011",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.commandAndControlDescription",{defaultMessage:"Command and Control (TA0011)"}),value:"commandAndControl"},{id:"TA0006",name:"Credential Access",reference:"https://attack.mitre.org/tactics/TA0006",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.credentialAccessDescription",{defaultMessage:"Credential Access (TA0006)"}),value:"credentialAccess"},{id:"TA0005",name:"Defense Evasion",reference:"https://attack.mitre.org/tactics/TA0005",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.defenseEvasionDescription",{defaultMessage:"Defense Evasion (TA0005)"}),value:"defenseEvasion"},{id:"TA0007",name:"Discovery",reference:"https://attack.mitre.org/tactics/TA0007",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.discoveryDescription",{defaultMessage:"Discovery (TA0007)"}),value:"discovery"},{id:"TA0002",name:"Execution",reference:"https://attack.mitre.org/tactics/TA0002",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.executionDescription",{defaultMessage:"Execution (TA0002)"}),value:"execution"},{id:"TA0010",name:"Exfiltration",reference:"https://attack.mitre.org/tactics/TA0010",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.exfiltrationDescription",{defaultMessage:"Exfiltration (TA0010)"}),value:"exfiltration"},{id:"TA0040",name:"Impact",reference:"https://attack.mitre.org/tactics/TA0040",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.impactDescription",{defaultMessage:"Impact (TA0040)"}),value:"impact"},{id:"TA0001",name:"Initial Access",reference:"https://attack.mitre.org/tactics/TA0001",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.initialAccessDescription",{defaultMessage:"Initial Access (TA0001)"}),value:"initialAccess"},{id:"TA0008",name:"Lateral Movement",reference:"https://attack.mitre.org/tactics/TA0008",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.lateralMovementDescription",{defaultMessage:"Lateral Movement (TA0008)"}),value:"lateralMovement"},{id:"TA0003",name:"Persistence",reference:"https://attack.mitre.org/tactics/TA0003",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.persistenceDescription",{defaultMessage:"Persistence (TA0003)"}),value:"persistence"},{id:"TA0004",name:"Privilege Escalation",reference:"https://attack.mitre.org/tactics/TA0004",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.privilegeEscalationDescription",{defaultMessage:"Privilege Escalation (TA0004)"}),value:"privilegeEscalation"},{id:"TA0043",name:"Reconnaissance",reference:"https://attack.mitre.org/tactics/TA0043",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.reconnaissanceDescription",{defaultMessage:"Reconnaissance (TA0043)"}),value:"reconnaissance"},{id:"TA0042",name:"Resource Development",reference:"https://attack.mitre.org/tactics/TA0042",text:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.resourceDevelopmentDescription",{defaultMessage:"Resource Development (TA0042)"}),value:"resourceDevelopment"}];const mitre_tactics_techniques_technique=[{name:"Abuse Elevation Control Mechanism",id:"T1548",reference:"https://attack.mitre.org/techniques/T1548",tactics:["privilege-escalation","defense-evasion"]},{name:"Access Token Manipulation",id:"T1134",reference:"https://attack.mitre.org/techniques/T1134",tactics:["defense-evasion","privilege-escalation"]},{name:"Account Access Removal",id:"T1531",reference:"https://attack.mitre.org/techniques/T1531",tactics:["impact"]},{name:"Account Discovery",id:"T1087",reference:"https://attack.mitre.org/techniques/T1087",tactics:["discovery"]},{name:"Account Manipulation",id:"T1098",reference:"https://attack.mitre.org/techniques/T1098",tactics:["persistence"]},{name:"Acquire Infrastructure",id:"T1583",reference:"https://attack.mitre.org/techniques/T1583",tactics:["resource-development"]},{name:"Active Scanning",id:"T1595",reference:"https://attack.mitre.org/techniques/T1595",tactics:["reconnaissance"]},{name:"Application Layer Protocol",id:"T1071",reference:"https://attack.mitre.org/techniques/T1071",tactics:["command-and-control"]},{name:"Application Window Discovery",id:"T1010",reference:"https://attack.mitre.org/techniques/T1010",tactics:["discovery"]},{name:"Archive Collected Data",id:"T1560",reference:"https://attack.mitre.org/techniques/T1560",tactics:["collection"]},{name:"Audio Capture",id:"T1123",reference:"https://attack.mitre.org/techniques/T1123",tactics:["collection"]},{name:"Automated Collection",id:"T1119",reference:"https://attack.mitre.org/techniques/T1119",tactics:["collection"]},{name:"Automated Exfiltration",id:"T1020",reference:"https://attack.mitre.org/techniques/T1020",tactics:["exfiltration"]},{name:"BITS Jobs",id:"T1197",reference:"https://attack.mitre.org/techniques/T1197",tactics:["defense-evasion","persistence"]},{name:"Boot or Logon Autostart Execution",id:"T1547",reference:"https://attack.mitre.org/techniques/T1547",tactics:["persistence","privilege-escalation"]},{name:"Boot or Logon Initialization Scripts",id:"T1037",reference:"https://attack.mitre.org/techniques/T1037",tactics:["persistence","privilege-escalation"]},{name:"Browser Bookmark Discovery",id:"T1217",reference:"https://attack.mitre.org/techniques/T1217",tactics:["discovery"]},{name:"Browser Extensions",id:"T1176",reference:"https://attack.mitre.org/techniques/T1176",tactics:["persistence"]},{name:"Brute Force",id:"T1110",reference:"https://attack.mitre.org/techniques/T1110",tactics:["credential-access"]},{name:"Clipboard Data",id:"T1115",reference:"https://attack.mitre.org/techniques/T1115",tactics:["collection"]},{name:"Cloud Infrastructure Discovery",id:"T1580",reference:"https://attack.mitre.org/techniques/T1580",tactics:["discovery"]},{name:"Cloud Service Dashboard",id:"T1538",reference:"https://attack.mitre.org/techniques/T1538",tactics:["discovery"]},{name:"Cloud Service Discovery",id:"T1526",reference:"https://attack.mitre.org/techniques/T1526",tactics:["discovery"]},{name:"Command and Scripting Interpreter",id:"T1059",reference:"https://attack.mitre.org/techniques/T1059",tactics:["execution"]},{name:"Commonly Used Port",id:"T1043",reference:"https://attack.mitre.org/techniques/T1043",tactics:["command-and-control"]},{name:"Communication Through Removable Media",id:"T1092",reference:"https://attack.mitre.org/techniques/T1092",tactics:["command-and-control"]},{name:"Component Object Model and Distributed COM",id:"T1175",reference:"https://attack.mitre.org/techniques/T1175",tactics:["lateral-movement","execution"]},{name:"Compromise Accounts",id:"T1586",reference:"https://attack.mitre.org/techniques/T1586",tactics:["resource-development"]},{name:"Compromise Client Software Binary",id:"T1554",reference:"https://attack.mitre.org/techniques/T1554",tactics:["persistence"]},{name:"Compromise Infrastructure",id:"T1584",reference:"https://attack.mitre.org/techniques/T1584",tactics:["resource-development"]},{name:"Create Account",id:"T1136",reference:"https://attack.mitre.org/techniques/T1136",tactics:["persistence"]},{name:"Create or Modify System Process",id:"T1543",reference:"https://attack.mitre.org/techniques/T1543",tactics:["persistence","privilege-escalation"]},{name:"Credentials from Password Stores",id:"T1555",reference:"https://attack.mitre.org/techniques/T1555",tactics:["credential-access"]},{name:"Data Destruction",id:"T1485",reference:"https://attack.mitre.org/techniques/T1485",tactics:["impact"]},{name:"Data Encoding",id:"T1132",reference:"https://attack.mitre.org/techniques/T1132",tactics:["command-and-control"]},{name:"Data Encrypted for Impact",id:"T1486",reference:"https://attack.mitre.org/techniques/T1486",tactics:["impact"]},{name:"Data Manipulation",id:"T1565",reference:"https://attack.mitre.org/techniques/T1565",tactics:["impact"]},{name:"Data Obfuscation",id:"T1001",reference:"https://attack.mitre.org/techniques/T1001",tactics:["command-and-control"]},{name:"Data Staged",id:"T1074",reference:"https://attack.mitre.org/techniques/T1074",tactics:["collection"]},{name:"Data Transfer Size Limits",id:"T1030",reference:"https://attack.mitre.org/techniques/T1030",tactics:["exfiltration"]},{name:"Data from Cloud Storage Object",id:"T1530",reference:"https://attack.mitre.org/techniques/T1530",tactics:["collection"]},{name:"Data from Configuration Repository",id:"T1602",reference:"https://attack.mitre.org/techniques/T1602",tactics:["collection"]},{name:"Data from Information Repositories",id:"T1213",reference:"https://attack.mitre.org/techniques/T1213",tactics:["collection"]},{name:"Data from Local System",id:"T1005",reference:"https://attack.mitre.org/techniques/T1005",tactics:["collection"]},{name:"Data from Network Shared Drive",id:"T1039",reference:"https://attack.mitre.org/techniques/T1039",tactics:["collection"]},{name:"Data from Removable Media",id:"T1025",reference:"https://attack.mitre.org/techniques/T1025",tactics:["collection"]},{name:"Defacement",id:"T1491",reference:"https://attack.mitre.org/techniques/T1491",tactics:["impact"]},{name:"Deobfuscate/Decode Files or Information",id:"T1140",reference:"https://attack.mitre.org/techniques/T1140",tactics:["defense-evasion"]},{name:"Develop Capabilities",id:"T1587",reference:"https://attack.mitre.org/techniques/T1587",tactics:["resource-development"]},{name:"Direct Volume Access",id:"T1006",reference:"https://attack.mitre.org/techniques/T1006",tactics:["defense-evasion"]},{name:"Disk Wipe",id:"T1561",reference:"https://attack.mitre.org/techniques/T1561",tactics:["impact"]},{name:"Domain Trust Discovery",id:"T1482",reference:"https://attack.mitre.org/techniques/T1482",tactics:["discovery"]},{name:"Drive-by Compromise",id:"T1189",reference:"https://attack.mitre.org/techniques/T1189",tactics:["initial-access"]},{name:"Dynamic Resolution",id:"T1568",reference:"https://attack.mitre.org/techniques/T1568",tactics:["command-and-control"]},{name:"Email Collection",id:"T1114",reference:"https://attack.mitre.org/techniques/T1114",tactics:["collection"]},{name:"Encrypted Channel",id:"T1573",reference:"https://attack.mitre.org/techniques/T1573",tactics:["command-and-control"]},{name:"Endpoint Denial of Service",id:"T1499",reference:"https://attack.mitre.org/techniques/T1499",tactics:["impact"]},{name:"Establish Accounts",id:"T1585",reference:"https://attack.mitre.org/techniques/T1585",tactics:["resource-development"]},{name:"Event Triggered Execution",id:"T1546",reference:"https://attack.mitre.org/techniques/T1546",tactics:["privilege-escalation","persistence"]},{name:"Execution Guardrails",id:"T1480",reference:"https://attack.mitre.org/techniques/T1480",tactics:["defense-evasion"]},{name:"Exfiltration Over Alternative Protocol",id:"T1048",reference:"https://attack.mitre.org/techniques/T1048",tactics:["exfiltration"]},{name:"Exfiltration Over C2 Channel",id:"T1041",reference:"https://attack.mitre.org/techniques/T1041",tactics:["exfiltration"]},{name:"Exfiltration Over Other Network Medium",id:"T1011",reference:"https://attack.mitre.org/techniques/T1011",tactics:["exfiltration"]},{name:"Exfiltration Over Physical Medium",id:"T1052",reference:"https://attack.mitre.org/techniques/T1052",tactics:["exfiltration"]},{name:"Exfiltration Over Web Service",id:"T1567",reference:"https://attack.mitre.org/techniques/T1567",tactics:["exfiltration"]},{name:"Exploit Public-Facing Application",id:"T1190",reference:"https://attack.mitre.org/techniques/T1190",tactics:["initial-access"]},{name:"Exploitation for Client Execution",id:"T1203",reference:"https://attack.mitre.org/techniques/T1203",tactics:["execution"]},{name:"Exploitation for Credential Access",id:"T1212",reference:"https://attack.mitre.org/techniques/T1212",tactics:["credential-access"]},{name:"Exploitation for Defense Evasion",id:"T1211",reference:"https://attack.mitre.org/techniques/T1211",tactics:["defense-evasion"]},{name:"Exploitation for Privilege Escalation",id:"T1068",reference:"https://attack.mitre.org/techniques/T1068",tactics:["privilege-escalation"]},{name:"Exploitation of Remote Services",id:"T1210",reference:"https://attack.mitre.org/techniques/T1210",tactics:["lateral-movement"]},{name:"External Remote Services",id:"T1133",reference:"https://attack.mitre.org/techniques/T1133",tactics:["persistence","initial-access"]},{name:"Fallback Channels",id:"T1008",reference:"https://attack.mitre.org/techniques/T1008",tactics:["command-and-control"]},{name:"File and Directory Discovery",id:"T1083",reference:"https://attack.mitre.org/techniques/T1083",tactics:["discovery"]},{name:"File and Directory Permissions Modification",id:"T1222",reference:"https://attack.mitre.org/techniques/T1222",tactics:["defense-evasion"]},{name:"Firmware Corruption",id:"T1495",reference:"https://attack.mitre.org/techniques/T1495",tactics:["impact"]},{name:"Forced Authentication",id:"T1187",reference:"https://attack.mitre.org/techniques/T1187",tactics:["credential-access"]},{name:"Gather Victim Host Information",id:"T1592",reference:"https://attack.mitre.org/techniques/T1592",tactics:["reconnaissance"]},{name:"Gather Victim Identity Information",id:"T1589",reference:"https://attack.mitre.org/techniques/T1589",tactics:["reconnaissance"]},{name:"Gather Victim Network Information",id:"T1590",reference:"https://attack.mitre.org/techniques/T1590",tactics:["reconnaissance"]},{name:"Gather Victim Org Information",id:"T1591",reference:"https://attack.mitre.org/techniques/T1591",tactics:["reconnaissance"]},{name:"Graphical User Interface",id:"T1061",reference:"https://attack.mitre.org/techniques/T1061",tactics:["execution"]},{name:"Group Policy Modification",id:"T1484",reference:"https://attack.mitre.org/techniques/T1484",tactics:["defense-evasion","privilege-escalation"]},{name:"Hardware Additions",id:"T1200",reference:"https://attack.mitre.org/techniques/T1200",tactics:["initial-access"]},{name:"Hide Artifacts",id:"T1564",reference:"https://attack.mitre.org/techniques/T1564",tactics:["defense-evasion"]},{name:"Hijack Execution Flow",id:"T1574",reference:"https://attack.mitre.org/techniques/T1574",tactics:["persistence","privilege-escalation","defense-evasion"]},{name:"Hypervisor",id:"T1062",reference:"https://attack.mitre.org/techniques/T1062",tactics:["persistence"]},{name:"Impair Defenses",id:"T1562",reference:"https://attack.mitre.org/techniques/T1562",tactics:["defense-evasion"]},{name:"Implant Container Image",id:"T1525",reference:"https://attack.mitre.org/techniques/T1525",tactics:["persistence"]},{name:"Indicator Removal on Host",id:"T1070",reference:"https://attack.mitre.org/techniques/T1070",tactics:["defense-evasion"]},{name:"Indirect Command Execution",id:"T1202",reference:"https://attack.mitre.org/techniques/T1202",tactics:["defense-evasion"]},{name:"Ingress Tool Transfer",id:"T1105",reference:"https://attack.mitre.org/techniques/T1105",tactics:["command-and-control"]},{name:"Inhibit System Recovery",id:"T1490",reference:"https://attack.mitre.org/techniques/T1490",tactics:["impact"]},{name:"Input Capture",id:"T1056",reference:"https://attack.mitre.org/techniques/T1056",tactics:["collection","credential-access"]},{name:"Inter-Process Communication",id:"T1559",reference:"https://attack.mitre.org/techniques/T1559",tactics:["execution"]},{name:"Internal Spearphishing",id:"T1534",reference:"https://attack.mitre.org/techniques/T1534",tactics:["lateral-movement"]},{name:"LC_MAIN Hijacking",id:"T1149",reference:"https://attack.mitre.org/techniques/T1149",tactics:["defense-evasion"]},{name:"Lateral Tool Transfer",id:"T1570",reference:"https://attack.mitre.org/techniques/T1570",tactics:["lateral-movement"]},{name:"Man in the Browser",id:"T1185",reference:"https://attack.mitre.org/techniques/T1185",tactics:["collection"]},{name:"Man-in-the-Middle",id:"T1557",reference:"https://attack.mitre.org/techniques/T1557",tactics:["credential-access","collection"]},{name:"Masquerading",id:"T1036",reference:"https://attack.mitre.org/techniques/T1036",tactics:["defense-evasion"]},{name:"Modify Authentication Process",id:"T1556",reference:"https://attack.mitre.org/techniques/T1556",tactics:["credential-access","defense-evasion"]},{name:"Modify Cloud Compute Infrastructure",id:"T1578",reference:"https://attack.mitre.org/techniques/T1578",tactics:["defense-evasion"]},{name:"Modify Registry",id:"T1112",reference:"https://attack.mitre.org/techniques/T1112",tactics:["defense-evasion"]},{name:"Modify System Image",id:"T1601",reference:"https://attack.mitre.org/techniques/T1601",tactics:["defense-evasion"]},{name:"Multi-Stage Channels",id:"T1104",reference:"https://attack.mitre.org/techniques/T1104",tactics:["command-and-control"]},{name:"Multiband Communication",id:"T1026",reference:"https://attack.mitre.org/techniques/T1026",tactics:["command-and-control"]},{name:"Native API",id:"T1106",reference:"https://attack.mitre.org/techniques/T1106",tactics:["execution"]},{name:"Network Boundary Bridging",id:"T1599",reference:"https://attack.mitre.org/techniques/T1599",tactics:["defense-evasion"]},{name:"Network Denial of Service",id:"T1498",reference:"https://attack.mitre.org/techniques/T1498",tactics:["impact"]},{name:"Network Service Scanning",id:"T1046",reference:"https://attack.mitre.org/techniques/T1046",tactics:["discovery"]},{name:"Network Share Discovery",id:"T1135",reference:"https://attack.mitre.org/techniques/T1135",tactics:["discovery"]},{name:"Network Sniffing",id:"T1040",reference:"https://attack.mitre.org/techniques/T1040",tactics:["credential-access","discovery"]},{name:"Non-Application Layer Protocol",id:"T1095",reference:"https://attack.mitre.org/techniques/T1095",tactics:["command-and-control"]},{name:"Non-Standard Port",id:"T1571",reference:"https://attack.mitre.org/techniques/T1571",tactics:["command-and-control"]},{name:"OS Credential Dumping",id:"T1003",reference:"https://attack.mitre.org/techniques/T1003",tactics:["credential-access"]},{name:"Obfuscated Files or Information",id:"T1027",reference:"https://attack.mitre.org/techniques/T1027",tactics:["defense-evasion"]},{name:"Obtain Capabilities",id:"T1588",reference:"https://attack.mitre.org/techniques/T1588",tactics:["resource-development"]},{name:"Office Application Startup",id:"T1137",reference:"https://attack.mitre.org/techniques/T1137",tactics:["persistence"]},{name:"Password Policy Discovery",id:"T1201",reference:"https://attack.mitre.org/techniques/T1201",tactics:["discovery"]},{name:"Path Interception",id:"T1034",reference:"https://attack.mitre.org/techniques/T1034",tactics:["persistence","privilege-escalation"]},{name:"Peripheral Device Discovery",id:"T1120",reference:"https://attack.mitre.org/techniques/T1120",tactics:["discovery"]},{name:"Permission Groups Discovery",id:"T1069",reference:"https://attack.mitre.org/techniques/T1069",tactics:["discovery"]},{name:"Phishing",id:"T1566",reference:"https://attack.mitre.org/techniques/T1566",tactics:["initial-access"]},{name:"Phishing for Information",id:"T1598",reference:"https://attack.mitre.org/techniques/T1598",tactics:["reconnaissance"]},{name:"Pre-OS Boot",id:"T1542",reference:"https://attack.mitre.org/techniques/T1542",tactics:["defense-evasion","persistence"]},{name:"Process Discovery",id:"T1057",reference:"https://attack.mitre.org/techniques/T1057",tactics:["discovery"]},{name:"Process Injection",id:"T1055",reference:"https://attack.mitre.org/techniques/T1055",tactics:["defense-evasion","privilege-escalation"]},{name:"Protocol Tunneling",id:"T1572",reference:"https://attack.mitre.org/techniques/T1572",tactics:["command-and-control"]},{name:"Proxy",id:"T1090",reference:"https://attack.mitre.org/techniques/T1090",tactics:["command-and-control"]},{name:"Query Registry",id:"T1012",reference:"https://attack.mitre.org/techniques/T1012",tactics:["discovery"]},{name:"Redundant Access",id:"T1108",reference:"https://attack.mitre.org/techniques/T1108",tactics:["defense-evasion","persistence"]},{name:"Remote Access Software",id:"T1219",reference:"https://attack.mitre.org/techniques/T1219",tactics:["command-and-control"]},{name:"Remote Service Session Hijacking",id:"T1563",reference:"https://attack.mitre.org/techniques/T1563",tactics:["lateral-movement"]},{name:"Remote Services",id:"T1021",reference:"https://attack.mitre.org/techniques/T1021",tactics:["lateral-movement"]},{name:"Remote System Discovery",id:"T1018",reference:"https://attack.mitre.org/techniques/T1018",tactics:["discovery"]},{name:"Replication Through Removable Media",id:"T1091",reference:"https://attack.mitre.org/techniques/T1091",tactics:["lateral-movement","initial-access"]},{name:"Resource Hijacking",id:"T1496",reference:"https://attack.mitre.org/techniques/T1496",tactics:["impact"]},{name:"Rogue Domain Controller",id:"T1207",reference:"https://attack.mitre.org/techniques/T1207",tactics:["defense-evasion"]},{name:"Rootkit",id:"T1014",reference:"https://attack.mitre.org/techniques/T1014",tactics:["defense-evasion"]},{name:"Scheduled Task/Job",id:"T1053",reference:"https://attack.mitre.org/techniques/T1053",tactics:["execution","persistence","privilege-escalation"]},{name:"Scheduled Transfer",id:"T1029",reference:"https://attack.mitre.org/techniques/T1029",tactics:["exfiltration"]},{name:"Screen Capture",id:"T1113",reference:"https://attack.mitre.org/techniques/T1113",tactics:["collection"]},{name:"Scripting",id:"T1064",reference:"https://attack.mitre.org/techniques/T1064",tactics:["defense-evasion","execution"]},{name:"Search Closed Sources",id:"T1597",reference:"https://attack.mitre.org/techniques/T1597",tactics:["reconnaissance"]},{name:"Search Open Technical Databases",id:"T1596",reference:"https://attack.mitre.org/techniques/T1596",tactics:["reconnaissance"]},{name:"Search Open Websites/Domains",id:"T1593",reference:"https://attack.mitre.org/techniques/T1593",tactics:["reconnaissance"]},{name:"Search Victim-Owned Websites",id:"T1594",reference:"https://attack.mitre.org/techniques/T1594",tactics:["reconnaissance"]},{name:"Server Software Component",id:"T1505",reference:"https://attack.mitre.org/techniques/T1505",tactics:["persistence"]},{name:"Service Stop",id:"T1489",reference:"https://attack.mitre.org/techniques/T1489",tactics:["impact"]},{name:"Shared Modules",id:"T1129",reference:"https://attack.mitre.org/techniques/T1129",tactics:["execution"]},{name:"Shared Webroot",id:"T1051",reference:"https://attack.mitre.org/techniques/T1051",tactics:["lateral-movement"]},{name:"Signed Binary Proxy Execution",id:"T1218",reference:"https://attack.mitre.org/techniques/T1218",tactics:["defense-evasion"]},{name:"Signed Script Proxy Execution",id:"T1216",reference:"https://attack.mitre.org/techniques/T1216",tactics:["defense-evasion"]},{name:"Software Deployment Tools",id:"T1072",reference:"https://attack.mitre.org/techniques/T1072",tactics:["execution","lateral-movement"]},{name:"Software Discovery",id:"T1518",reference:"https://attack.mitre.org/techniques/T1518",tactics:["discovery"]},{name:"Source",id:"T1153",reference:"https://attack.mitre.org/techniques/T1153",tactics:["execution"]},{name:"Steal Application Access Token",id:"T1528",reference:"https://attack.mitre.org/techniques/T1528",tactics:["credential-access"]},{name:"Steal Web Session Cookie",id:"T1539",reference:"https://attack.mitre.org/techniques/T1539",tactics:["credential-access"]},{name:"Steal or Forge Kerberos Tickets",id:"T1558",reference:"https://attack.mitre.org/techniques/T1558",tactics:["credential-access"]},{name:"Subvert Trust Controls",id:"T1553",reference:"https://attack.mitre.org/techniques/T1553",tactics:["defense-evasion"]},{name:"Supply Chain Compromise",id:"T1195",reference:"https://attack.mitre.org/techniques/T1195",tactics:["initial-access"]},{name:"System Information Discovery",id:"T1082",reference:"https://attack.mitre.org/techniques/T1082",tactics:["discovery"]},{name:"System Network Configuration Discovery",id:"T1016",reference:"https://attack.mitre.org/techniques/T1016",tactics:["discovery"]},{name:"System Network Connections Discovery",id:"T1049",reference:"https://attack.mitre.org/techniques/T1049",tactics:["discovery"]},{name:"System Owner/User Discovery",id:"T1033",reference:"https://attack.mitre.org/techniques/T1033",tactics:["discovery"]},{name:"System Service Discovery",id:"T1007",reference:"https://attack.mitre.org/techniques/T1007",tactics:["discovery"]},{name:"System Services",id:"T1569",reference:"https://attack.mitre.org/techniques/T1569",tactics:["execution"]},{name:"System Shutdown/Reboot",id:"T1529",reference:"https://attack.mitre.org/techniques/T1529",tactics:["impact"]},{name:"System Time Discovery",id:"T1124",reference:"https://attack.mitre.org/techniques/T1124",tactics:["discovery"]},{name:"Taint Shared Content",id:"T1080",reference:"https://attack.mitre.org/techniques/T1080",tactics:["lateral-movement"]},{name:"Template Injection",id:"T1221",reference:"https://attack.mitre.org/techniques/T1221",tactics:["defense-evasion"]},{name:"Traffic Signaling",id:"T1205",reference:"https://attack.mitre.org/techniques/T1205",tactics:["defense-evasion","persistence","command-and-control"]},{name:"Transfer Data to Cloud Account",id:"T1537",reference:"https://attack.mitre.org/techniques/T1537",tactics:["exfiltration"]},{name:"Trusted Developer Utilities Proxy Execution",id:"T1127",reference:"https://attack.mitre.org/techniques/T1127",tactics:["defense-evasion"]},{name:"Trusted Relationship",id:"T1199",reference:"https://attack.mitre.org/techniques/T1199",tactics:["initial-access"]},{name:"Two-Factor Authentication Interception",id:"T1111",reference:"https://attack.mitre.org/techniques/T1111",tactics:["credential-access"]},{name:"Unsecured Credentials",id:"T1552",reference:"https://attack.mitre.org/techniques/T1552",tactics:["credential-access"]},{name:"Unused/Unsupported Cloud Regions",id:"T1535",reference:"https://attack.mitre.org/techniques/T1535",tactics:["defense-evasion"]},{name:"Use Alternate Authentication Material",id:"T1550",reference:"https://attack.mitre.org/techniques/T1550",tactics:["defense-evasion","lateral-movement"]},{name:"User Execution",id:"T1204",reference:"https://attack.mitre.org/techniques/T1204",tactics:["execution"]},{name:"Valid Accounts",id:"T1078",reference:"https://attack.mitre.org/techniques/T1078",tactics:["defense-evasion","persistence","privilege-escalation","initial-access"]},{name:"Video Capture",id:"T1125",reference:"https://attack.mitre.org/techniques/T1125",tactics:["collection"]},{name:"Virtualization/Sandbox Evasion",id:"T1497",reference:"https://attack.mitre.org/techniques/T1497",tactics:["defense-evasion","discovery"]},{name:"Weaken Encryption",id:"T1600",reference:"https://attack.mitre.org/techniques/T1600",tactics:["defense-evasion"]},{name:"Web Service",id:"T1102",reference:"https://attack.mitre.org/techniques/T1102",tactics:["command-and-control"]},{name:"Windows Management Instrumentation",id:"T1047",reference:"https://attack.mitre.org/techniques/T1047",tactics:["execution"]},{name:"XSL Script Processing",id:"T1220",reference:"https://attack.mitre.org/techniques/T1220",tactics:["defense-evasion"]}];const techniquesOptions=[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.abuseElevationControlMechanismDescription",{defaultMessage:"Abuse Elevation Control Mechanism (T1548)"}),id:"T1548",name:"Abuse Elevation Control Mechanism",reference:"https://attack.mitre.org/techniques/T1548",tactics:"privilege-escalation,defense-evasion",value:"abuseElevationControlMechanism"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accessTokenManipulationDescription",{defaultMessage:"Access Token Manipulation (T1134)"}),id:"T1134",name:"Access Token Manipulation",reference:"https://attack.mitre.org/techniques/T1134",tactics:"defense-evasion,privilege-escalation",value:"accessTokenManipulation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accountAccessRemovalDescription",{defaultMessage:"Account Access Removal (T1531)"}),id:"T1531",name:"Account Access Removal",reference:"https://attack.mitre.org/techniques/T1531",tactics:"impact",value:"accountAccessRemoval"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accountDiscoveryDescription",{defaultMessage:"Account Discovery (T1087)"}),id:"T1087",name:"Account Discovery",reference:"https://attack.mitre.org/techniques/T1087",tactics:"discovery",value:"accountDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accountManipulationDescription",{defaultMessage:"Account Manipulation (T1098)"}),id:"T1098",name:"Account Manipulation",reference:"https://attack.mitre.org/techniques/T1098",tactics:"persistence",value:"accountManipulation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.acquireInfrastructureDescription",{defaultMessage:"Acquire Infrastructure (T1583)"}),id:"T1583",name:"Acquire Infrastructure",reference:"https://attack.mitre.org/techniques/T1583",tactics:"resource-development",value:"acquireInfrastructure"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.activeScanningDescription",{defaultMessage:"Active Scanning (T1595)"}),id:"T1595",name:"Active Scanning",reference:"https://attack.mitre.org/techniques/T1595",tactics:"reconnaissance",value:"activeScanning"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.applicationLayerProtocolDescription",{defaultMessage:"Application Layer Protocol (T1071)"}),id:"T1071",name:"Application Layer Protocol",reference:"https://attack.mitre.org/techniques/T1071",tactics:"command-and-control",value:"applicationLayerProtocol"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.applicationWindowDiscoveryDescription",{defaultMessage:"Application Window Discovery (T1010)"}),id:"T1010",name:"Application Window Discovery",reference:"https://attack.mitre.org/techniques/T1010",tactics:"discovery",value:"applicationWindowDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.archiveCollectedDataDescription",{defaultMessage:"Archive Collected Data (T1560)"}),id:"T1560",name:"Archive Collected Data",reference:"https://attack.mitre.org/techniques/T1560",tactics:"collection",value:"archiveCollectedData"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.audioCaptureDescription",{defaultMessage:"Audio Capture (T1123)"}),id:"T1123",name:"Audio Capture",reference:"https://attack.mitre.org/techniques/T1123",tactics:"collection",value:"audioCapture"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.automatedCollectionDescription",{defaultMessage:"Automated Collection (T1119)"}),id:"T1119",name:"Automated Collection",reference:"https://attack.mitre.org/techniques/T1119",tactics:"collection",value:"automatedCollection"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.automatedExfiltrationDescription",{defaultMessage:"Automated Exfiltration (T1020)"}),id:"T1020",name:"Automated Exfiltration",reference:"https://attack.mitre.org/techniques/T1020",tactics:"exfiltration",value:"automatedExfiltration"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bitsJobsDescription",{defaultMessage:"BITS Jobs (T1197)"}),id:"T1197",name:"BITS Jobs",reference:"https://attack.mitre.org/techniques/T1197",tactics:"defense-evasion,persistence",value:"bitsJobs"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bootOrLogonAutostartExecutionDescription",{defaultMessage:"Boot or Logon Autostart Execution (T1547)"}),id:"T1547",name:"Boot or Logon Autostart Execution",reference:"https://attack.mitre.org/techniques/T1547",tactics:"persistence,privilege-escalation",value:"bootOrLogonAutostartExecution"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bootOrLogonInitializationScriptsDescription",{defaultMessage:"Boot or Logon Initialization Scripts (T1037)"}),id:"T1037",name:"Boot or Logon Initialization Scripts",reference:"https://attack.mitre.org/techniques/T1037",tactics:"persistence,privilege-escalation",value:"bootOrLogonInitializationScripts"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.browserBookmarkDiscoveryDescription",{defaultMessage:"Browser Bookmark Discovery (T1217)"}),id:"T1217",name:"Browser Bookmark Discovery",reference:"https://attack.mitre.org/techniques/T1217",tactics:"discovery",value:"browserBookmarkDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.browserExtensionsDescription",{defaultMessage:"Browser Extensions (T1176)"}),id:"T1176",name:"Browser Extensions",reference:"https://attack.mitre.org/techniques/T1176",tactics:"persistence",value:"browserExtensions"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bruteForceDescription",{defaultMessage:"Brute Force (T1110)"}),id:"T1110",name:"Brute Force",reference:"https://attack.mitre.org/techniques/T1110",tactics:"credential-access",value:"bruteForce"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.clipboardDataDescription",{defaultMessage:"Clipboard Data (T1115)"}),id:"T1115",name:"Clipboard Data",reference:"https://attack.mitre.org/techniques/T1115",tactics:"collection",value:"clipboardData"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cloudInfrastructureDiscoveryDescription",{defaultMessage:"Cloud Infrastructure Discovery (T1580)"}),id:"T1580",name:"Cloud Infrastructure Discovery",reference:"https://attack.mitre.org/techniques/T1580",tactics:"discovery",value:"cloudInfrastructureDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cloudServiceDashboardDescription",{defaultMessage:"Cloud Service Dashboard (T1538)"}),id:"T1538",name:"Cloud Service Dashboard",reference:"https://attack.mitre.org/techniques/T1538",tactics:"discovery",value:"cloudServiceDashboard"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cloudServiceDiscoveryDescription",{defaultMessage:"Cloud Service Discovery (T1526)"}),id:"T1526",name:"Cloud Service Discovery",reference:"https://attack.mitre.org/techniques/T1526",tactics:"discovery",value:"cloudServiceDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.commandAndScriptingInterpreterDescription",{defaultMessage:"Command and Scripting Interpreter (T1059)"}),id:"T1059",name:"Command and Scripting Interpreter",reference:"https://attack.mitre.org/techniques/T1059",tactics:"execution",value:"commandAndScriptingInterpreter"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.commonlyUsedPortDescription",{defaultMessage:"Commonly Used Port (T1043)"}),id:"T1043",name:"Commonly Used Port",reference:"https://attack.mitre.org/techniques/T1043",tactics:"command-and-control",value:"commonlyUsedPort"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.communicationThroughRemovableMediaDescription",{defaultMessage:"Communication Through Removable Media (T1092)"}),id:"T1092",name:"Communication Through Removable Media",reference:"https://attack.mitre.org/techniques/T1092",tactics:"command-and-control",value:"communicationThroughRemovableMedia"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.componentObjectModelAndDistributedComDescription",{defaultMessage:"Component Object Model and Distributed COM (T1175)"}),id:"T1175",name:"Component Object Model and Distributed COM",reference:"https://attack.mitre.org/techniques/T1175",tactics:"lateral-movement,execution",value:"componentObjectModelAndDistributedCom"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.compromiseAccountsDescription",{defaultMessage:"Compromise Accounts (T1586)"}),id:"T1586",name:"Compromise Accounts",reference:"https://attack.mitre.org/techniques/T1586",tactics:"resource-development",value:"compromiseAccounts"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.compromiseClientSoftwareBinaryDescription",{defaultMessage:"Compromise Client Software Binary (T1554)"}),id:"T1554",name:"Compromise Client Software Binary",reference:"https://attack.mitre.org/techniques/T1554",tactics:"persistence",value:"compromiseClientSoftwareBinary"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.compromiseInfrastructureDescription",{defaultMessage:"Compromise Infrastructure (T1584)"}),id:"T1584",name:"Compromise Infrastructure",reference:"https://attack.mitre.org/techniques/T1584",tactics:"resource-development",value:"compromiseInfrastructure"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.createAccountDescription",{defaultMessage:"Create Account (T1136)"}),id:"T1136",name:"Create Account",reference:"https://attack.mitre.org/techniques/T1136",tactics:"persistence",value:"createAccount"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.createOrModifySystemProcessDescription",{defaultMessage:"Create or Modify System Process (T1543)"}),id:"T1543",name:"Create or Modify System Process",reference:"https://attack.mitre.org/techniques/T1543",tactics:"persistence,privilege-escalation",value:"createOrModifySystemProcess"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.credentialsFromPasswordStoresDescription",{defaultMessage:"Credentials from Password Stores (T1555)"}),id:"T1555",name:"Credentials from Password Stores",reference:"https://attack.mitre.org/techniques/T1555",tactics:"credential-access",value:"credentialsFromPasswordStores"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataDestructionDescription",{defaultMessage:"Data Destruction (T1485)"}),id:"T1485",name:"Data Destruction",reference:"https://attack.mitre.org/techniques/T1485",tactics:"impact",value:"dataDestruction"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataEncodingDescription",{defaultMessage:"Data Encoding (T1132)"}),id:"T1132",name:"Data Encoding",reference:"https://attack.mitre.org/techniques/T1132",tactics:"command-and-control",value:"dataEncoding"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataEncryptedForImpactDescription",{defaultMessage:"Data Encrypted for Impact (T1486)"}),id:"T1486",name:"Data Encrypted for Impact",reference:"https://attack.mitre.org/techniques/T1486",tactics:"impact",value:"dataEncryptedForImpact"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataManipulationDescription",{defaultMessage:"Data Manipulation (T1565)"}),id:"T1565",name:"Data Manipulation",reference:"https://attack.mitre.org/techniques/T1565",tactics:"impact",value:"dataManipulation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataObfuscationDescription",{defaultMessage:"Data Obfuscation (T1001)"}),id:"T1001",name:"Data Obfuscation",reference:"https://attack.mitre.org/techniques/T1001",tactics:"command-and-control",value:"dataObfuscation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataStagedDescription",{defaultMessage:"Data Staged (T1074)"}),id:"T1074",name:"Data Staged",reference:"https://attack.mitre.org/techniques/T1074",tactics:"collection",value:"dataStaged"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataTransferSizeLimitsDescription",{defaultMessage:"Data Transfer Size Limits (T1030)"}),id:"T1030",name:"Data Transfer Size Limits",reference:"https://attack.mitre.org/techniques/T1030",tactics:"exfiltration",value:"dataTransferSizeLimits"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromCloudStorageObjectDescription",{defaultMessage:"Data from Cloud Storage Object (T1530)"}),id:"T1530",name:"Data from Cloud Storage Object",reference:"https://attack.mitre.org/techniques/T1530",tactics:"collection",value:"dataFromCloudStorageObject"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromConfigurationRepositoryDescription",{defaultMessage:"Data from Configuration Repository (T1602)"}),id:"T1602",name:"Data from Configuration Repository",reference:"https://attack.mitre.org/techniques/T1602",tactics:"collection",value:"dataFromConfigurationRepository"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromInformationRepositoriesDescription",{defaultMessage:"Data from Information Repositories (T1213)"}),id:"T1213",name:"Data from Information Repositories",reference:"https://attack.mitre.org/techniques/T1213",tactics:"collection",value:"dataFromInformationRepositories"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromLocalSystemDescription",{defaultMessage:"Data from Local System (T1005)"}),id:"T1005",name:"Data from Local System",reference:"https://attack.mitre.org/techniques/T1005",tactics:"collection",value:"dataFromLocalSystem"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromNetworkSharedDriveDescription",{defaultMessage:"Data from Network Shared Drive (T1039)"}),id:"T1039",name:"Data from Network Shared Drive",reference:"https://attack.mitre.org/techniques/T1039",tactics:"collection",value:"dataFromNetworkSharedDrive"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromRemovableMediaDescription",{defaultMessage:"Data from Removable Media (T1025)"}),id:"T1025",name:"Data from Removable Media",reference:"https://attack.mitre.org/techniques/T1025",tactics:"collection",value:"dataFromRemovableMedia"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.defacementDescription",{defaultMessage:"Defacement (T1491)"}),id:"T1491",name:"Defacement",reference:"https://attack.mitre.org/techniques/T1491",tactics:"impact",value:"defacement"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.deobfuscateDecodeFilesOrInformationDescription",{defaultMessage:"Deobfuscate/Decode Files or Information (T1140)"}),id:"T1140",name:"Deobfuscate/Decode Files or Information",reference:"https://attack.mitre.org/techniques/T1140",tactics:"defense-evasion",value:"deobfuscateDecodeFilesOrInformation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.developCapabilitiesDescription",{defaultMessage:"Develop Capabilities (T1587)"}),id:"T1587",name:"Develop Capabilities",reference:"https://attack.mitre.org/techniques/T1587",tactics:"resource-development",value:"developCapabilities"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.directVolumeAccessDescription",{defaultMessage:"Direct Volume Access (T1006)"}),id:"T1006",name:"Direct Volume Access",reference:"https://attack.mitre.org/techniques/T1006",tactics:"defense-evasion",value:"directVolumeAccess"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.diskWipeDescription",{defaultMessage:"Disk Wipe (T1561)"}),id:"T1561",name:"Disk Wipe",reference:"https://attack.mitre.org/techniques/T1561",tactics:"impact",value:"diskWipe"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.domainTrustDiscoveryDescription",{defaultMessage:"Domain Trust Discovery (T1482)"}),id:"T1482",name:"Domain Trust Discovery",reference:"https://attack.mitre.org/techniques/T1482",tactics:"discovery",value:"domainTrustDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.driveByCompromiseDescription",{defaultMessage:"Drive-by Compromise (T1189)"}),id:"T1189",name:"Drive-by Compromise",reference:"https://attack.mitre.org/techniques/T1189",tactics:"initial-access",value:"driveByCompromise"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dynamicResolutionDescription",{defaultMessage:"Dynamic Resolution (T1568)"}),id:"T1568",name:"Dynamic Resolution",reference:"https://attack.mitre.org/techniques/T1568",tactics:"command-and-control",value:"dynamicResolution"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.emailCollectionDescription",{defaultMessage:"Email Collection (T1114)"}),id:"T1114",name:"Email Collection",reference:"https://attack.mitre.org/techniques/T1114",tactics:"collection",value:"emailCollection"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.encryptedChannelDescription",{defaultMessage:"Encrypted Channel (T1573)"}),id:"T1573",name:"Encrypted Channel",reference:"https://attack.mitre.org/techniques/T1573",tactics:"command-and-control",value:"encryptedChannel"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.endpointDenialOfServiceDescription",{defaultMessage:"Endpoint Denial of Service (T1499)"}),id:"T1499",name:"Endpoint Denial of Service",reference:"https://attack.mitre.org/techniques/T1499",tactics:"impact",value:"endpointDenialOfService"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.establishAccountsDescription",{defaultMessage:"Establish Accounts (T1585)"}),id:"T1585",name:"Establish Accounts",reference:"https://attack.mitre.org/techniques/T1585",tactics:"resource-development",value:"establishAccounts"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.eventTriggeredExecutionDescription",{defaultMessage:"Event Triggered Execution (T1546)"}),id:"T1546",name:"Event Triggered Execution",reference:"https://attack.mitre.org/techniques/T1546",tactics:"privilege-escalation,persistence",value:"eventTriggeredExecution"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.executionGuardrailsDescription",{defaultMessage:"Execution Guardrails (T1480)"}),id:"T1480",name:"Execution Guardrails",reference:"https://attack.mitre.org/techniques/T1480",tactics:"defense-evasion",value:"executionGuardrails"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverAlternativeProtocolDescription",{defaultMessage:"Exfiltration Over Alternative Protocol (T1048)"}),id:"T1048",name:"Exfiltration Over Alternative Protocol",reference:"https://attack.mitre.org/techniques/T1048",tactics:"exfiltration",value:"exfiltrationOverAlternativeProtocol"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverC2ChannelDescription",{defaultMessage:"Exfiltration Over C2 Channel (T1041)"}),id:"T1041",name:"Exfiltration Over C2 Channel",reference:"https://attack.mitre.org/techniques/T1041",tactics:"exfiltration",value:"exfiltrationOverC2Channel"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverOtherNetworkMediumDescription",{defaultMessage:"Exfiltration Over Other Network Medium (T1011)"}),id:"T1011",name:"Exfiltration Over Other Network Medium",reference:"https://attack.mitre.org/techniques/T1011",tactics:"exfiltration",value:"exfiltrationOverOtherNetworkMedium"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverPhysicalMediumDescription",{defaultMessage:"Exfiltration Over Physical Medium (T1052)"}),id:"T1052",name:"Exfiltration Over Physical Medium",reference:"https://attack.mitre.org/techniques/T1052",tactics:"exfiltration",value:"exfiltrationOverPhysicalMedium"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverWebServiceDescription",{defaultMessage:"Exfiltration Over Web Service (T1567)"}),id:"T1567",name:"Exfiltration Over Web Service",reference:"https://attack.mitre.org/techniques/T1567",tactics:"exfiltration",value:"exfiltrationOverWebService"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitPublicFacingApplicationDescription",{defaultMessage:"Exploit Public-Facing Application (T1190)"}),id:"T1190",name:"Exploit Public-Facing Application",reference:"https://attack.mitre.org/techniques/T1190",tactics:"initial-access",value:"exploitPublicFacingApplication"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForClientExecutionDescription",{defaultMessage:"Exploitation for Client Execution (T1203)"}),id:"T1203",name:"Exploitation for Client Execution",reference:"https://attack.mitre.org/techniques/T1203",tactics:"execution",value:"exploitationForClientExecution"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForCredentialAccessDescription",{defaultMessage:"Exploitation for Credential Access (T1212)"}),id:"T1212",name:"Exploitation for Credential Access",reference:"https://attack.mitre.org/techniques/T1212",tactics:"credential-access",value:"exploitationForCredentialAccess"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForDefenseEvasionDescription",{defaultMessage:"Exploitation for Defense Evasion (T1211)"}),id:"T1211",name:"Exploitation for Defense Evasion",reference:"https://attack.mitre.org/techniques/T1211",tactics:"defense-evasion",value:"exploitationForDefenseEvasion"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForPrivilegeEscalationDescription",{defaultMessage:"Exploitation for Privilege Escalation (T1068)"}),id:"T1068",name:"Exploitation for Privilege Escalation",reference:"https://attack.mitre.org/techniques/T1068",tactics:"privilege-escalation",value:"exploitationForPrivilegeEscalation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationOfRemoteServicesDescription",{defaultMessage:"Exploitation of Remote Services (T1210)"}),id:"T1210",name:"Exploitation of Remote Services",reference:"https://attack.mitre.org/techniques/T1210",tactics:"lateral-movement",value:"exploitationOfRemoteServices"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.externalRemoteServicesDescription",{defaultMessage:"External Remote Services (T1133)"}),id:"T1133",name:"External Remote Services",reference:"https://attack.mitre.org/techniques/T1133",tactics:"persistence,initial-access",value:"externalRemoteServices"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fallbackChannelsDescription",{defaultMessage:"Fallback Channels (T1008)"}),id:"T1008",name:"Fallback Channels",reference:"https://attack.mitre.org/techniques/T1008",tactics:"command-and-control",value:"fallbackChannels"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fileAndDirectoryDiscoveryDescription",{defaultMessage:"File and Directory Discovery (T1083)"}),id:"T1083",name:"File and Directory Discovery",reference:"https://attack.mitre.org/techniques/T1083",tactics:"discovery",value:"fileAndDirectoryDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fileAndDirectoryPermissionsModificationDescription",{defaultMessage:"File and Directory Permissions Modification (T1222)"}),id:"T1222",name:"File and Directory Permissions Modification",reference:"https://attack.mitre.org/techniques/T1222",tactics:"defense-evasion",value:"fileAndDirectoryPermissionsModification"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.firmwareCorruptionDescription",{defaultMessage:"Firmware Corruption (T1495)"}),id:"T1495",name:"Firmware Corruption",reference:"https://attack.mitre.org/techniques/T1495",tactics:"impact",value:"firmwareCorruption"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.forcedAuthenticationDescription",{defaultMessage:"Forced Authentication (T1187)"}),id:"T1187",name:"Forced Authentication",reference:"https://attack.mitre.org/techniques/T1187",tactics:"credential-access",value:"forcedAuthentication"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.gatherVictimHostInformationDescription",{defaultMessage:"Gather Victim Host Information (T1592)"}),id:"T1592",name:"Gather Victim Host Information",reference:"https://attack.mitre.org/techniques/T1592",tactics:"reconnaissance",value:"gatherVictimHostInformation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.gatherVictimIdentityInformationDescription",{defaultMessage:"Gather Victim Identity Information (T1589)"}),id:"T1589",name:"Gather Victim Identity Information",reference:"https://attack.mitre.org/techniques/T1589",tactics:"reconnaissance",value:"gatherVictimIdentityInformation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.gatherVictimNetworkInformationDescription",{defaultMessage:"Gather Victim Network Information (T1590)"}),id:"T1590",name:"Gather Victim Network Information",reference:"https://attack.mitre.org/techniques/T1590",tactics:"reconnaissance",value:"gatherVictimNetworkInformation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.gatherVictimOrgInformationDescription",{defaultMessage:"Gather Victim Org Information (T1591)"}),id:"T1591",name:"Gather Victim Org Information",reference:"https://attack.mitre.org/techniques/T1591",tactics:"reconnaissance",value:"gatherVictimOrgInformation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.graphicalUserInterfaceDescription",{defaultMessage:"Graphical User Interface (T1061)"}),id:"T1061",name:"Graphical User Interface",reference:"https://attack.mitre.org/techniques/T1061",tactics:"execution",value:"graphicalUserInterface"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.groupPolicyModificationDescription",{defaultMessage:"Group Policy Modification (T1484)"}),id:"T1484",name:"Group Policy Modification",reference:"https://attack.mitre.org/techniques/T1484",tactics:"defense-evasion,privilege-escalation",value:"groupPolicyModification"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hardwareAdditionsDescription",{defaultMessage:"Hardware Additions (T1200)"}),id:"T1200",name:"Hardware Additions",reference:"https://attack.mitre.org/techniques/T1200",tactics:"initial-access",value:"hardwareAdditions"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hideArtifactsDescription",{defaultMessage:"Hide Artifacts (T1564)"}),id:"T1564",name:"Hide Artifacts",reference:"https://attack.mitre.org/techniques/T1564",tactics:"defense-evasion",value:"hideArtifacts"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hijackExecutionFlowDescription",{defaultMessage:"Hijack Execution Flow (T1574)"}),id:"T1574",name:"Hijack Execution Flow",reference:"https://attack.mitre.org/techniques/T1574",tactics:"persistence,privilege-escalation,defense-evasion",value:"hijackExecutionFlow"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hypervisorDescription",{defaultMessage:"Hypervisor (T1062)"}),id:"T1062",name:"Hypervisor",reference:"https://attack.mitre.org/techniques/T1062",tactics:"persistence",value:"hypervisor"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.impairDefensesDescription",{defaultMessage:"Impair Defenses (T1562)"}),id:"T1562",name:"Impair Defenses",reference:"https://attack.mitre.org/techniques/T1562",tactics:"defense-evasion",value:"impairDefenses"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.implantContainerImageDescription",{defaultMessage:"Implant Container Image (T1525)"}),id:"T1525",name:"Implant Container Image",reference:"https://attack.mitre.org/techniques/T1525",tactics:"persistence",value:"implantContainerImage"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.indicatorRemovalOnHostDescription",{defaultMessage:"Indicator Removal on Host (T1070)"}),id:"T1070",name:"Indicator Removal on Host",reference:"https://attack.mitre.org/techniques/T1070",tactics:"defense-evasion",value:"indicatorRemovalOnHost"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.indirectCommandExecutionDescription",{defaultMessage:"Indirect Command Execution (T1202)"}),id:"T1202",name:"Indirect Command Execution",reference:"https://attack.mitre.org/techniques/T1202",tactics:"defense-evasion",value:"indirectCommandExecution"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.ingressToolTransferDescription",{defaultMessage:"Ingress Tool Transfer (T1105)"}),id:"T1105",name:"Ingress Tool Transfer",reference:"https://attack.mitre.org/techniques/T1105",tactics:"command-and-control",value:"ingressToolTransfer"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.inhibitSystemRecoveryDescription",{defaultMessage:"Inhibit System Recovery (T1490)"}),id:"T1490",name:"Inhibit System Recovery",reference:"https://attack.mitre.org/techniques/T1490",tactics:"impact",value:"inhibitSystemRecovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.inputCaptureDescription",{defaultMessage:"Input Capture (T1056)"}),id:"T1056",name:"Input Capture",reference:"https://attack.mitre.org/techniques/T1056",tactics:"collection,credential-access",value:"inputCapture"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.interProcessCommunicationDescription",{defaultMessage:"Inter-Process Communication (T1559)"}),id:"T1559",name:"Inter-Process Communication",reference:"https://attack.mitre.org/techniques/T1559",tactics:"execution",value:"interProcessCommunication"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.internalSpearphishingDescription",{defaultMessage:"Internal Spearphishing (T1534)"}),id:"T1534",name:"Internal Spearphishing",reference:"https://attack.mitre.org/techniques/T1534",tactics:"lateral-movement",value:"internalSpearphishing"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.lcMainHijackingDescription",{defaultMessage:"LC_MAIN Hijacking (T1149)"}),id:"T1149",name:"LC_MAIN Hijacking",reference:"https://attack.mitre.org/techniques/T1149",tactics:"defense-evasion",value:"lcMainHijacking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.lateralToolTransferDescription",{defaultMessage:"Lateral Tool Transfer (T1570)"}),id:"T1570",name:"Lateral Tool Transfer",reference:"https://attack.mitre.org/techniques/T1570",tactics:"lateral-movement",value:"lateralToolTransfer"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.manInTheBrowserDescription",{defaultMessage:"Man in the Browser (T1185)"}),id:"T1185",name:"Man in the Browser",reference:"https://attack.mitre.org/techniques/T1185",tactics:"collection",value:"manInTheBrowser"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.manInTheMiddleDescription",{defaultMessage:"Man-in-the-Middle (T1557)"}),id:"T1557",name:"Man-in-the-Middle",reference:"https://attack.mitre.org/techniques/T1557",tactics:"credential-access,collection",value:"manInTheMiddle"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.masqueradingDescription",{defaultMessage:"Masquerading (T1036)"}),id:"T1036",name:"Masquerading",reference:"https://attack.mitre.org/techniques/T1036",tactics:"defense-evasion",value:"masquerading"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifyAuthenticationProcessDescription",{defaultMessage:"Modify Authentication Process (T1556)"}),id:"T1556",name:"Modify Authentication Process",reference:"https://attack.mitre.org/techniques/T1556",tactics:"credential-access,defense-evasion",value:"modifyAuthenticationProcess"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifyCloudComputeInfrastructureDescription",{defaultMessage:"Modify Cloud Compute Infrastructure (T1578)"}),id:"T1578",name:"Modify Cloud Compute Infrastructure",reference:"https://attack.mitre.org/techniques/T1578",tactics:"defense-evasion",value:"modifyCloudComputeInfrastructure"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifyRegistryDescription",{defaultMessage:"Modify Registry (T1112)"}),id:"T1112",name:"Modify Registry",reference:"https://attack.mitre.org/techniques/T1112",tactics:"defense-evasion",value:"modifyRegistry"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifySystemImageDescription",{defaultMessage:"Modify System Image (T1601)"}),id:"T1601",name:"Modify System Image",reference:"https://attack.mitre.org/techniques/T1601",tactics:"defense-evasion",value:"modifySystemImage"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.multiStageChannelsDescription",{defaultMessage:"Multi-Stage Channels (T1104)"}),id:"T1104",name:"Multi-Stage Channels",reference:"https://attack.mitre.org/techniques/T1104",tactics:"command-and-control",value:"multiStageChannels"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.multibandCommunicationDescription",{defaultMessage:"Multiband Communication (T1026)"}),id:"T1026",name:"Multiband Communication",reference:"https://attack.mitre.org/techniques/T1026",tactics:"command-and-control",value:"multibandCommunication"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.nativeApiDescription",{defaultMessage:"Native API (T1106)"}),id:"T1106",name:"Native API",reference:"https://attack.mitre.org/techniques/T1106",tactics:"execution",value:"nativeApi"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkBoundaryBridgingDescription",{defaultMessage:"Network Boundary Bridging (T1599)"}),id:"T1599",name:"Network Boundary Bridging",reference:"https://attack.mitre.org/techniques/T1599",tactics:"defense-evasion",value:"networkBoundaryBridging"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkDenialOfServiceDescription",{defaultMessage:"Network Denial of Service (T1498)"}),id:"T1498",name:"Network Denial of Service",reference:"https://attack.mitre.org/techniques/T1498",tactics:"impact",value:"networkDenialOfService"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkServiceScanningDescription",{defaultMessage:"Network Service Scanning (T1046)"}),id:"T1046",name:"Network Service Scanning",reference:"https://attack.mitre.org/techniques/T1046",tactics:"discovery",value:"networkServiceScanning"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkShareDiscoveryDescription",{defaultMessage:"Network Share Discovery (T1135)"}),id:"T1135",name:"Network Share Discovery",reference:"https://attack.mitre.org/techniques/T1135",tactics:"discovery",value:"networkShareDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkSniffingDescription",{defaultMessage:"Network Sniffing (T1040)"}),id:"T1040",name:"Network Sniffing",reference:"https://attack.mitre.org/techniques/T1040",tactics:"credential-access,discovery",value:"networkSniffing"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.nonApplicationLayerProtocolDescription",{defaultMessage:"Non-Application Layer Protocol (T1095)"}),id:"T1095",name:"Non-Application Layer Protocol",reference:"https://attack.mitre.org/techniques/T1095",tactics:"command-and-control",value:"nonApplicationLayerProtocol"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.nonStandardPortDescription",{defaultMessage:"Non-Standard Port (T1571)"}),id:"T1571",name:"Non-Standard Port",reference:"https://attack.mitre.org/techniques/T1571",tactics:"command-and-control",value:"nonStandardPort"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.osCredentialDumpingDescription",{defaultMessage:"OS Credential Dumping (T1003)"}),id:"T1003",name:"OS Credential Dumping",reference:"https://attack.mitre.org/techniques/T1003",tactics:"credential-access",value:"osCredentialDumping"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.obfuscatedFilesOrInformationDescription",{defaultMessage:"Obfuscated Files or Information (T1027)"}),id:"T1027",name:"Obfuscated Files or Information",reference:"https://attack.mitre.org/techniques/T1027",tactics:"defense-evasion",value:"obfuscatedFilesOrInformation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.obtainCapabilitiesDescription",{defaultMessage:"Obtain Capabilities (T1588)"}),id:"T1588",name:"Obtain Capabilities",reference:"https://attack.mitre.org/techniques/T1588",tactics:"resource-development",value:"obtainCapabilities"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.officeApplicationStartupDescription",{defaultMessage:"Office Application Startup (T1137)"}),id:"T1137",name:"Office Application Startup",reference:"https://attack.mitre.org/techniques/T1137",tactics:"persistence",value:"officeApplicationStartup"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.passwordPolicyDiscoveryDescription",{defaultMessage:"Password Policy Discovery (T1201)"}),id:"T1201",name:"Password Policy Discovery",reference:"https://attack.mitre.org/techniques/T1201",tactics:"discovery",value:"passwordPolicyDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.pathInterceptionDescription",{defaultMessage:"Path Interception (T1034)"}),id:"T1034",name:"Path Interception",reference:"https://attack.mitre.org/techniques/T1034",tactics:"persistence,privilege-escalation",value:"pathInterception"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.peripheralDeviceDiscoveryDescription",{defaultMessage:"Peripheral Device Discovery (T1120)"}),id:"T1120",name:"Peripheral Device Discovery",reference:"https://attack.mitre.org/techniques/T1120",tactics:"discovery",value:"peripheralDeviceDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.permissionGroupsDiscoveryDescription",{defaultMessage:"Permission Groups Discovery (T1069)"}),id:"T1069",name:"Permission Groups Discovery",reference:"https://attack.mitre.org/techniques/T1069",tactics:"discovery",value:"permissionGroupsDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.phishingDescription",{defaultMessage:"Phishing (T1566)"}),id:"T1566",name:"Phishing",reference:"https://attack.mitre.org/techniques/T1566",tactics:"initial-access",value:"phishing"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.phishingForInformationDescription",{defaultMessage:"Phishing for Information (T1598)"}),id:"T1598",name:"Phishing for Information",reference:"https://attack.mitre.org/techniques/T1598",tactics:"reconnaissance",value:"phishingForInformation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.preOsBootDescription",{defaultMessage:"Pre-OS Boot (T1542)"}),id:"T1542",name:"Pre-OS Boot",reference:"https://attack.mitre.org/techniques/T1542",tactics:"defense-evasion,persistence",value:"preOsBoot"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.processDiscoveryDescription",{defaultMessage:"Process Discovery (T1057)"}),id:"T1057",name:"Process Discovery",reference:"https://attack.mitre.org/techniques/T1057",tactics:"discovery",value:"processDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.processInjectionDescription",{defaultMessage:"Process Injection (T1055)"}),id:"T1055",name:"Process Injection",reference:"https://attack.mitre.org/techniques/T1055",tactics:"defense-evasion,privilege-escalation",value:"processInjection"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.protocolTunnelingDescription",{defaultMessage:"Protocol Tunneling (T1572)"}),id:"T1572",name:"Protocol Tunneling",reference:"https://attack.mitre.org/techniques/T1572",tactics:"command-and-control",value:"protocolTunneling"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.proxyDescription",{defaultMessage:"Proxy (T1090)"}),id:"T1090",name:"Proxy",reference:"https://attack.mitre.org/techniques/T1090",tactics:"command-and-control",value:"proxy"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.queryRegistryDescription",{defaultMessage:"Query Registry (T1012)"}),id:"T1012",name:"Query Registry",reference:"https://attack.mitre.org/techniques/T1012",tactics:"discovery",value:"queryRegistry"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.redundantAccessDescription",{defaultMessage:"Redundant Access (T1108)"}),id:"T1108",name:"Redundant Access",reference:"https://attack.mitre.org/techniques/T1108",tactics:"defense-evasion,persistence",value:"redundantAccess"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteAccessSoftwareDescription",{defaultMessage:"Remote Access Software (T1219)"}),id:"T1219",name:"Remote Access Software",reference:"https://attack.mitre.org/techniques/T1219",tactics:"command-and-control",value:"remoteAccessSoftware"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteServiceSessionHijackingDescription",{defaultMessage:"Remote Service Session Hijacking (T1563)"}),id:"T1563",name:"Remote Service Session Hijacking",reference:"https://attack.mitre.org/techniques/T1563",tactics:"lateral-movement",value:"remoteServiceSessionHijacking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteServicesDescription",{defaultMessage:"Remote Services (T1021)"}),id:"T1021",name:"Remote Services",reference:"https://attack.mitre.org/techniques/T1021",tactics:"lateral-movement",value:"remoteServices"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteSystemDiscoveryDescription",{defaultMessage:"Remote System Discovery (T1018)"}),id:"T1018",name:"Remote System Discovery",reference:"https://attack.mitre.org/techniques/T1018",tactics:"discovery",value:"remoteSystemDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.replicationThroughRemovableMediaDescription",{defaultMessage:"Replication Through Removable Media (T1091)"}),id:"T1091",name:"Replication Through Removable Media",reference:"https://attack.mitre.org/techniques/T1091",tactics:"lateral-movement,initial-access",value:"replicationThroughRemovableMedia"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.resourceHijackingDescription",{defaultMessage:"Resource Hijacking (T1496)"}),id:"T1496",name:"Resource Hijacking",reference:"https://attack.mitre.org/techniques/T1496",tactics:"impact",value:"resourceHijacking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.rogueDomainControllerDescription",{defaultMessage:"Rogue Domain Controller (T1207)"}),id:"T1207",name:"Rogue Domain Controller",reference:"https://attack.mitre.org/techniques/T1207",tactics:"defense-evasion",value:"rogueDomainController"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.rootkitDescription",{defaultMessage:"Rootkit (T1014)"}),id:"T1014",name:"Rootkit",reference:"https://attack.mitre.org/techniques/T1014",tactics:"defense-evasion",value:"rootkit"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.scheduledTaskJobDescription",{defaultMessage:"Scheduled Task/Job (T1053)"}),id:"T1053",name:"Scheduled Task/Job",reference:"https://attack.mitre.org/techniques/T1053",tactics:"execution,persistence,privilege-escalation",value:"scheduledTaskJob"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.scheduledTransferDescription",{defaultMessage:"Scheduled Transfer (T1029)"}),id:"T1029",name:"Scheduled Transfer",reference:"https://attack.mitre.org/techniques/T1029",tactics:"exfiltration",value:"scheduledTransfer"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.screenCaptureDescription",{defaultMessage:"Screen Capture (T1113)"}),id:"T1113",name:"Screen Capture",reference:"https://attack.mitre.org/techniques/T1113",tactics:"collection",value:"screenCapture"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.scriptingDescription",{defaultMessage:"Scripting (T1064)"}),id:"T1064",name:"Scripting",reference:"https://attack.mitre.org/techniques/T1064",tactics:"defense-evasion,execution",value:"scripting"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.searchClosedSourcesDescription",{defaultMessage:"Search Closed Sources (T1597)"}),id:"T1597",name:"Search Closed Sources",reference:"https://attack.mitre.org/techniques/T1597",tactics:"reconnaissance",value:"searchClosedSources"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.searchOpenTechnicalDatabasesDescription",{defaultMessage:"Search Open Technical Databases (T1596)"}),id:"T1596",name:"Search Open Technical Databases",reference:"https://attack.mitre.org/techniques/T1596",tactics:"reconnaissance",value:"searchOpenTechnicalDatabases"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.searchOpenWebsitesDomainsDescription",{defaultMessage:"Search Open Websites/Domains (T1593)"}),id:"T1593",name:"Search Open Websites/Domains",reference:"https://attack.mitre.org/techniques/T1593",tactics:"reconnaissance",value:"searchOpenWebsitesDomains"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.searchVictimOwnedWebsitesDescription",{defaultMessage:"Search Victim-Owned Websites (T1594)"}),id:"T1594",name:"Search Victim-Owned Websites",reference:"https://attack.mitre.org/techniques/T1594",tactics:"reconnaissance",value:"searchVictimOwnedWebsites"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.serverSoftwareComponentDescription",{defaultMessage:"Server Software Component (T1505)"}),id:"T1505",name:"Server Software Component",reference:"https://attack.mitre.org/techniques/T1505",tactics:"persistence",value:"serverSoftwareComponent"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.serviceStopDescription",{defaultMessage:"Service Stop (T1489)"}),id:"T1489",name:"Service Stop",reference:"https://attack.mitre.org/techniques/T1489",tactics:"impact",value:"serviceStop"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sharedModulesDescription",{defaultMessage:"Shared Modules (T1129)"}),id:"T1129",name:"Shared Modules",reference:"https://attack.mitre.org/techniques/T1129",tactics:"execution",value:"sharedModules"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sharedWebrootDescription",{defaultMessage:"Shared Webroot (T1051)"}),id:"T1051",name:"Shared Webroot",reference:"https://attack.mitre.org/techniques/T1051",tactics:"lateral-movement",value:"sharedWebroot"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.signedBinaryProxyExecutionDescription",{defaultMessage:"Signed Binary Proxy Execution (T1218)"}),id:"T1218",name:"Signed Binary Proxy Execution",reference:"https://attack.mitre.org/techniques/T1218",tactics:"defense-evasion",value:"signedBinaryProxyExecution"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.signedScriptProxyExecutionDescription",{defaultMessage:"Signed Script Proxy Execution (T1216)"}),id:"T1216",name:"Signed Script Proxy Execution",reference:"https://attack.mitre.org/techniques/T1216",tactics:"defense-evasion",value:"signedScriptProxyExecution"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.softwareDeploymentToolsDescription",{defaultMessage:"Software Deployment Tools (T1072)"}),id:"T1072",name:"Software Deployment Tools",reference:"https://attack.mitre.org/techniques/T1072",tactics:"execution,lateral-movement",value:"softwareDeploymentTools"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.softwareDiscoveryDescription",{defaultMessage:"Software Discovery (T1518)"}),id:"T1518",name:"Software Discovery",reference:"https://attack.mitre.org/techniques/T1518",tactics:"discovery",value:"softwareDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sourceDescription",{defaultMessage:"Source (T1153)"}),id:"T1153",name:"Source",reference:"https://attack.mitre.org/techniques/T1153",tactics:"execution",value:"source"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.stealApplicationAccessTokenDescription",{defaultMessage:"Steal Application Access Token (T1528)"}),id:"T1528",name:"Steal Application Access Token",reference:"https://attack.mitre.org/techniques/T1528",tactics:"credential-access",value:"stealApplicationAccessToken"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.stealWebSessionCookieDescription",{defaultMessage:"Steal Web Session Cookie (T1539)"}),id:"T1539",name:"Steal Web Session Cookie",reference:"https://attack.mitre.org/techniques/T1539",tactics:"credential-access",value:"stealWebSessionCookie"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.stealOrForgeKerberosTicketsDescription",{defaultMessage:"Steal or Forge Kerberos Tickets (T1558)"}),id:"T1558",name:"Steal or Forge Kerberos Tickets",reference:"https://attack.mitre.org/techniques/T1558",tactics:"credential-access",value:"stealOrForgeKerberosTickets"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.subvertTrustControlsDescription",{defaultMessage:"Subvert Trust Controls (T1553)"}),id:"T1553",name:"Subvert Trust Controls",reference:"https://attack.mitre.org/techniques/T1553",tactics:"defense-evasion",value:"subvertTrustControls"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.supplyChainCompromiseDescription",{defaultMessage:"Supply Chain Compromise (T1195)"}),id:"T1195",name:"Supply Chain Compromise",reference:"https://attack.mitre.org/techniques/T1195",tactics:"initial-access",value:"supplyChainCompromise"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemInformationDiscoveryDescription",{defaultMessage:"System Information Discovery (T1082)"}),id:"T1082",name:"System Information Discovery",reference:"https://attack.mitre.org/techniques/T1082",tactics:"discovery",value:"systemInformationDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemNetworkConfigurationDiscoveryDescription",{defaultMessage:"System Network Configuration Discovery (T1016)"}),id:"T1016",name:"System Network Configuration Discovery",reference:"https://attack.mitre.org/techniques/T1016",tactics:"discovery",value:"systemNetworkConfigurationDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemNetworkConnectionsDiscoveryDescription",{defaultMessage:"System Network Connections Discovery (T1049)"}),id:"T1049",name:"System Network Connections Discovery",reference:"https://attack.mitre.org/techniques/T1049",tactics:"discovery",value:"systemNetworkConnectionsDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemOwnerUserDiscoveryDescription",{defaultMessage:"System Owner/User Discovery (T1033)"}),id:"T1033",name:"System Owner/User Discovery",reference:"https://attack.mitre.org/techniques/T1033",tactics:"discovery",value:"systemOwnerUserDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemServiceDiscoveryDescription",{defaultMessage:"System Service Discovery (T1007)"}),id:"T1007",name:"System Service Discovery",reference:"https://attack.mitre.org/techniques/T1007",tactics:"discovery",value:"systemServiceDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemServicesDescription",{defaultMessage:"System Services (T1569)"}),id:"T1569",name:"System Services",reference:"https://attack.mitre.org/techniques/T1569",tactics:"execution",value:"systemServices"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemShutdownRebootDescription",{defaultMessage:"System Shutdown/Reboot (T1529)"}),id:"T1529",name:"System Shutdown/Reboot",reference:"https://attack.mitre.org/techniques/T1529",tactics:"impact",value:"systemShutdownReboot"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemTimeDiscoveryDescription",{defaultMessage:"System Time Discovery (T1124)"}),id:"T1124",name:"System Time Discovery",reference:"https://attack.mitre.org/techniques/T1124",tactics:"discovery",value:"systemTimeDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.taintSharedContentDescription",{defaultMessage:"Taint Shared Content (T1080)"}),id:"T1080",name:"Taint Shared Content",reference:"https://attack.mitre.org/techniques/T1080",tactics:"lateral-movement",value:"taintSharedContent"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.templateInjectionDescription",{defaultMessage:"Template Injection (T1221)"}),id:"T1221",name:"Template Injection",reference:"https://attack.mitre.org/techniques/T1221",tactics:"defense-evasion",value:"templateInjection"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.trafficSignalingDescription",{defaultMessage:"Traffic Signaling (T1205)"}),id:"T1205",name:"Traffic Signaling",reference:"https://attack.mitre.org/techniques/T1205",tactics:"defense-evasion,persistence,command-and-control",value:"trafficSignaling"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.transferDataToCloudAccountDescription",{defaultMessage:"Transfer Data to Cloud Account (T1537)"}),id:"T1537",name:"Transfer Data to Cloud Account",reference:"https://attack.mitre.org/techniques/T1537",tactics:"exfiltration",value:"transferDataToCloudAccount"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.trustedDeveloperUtilitiesProxyExecutionDescription",{defaultMessage:"Trusted Developer Utilities Proxy Execution (T1127)"}),id:"T1127",name:"Trusted Developer Utilities Proxy Execution",reference:"https://attack.mitre.org/techniques/T1127",tactics:"defense-evasion",value:"trustedDeveloperUtilitiesProxyExecution"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.trustedRelationshipDescription",{defaultMessage:"Trusted Relationship (T1199)"}),id:"T1199",name:"Trusted Relationship",reference:"https://attack.mitre.org/techniques/T1199",tactics:"initial-access",value:"trustedRelationship"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.twoFactorAuthenticationInterceptionDescription",{defaultMessage:"Two-Factor Authentication Interception (T1111)"}),id:"T1111",name:"Two-Factor Authentication Interception",reference:"https://attack.mitre.org/techniques/T1111",tactics:"credential-access",value:"twoFactorAuthenticationInterception"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.unsecuredCredentialsDescription",{defaultMessage:"Unsecured Credentials (T1552)"}),id:"T1552",name:"Unsecured Credentials",reference:"https://attack.mitre.org/techniques/T1552",tactics:"credential-access",value:"unsecuredCredentials"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.unusedUnsupportedCloudRegionsDescription",{defaultMessage:"Unused/Unsupported Cloud Regions (T1535)"}),id:"T1535",name:"Unused/Unsupported Cloud Regions",reference:"https://attack.mitre.org/techniques/T1535",tactics:"defense-evasion",value:"unusedUnsupportedCloudRegions"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.useAlternateAuthenticationMaterialDescription",{defaultMessage:"Use Alternate Authentication Material (T1550)"}),id:"T1550",name:"Use Alternate Authentication Material",reference:"https://attack.mitre.org/techniques/T1550",tactics:"defense-evasion,lateral-movement",value:"useAlternateAuthenticationMaterial"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.userExecutionDescription",{defaultMessage:"User Execution (T1204)"}),id:"T1204",name:"User Execution",reference:"https://attack.mitre.org/techniques/T1204",tactics:"execution",value:"userExecution"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.validAccountsDescription",{defaultMessage:"Valid Accounts (T1078)"}),id:"T1078",name:"Valid Accounts",reference:"https://attack.mitre.org/techniques/T1078",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",value:"validAccounts"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.videoCaptureDescription",{defaultMessage:"Video Capture (T1125)"}),id:"T1125",name:"Video Capture",reference:"https://attack.mitre.org/techniques/T1125",tactics:"collection",value:"videoCapture"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.virtualizationSandboxEvasionDescription",{defaultMessage:"Virtualization/Sandbox Evasion (T1497)"}),id:"T1497",name:"Virtualization/Sandbox Evasion",reference:"https://attack.mitre.org/techniques/T1497",tactics:"defense-evasion,discovery",value:"virtualizationSandboxEvasion"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.weakenEncryptionDescription",{defaultMessage:"Weaken Encryption (T1600)"}),id:"T1600",name:"Weaken Encryption",reference:"https://attack.mitre.org/techniques/T1600",tactics:"defense-evasion",value:"weakenEncryption"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.webServiceDescription",{defaultMessage:"Web Service (T1102)"}),id:"T1102",name:"Web Service",reference:"https://attack.mitre.org/techniques/T1102",tactics:"command-and-control",value:"webService"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.windowsManagementInstrumentationDescription",{defaultMessage:"Windows Management Instrumentation (T1047)"}),id:"T1047",name:"Windows Management Instrumentation",reference:"https://attack.mitre.org/techniques/T1047",tactics:"execution",value:"windowsManagementInstrumentation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.xslScriptProcessingDescription",{defaultMessage:"XSL Script Processing (T1220)"}),id:"T1220",name:"XSL Script Processing",reference:"https://attack.mitre.org/techniques/T1220",tactics:"defense-evasion",value:"xslScriptProcessing"}];const mitre_tactics_techniques_subtechniques=[{name:".bash_profile and .bashrc",id:"T1546.004",reference:"https://attack.mitre.org/techniques/T1546/004",tactics:["privilege-escalation","persistence"],techniqueId:"T1546"},{name:"/etc/passwd and /etc/shadow",id:"T1003.008",reference:"https://attack.mitre.org/techniques/T1003/008",tactics:["credential-access"],techniqueId:"T1003"},{name:"ARP Cache Poisoning",id:"T1557.002",reference:"https://attack.mitre.org/techniques/T1557/002",tactics:["credential-access","collection"],techniqueId:"T1557"},{name:"AS-REP Roasting",id:"T1558.004",reference:"https://attack.mitre.org/techniques/T1558/004",tactics:["credential-access"],techniqueId:"T1558"},{name:"Accessibility Features",id:"T1546.008",reference:"https://attack.mitre.org/techniques/T1546/008",tactics:["privilege-escalation","persistence"],techniqueId:"T1546"},{name:"Add Office 365 Global Administrator Role",id:"T1098.003",reference:"https://attack.mitre.org/techniques/T1098/003",tactics:["persistence"],techniqueId:"T1098"},{name:"Add-ins",id:"T1137.006",reference:"https://attack.mitre.org/techniques/T1137/006",tactics:["persistence"],techniqueId:"T1137"},{name:"Additional Cloud Credentials",id:"T1098.001",reference:"https://attack.mitre.org/techniques/T1098/001",tactics:["persistence"],techniqueId:"T1098"},{name:"AppCert DLLs",id:"T1546.009",reference:"https://attack.mitre.org/techniques/T1546/009",tactics:["privilege-escalation","persistence"],techniqueId:"T1546"},{name:"AppInit DLLs",id:"T1546.010",reference:"https://attack.mitre.org/techniques/T1546/010",tactics:["privilege-escalation","persistence"],techniqueId:"T1546"},{name:"AppleScript",id:"T1059.002",reference:"https://attack.mitre.org/techniques/T1059/002",tactics:["execution"],techniqueId:"T1059"},{name:"Application Access Token",id:"T1550.001",reference:"https://attack.mitre.org/techniques/T1550/001",tactics:["defense-evasion","lateral-movement"],techniqueId:"T1550"},{name:"Application Exhaustion Flood",id:"T1499.003",reference:"https://attack.mitre.org/techniques/T1499/003",tactics:["impact"],techniqueId:"T1499"},{name:"Application Shimming",id:"T1546.011",reference:"https://attack.mitre.org/techniques/T1546/011",tactics:["privilege-escalation","persistence"],techniqueId:"T1546"},{name:"Application or System Exploitation",id:"T1499.004",reference:"https://attack.mitre.org/techniques/T1499/004",tactics:["impact"],techniqueId:"T1499"},{name:"Archive via Custom Method",id:"T1560.003",reference:"https://attack.mitre.org/techniques/T1560/003",tactics:["collection"],techniqueId:"T1560"},{name:"Archive via Library",id:"T1560.002",reference:"https://attack.mitre.org/techniques/T1560/002",tactics:["collection"],techniqueId:"T1560"},{name:"Archive via Utility",id:"T1560.001",reference:"https://attack.mitre.org/techniques/T1560/001",tactics:["collection"],techniqueId:"T1560"},{name:"Asymmetric Cryptography",id:"T1573.002",reference:"https://attack.mitre.org/techniques/T1573/002",tactics:["command-and-control"],techniqueId:"T1573"},{name:"Asynchronous Procedure Call",id:"T1055.004",reference:"https://attack.mitre.org/techniques/T1055/004",tactics:["defense-evasion","privilege-escalation"],techniqueId:"T1055"},{name:"At (Linux)",id:"T1053.001",reference:"https://attack.mitre.org/techniques/T1053/001",tactics:["execution","persistence","privilege-escalation"],techniqueId:"T1053"},{name:"At (Windows)",id:"T1053.002",reference:"https://attack.mitre.org/techniques/T1053/002",tactics:["execution","persistence","privilege-escalation"],techniqueId:"T1053"},{name:"Authentication Package",id:"T1547.002",reference:"https://attack.mitre.org/techniques/T1547/002",tactics:["persistence","privilege-escalation"],techniqueId:"T1547"},{name:"Bash History",id:"T1552.003",reference:"https://attack.mitre.org/techniques/T1552/003",tactics:["credential-access"],techniqueId:"T1552"},{name:"Bidirectional Communication",id:"T1102.002",reference:"https://attack.mitre.org/techniques/T1102/002",tactics:["command-and-control"],techniqueId:"T1102"},{name:"Binary Padding",id:"T1027.001",reference:"https://attack.mitre.org/techniques/T1027/001",tactics:["defense-evasion"],techniqueId:"T1027"},{name:"Bootkit",id:"T1542.003",reference:"https://attack.mitre.org/techniques/T1542/003",tactics:["persistence","defense-evasion"],techniqueId:"T1542"},{name:"Botnet",id:"T1583.005",reference:"https://attack.mitre.org/techniques/T1583/005",tactics:["resource-development"],techniqueId:"T1583"},{name:"Botnet",id:"T1584.005",reference:"https://attack.mitre.org/techniques/T1584/005",tactics:["resource-development"],techniqueId:"T1584"},{name:"Business Relationships",id:"T1591.002",reference:"https://attack.mitre.org/techniques/T1591/002",tactics:["reconnaissance"],techniqueId:"T1591"},{name:"Bypass User Account Control",id:"T1548.002",reference:"https://attack.mitre.org/techniques/T1548/002",tactics:["privilege-escalation","defense-evasion"],techniqueId:"T1548"},{name:"CDNs",id:"T1596.004",reference:"https://attack.mitre.org/techniques/T1596/004",tactics:["reconnaissance"],techniqueId:"T1596"},{name:"CMSTP",id:"T1218.003",reference:"https://attack.mitre.org/techniques/T1218/003",tactics:["defense-evasion"],techniqueId:"T1218"},{name:"COR_PROFILER",id:"T1574.012",reference:"https://attack.mitre.org/techniques/T1574/012",tactics:["persistence","privilege-escalation","defense-evasion"],techniqueId:"T1574"},{name:"Cached Domain Credentials",id:"T1003.005",reference:"https://attack.mitre.org/techniques/T1003/005",tactics:["credential-access"],techniqueId:"T1003"},{name:"Change Default File Association",id:"T1546.001",reference:"https://attack.mitre.org/techniques/T1546/001",tactics:["privilege-escalation","persistence"],techniqueId:"T1546"},{name:"Clear Command History",id:"T1070.003",reference:"https://attack.mitre.org/techniques/T1070/003",tactics:["defense-evasion"],techniqueId:"T1070"},{name:"Clear Linux or Mac System Logs",id:"T1070.002",reference:"https://attack.mitre.org/techniques/T1070/002",tactics:["defense-evasion"],techniqueId:"T1070"},{name:"Clear Windows Event Logs",id:"T1070.001",reference:"https://attack.mitre.org/techniques/T1070/001",tactics:["defense-evasion"],techniqueId:"T1070"},{name:"Client Configurations",id:"T1592.004",reference:"https://attack.mitre.org/techniques/T1592/004",tactics:["reconnaissance"],techniqueId:"T1592"},{name:"Cloud Account",id:"T1136.003",reference:"https://attack.mitre.org/techniques/T1136/003",tactics:["persistence"],techniqueId:"T1136"},{name:"Cloud Account",id:"T1087.004",reference:"https://attack.mitre.org/techniques/T1087/004",tactics:["discovery"],techniqueId:"T1087"},{name:"Cloud Accounts",id:"T1078.004",reference:"https://attack.mitre.org/techniques/T1078/004",tactics:["defense-evasion","persistence","privilege-escalation","initial-access"],techniqueId:"T1078"},{name:"Cloud Groups",id:"T1069.003",reference:"https://attack.mitre.org/techniques/T1069/003",tactics:["discovery"],techniqueId:"T1069"},{name:"Cloud Instance Metadata API",id:"T1552.005",reference:"https://attack.mitre.org/techniques/T1552/005",tactics:["credential-access"],techniqueId:"T1552"},{name:"Code Signing",id:"T1553.002",reference:"https://attack.mitre.org/techniques/T1553/002",tactics:["defense-evasion"],techniqueId:"T1553"},{name:"Code Signing Certificates",id:"T1587.002",reference:"https://attack.mitre.org/techniques/T1587/002",tactics:["resource-development"],techniqueId:"T1587"},{name:"Code Signing Certificates",id:"T1588.003",reference:"https://attack.mitre.org/techniques/T1588/003",tactics:["resource-development"],techniqueId:"T1588"},{name:"Compile After Delivery",id:"T1027.004",reference:"https://attack.mitre.org/techniques/T1027/004",tactics:["defense-evasion"],techniqueId:"T1027"},{name:"Compiled HTML File",id:"T1218.001",reference:"https://attack.mitre.org/techniques/T1218/001",tactics:["defense-evasion"],techniqueId:"T1218"},{name:"Component Firmware",id:"T1542.002",reference:"https://attack.mitre.org/techniques/T1542/002",tactics:["persistence","defense-evasion"],techniqueId:"T1542"},{name:"Component Object Model",id:"T1559.001",reference:"https://attack.mitre.org/techniques/T1559/001",tactics:["execution"],techniqueId:"T1559"},{name:"Component Object Model Hijacking",id:"T1546.015",reference:"https://attack.mitre.org/techniques/T1546/015",tactics:["privilege-escalation","persistence"],techniqueId:"T1546"},{name:"Compromise Hardware Supply Chain",id:"T1195.003",reference:"https://attack.mitre.org/techniques/T1195/003",tactics:["initial-access"],techniqueId:"T1195"},{name:"Compromise Software Dependencies and Development Tools",id:"T1195.001",reference:"https://attack.mitre.org/techniques/T1195/001",tactics:["initial-access"],techniqueId:"T1195"},{name:"Compromise Software Supply Chain",id:"T1195.002",reference:"https://attack.mitre.org/techniques/T1195/002",tactics:["initial-access"],techniqueId:"T1195"},{name:"Confluence",id:"T1213.001",reference:"https://attack.mitre.org/techniques/T1213/001",tactics:["collection"],techniqueId:"T1213"},{name:"Control Panel",id:"T1218.002",reference:"https://attack.mitre.org/techniques/T1218/002",tactics:["defense-evasion"],techniqueId:"T1218"},{name:"Create Cloud Instance",id:"T1578.002",reference:"https://attack.mitre.org/techniques/T1578/002",tactics:["defense-evasion"],techniqueId:"T1578"},{name:"Create Process with Token",id:"T1134.002",reference:"https://attack.mitre.org/techniques/T1134/002",tactics:["defense-evasion","privilege-escalation"],techniqueId:"T1134"},{name:"Create Snapshot",id:"T1578.001",reference:"https://attack.mitre.org/techniques/T1578/001",tactics:["defense-evasion"],techniqueId:"T1578"},{name:"Credential API Hooking",id:"T1056.004",reference:"https://attack.mitre.org/techniques/T1056/004",tactics:["collection","credential-access"],techniqueId:"T1056"},{name:"Credential Stuffing",id:"T1110.004",reference:"https://attack.mitre.org/techniques/T1110/004",tactics:["credential-access"],techniqueId:"T1110"},{name:"Credentials",id:"T1589.001",reference:"https://attack.mitre.org/techniques/T1589/001",tactics:["reconnaissance"],techniqueId:"T1589"},{name:"Credentials In Files",id:"T1552.001",reference:"https://attack.mitre.org/techniques/T1552/001",tactics:["credential-access"],techniqueId:"T1552"},{name:"Credentials from Web Browsers",id:"T1555.003",reference:"https://attack.mitre.org/techniques/T1555/003",tactics:["credential-access"],techniqueId:"T1555"},{name:"Credentials in Registry",id:"T1552.002",reference:"https://attack.mitre.org/techniques/T1552/002",tactics:["credential-access"],techniqueId:"T1552"},{name:"Cron",id:"T1053.003",reference:"https://attack.mitre.org/techniques/T1053/003",tactics:["execution","persistence","privilege-escalation"],techniqueId:"T1053"},{name:"DCSync",id:"T1003.006",reference:"https://attack.mitre.org/techniques/T1003/006",tactics:["credential-access"],techniqueId:"T1003"},{name:"DLL Search Order Hijacking",id:"T1574.001",reference:"https://attack.mitre.org/techniques/T1574/001",tactics:["persistence","privilege-escalation","defense-evasion"],techniqueId:"T1574"},{name:"DLL Side-Loading",id:"T1574.002",reference:"https://attack.mitre.org/techniques/T1574/002",tactics:["persistence","privilege-escalation","defense-evasion"],techniqueId:"T1574"},{name:"DNS",id:"T1071.004",reference:"https://attack.mitre.org/techniques/T1071/004",tactics:["command-and-control"],techniqueId:"T1071"},{name:"DNS",id:"T1590.002",reference:"https://attack.mitre.org/techniques/T1590/002",tactics:["reconnaissance"],techniqueId:"T1590"},{name:"DNS Calculation",id:"T1568.003",reference:"https://attack.mitre.org/techniques/T1568/003",tactics:["command-and-control"],techniqueId:"T1568"},{name:"DNS Server",id:"T1583.002",reference:"https://attack.mitre.org/techniques/T1583/002",tactics:["resource-development"],techniqueId:"T1583"},{name:"DNS Server",id:"T1584.002",reference:"https://attack.mitre.org/techniques/T1584/002",tactics:["resource-development"],techniqueId:"T1584"},{name:"DNS/Passive DNS",id:"T1596.001",reference:"https://attack.mitre.org/techniques/T1596/001",tactics:["reconnaissance"],techniqueId:"T1596"},{name:"Dead Drop Resolver",id:"T1102.001",reference:"https://attack.mitre.org/techniques/T1102/001",tactics:["command-and-control"],techniqueId:"T1102"},{name:"Default Accounts",id:"T1078.001",reference:"https://attack.mitre.org/techniques/T1078/001",tactics:["defense-evasion","persistence","privilege-escalation","initial-access"],techniqueId:"T1078"},{name:"Delete Cloud Instance",id:"T1578.003",reference:"https://attack.mitre.org/techniques/T1578/003",tactics:["defense-evasion"],techniqueId:"T1578"},{name:"Determine Physical Locations",id:"T1591.001",reference:"https://attack.mitre.org/techniques/T1591/001",tactics:["reconnaissance"],techniqueId:"T1591"},{name:"Digital Certificates",id:"T1587.003",reference:"https://attack.mitre.org/techniques/T1587/003",tactics:["resource-development"],techniqueId:"T1587"},{name:"Digital Certificates",id:"T1588.004",reference:"https://attack.mitre.org/techniques/T1588/004",tactics:["resource-development"],techniqueId:"T1588"},{name:"Digital Certificates",id:"T1596.003",reference:"https://attack.mitre.org/techniques/T1596/003",tactics:["reconnaissance"],techniqueId:"T1596"},{name:"Direct Network Flood",id:"T1498.001",reference:"https://attack.mitre.org/techniques/T1498/001",tactics:["impact"],techniqueId:"T1498"},{name:"Disable Cloud Logs",id:"T1562.008",reference:"https://attack.mitre.org/techniques/T1562/008",tactics:["defense-evasion"],techniqueId:"T1562"},{name:"Disable Crypto Hardware",id:"T1600.002",reference:"https://attack.mitre.org/techniques/T1600/002",tactics:["defense-evasion"],techniqueId:"T1600"},{name:"Disable Windows Event Logging",id:"T1562.002",reference:"https://attack.mitre.org/techniques/T1562/002",tactics:["defense-evasion"],techniqueId:"T1562"},{name:"Disable or Modify Cloud Firewall",id:"T1562.007",reference:"https://attack.mitre.org/techniques/T1562/007",tactics:["defense-evasion"],techniqueId:"T1562"},{name:"Disable or Modify System Firewall",id:"T1562.004",reference:"https://attack.mitre.org/techniques/T1562/004",tactics:["defense-evasion"],techniqueId:"T1562"},{name:"Disable or Modify Tools",id:"T1562.001",reference:"https://attack.mitre.org/techniques/T1562/001",tactics:["defense-evasion"],techniqueId:"T1562"},{name:"Disk Content Wipe",id:"T1561.001",reference:"https://attack.mitre.org/techniques/T1561/001",tactics:["impact"],techniqueId:"T1561"},{name:"Disk Structure Wipe",id:"T1561.002",reference:"https://attack.mitre.org/techniques/T1561/002",tactics:["impact"],techniqueId:"T1561"},{name:"Distributed Component Object Model",id:"T1021.003",reference:"https://attack.mitre.org/techniques/T1021/003",tactics:["lateral-movement"],techniqueId:"T1021"},{name:"Domain Account",id:"T1136.002",reference:"https://attack.mitre.org/techniques/T1136/002",tactics:["persistence"],techniqueId:"T1136"},{name:"Domain Account",id:"T1087.002",reference:"https://attack.mitre.org/techniques/T1087/002",tactics:["discovery"],techniqueId:"T1087"},{name:"Domain Accounts",id:"T1078.002",reference:"https://attack.mitre.org/techniques/T1078/002",tactics:["defense-evasion","persistence","privilege-escalation","initial-access"],techniqueId:"T1078"},{name:"Domain Controller Authentication",id:"T1556.001",reference:"https://attack.mitre.org/techniques/T1556/001",tactics:["credential-access","defense-evasion"],techniqueId:"T1556"},{name:"Domain Fronting",id:"T1090.004",reference:"https://attack.mitre.org/techniques/T1090/004",tactics:["command-and-control"],techniqueId:"T1090"},{name:"Domain Generation Algorithms",id:"T1568.002",reference:"https://attack.mitre.org/techniques/T1568/002",tactics:["command-and-control"],techniqueId:"T1568"},{name:"Domain Groups",id:"T1069.002",reference:"https://attack.mitre.org/techniques/T1069/002",tactics:["discovery"],techniqueId:"T1069"},{name:"Domain Properties",id:"T1590.001",reference:"https://attack.mitre.org/techniques/T1590/001",tactics:["reconnaissance"],techniqueId:"T1590"},{name:"Domains",id:"T1583.001",reference:"https://attack.mitre.org/techniques/T1583/001",tactics:["resource-development"],techniqueId:"T1583"},{name:"Domains",id:"T1584.001",reference:"https://attack.mitre.org/techniques/T1584/001",tactics:["resource-development"],techniqueId:"T1584"},{name:"Downgrade System Image",id:"T1601.002",reference:"https://attack.mitre.org/techniques/T1601/002",tactics:["defense-evasion"],techniqueId:"T1601"},{name:"Dylib Hijacking",id:"T1574.004",reference:"https://attack.mitre.org/techniques/T1574/004",tactics:["persistence","privilege-escalation","defense-evasion"],techniqueId:"T1574"},{name:"Dynamic Data Exchange",id:"T1559.002",reference:"https://attack.mitre.org/techniques/T1559/002",tactics:["execution"],techniqueId:"T1559"},{name:"Dynamic-link Library Injection",id:"T1055.001",reference:"https://attack.mitre.org/techniques/T1055/001",tactics:["defense-evasion","privilege-escalation"],techniqueId:"T1055"},{name:"Elevated Execution with Prompt",id:"T1548.004",reference:"https://attack.mitre.org/techniques/T1548/004",tactics:["privilege-escalation","defense-evasion"],techniqueId:"T1548"},{name:"Email Account",id:"T1087.003",reference:"https://attack.mitre.org/techniques/T1087/003",tactics:["discovery"],techniqueId:"T1087"},{name:"Email Accounts",id:"T1585.002",reference:"https://attack.mitre.org/techniques/T1585/002",tactics:["resource-development"],techniqueId:"T1585"},{name:"Email Accounts",id:"T1586.002",reference:"https://attack.mitre.org/techniques/T1586/002",tactics:["resource-development"],techniqueId:"T1586"},{name:"Email Addresses",id:"T1589.002",reference:"https://attack.mitre.org/techniques/T1589/002",tactics:["reconnaissance"],techniqueId:"T1589"},{name:"Email Forwarding Rule",id:"T1114.003",reference:"https://attack.mitre.org/techniques/T1114/003",tactics:["collection"],techniqueId:"T1114"},{name:"Emond",id:"T1546.014",reference:"https://attack.mitre.org/techniques/T1546/014",tactics:["privilege-escalation","persistence"],techniqueId:"T1546"},{name:"Employee Names",id:"T1589.003",reference:"https://attack.mitre.org/techniques/T1589/003",tactics:["reconnaissance"],techniqueId:"T1589"},{name:"Environmental Keying",id:"T1480.001",reference:"https://attack.mitre.org/techniques/T1480/001",tactics:["defense-evasion"],techniqueId:"T1480"},{name:"Exchange Email Delegate Permissions",id:"T1098.002",reference:"https://attack.mitre.org/techniques/T1098/002",tactics:["persistence"],techniqueId:"T1098"},{name:"Executable Installer File Permissions Weakness",id:"T1574.005",reference:"https://attack.mitre.org/techniques/T1574/005",tactics:["persistence","privilege-escalation","defense-evasion"],techniqueId:"T1574"},{name:"Exfiltration Over Asymmetric Encrypted Non-C2 Protocol",id:"T1048.002",reference:"https://attack.mitre.org/techniques/T1048/002",tactics:["exfiltration"],techniqueId:"T1048"},{name:"Exfiltration Over Bluetooth",id:"T1011.001",reference:"https://attack.mitre.org/techniques/T1011/001",tactics:["exfiltration"],techniqueId:"T1011"},{name:"Exfiltration Over Symmetric Encrypted Non-C2 Protocol",id:"T1048.001",reference:"https://attack.mitre.org/techniques/T1048/001",tactics:["exfiltration"],techniqueId:"T1048"},{name:"Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol",id:"T1048.003",reference:"https://attack.mitre.org/techniques/T1048/003",tactics:["exfiltration"],techniqueId:"T1048"},{name:"Exfiltration over USB",id:"T1052.001",reference:"https://attack.mitre.org/techniques/T1052/001",tactics:["exfiltration"],techniqueId:"T1052"},{name:"Exfiltration to Cloud Storage",id:"T1567.002",reference:"https://attack.mitre.org/techniques/T1567/002",tactics:["exfiltration"],techniqueId:"T1567"},{name:"Exfiltration to Code Repository",id:"T1567.001",reference:"https://attack.mitre.org/techniques/T1567/001",tactics:["exfiltration"],techniqueId:"T1567"},{name:"Exploits",id:"T1587.004",reference:"https://attack.mitre.org/techniques/T1587/004",tactics:["resource-development"],techniqueId:"T1587"},{name:"Exploits",id:"T1588.005",reference:"https://attack.mitre.org/techniques/T1588/005",tactics:["resource-development"],techniqueId:"T1588"},{name:"External Defacement",id:"T1491.002",reference:"https://attack.mitre.org/techniques/T1491/002",tactics:["impact"],techniqueId:"T1491"},{name:"External Proxy",id:"T1090.002",reference:"https://attack.mitre.org/techniques/T1090/002",tactics:["command-and-control"],techniqueId:"T1090"},{name:"Extra Window Memory Injection",id:"T1055.011",reference:"https://attack.mitre.org/techniques/T1055/011",tactics:["defense-evasion","privilege-escalation"],techniqueId:"T1055"},{name:"Fast Flux DNS",id:"T1568.001",reference:"https://attack.mitre.org/techniques/T1568/001",tactics:["command-and-control"],techniqueId:"T1568"},{name:"File Deletion",id:"T1070.004",reference:"https://attack.mitre.org/techniques/T1070/004",tactics:["defense-evasion"],techniqueId:"T1070"},{name:"File Transfer Protocols",id:"T1071.002",reference:"https://attack.mitre.org/techniques/T1071/002",tactics:["command-and-control"],techniqueId:"T1071"},{name:"Firmware",id:"T1592.003",reference:"https://attack.mitre.org/techniques/T1592/003",tactics:["reconnaissance"],techniqueId:"T1592"},{name:"GUI Input Capture",id:"T1056.002",reference:"https://attack.mitre.org/techniques/T1056/002",tactics:["collection","credential-access"],techniqueId:"T1056"},{name:"Gatekeeper Bypass",id:"T1553.001",reference:"https://attack.mitre.org/techniques/T1553/001",tactics:["defense-evasion"],techniqueId:"T1553"},{name:"Golden Ticket",id:"T1558.001",reference:"https://attack.mitre.org/techniques/T1558/001",tactics:["credential-access"],techniqueId:"T1558"},{name:"Group Policy Preferences",id:"T1552.006",reference:"https://attack.mitre.org/techniques/T1552/006",tactics:["credential-access"],techniqueId:"T1552"},{name:"Hardware",id:"T1592.001",reference:"https://attack.mitre.org/techniques/T1592/001",tactics:["reconnaissance"],techniqueId:"T1592"},{name:"Hidden File System",id:"T1564.005",reference:"https://attack.mitre.org/techniques/T1564/005",tactics:["defense-evasion"],techniqueId:"T1564"},{name:"Hidden Files and Directories",id:"T1564.001",reference:"https://attack.mitre.org/techniques/T1564/001",tactics:["defense-evasion"],techniqueId:"T1564"},{name:"Hidden Users",id:"T1564.002",reference:"https://attack.mitre.org/techniques/T1564/002",tactics:["defense-evasion"],techniqueId:"T1564"},{name:"Hidden Window",id:"T1564.003",reference:"https://attack.mitre.org/techniques/T1564/003",tactics:["defense-evasion"],techniqueId:"T1564"},{name:"IP Addresses",id:"T1590.005",reference:"https://attack.mitre.org/techniques/T1590/005",tactics:["reconnaissance"],techniqueId:"T1590"},{name:"Identify Business Tempo",id:"T1591.003",reference:"https://attack.mitre.org/techniques/T1591/003",tactics:["reconnaissance"],techniqueId:"T1591"},{name:"Identify Roles",id:"T1591.004",reference:"https://attack.mitre.org/techniques/T1591/004",tactics:["reconnaissance"],techniqueId:"T1591"},{name:"Image File Execution Options Injection",id:"T1546.012",reference:"https://attack.mitre.org/techniques/T1546/012",tactics:["privilege-escalation","persistence"],techniqueId:"T1546"},{name:"Impair Command History Logging",id:"T1562.003",reference:"https://attack.mitre.org/techniques/T1562/003",tactics:["defense-evasion"],techniqueId:"T1562"},{name:"Indicator Blocking",id:"T1562.006",reference:"https://attack.mitre.org/techniques/T1562/006",tactics:["defense-evasion"],techniqueId:"T1562"},{name:"Indicator Removal from Tools",id:"T1027.005",reference:"https://attack.mitre.org/techniques/T1027/005",tactics:["defense-evasion"],techniqueId:"T1027"},{name:"Install Root Certificate",id:"T1553.004",reference:"https://attack.mitre.org/techniques/T1553/004",tactics:["defense-evasion"],techniqueId:"T1553"},{name:"InstallUtil",id:"T1218.004",reference:"https://attack.mitre.org/techniques/T1218/004",tactics:["defense-evasion"],techniqueId:"T1218"},{name:"Internal Defacement",id:"T1491.001",reference:"https://attack.mitre.org/techniques/T1491/001",tactics:["impact"],techniqueId:"T1491"},{name:"Internal Proxy",id:"T1090.001",reference:"https://attack.mitre.org/techniques/T1090/001",tactics:["command-and-control"],techniqueId:"T1090"},{name:"Invalid Code Signature",id:"T1036.001",reference:"https://attack.mitre.org/techniques/T1036/001",tactics:["defense-evasion"],techniqueId:"T1036"},{name:"JavaScript/JScript",id:"T1059.007",reference:"https://attack.mitre.org/techniques/T1059/007",tactics:["execution"],techniqueId:"T1059"},{name:"Junk Data",id:"T1001.001",reference:"https://attack.mitre.org/techniques/T1001/001",tactics:["command-and-control"],techniqueId:"T1001"},{name:"Kerberoasting",id:"T1558.003",reference:"https://attack.mitre.org/techniques/T1558/003",tactics:["credential-access"],techniqueId:"T1558"},{name:"Kernel Modules and Extensions",id:"T1547.006",reference:"https://attack.mitre.org/techniques/T1547/006",tactics:["persistence","privilege-escalation"],techniqueId:"T1547"},{name:"Keychain",id:"T1555.001",reference:"https://attack.mitre.org/techniques/T1555/001",tactics:["credential-access"],techniqueId:"T1555"},{name:"Keylogging",id:"T1056.001",reference:"https://attack.mitre.org/techniques/T1056/001",tactics:["collection","credential-access"],techniqueId:"T1056"},{name:"LC_LOAD_DYLIB Addition",id:"T1546.006",reference:"https://attack.mitre.org/techniques/T1546/006",tactics:["privilege-escalation","persistence"],techniqueId:"T1546"},{name:"LD_PRELOAD",id:"T1574.006",reference:"https://attack.mitre.org/techniques/T1574/006",tactics:["persistence","privilege-escalation","defense-evasion"],techniqueId:"T1574"},{name:"LLMNR/NBT-NS Poisoning and SMB Relay",id:"T1557.001",reference:"https://attack.mitre.org/techniques/T1557/001",tactics:["credential-access","collection"],techniqueId:"T1557"},{name:"LSA Secrets",id:"T1003.004",reference:"https://attack.mitre.org/techniques/T1003/004",tactics:["credential-access"],techniqueId:"T1003"},{name:"LSASS Driver",id:"T1547.008",reference:"https://attack.mitre.org/techniques/T1547/008",tactics:["persistence","privilege-escalation"],techniqueId:"T1547"},{name:"LSASS Memory",id:"T1003.001",reference:"https://attack.mitre.org/techniques/T1003/001",tactics:["credential-access"],techniqueId:"T1003"},{name:"Launch Agent",id:"T1543.001",reference:"https://attack.mitre.org/techniques/T1543/001",tactics:["persistence","privilege-escalation"],techniqueId:"T1543"},{name:"Launch Daemon",id:"T1543.004",reference:"https://attack.mitre.org/techniques/T1543/004",tactics:["persistence","privilege-escalation"],techniqueId:"T1543"},{name:"Launchctl",id:"T1569.001",reference:"https://attack.mitre.org/techniques/T1569/001",tactics:["execution"],techniqueId:"T1569"},{name:"Launchd",id:"T1053.004",reference:"https://attack.mitre.org/techniques/T1053/004",tactics:["execution","persistence","privilege-escalation"],techniqueId:"T1053"},{name:"Linux and Mac File and Directory Permissions Modification",id:"T1222.002",reference:"https://attack.mitre.org/techniques/T1222/002",tactics:["defense-evasion"],techniqueId:"T1222"},{name:"Local Account",id:"T1136.001",reference:"https://attack.mitre.org/techniques/T1136/001",tactics:["persistence"],techniqueId:"T1136"},{name:"Local Account",id:"T1087.001",reference:"https://attack.mitre.org/techniques/T1087/001",tactics:["discovery"],techniqueId:"T1087"},{name:"Local Accounts",id:"T1078.003",reference:"https://attack.mitre.org/techniques/T1078/003",tactics:["defense-evasion","persistence","privilege-escalation","initial-access"],techniqueId:"T1078"},{name:"Local Data Staging",id:"T1074.001",reference:"https://attack.mitre.org/techniques/T1074/001",tactics:["collection"],techniqueId:"T1074"},{name:"Local Email Collection",id:"T1114.001",reference:"https://attack.mitre.org/techniques/T1114/001",tactics:["collection"],techniqueId:"T1114"},{name:"Local Groups",id:"T1069.001",reference:"https://attack.mitre.org/techniques/T1069/001",tactics:["discovery"],techniqueId:"T1069"},{name:"Logon Script (Mac)",id:"T1037.002",reference:"https://attack.mitre.org/techniques/T1037/002",tactics:["persistence","privilege-escalation"],techniqueId:"T1037"},{name:"Logon Script (Windows)",id:"T1037.001",reference:"https://attack.mitre.org/techniques/T1037/001",tactics:["persistence","privilege-escalation"],techniqueId:"T1037"},{name:"MSBuild",id:"T1127.001",reference:"https://attack.mitre.org/techniques/T1127/001",tactics:["defense-evasion"],techniqueId:"T1127"},{name:"Mail Protocols",id:"T1071.003",reference:"https://attack.mitre.org/techniques/T1071/003",tactics:["command-and-control"],techniqueId:"T1071"},{name:"Make and Impersonate Token",id:"T1134.003",reference:"https://attack.mitre.org/techniques/T1134/003",tactics:["defense-evasion","privilege-escalation"],techniqueId:"T1134"},{name:"Malicious File",id:"T1204.002",reference:"https://attack.mitre.org/techniques/T1204/002",tactics:["execution"],techniqueId:"T1204"},{name:"Malicious Link",id:"T1204.001",reference:"https://attack.mitre.org/techniques/T1204/001",tactics:["execution"],techniqueId:"T1204"},{name:"Malware",id:"T1587.001",reference:"https://attack.mitre.org/techniques/T1587/001",tactics:["resource-development"],techniqueId:"T1587"},{name:"Malware",id:"T1588.001",reference:"https://attack.mitre.org/techniques/T1588/001",tactics:["resource-development"],techniqueId:"T1588"},{name:"Masquerade Task or Service",id:"T1036.004",reference:"https://attack.mitre.org/techniques/T1036/004",tactics:["defense-evasion"],techniqueId:"T1036"},{name:"Match Legitimate Name or Location",id:"T1036.005",reference:"https://attack.mitre.org/techniques/T1036/005",tactics:["defense-evasion"],techniqueId:"T1036"},{name:"Mshta",id:"T1218.005",reference:"https://attack.mitre.org/techniques/T1218/005",tactics:["defense-evasion"],techniqueId:"T1218"},{name:"Msiexec",id:"T1218.007",reference:"https://attack.mitre.org/techniques/T1218/007",tactics:["defense-evasion"],techniqueId:"T1218"},{name:"Multi-hop Proxy",id:"T1090.003",reference:"https://attack.mitre.org/techniques/T1090/003",tactics:["command-and-control"],techniqueId:"T1090"},{name:"NTDS",id:"T1003.003",reference:"https://attack.mitre.org/techniques/T1003/003",tactics:["credential-access"],techniqueId:"T1003"},{name:"NTFS File Attributes",id:"T1564.004",reference:"https://attack.mitre.org/techniques/T1564/004",tactics:["defense-evasion"],techniqueId:"T1564"},{name:"Netsh Helper DLL",id:"T1546.007",reference:"https://attack.mitre.org/techniques/T1546/007",tactics:["privilege-escalation","persistence"],techniqueId:"T1546"},{name:"Network Address Translation Traversal",id:"T1599.001",reference:"https://attack.mitre.org/techniques/T1599/001",tactics:["defense-evasion"],techniqueId:"T1599"},{name:"Network Device Authentication",id:"T1556.004",reference:"https://attack.mitre.org/techniques/T1556/004",tactics:["credential-access","defense-evasion"],techniqueId:"T1556"},{name:"Network Device CLI",id:"T1059.008",reference:"https://attack.mitre.org/techniques/T1059/008",tactics:["execution"],techniqueId:"T1059"},{name:"Network Device Configuration Dump",id:"T1602.002",reference:"https://attack.mitre.org/techniques/T1602/002",tactics:["collection"],techniqueId:"T1602"},{name:"Network Logon Script",id:"T1037.003",reference:"https://attack.mitre.org/techniques/T1037/003",tactics:["persistence","privilege-escalation"],techniqueId:"T1037"},{name:"Network Security Appliances",id:"T1590.006",reference:"https://attack.mitre.org/techniques/T1590/006",tactics:["reconnaissance"],techniqueId:"T1590"},{name:"Network Share Connection Removal",id:"T1070.005",reference:"https://attack.mitre.org/techniques/T1070/005",tactics:["defense-evasion"],techniqueId:"T1070"},{name:"Network Topology",id:"T1590.004",reference:"https://attack.mitre.org/techniques/T1590/004",tactics:["reconnaissance"],techniqueId:"T1590"},{name:"Network Trust Dependencies",id:"T1590.003",reference:"https://attack.mitre.org/techniques/T1590/003",tactics:["reconnaissance"],techniqueId:"T1590"},{name:"Non-Standard Encoding",id:"T1132.002",reference:"https://attack.mitre.org/techniques/T1132/002",tactics:["command-and-control"],techniqueId:"T1132"},{name:"OS Exhaustion Flood",id:"T1499.001",reference:"https://attack.mitre.org/techniques/T1499/001",tactics:["impact"],techniqueId:"T1499"},{name:"Odbcconf",id:"T1218.008",reference:"https://attack.mitre.org/techniques/T1218/008",tactics:["defense-evasion"],techniqueId:"T1218"},{name:"Office Template Macros",id:"T1137.001",reference:"https://attack.mitre.org/techniques/T1137/001",tactics:["persistence"],techniqueId:"T1137"},{name:"Office Test",id:"T1137.002",reference:"https://attack.mitre.org/techniques/T1137/002",tactics:["persistence"],techniqueId:"T1137"},{name:"One-Way Communication",id:"T1102.003",reference:"https://attack.mitre.org/techniques/T1102/003",tactics:["command-and-control"],techniqueId:"T1102"},{name:"Outlook Forms",id:"T1137.003",reference:"https://attack.mitre.org/techniques/T1137/003",tactics:["persistence"],techniqueId:"T1137"},{name:"Outlook Home Page",id:"T1137.004",reference:"https://attack.mitre.org/techniques/T1137/004",tactics:["persistence"],techniqueId:"T1137"},{name:"Outlook Rules",id:"T1137.005",reference:"https://attack.mitre.org/techniques/T1137/005",tactics:["persistence"],techniqueId:"T1137"},{name:"Parent PID Spoofing",id:"T1134.004",reference:"https://attack.mitre.org/techniques/T1134/004",tactics:["defense-evasion","privilege-escalation"],techniqueId:"T1134"},{name:"Pass the Hash",id:"T1550.002",reference:"https://attack.mitre.org/techniques/T1550/002",tactics:["defense-evasion","lateral-movement"],techniqueId:"T1550"},{name:"Pass the Ticket",id:"T1550.003",reference:"https://attack.mitre.org/techniques/T1550/003",tactics:["defense-evasion","lateral-movement"],techniqueId:"T1550"},{name:"Password Cracking",id:"T1110.002",reference:"https://attack.mitre.org/techniques/T1110/002",tactics:["credential-access"],techniqueId:"T1110"},{name:"Password Filter DLL",id:"T1556.002",reference:"https://attack.mitre.org/techniques/T1556/002",tactics:["credential-access","defense-evasion"],techniqueId:"T1556"},{name:"Password Guessing",id:"T1110.001",reference:"https://attack.mitre.org/techniques/T1110/001",tactics:["credential-access"],techniqueId:"T1110"},{name:"Password Spraying",id:"T1110.003",reference:"https://attack.mitre.org/techniques/T1110/003",tactics:["credential-access"],techniqueId:"T1110"},{name:"Patch System Image",id:"T1601.001",reference:"https://attack.mitre.org/techniques/T1601/001",tactics:["defense-evasion"],techniqueId:"T1601"},{name:"Path Interception by PATH Environment Variable",id:"T1574.007",reference:"https://attack.mitre.org/techniques/T1574/007",tactics:["persistence","privilege-escalation","defense-evasion"],techniqueId:"T1574"},{name:"Path Interception by Search Order Hijacking",id:"T1574.008",reference:"https://attack.mitre.org/techniques/T1574/008",tactics:["persistence","privilege-escalation","defense-evasion"],techniqueId:"T1574"},{name:"Path Interception by Unquoted Path",id:"T1574.009",reference:"https://attack.mitre.org/techniques/T1574/009",tactics:["persistence","privilege-escalation","defense-evasion"],techniqueId:"T1574"},{name:"Plist Modification",id:"T1547.011",reference:"https://attack.mitre.org/techniques/T1547/011",tactics:["persistence","privilege-escalation"],techniqueId:"T1547"},{name:"Pluggable Authentication Modules",id:"T1556.003",reference:"https://attack.mitre.org/techniques/T1556/003",tactics:["credential-access","defense-evasion"],techniqueId:"T1556"},{name:"Port Knocking",id:"T1205.001",reference:"https://attack.mitre.org/techniques/T1205/001",tactics:["defense-evasion","persistence","command-and-control"],techniqueId:"T1205"},{name:"Port Monitors",id:"T1547.010",reference:"https://attack.mitre.org/techniques/T1547/010",tactics:["persistence","privilege-escalation"],techniqueId:"T1547"},{name:"Portable Executable Injection",id:"T1055.002",reference:"https://attack.mitre.org/techniques/T1055/002",tactics:["defense-evasion","privilege-escalation"],techniqueId:"T1055"},{name:"PowerShell",id:"T1059.001",reference:"https://attack.mitre.org/techniques/T1059/001",tactics:["execution"],techniqueId:"T1059"},{name:"PowerShell Profile",id:"T1546.013",reference:"https://attack.mitre.org/techniques/T1546/013",tactics:["privilege-escalation","persistence"],techniqueId:"T1546"},{name:"Print Processors",id:"T1547.012",reference:"https://attack.mitre.org/techniques/T1547/012",tactics:["persistence","privilege-escalation"],techniqueId:"T1547"},{name:"Private Keys",id:"T1552.004",reference:"https://attack.mitre.org/techniques/T1552/004",tactics:["credential-access"],techniqueId:"T1552"},{name:"Proc Filesystem",id:"T1003.007",reference:"https://attack.mitre.org/techniques/T1003/007",tactics:["credential-access"],techniqueId:"T1003"},{name:"Proc Memory",id:"T1055.009",reference:"https://attack.mitre.org/techniques/T1055/009",tactics:["defense-evasion","privilege-escalation"],techniqueId:"T1055"},{name:"Process Doppelgänging",id:"T1055.013",reference:"https://attack.mitre.org/techniques/T1055/013",tactics:["defense-evasion","privilege-escalation"],techniqueId:"T1055"},{name:"Process Hollowing",id:"T1055.012",reference:"https://attack.mitre.org/techniques/T1055/012",tactics:["defense-evasion","privilege-escalation"],techniqueId:"T1055"},{name:"Protocol Impersonation",id:"T1001.003",reference:"https://attack.mitre.org/techniques/T1001/003",tactics:["command-and-control"],techniqueId:"T1001"},{name:"Ptrace System Calls",id:"T1055.008",reference:"https://attack.mitre.org/techniques/T1055/008",tactics:["defense-evasion","privilege-escalation"],techniqueId:"T1055"},{name:"PubPrn",id:"T1216.001",reference:"https://attack.mitre.org/techniques/T1216/001",tactics:["defense-evasion"],techniqueId:"T1216"},{name:"Purchase Technical Data",id:"T1597.002",reference:"https://attack.mitre.org/techniques/T1597/002",tactics:["reconnaissance"],techniqueId:"T1597"},{name:"Python",id:"T1059.006",reference:"https://attack.mitre.org/techniques/T1059/006",tactics:["execution"],techniqueId:"T1059"},{name:"RDP Hijacking",id:"T1563.002",reference:"https://attack.mitre.org/techniques/T1563/002",tactics:["lateral-movement"],techniqueId:"T1563"},{name:"ROMMONkit",id:"T1542.004",reference:"https://attack.mitre.org/techniques/T1542/004",tactics:["defense-evasion","persistence"],techniqueId:"T1542"},{name:"Rc.common",id:"T1037.004",reference:"https://attack.mitre.org/techniques/T1037/004",tactics:["persistence","privilege-escalation"],techniqueId:"T1037"},{name:"Re-opened Applications",id:"T1547.007",reference:"https://attack.mitre.org/techniques/T1547/007",tactics:["persistence","privilege-escalation"],techniqueId:"T1547"},{name:"Reduce Key Space",id:"T1600.001",reference:"https://attack.mitre.org/techniques/T1600/001",tactics:["defense-evasion"],techniqueId:"T1600"},{name:"Reflection Amplification",id:"T1498.002",reference:"https://attack.mitre.org/techniques/T1498/002",tactics:["impact"],techniqueId:"T1498"},{name:"Registry Run Keys / Startup Folder",id:"T1547.001",reference:"https://attack.mitre.org/techniques/T1547/001",tactics:["persistence","privilege-escalation"],techniqueId:"T1547"},{name:"Regsvcs/Regasm",id:"T1218.009",reference:"https://attack.mitre.org/techniques/T1218/009",tactics:["defense-evasion"],techniqueId:"T1218"},{name:"Regsvr32",id:"T1218.010",reference:"https://attack.mitre.org/techniques/T1218/010",tactics:["defense-evasion"],techniqueId:"T1218"},{name:"Remote Data Staging",id:"T1074.002",reference:"https://attack.mitre.org/techniques/T1074/002",tactics:["collection"],techniqueId:"T1074"},{name:"Remote Desktop Protocol",id:"T1021.001",reference:"https://attack.mitre.org/techniques/T1021/001",tactics:["lateral-movement"],techniqueId:"T1021"},{name:"Remote Email Collection",id:"T1114.002",reference:"https://attack.mitre.org/techniques/T1114/002",tactics:["collection"],techniqueId:"T1114"},{name:"Rename System Utilities",id:"T1036.003",reference:"https://attack.mitre.org/techniques/T1036/003",tactics:["defense-evasion"],techniqueId:"T1036"},{name:"Revert Cloud Instance",id:"T1578.004",reference:"https://attack.mitre.org/techniques/T1578/004",tactics:["defense-evasion"],techniqueId:"T1578"},{name:"Right-to-Left Override",id:"T1036.002",reference:"https://attack.mitre.org/techniques/T1036/002",tactics:["defense-evasion"],techniqueId:"T1036"},{name:"Run Virtual Instance",id:"T1564.006",reference:"https://attack.mitre.org/techniques/T1564/006",tactics:["defense-evasion"],techniqueId:"T1564"},{name:"Rundll32",id:"T1218.011",reference:"https://attack.mitre.org/techniques/T1218/011",tactics:["defense-evasion"],techniqueId:"T1218"},{name:"Runtime Data Manipulation",id:"T1565.003",reference:"https://attack.mitre.org/techniques/T1565/003",tactics:["impact"],techniqueId:"T1565"},{name:"SID-History Injection",id:"T1134.005",reference:"https://attack.mitre.org/techniques/T1134/005",tactics:["defense-evasion","privilege-escalation"],techniqueId:"T1134"},{name:"SIP and Trust Provider Hijacking",id:"T1553.003",reference:"https://attack.mitre.org/techniques/T1553/003",tactics:["defense-evasion"],techniqueId:"T1553"},{name:"SMB/Windows Admin Shares",id:"T1021.002",reference:"https://attack.mitre.org/techniques/T1021/002",tactics:["lateral-movement"],techniqueId:"T1021"},{name:"SNMP (MIB Dump)",id:"T1602.001",reference:"https://attack.mitre.org/techniques/T1602/001",tactics:["collection"],techniqueId:"T1602"},{name:"SQL Stored Procedures",id:"T1505.001",reference:"https://attack.mitre.org/techniques/T1505/001",tactics:["persistence"],techniqueId:"T1505"},{name:"SSH",id:"T1021.004",reference:"https://attack.mitre.org/techniques/T1021/004",tactics:["lateral-movement"],techniqueId:"T1021"},{name:"SSH Authorized Keys",id:"T1098.004",reference:"https://attack.mitre.org/techniques/T1098/004",tactics:["persistence"],techniqueId:"T1098"},{name:"SSH Hijacking",id:"T1563.001",reference:"https://attack.mitre.org/techniques/T1563/001",tactics:["lateral-movement"],techniqueId:"T1563"},{name:"Scan Databases",id:"T1596.005",reference:"https://attack.mitre.org/techniques/T1596/005",tactics:["reconnaissance"],techniqueId:"T1596"},{name:"Scanning IP Blocks",id:"T1595.001",reference:"https://attack.mitre.org/techniques/T1595/001",tactics:["reconnaissance"],techniqueId:"T1595"},{name:"Scheduled Task",id:"T1053.005",reference:"https://attack.mitre.org/techniques/T1053/005",tactics:["execution","persistence","privilege-escalation"],techniqueId:"T1053"},{name:"Screensaver",id:"T1546.002",reference:"https://attack.mitre.org/techniques/T1546/002",tactics:["privilege-escalation","persistence"],techniqueId:"T1546"},{name:"Search Engines",id:"T1593.002",reference:"https://attack.mitre.org/techniques/T1593/002",tactics:["reconnaissance"],techniqueId:"T1593"},{name:"Security Account Manager",id:"T1003.002",reference:"https://attack.mitre.org/techniques/T1003/002",tactics:["credential-access"],techniqueId:"T1003"},{name:"Security Software Discovery",id:"T1518.001",reference:"https://attack.mitre.org/techniques/T1518/001",tactics:["discovery"],techniqueId:"T1518"},{name:"Security Support Provider",id:"T1547.005",reference:"https://attack.mitre.org/techniques/T1547/005",tactics:["persistence","privilege-escalation"],techniqueId:"T1547"},{name:"Securityd Memory",id:"T1555.002",reference:"https://attack.mitre.org/techniques/T1555/002",tactics:["credential-access"],techniqueId:"T1555"},{name:"Server",id:"T1583.004",reference:"https://attack.mitre.org/techniques/T1583/004",tactics:["resource-development"],techniqueId:"T1583"},{name:"Server",id:"T1584.004",reference:"https://attack.mitre.org/techniques/T1584/004",tactics:["resource-development"],techniqueId:"T1584"},{name:"Service Execution",id:"T1569.002",reference:"https://attack.mitre.org/techniques/T1569/002",tactics:["execution"],techniqueId:"T1569"},{name:"Service Exhaustion Flood",id:"T1499.002",reference:"https://attack.mitre.org/techniques/T1499/002",tactics:["impact"],techniqueId:"T1499"},{name:"Services File Permissions Weakness",id:"T1574.010",reference:"https://attack.mitre.org/techniques/T1574/010",tactics:["persistence","privilege-escalation","defense-evasion"],techniqueId:"T1574"},{name:"Services Registry Permissions Weakness",id:"T1574.011",reference:"https://attack.mitre.org/techniques/T1574/011",tactics:["persistence","privilege-escalation","defense-evasion"],techniqueId:"T1574"},{name:"Setuid and Setgid",id:"T1548.001",reference:"https://attack.mitre.org/techniques/T1548/001",tactics:["privilege-escalation","defense-evasion"],techniqueId:"T1548"},{name:"Sharepoint",id:"T1213.002",reference:"https://attack.mitre.org/techniques/T1213/002",tactics:["collection"],techniqueId:"T1213"},{name:"Shortcut Modification",id:"T1547.009",reference:"https://attack.mitre.org/techniques/T1547/009",tactics:["persistence","privilege-escalation"],techniqueId:"T1547"},{name:"Silver Ticket",id:"T1558.002",reference:"https://attack.mitre.org/techniques/T1558/002",tactics:["credential-access"],techniqueId:"T1558"},{name:"Social Media",id:"T1593.001",reference:"https://attack.mitre.org/techniques/T1593/001",tactics:["reconnaissance"],techniqueId:"T1593"},{name:"Social Media Accounts",id:"T1585.001",reference:"https://attack.mitre.org/techniques/T1585/001",tactics:["resource-development"],techniqueId:"T1585"},{name:"Social Media Accounts",id:"T1586.001",reference:"https://attack.mitre.org/techniques/T1586/001",tactics:["resource-development"],techniqueId:"T1586"},{name:"Software",id:"T1592.002",reference:"https://attack.mitre.org/techniques/T1592/002",tactics:["reconnaissance"],techniqueId:"T1592"},{name:"Software Packing",id:"T1027.002",reference:"https://attack.mitre.org/techniques/T1027/002",tactics:["defense-evasion"],techniqueId:"T1027"},{name:"Space after Filename",id:"T1036.006",reference:"https://attack.mitre.org/techniques/T1036/006",tactics:["defense-evasion"],techniqueId:"T1036"},{name:"Spearphishing Attachment",id:"T1566.001",reference:"https://attack.mitre.org/techniques/T1566/001",tactics:["initial-access"],techniqueId:"T1566"},{name:"Spearphishing Attachment",id:"T1598.002",reference:"https://attack.mitre.org/techniques/T1598/002",tactics:["reconnaissance"],techniqueId:"T1598"},{name:"Spearphishing Link",id:"T1566.002",reference:"https://attack.mitre.org/techniques/T1566/002",tactics:["initial-access"],techniqueId:"T1566"},{name:"Spearphishing Link",id:"T1598.003",reference:"https://attack.mitre.org/techniques/T1598/003",tactics:["reconnaissance"],techniqueId:"T1598"},{name:"Spearphishing Service",id:"T1598.001",reference:"https://attack.mitre.org/techniques/T1598/001",tactics:["reconnaissance"],techniqueId:"T1598"},{name:"Spearphishing via Service",id:"T1566.003",reference:"https://attack.mitre.org/techniques/T1566/003",tactics:["initial-access"],techniqueId:"T1566"},{name:"Standard Encoding",id:"T1132.001",reference:"https://attack.mitre.org/techniques/T1132/001",tactics:["command-and-control"],techniqueId:"T1132"},{name:"Startup Items",id:"T1037.005",reference:"https://attack.mitre.org/techniques/T1037/005",tactics:["persistence","privilege-escalation"],techniqueId:"T1037"},{name:"Steganography",id:"T1027.003",reference:"https://attack.mitre.org/techniques/T1027/003",tactics:["defense-evasion"],techniqueId:"T1027"},{name:"Steganography",id:"T1001.002",reference:"https://attack.mitre.org/techniques/T1001/002",tactics:["command-and-control"],techniqueId:"T1001"},{name:"Stored Data Manipulation",id:"T1565.001",reference:"https://attack.mitre.org/techniques/T1565/001",tactics:["impact"],techniqueId:"T1565"},{name:"Sudo and Sudo Caching",id:"T1548.003",reference:"https://attack.mitre.org/techniques/T1548/003",tactics:["privilege-escalation","defense-evasion"],techniqueId:"T1548"},{name:"Symmetric Cryptography",id:"T1573.001",reference:"https://attack.mitre.org/techniques/T1573/001",tactics:["command-and-control"],techniqueId:"T1573"},{name:"System Checks",id:"T1497.001",reference:"https://attack.mitre.org/techniques/T1497/001",tactics:["defense-evasion","discovery"],techniqueId:"T1497"},{name:"System Firmware",id:"T1542.001",reference:"https://attack.mitre.org/techniques/T1542/001",tactics:["persistence","defense-evasion"],techniqueId:"T1542"},{name:"Systemd Service",id:"T1543.002",reference:"https://attack.mitre.org/techniques/T1543/002",tactics:["persistence","privilege-escalation"],techniqueId:"T1543"},{name:"Systemd Timers",id:"T1053.006",reference:"https://attack.mitre.org/techniques/T1053/006",tactics:["execution","persistence","privilege-escalation"],techniqueId:"T1053"},{name:"TFTP Boot",id:"T1542.005",reference:"https://attack.mitre.org/techniques/T1542/005",tactics:["defense-evasion","persistence"],techniqueId:"T1542"},{name:"Thread Execution Hijacking",id:"T1055.003",reference:"https://attack.mitre.org/techniques/T1055/003",tactics:["defense-evasion","privilege-escalation"],techniqueId:"T1055"},{name:"Thread Local Storage",id:"T1055.005",reference:"https://attack.mitre.org/techniques/T1055/005",tactics:["defense-evasion","privilege-escalation"],techniqueId:"T1055"},{name:"Threat Intel Vendors",id:"T1597.001",reference:"https://attack.mitre.org/techniques/T1597/001",tactics:["reconnaissance"],techniqueId:"T1597"},{name:"Time Based Evasion",id:"T1497.003",reference:"https://attack.mitre.org/techniques/T1497/003",tactics:["defense-evasion","discovery"],techniqueId:"T1497"},{name:"Time Providers",id:"T1547.003",reference:"https://attack.mitre.org/techniques/T1547/003",tactics:["persistence","privilege-escalation"],techniqueId:"T1547"},{name:"Timestomp",id:"T1070.006",reference:"https://attack.mitre.org/techniques/T1070/006",tactics:["defense-evasion"],techniqueId:"T1070"},{name:"Token Impersonation/Theft",id:"T1134.001",reference:"https://attack.mitre.org/techniques/T1134/001",tactics:["defense-evasion","privilege-escalation"],techniqueId:"T1134"},{name:"Tool",id:"T1588.002",reference:"https://attack.mitre.org/techniques/T1588/002",tactics:["resource-development"],techniqueId:"T1588"},{name:"Traffic Duplication",id:"T1020.001",reference:"https://attack.mitre.org/techniques/T1020/001",tactics:["exfiltration"],techniqueId:"T1020"},{name:"Transmitted Data Manipulation",id:"T1565.002",reference:"https://attack.mitre.org/techniques/T1565/002",tactics:["impact"],techniqueId:"T1565"},{name:"Transport Agent",id:"T1505.002",reference:"https://attack.mitre.org/techniques/T1505/002",tactics:["persistence"],techniqueId:"T1505"},{name:"Trap",id:"T1546.005",reference:"https://attack.mitre.org/techniques/T1546/005",tactics:["privilege-escalation","persistence"],techniqueId:"T1546"},{name:"Unix Shell",id:"T1059.004",reference:"https://attack.mitre.org/techniques/T1059/004",tactics:["execution"],techniqueId:"T1059"},{name:"User Activity Based Checks",id:"T1497.002",reference:"https://attack.mitre.org/techniques/T1497/002",tactics:["defense-evasion","discovery"],techniqueId:"T1497"},{name:"VBA Stomping",id:"T1564.007",reference:"https://attack.mitre.org/techniques/T1564/007",tactics:["defense-evasion"],techniqueId:"T1564"},{name:"VDSO Hijacking",id:"T1055.014",reference:"https://attack.mitre.org/techniques/T1055/014",tactics:["defense-evasion","privilege-escalation"],techniqueId:"T1055"},{name:"VNC",id:"T1021.005",reference:"https://attack.mitre.org/techniques/T1021/005",tactics:["lateral-movement"],techniqueId:"T1021"},{name:"Verclsid",id:"T1218.012",reference:"https://attack.mitre.org/techniques/T1218/012",tactics:["defense-evasion"],techniqueId:"T1218"},{name:"Virtual Private Server",id:"T1583.003",reference:"https://attack.mitre.org/techniques/T1583/003",tactics:["resource-development"],techniqueId:"T1583"},{name:"Virtual Private Server",id:"T1584.003",reference:"https://attack.mitre.org/techniques/T1584/003",tactics:["resource-development"],techniqueId:"T1584"},{name:"Visual Basic",id:"T1059.005",reference:"https://attack.mitre.org/techniques/T1059/005",tactics:["execution"],techniqueId:"T1059"},{name:"Vulnerabilities",id:"T1588.006",reference:"https://attack.mitre.org/techniques/T1588/006",tactics:["resource-development"],techniqueId:"T1588"},{name:"Vulnerability Scanning",id:"T1595.002",reference:"https://attack.mitre.org/techniques/T1595/002",tactics:["reconnaissance"],techniqueId:"T1595"},{name:"WHOIS",id:"T1596.002",reference:"https://attack.mitre.org/techniques/T1596/002",tactics:["reconnaissance"],techniqueId:"T1596"},{name:"Web Portal Capture",id:"T1056.003",reference:"https://attack.mitre.org/techniques/T1056/003",tactics:["collection","credential-access"],techniqueId:"T1056"},{name:"Web Protocols",id:"T1071.001",reference:"https://attack.mitre.org/techniques/T1071/001",tactics:["command-and-control"],techniqueId:"T1071"},{name:"Web Services",id:"T1583.006",reference:"https://attack.mitre.org/techniques/T1583/006",tactics:["resource-development"],techniqueId:"T1583"},{name:"Web Services",id:"T1584.006",reference:"https://attack.mitre.org/techniques/T1584/006",tactics:["resource-development"],techniqueId:"T1584"},{name:"Web Session Cookie",id:"T1550.004",reference:"https://attack.mitre.org/techniques/T1550/004",tactics:["defense-evasion","lateral-movement"],techniqueId:"T1550"},{name:"Web Shell",id:"T1505.003",reference:"https://attack.mitre.org/techniques/T1505/003",tactics:["persistence"],techniqueId:"T1505"},{name:"Windows Command Shell",id:"T1059.003",reference:"https://attack.mitre.org/techniques/T1059/003",tactics:["execution"],techniqueId:"T1059"},{name:"Windows File and Directory Permissions Modification",id:"T1222.001",reference:"https://attack.mitre.org/techniques/T1222/001",tactics:["defense-evasion"],techniqueId:"T1222"},{name:"Windows Management Instrumentation Event Subscription",id:"T1546.003",reference:"https://attack.mitre.org/techniques/T1546/003",tactics:["privilege-escalation","persistence"],techniqueId:"T1546"},{name:"Windows Remote Management",id:"T1021.006",reference:"https://attack.mitre.org/techniques/T1021/006",tactics:["lateral-movement"],techniqueId:"T1021"},{name:"Windows Service",id:"T1543.003",reference:"https://attack.mitre.org/techniques/T1543/003",tactics:["persistence","privilege-escalation"],techniqueId:"T1543"},{name:"Winlogon Helper DLL",id:"T1547.004",reference:"https://attack.mitre.org/techniques/T1547/004",tactics:["persistence","privilege-escalation"],techniqueId:"T1547"}];const subtechniquesOptions=[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.bashProfileAndBashrcT1546Description",{defaultMessage:".bash_profile and .bashrc (T1546.004)"}),id:"T1546.004",name:".bash_profile and .bashrc",reference:"https://attack.mitre.org/techniques/T1546/004",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"bashProfileAndBashrc"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.etcPasswdAndEtcShadowT1003Description",{defaultMessage:"/etc/passwd and /etc/shadow (T1003.008)"}),id:"T1003.008",name:"/etc/passwd and /etc/shadow",reference:"https://attack.mitre.org/techniques/T1003/008",tactics:"credential-access",techniqueId:"T1003",value:"etcPasswdAndEtcShadow"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.arpCachePoisoningT1557Description",{defaultMessage:"ARP Cache Poisoning (T1557.002)"}),id:"T1557.002",name:"ARP Cache Poisoning",reference:"https://attack.mitre.org/techniques/T1557/002",tactics:"credential-access,collection",techniqueId:"T1557",value:"arpCachePoisoning"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.asRepRoastingT1558Description",{defaultMessage:"AS-REP Roasting (T1558.004)"}),id:"T1558.004",name:"AS-REP Roasting",reference:"https://attack.mitre.org/techniques/T1558/004",tactics:"credential-access",techniqueId:"T1558",value:"asRepRoasting"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.accessibilityFeaturesT1546Description",{defaultMessage:"Accessibility Features (T1546.008)"}),id:"T1546.008",name:"Accessibility Features",reference:"https://attack.mitre.org/techniques/T1546/008",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"accessibilityFeatures"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.addOffice365GlobalAdministratorRoleT1098Description",{defaultMessage:"Add Office 365 Global Administrator Role (T1098.003)"}),id:"T1098.003",name:"Add Office 365 Global Administrator Role",reference:"https://attack.mitre.org/techniques/T1098/003",tactics:"persistence",techniqueId:"T1098",value:"addOffice365GlobalAdministratorRole"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.addInsT1137Description",{defaultMessage:"Add-ins (T1137.006)"}),id:"T1137.006",name:"Add-ins",reference:"https://attack.mitre.org/techniques/T1137/006",tactics:"persistence",techniqueId:"T1137",value:"addIns"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.additionalCloudCredentialsT1098Description",{defaultMessage:"Additional Cloud Credentials (T1098.001)"}),id:"T1098.001",name:"Additional Cloud Credentials",reference:"https://attack.mitre.org/techniques/T1098/001",tactics:"persistence",techniqueId:"T1098",value:"additionalCloudCredentials"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.appCertDlLsT1546Description",{defaultMessage:"AppCert DLLs (T1546.009)"}),id:"T1546.009",name:"AppCert DLLs",reference:"https://attack.mitre.org/techniques/T1546/009",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"appCertDlLs"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.appInitDlLsT1546Description",{defaultMessage:"AppInit DLLs (T1546.010)"}),id:"T1546.010",name:"AppInit DLLs",reference:"https://attack.mitre.org/techniques/T1546/010",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"appInitDlLs"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.appleScriptT1059Description",{defaultMessage:"AppleScript (T1059.002)"}),id:"T1059.002",name:"AppleScript",reference:"https://attack.mitre.org/techniques/T1059/002",tactics:"execution",techniqueId:"T1059",value:"appleScript"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.applicationAccessTokenT1550Description",{defaultMessage:"Application Access Token (T1550.001)"}),id:"T1550.001",name:"Application Access Token",reference:"https://attack.mitre.org/techniques/T1550/001",tactics:"defense-evasion,lateral-movement",techniqueId:"T1550",value:"applicationAccessToken"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.applicationExhaustionFloodT1499Description",{defaultMessage:"Application Exhaustion Flood (T1499.003)"}),id:"T1499.003",name:"Application Exhaustion Flood",reference:"https://attack.mitre.org/techniques/T1499/003",tactics:"impact",techniqueId:"T1499",value:"applicationExhaustionFlood"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.applicationShimmingT1546Description",{defaultMessage:"Application Shimming (T1546.011)"}),id:"T1546.011",name:"Application Shimming",reference:"https://attack.mitre.org/techniques/T1546/011",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"applicationShimming"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.applicationOrSystemExploitationT1499Description",{defaultMessage:"Application or System Exploitation (T1499.004)"}),id:"T1499.004",name:"Application or System Exploitation",reference:"https://attack.mitre.org/techniques/T1499/004",tactics:"impact",techniqueId:"T1499",value:"applicationOrSystemExploitation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.archiveViaCustomMethodT1560Description",{defaultMessage:"Archive via Custom Method (T1560.003)"}),id:"T1560.003",name:"Archive via Custom Method",reference:"https://attack.mitre.org/techniques/T1560/003",tactics:"collection",techniqueId:"T1560",value:"archiveViaCustomMethod"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.archiveViaLibraryT1560Description",{defaultMessage:"Archive via Library (T1560.002)"}),id:"T1560.002",name:"Archive via Library",reference:"https://attack.mitre.org/techniques/T1560/002",tactics:"collection",techniqueId:"T1560",value:"archiveViaLibrary"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.archiveViaUtilityT1560Description",{defaultMessage:"Archive via Utility (T1560.001)"}),id:"T1560.001",name:"Archive via Utility",reference:"https://attack.mitre.org/techniques/T1560/001",tactics:"collection",techniqueId:"T1560",value:"archiveViaUtility"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.asymmetricCryptographyT1573Description",{defaultMessage:"Asymmetric Cryptography (T1573.002)"}),id:"T1573.002",name:"Asymmetric Cryptography",reference:"https://attack.mitre.org/techniques/T1573/002",tactics:"command-and-control",techniqueId:"T1573",value:"asymmetricCryptography"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.asynchronousProcedureCallT1055Description",{defaultMessage:"Asynchronous Procedure Call (T1055.004)"}),id:"T1055.004",name:"Asynchronous Procedure Call",reference:"https://attack.mitre.org/techniques/T1055/004",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"asynchronousProcedureCall"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.atLinuxT1053Description",{defaultMessage:"At (Linux) (T1053.001)"}),id:"T1053.001",name:"At (Linux)",reference:"https://attack.mitre.org/techniques/T1053/001",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"atLinux"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.atWindowsT1053Description",{defaultMessage:"At (Windows) (T1053.002)"}),id:"T1053.002",name:"At (Windows)",reference:"https://attack.mitre.org/techniques/T1053/002",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"atWindows"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.authenticationPackageT1547Description",{defaultMessage:"Authentication Package (T1547.002)"}),id:"T1547.002",name:"Authentication Package",reference:"https://attack.mitre.org/techniques/T1547/002",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"authenticationPackage"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.bashHistoryT1552Description",{defaultMessage:"Bash History (T1552.003)"}),id:"T1552.003",name:"Bash History",reference:"https://attack.mitre.org/techniques/T1552/003",tactics:"credential-access",techniqueId:"T1552",value:"bashHistory"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.bidirectionalCommunicationT1102Description",{defaultMessage:"Bidirectional Communication (T1102.002)"}),id:"T1102.002",name:"Bidirectional Communication",reference:"https://attack.mitre.org/techniques/T1102/002",tactics:"command-and-control",techniqueId:"T1102",value:"bidirectionalCommunication"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.binaryPaddingT1027Description",{defaultMessage:"Binary Padding (T1027.001)"}),id:"T1027.001",name:"Binary Padding",reference:"https://attack.mitre.org/techniques/T1027/001",tactics:"defense-evasion",techniqueId:"T1027",value:"binaryPadding"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.bootkitT1542Description",{defaultMessage:"Bootkit (T1542.003)"}),id:"T1542.003",name:"Bootkit",reference:"https://attack.mitre.org/techniques/T1542/003",tactics:"persistence,defense-evasion",techniqueId:"T1542",value:"bootkit"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.botnetT1583Description",{defaultMessage:"Botnet (T1583.005)"}),id:"T1583.005",name:"Botnet",reference:"https://attack.mitre.org/techniques/T1583/005",tactics:"resource-development",techniqueId:"T1583",value:"botnet"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.botnetT1584Description",{defaultMessage:"Botnet (T1584.005)"}),id:"T1584.005",name:"Botnet",reference:"https://attack.mitre.org/techniques/T1584/005",tactics:"resource-development",techniqueId:"T1584",value:"botnet"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.businessRelationshipsT1591Description",{defaultMessage:"Business Relationships (T1591.002)"}),id:"T1591.002",name:"Business Relationships",reference:"https://attack.mitre.org/techniques/T1591/002",tactics:"reconnaissance",techniqueId:"T1591",value:"businessRelationships"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.bypassUserAccountControlT1548Description",{defaultMessage:"Bypass User Account Control (T1548.002)"}),id:"T1548.002",name:"Bypass User Account Control",reference:"https://attack.mitre.org/techniques/T1548/002",tactics:"privilege-escalation,defense-evasion",techniqueId:"T1548",value:"bypassUserAccountControl"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cdNsT1596Description",{defaultMessage:"CDNs (T1596.004)"}),id:"T1596.004",name:"CDNs",reference:"https://attack.mitre.org/techniques/T1596/004",tactics:"reconnaissance",techniqueId:"T1596",value:"cdNs"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cmstpT1218Description",{defaultMessage:"CMSTP (T1218.003)"}),id:"T1218.003",name:"CMSTP",reference:"https://attack.mitre.org/techniques/T1218/003",tactics:"defense-evasion",techniqueId:"T1218",value:"cmstp"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.corProfilerT1574Description",{defaultMessage:"COR_PROFILER (T1574.012)"}),id:"T1574.012",name:"COR_PROFILER",reference:"https://attack.mitre.org/techniques/T1574/012",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"corProfiler"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cachedDomainCredentialsT1003Description",{defaultMessage:"Cached Domain Credentials (T1003.005)"}),id:"T1003.005",name:"Cached Domain Credentials",reference:"https://attack.mitre.org/techniques/T1003/005",tactics:"credential-access",techniqueId:"T1003",value:"cachedDomainCredentials"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.changeDefaultFileAssociationT1546Description",{defaultMessage:"Change Default File Association (T1546.001)"}),id:"T1546.001",name:"Change Default File Association",reference:"https://attack.mitre.org/techniques/T1546/001",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"changeDefaultFileAssociation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.clearCommandHistoryT1070Description",{defaultMessage:"Clear Command History (T1070.003)"}),id:"T1070.003",name:"Clear Command History",reference:"https://attack.mitre.org/techniques/T1070/003",tactics:"defense-evasion",techniqueId:"T1070",value:"clearCommandHistory"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.clearLinuxOrMacSystemLogsT1070Description",{defaultMessage:"Clear Linux or Mac System Logs (T1070.002)"}),id:"T1070.002",name:"Clear Linux or Mac System Logs",reference:"https://attack.mitre.org/techniques/T1070/002",tactics:"defense-evasion",techniqueId:"T1070",value:"clearLinuxOrMacSystemLogs"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.clearWindowsEventLogsT1070Description",{defaultMessage:"Clear Windows Event Logs (T1070.001)"}),id:"T1070.001",name:"Clear Windows Event Logs",reference:"https://attack.mitre.org/techniques/T1070/001",tactics:"defense-evasion",techniqueId:"T1070",value:"clearWindowsEventLogs"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.clientConfigurationsT1592Description",{defaultMessage:"Client Configurations (T1592.004)"}),id:"T1592.004",name:"Client Configurations",reference:"https://attack.mitre.org/techniques/T1592/004",tactics:"reconnaissance",techniqueId:"T1592",value:"clientConfigurations"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudAccountT1136Description",{defaultMessage:"Cloud Account (T1136.003)"}),id:"T1136.003",name:"Cloud Account",reference:"https://attack.mitre.org/techniques/T1136/003",tactics:"persistence",techniqueId:"T1136",value:"cloudAccount"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudAccountT1087Description",{defaultMessage:"Cloud Account (T1087.004)"}),id:"T1087.004",name:"Cloud Account",reference:"https://attack.mitre.org/techniques/T1087/004",tactics:"discovery",techniqueId:"T1087",value:"cloudAccount"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudAccountsT1078Description",{defaultMessage:"Cloud Accounts (T1078.004)"}),id:"T1078.004",name:"Cloud Accounts",reference:"https://attack.mitre.org/techniques/T1078/004",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",techniqueId:"T1078",value:"cloudAccounts"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudGroupsT1069Description",{defaultMessage:"Cloud Groups (T1069.003)"}),id:"T1069.003",name:"Cloud Groups",reference:"https://attack.mitre.org/techniques/T1069/003",tactics:"discovery",techniqueId:"T1069",value:"cloudGroups"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudInstanceMetadataApiT1552Description",{defaultMessage:"Cloud Instance Metadata API (T1552.005)"}),id:"T1552.005",name:"Cloud Instance Metadata API",reference:"https://attack.mitre.org/techniques/T1552/005",tactics:"credential-access",techniqueId:"T1552",value:"cloudInstanceMetadataApi"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.codeSigningT1553Description",{defaultMessage:"Code Signing (T1553.002)"}),id:"T1553.002",name:"Code Signing",reference:"https://attack.mitre.org/techniques/T1553/002",tactics:"defense-evasion",techniqueId:"T1553",value:"codeSigning"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.codeSigningCertificatesT1587Description",{defaultMessage:"Code Signing Certificates (T1587.002)"}),id:"T1587.002",name:"Code Signing Certificates",reference:"https://attack.mitre.org/techniques/T1587/002",tactics:"resource-development",techniqueId:"T1587",value:"codeSigningCertificates"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.codeSigningCertificatesT1588Description",{defaultMessage:"Code Signing Certificates (T1588.003)"}),id:"T1588.003",name:"Code Signing Certificates",reference:"https://attack.mitre.org/techniques/T1588/003",tactics:"resource-development",techniqueId:"T1588",value:"codeSigningCertificates"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compileAfterDeliveryT1027Description",{defaultMessage:"Compile After Delivery (T1027.004)"}),id:"T1027.004",name:"Compile After Delivery",reference:"https://attack.mitre.org/techniques/T1027/004",tactics:"defense-evasion",techniqueId:"T1027",value:"compileAfterDelivery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compiledHtmlFileT1218Description",{defaultMessage:"Compiled HTML File (T1218.001)"}),id:"T1218.001",name:"Compiled HTML File",reference:"https://attack.mitre.org/techniques/T1218/001",tactics:"defense-evasion",techniqueId:"T1218",value:"compiledHtmlFile"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.componentFirmwareT1542Description",{defaultMessage:"Component Firmware (T1542.002)"}),id:"T1542.002",name:"Component Firmware",reference:"https://attack.mitre.org/techniques/T1542/002",tactics:"persistence,defense-evasion",techniqueId:"T1542",value:"componentFirmware"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.componentObjectModelT1559Description",{defaultMessage:"Component Object Model (T1559.001)"}),id:"T1559.001",name:"Component Object Model",reference:"https://attack.mitre.org/techniques/T1559/001",tactics:"execution",techniqueId:"T1559",value:"componentObjectModel"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.componentObjectModelHijackingT1546Description",{defaultMessage:"Component Object Model Hijacking (T1546.015)"}),id:"T1546.015",name:"Component Object Model Hijacking",reference:"https://attack.mitre.org/techniques/T1546/015",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"componentObjectModelHijacking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compromiseHardwareSupplyChainT1195Description",{defaultMessage:"Compromise Hardware Supply Chain (T1195.003)"}),id:"T1195.003",name:"Compromise Hardware Supply Chain",reference:"https://attack.mitre.org/techniques/T1195/003",tactics:"initial-access",techniqueId:"T1195",value:"compromiseHardwareSupplyChain"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compromiseSoftwareDependenciesAndDevelopmentToolsT1195Description",{defaultMessage:"Compromise Software Dependencies and Development Tools (T1195.001)"}),id:"T1195.001",name:"Compromise Software Dependencies and Development Tools",reference:"https://attack.mitre.org/techniques/T1195/001",tactics:"initial-access",techniqueId:"T1195",value:"compromiseSoftwareDependenciesAndDevelopmentTools"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compromiseSoftwareSupplyChainT1195Description",{defaultMessage:"Compromise Software Supply Chain (T1195.002)"}),id:"T1195.002",name:"Compromise Software Supply Chain",reference:"https://attack.mitre.org/techniques/T1195/002",tactics:"initial-access",techniqueId:"T1195",value:"compromiseSoftwareSupplyChain"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.confluenceT1213Description",{defaultMessage:"Confluence (T1213.001)"}),id:"T1213.001",name:"Confluence",reference:"https://attack.mitre.org/techniques/T1213/001",tactics:"collection",techniqueId:"T1213",value:"confluence"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.controlPanelT1218Description",{defaultMessage:"Control Panel (T1218.002)"}),id:"T1218.002",name:"Control Panel",reference:"https://attack.mitre.org/techniques/T1218/002",tactics:"defense-evasion",techniqueId:"T1218",value:"controlPanel"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.createCloudInstanceT1578Description",{defaultMessage:"Create Cloud Instance (T1578.002)"}),id:"T1578.002",name:"Create Cloud Instance",reference:"https://attack.mitre.org/techniques/T1578/002",tactics:"defense-evasion",techniqueId:"T1578",value:"createCloudInstance"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.createProcessWithTokenT1134Description",{defaultMessage:"Create Process with Token (T1134.002)"}),id:"T1134.002",name:"Create Process with Token",reference:"https://attack.mitre.org/techniques/T1134/002",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"createProcessWithToken"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.createSnapshotT1578Description",{defaultMessage:"Create Snapshot (T1578.001)"}),id:"T1578.001",name:"Create Snapshot",reference:"https://attack.mitre.org/techniques/T1578/001",tactics:"defense-evasion",techniqueId:"T1578",value:"createSnapshot"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialApiHookingT1056Description",{defaultMessage:"Credential API Hooking (T1056.004)"}),id:"T1056.004",name:"Credential API Hooking",reference:"https://attack.mitre.org/techniques/T1056/004",tactics:"collection,credential-access",techniqueId:"T1056",value:"credentialApiHooking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialStuffingT1110Description",{defaultMessage:"Credential Stuffing (T1110.004)"}),id:"T1110.004",name:"Credential Stuffing",reference:"https://attack.mitre.org/techniques/T1110/004",tactics:"credential-access",techniqueId:"T1110",value:"credentialStuffing"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialsT1589Description",{defaultMessage:"Credentials (T1589.001)"}),id:"T1589.001",name:"Credentials",reference:"https://attack.mitre.org/techniques/T1589/001",tactics:"reconnaissance",techniqueId:"T1589",value:"credentials"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialsInFilesT1552Description",{defaultMessage:"Credentials In Files (T1552.001)"}),id:"T1552.001",name:"Credentials In Files",reference:"https://attack.mitre.org/techniques/T1552/001",tactics:"credential-access",techniqueId:"T1552",value:"credentialsInFiles"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialsFromWebBrowsersT1555Description",{defaultMessage:"Credentials from Web Browsers (T1555.003)"}),id:"T1555.003",name:"Credentials from Web Browsers",reference:"https://attack.mitre.org/techniques/T1555/003",tactics:"credential-access",techniqueId:"T1555",value:"credentialsFromWebBrowsers"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialsInRegistryT1552Description",{defaultMessage:"Credentials in Registry (T1552.002)"}),id:"T1552.002",name:"Credentials in Registry",reference:"https://attack.mitre.org/techniques/T1552/002",tactics:"credential-access",techniqueId:"T1552",value:"credentialsInRegistry"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cronT1053Description",{defaultMessage:"Cron (T1053.003)"}),id:"T1053.003",name:"Cron",reference:"https://attack.mitre.org/techniques/T1053/003",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"cron"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dcSyncT1003Description",{defaultMessage:"DCSync (T1003.006)"}),id:"T1003.006",name:"DCSync",reference:"https://attack.mitre.org/techniques/T1003/006",tactics:"credential-access",techniqueId:"T1003",value:"dcSync"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dllSearchOrderHijackingT1574Description",{defaultMessage:"DLL Search Order Hijacking (T1574.001)"}),id:"T1574.001",name:"DLL Search Order Hijacking",reference:"https://attack.mitre.org/techniques/T1574/001",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"dllSearchOrderHijacking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dllSideLoadingT1574Description",{defaultMessage:"DLL Side-Loading (T1574.002)"}),id:"T1574.002",name:"DLL Side-Loading",reference:"https://attack.mitre.org/techniques/T1574/002",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"dllSideLoading"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsT1071Description",{defaultMessage:"DNS (T1071.004)"}),id:"T1071.004",name:"DNS",reference:"https://attack.mitre.org/techniques/T1071/004",tactics:"command-and-control",techniqueId:"T1071",value:"dns"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsT1590Description",{defaultMessage:"DNS (T1590.002)"}),id:"T1590.002",name:"DNS",reference:"https://attack.mitre.org/techniques/T1590/002",tactics:"reconnaissance",techniqueId:"T1590",value:"dns"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsCalculationT1568Description",{defaultMessage:"DNS Calculation (T1568.003)"}),id:"T1568.003",name:"DNS Calculation",reference:"https://attack.mitre.org/techniques/T1568/003",tactics:"command-and-control",techniqueId:"T1568",value:"dnsCalculation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsServerT1583Description",{defaultMessage:"DNS Server (T1583.002)"}),id:"T1583.002",name:"DNS Server",reference:"https://attack.mitre.org/techniques/T1583/002",tactics:"resource-development",techniqueId:"T1583",value:"dnsServer"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsServerT1584Description",{defaultMessage:"DNS Server (T1584.002)"}),id:"T1584.002",name:"DNS Server",reference:"https://attack.mitre.org/techniques/T1584/002",tactics:"resource-development",techniqueId:"T1584",value:"dnsServer"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsPassiveDnsT1596Description",{defaultMessage:"DNS/Passive DNS (T1596.001)"}),id:"T1596.001",name:"DNS/Passive DNS",reference:"https://attack.mitre.org/techniques/T1596/001",tactics:"reconnaissance",techniqueId:"T1596",value:"dnsPassiveDns"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.deadDropResolverT1102Description",{defaultMessage:"Dead Drop Resolver (T1102.001)"}),id:"T1102.001",name:"Dead Drop Resolver",reference:"https://attack.mitre.org/techniques/T1102/001",tactics:"command-and-control",techniqueId:"T1102",value:"deadDropResolver"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.defaultAccountsT1078Description",{defaultMessage:"Default Accounts (T1078.001)"}),id:"T1078.001",name:"Default Accounts",reference:"https://attack.mitre.org/techniques/T1078/001",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",techniqueId:"T1078",value:"defaultAccounts"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.deleteCloudInstanceT1578Description",{defaultMessage:"Delete Cloud Instance (T1578.003)"}),id:"T1578.003",name:"Delete Cloud Instance",reference:"https://attack.mitre.org/techniques/T1578/003",tactics:"defense-evasion",techniqueId:"T1578",value:"deleteCloudInstance"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.determinePhysicalLocationsT1591Description",{defaultMessage:"Determine Physical Locations (T1591.001)"}),id:"T1591.001",name:"Determine Physical Locations",reference:"https://attack.mitre.org/techniques/T1591/001",tactics:"reconnaissance",techniqueId:"T1591",value:"determinePhysicalLocations"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.digitalCertificatesT1587Description",{defaultMessage:"Digital Certificates (T1587.003)"}),id:"T1587.003",name:"Digital Certificates",reference:"https://attack.mitre.org/techniques/T1587/003",tactics:"resource-development",techniqueId:"T1587",value:"digitalCertificates"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.digitalCertificatesT1588Description",{defaultMessage:"Digital Certificates (T1588.004)"}),id:"T1588.004",name:"Digital Certificates",reference:"https://attack.mitre.org/techniques/T1588/004",tactics:"resource-development",techniqueId:"T1588",value:"digitalCertificates"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.digitalCertificatesT1596Description",{defaultMessage:"Digital Certificates (T1596.003)"}),id:"T1596.003",name:"Digital Certificates",reference:"https://attack.mitre.org/techniques/T1596/003",tactics:"reconnaissance",techniqueId:"T1596",value:"digitalCertificates"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.directNetworkFloodT1498Description",{defaultMessage:"Direct Network Flood (T1498.001)"}),id:"T1498.001",name:"Direct Network Flood",reference:"https://attack.mitre.org/techniques/T1498/001",tactics:"impact",techniqueId:"T1498",value:"directNetworkFlood"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableCloudLogsT1562Description",{defaultMessage:"Disable Cloud Logs (T1562.008)"}),id:"T1562.008",name:"Disable Cloud Logs",reference:"https://attack.mitre.org/techniques/T1562/008",tactics:"defense-evasion",techniqueId:"T1562",value:"disableCloudLogs"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableCryptoHardwareT1600Description",{defaultMessage:"Disable Crypto Hardware (T1600.002)"}),id:"T1600.002",name:"Disable Crypto Hardware",reference:"https://attack.mitre.org/techniques/T1600/002",tactics:"defense-evasion",techniqueId:"T1600",value:"disableCryptoHardware"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableWindowsEventLoggingT1562Description",{defaultMessage:"Disable Windows Event Logging (T1562.002)"}),id:"T1562.002",name:"Disable Windows Event Logging",reference:"https://attack.mitre.org/techniques/T1562/002",tactics:"defense-evasion",techniqueId:"T1562",value:"disableWindowsEventLogging"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableOrModifyCloudFirewallT1562Description",{defaultMessage:"Disable or Modify Cloud Firewall (T1562.007)"}),id:"T1562.007",name:"Disable or Modify Cloud Firewall",reference:"https://attack.mitre.org/techniques/T1562/007",tactics:"defense-evasion",techniqueId:"T1562",value:"disableOrModifyCloudFirewall"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableOrModifySystemFirewallT1562Description",{defaultMessage:"Disable or Modify System Firewall (T1562.004)"}),id:"T1562.004",name:"Disable or Modify System Firewall",reference:"https://attack.mitre.org/techniques/T1562/004",tactics:"defense-evasion",techniqueId:"T1562",value:"disableOrModifySystemFirewall"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableOrModifyToolsT1562Description",{defaultMessage:"Disable or Modify Tools (T1562.001)"}),id:"T1562.001",name:"Disable or Modify Tools",reference:"https://attack.mitre.org/techniques/T1562/001",tactics:"defense-evasion",techniqueId:"T1562",value:"disableOrModifyTools"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.diskContentWipeT1561Description",{defaultMessage:"Disk Content Wipe (T1561.001)"}),id:"T1561.001",name:"Disk Content Wipe",reference:"https://attack.mitre.org/techniques/T1561/001",tactics:"impact",techniqueId:"T1561",value:"diskContentWipe"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.diskStructureWipeT1561Description",{defaultMessage:"Disk Structure Wipe (T1561.002)"}),id:"T1561.002",name:"Disk Structure Wipe",reference:"https://attack.mitre.org/techniques/T1561/002",tactics:"impact",techniqueId:"T1561",value:"diskStructureWipe"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.distributedComponentObjectModelT1021Description",{defaultMessage:"Distributed Component Object Model (T1021.003)"}),id:"T1021.003",name:"Distributed Component Object Model",reference:"https://attack.mitre.org/techniques/T1021/003",tactics:"lateral-movement",techniqueId:"T1021",value:"distributedComponentObjectModel"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainAccountT1136Description",{defaultMessage:"Domain Account (T1136.002)"}),id:"T1136.002",name:"Domain Account",reference:"https://attack.mitre.org/techniques/T1136/002",tactics:"persistence",techniqueId:"T1136",value:"domainAccount"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainAccountT1087Description",{defaultMessage:"Domain Account (T1087.002)"}),id:"T1087.002",name:"Domain Account",reference:"https://attack.mitre.org/techniques/T1087/002",tactics:"discovery",techniqueId:"T1087",value:"domainAccount"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainAccountsT1078Description",{defaultMessage:"Domain Accounts (T1078.002)"}),id:"T1078.002",name:"Domain Accounts",reference:"https://attack.mitre.org/techniques/T1078/002",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",techniqueId:"T1078",value:"domainAccounts"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainControllerAuthenticationT1556Description",{defaultMessage:"Domain Controller Authentication (T1556.001)"}),id:"T1556.001",name:"Domain Controller Authentication",reference:"https://attack.mitre.org/techniques/T1556/001",tactics:"credential-access,defense-evasion",techniqueId:"T1556",value:"domainControllerAuthentication"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainFrontingT1090Description",{defaultMessage:"Domain Fronting (T1090.004)"}),id:"T1090.004",name:"Domain Fronting",reference:"https://attack.mitre.org/techniques/T1090/004",tactics:"command-and-control",techniqueId:"T1090",value:"domainFronting"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainGenerationAlgorithmsT1568Description",{defaultMessage:"Domain Generation Algorithms (T1568.002)"}),id:"T1568.002",name:"Domain Generation Algorithms",reference:"https://attack.mitre.org/techniques/T1568/002",tactics:"command-and-control",techniqueId:"T1568",value:"domainGenerationAlgorithms"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainGroupsT1069Description",{defaultMessage:"Domain Groups (T1069.002)"}),id:"T1069.002",name:"Domain Groups",reference:"https://attack.mitre.org/techniques/T1069/002",tactics:"discovery",techniqueId:"T1069",value:"domainGroups"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainPropertiesT1590Description",{defaultMessage:"Domain Properties (T1590.001)"}),id:"T1590.001",name:"Domain Properties",reference:"https://attack.mitre.org/techniques/T1590/001",tactics:"reconnaissance",techniqueId:"T1590",value:"domainProperties"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainsT1583Description",{defaultMessage:"Domains (T1583.001)"}),id:"T1583.001",name:"Domains",reference:"https://attack.mitre.org/techniques/T1583/001",tactics:"resource-development",techniqueId:"T1583",value:"domains"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainsT1584Description",{defaultMessage:"Domains (T1584.001)"}),id:"T1584.001",name:"Domains",reference:"https://attack.mitre.org/techniques/T1584/001",tactics:"resource-development",techniqueId:"T1584",value:"domains"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.downgradeSystemImageT1601Description",{defaultMessage:"Downgrade System Image (T1601.002)"}),id:"T1601.002",name:"Downgrade System Image",reference:"https://attack.mitre.org/techniques/T1601/002",tactics:"defense-evasion",techniqueId:"T1601",value:"downgradeSystemImage"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dylibHijackingT1574Description",{defaultMessage:"Dylib Hijacking (T1574.004)"}),id:"T1574.004",name:"Dylib Hijacking",reference:"https://attack.mitre.org/techniques/T1574/004",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"dylibHijacking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dynamicDataExchangeT1559Description",{defaultMessage:"Dynamic Data Exchange (T1559.002)"}),id:"T1559.002",name:"Dynamic Data Exchange",reference:"https://attack.mitre.org/techniques/T1559/002",tactics:"execution",techniqueId:"T1559",value:"dynamicDataExchange"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dynamicLinkLibraryInjectionT1055Description",{defaultMessage:"Dynamic-link Library Injection (T1055.001)"}),id:"T1055.001",name:"Dynamic-link Library Injection",reference:"https://attack.mitre.org/techniques/T1055/001",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"dynamicLinkLibraryInjection"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.elevatedExecutionWithPromptT1548Description",{defaultMessage:"Elevated Execution with Prompt (T1548.004)"}),id:"T1548.004",name:"Elevated Execution with Prompt",reference:"https://attack.mitre.org/techniques/T1548/004",tactics:"privilege-escalation,defense-evasion",techniqueId:"T1548",value:"elevatedExecutionWithPrompt"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailAccountT1087Description",{defaultMessage:"Email Account (T1087.003)"}),id:"T1087.003",name:"Email Account",reference:"https://attack.mitre.org/techniques/T1087/003",tactics:"discovery",techniqueId:"T1087",value:"emailAccount"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailAccountsT1585Description",{defaultMessage:"Email Accounts (T1585.002)"}),id:"T1585.002",name:"Email Accounts",reference:"https://attack.mitre.org/techniques/T1585/002",tactics:"resource-development",techniqueId:"T1585",value:"emailAccounts"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailAccountsT1586Description",{defaultMessage:"Email Accounts (T1586.002)"}),id:"T1586.002",name:"Email Accounts",reference:"https://attack.mitre.org/techniques/T1586/002",tactics:"resource-development",techniqueId:"T1586",value:"emailAccounts"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailAddressesT1589Description",{defaultMessage:"Email Addresses (T1589.002)"}),id:"T1589.002",name:"Email Addresses",reference:"https://attack.mitre.org/techniques/T1589/002",tactics:"reconnaissance",techniqueId:"T1589",value:"emailAddresses"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailForwardingRuleT1114Description",{defaultMessage:"Email Forwarding Rule (T1114.003)"}),id:"T1114.003",name:"Email Forwarding Rule",reference:"https://attack.mitre.org/techniques/T1114/003",tactics:"collection",techniqueId:"T1114",value:"emailForwardingRule"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emondT1546Description",{defaultMessage:"Emond (T1546.014)"}),id:"T1546.014",name:"Emond",reference:"https://attack.mitre.org/techniques/T1546/014",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"emond"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.employeeNamesT1589Description",{defaultMessage:"Employee Names (T1589.003)"}),id:"T1589.003",name:"Employee Names",reference:"https://attack.mitre.org/techniques/T1589/003",tactics:"reconnaissance",techniqueId:"T1589",value:"employeeNames"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.environmentalKeyingT1480Description",{defaultMessage:"Environmental Keying (T1480.001)"}),id:"T1480.001",name:"Environmental Keying",reference:"https://attack.mitre.org/techniques/T1480/001",tactics:"defense-evasion",techniqueId:"T1480",value:"environmentalKeying"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exchangeEmailDelegatePermissionsT1098Description",{defaultMessage:"Exchange Email Delegate Permissions (T1098.002)"}),id:"T1098.002",name:"Exchange Email Delegate Permissions",reference:"https://attack.mitre.org/techniques/T1098/002",tactics:"persistence",techniqueId:"T1098",value:"exchangeEmailDelegatePermissions"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.executableInstallerFilePermissionsWeaknessT1574Description",{defaultMessage:"Executable Installer File Permissions Weakness (T1574.005)"}),id:"T1574.005",name:"Executable Installer File Permissions Weakness",reference:"https://attack.mitre.org/techniques/T1574/005",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"executableInstallerFilePermissionsWeakness"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverAsymmetricEncryptedNonC2ProtocolT1048Description",{defaultMessage:"Exfiltration Over Asymmetric Encrypted Non-C2 Protocol (T1048.002)"}),id:"T1048.002",name:"Exfiltration Over Asymmetric Encrypted Non-C2 Protocol",reference:"https://attack.mitre.org/techniques/T1048/002",tactics:"exfiltration",techniqueId:"T1048",value:"exfiltrationOverAsymmetricEncryptedNonC2Protocol"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverBluetoothT1011Description",{defaultMessage:"Exfiltration Over Bluetooth (T1011.001)"}),id:"T1011.001",name:"Exfiltration Over Bluetooth",reference:"https://attack.mitre.org/techniques/T1011/001",tactics:"exfiltration",techniqueId:"T1011",value:"exfiltrationOverBluetooth"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverSymmetricEncryptedNonC2ProtocolT1048Description",{defaultMessage:"Exfiltration Over Symmetric Encrypted Non-C2 Protocol (T1048.001)"}),id:"T1048.001",name:"Exfiltration Over Symmetric Encrypted Non-C2 Protocol",reference:"https://attack.mitre.org/techniques/T1048/001",tactics:"exfiltration",techniqueId:"T1048",value:"exfiltrationOverSymmetricEncryptedNonC2Protocol"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverUnencryptedObfuscatedNonC2ProtocolT1048Description",{defaultMessage:"Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol (T1048.003)"}),id:"T1048.003",name:"Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol",reference:"https://attack.mitre.org/techniques/T1048/003",tactics:"exfiltration",techniqueId:"T1048",value:"exfiltrationOverUnencryptedObfuscatedNonC2Protocol"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverUsbT1052Description",{defaultMessage:"Exfiltration over USB (T1052.001)"}),id:"T1052.001",name:"Exfiltration over USB",reference:"https://attack.mitre.org/techniques/T1052/001",tactics:"exfiltration",techniqueId:"T1052",value:"exfiltrationOverUsb"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationToCloudStorageT1567Description",{defaultMessage:"Exfiltration to Cloud Storage (T1567.002)"}),id:"T1567.002",name:"Exfiltration to Cloud Storage",reference:"https://attack.mitre.org/techniques/T1567/002",tactics:"exfiltration",techniqueId:"T1567",value:"exfiltrationToCloudStorage"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationToCodeRepositoryT1567Description",{defaultMessage:"Exfiltration to Code Repository (T1567.001)"}),id:"T1567.001",name:"Exfiltration to Code Repository",reference:"https://attack.mitre.org/techniques/T1567/001",tactics:"exfiltration",techniqueId:"T1567",value:"exfiltrationToCodeRepository"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exploitsT1587Description",{defaultMessage:"Exploits (T1587.004)"}),id:"T1587.004",name:"Exploits",reference:"https://attack.mitre.org/techniques/T1587/004",tactics:"resource-development",techniqueId:"T1587",value:"exploits"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exploitsT1588Description",{defaultMessage:"Exploits (T1588.005)"}),id:"T1588.005",name:"Exploits",reference:"https://attack.mitre.org/techniques/T1588/005",tactics:"resource-development",techniqueId:"T1588",value:"exploits"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.externalDefacementT1491Description",{defaultMessage:"External Defacement (T1491.002)"}),id:"T1491.002",name:"External Defacement",reference:"https://attack.mitre.org/techniques/T1491/002",tactics:"impact",techniqueId:"T1491",value:"externalDefacement"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.externalProxyT1090Description",{defaultMessage:"External Proxy (T1090.002)"}),id:"T1090.002",name:"External Proxy",reference:"https://attack.mitre.org/techniques/T1090/002",tactics:"command-and-control",techniqueId:"T1090",value:"externalProxy"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.extraWindowMemoryInjectionT1055Description",{defaultMessage:"Extra Window Memory Injection (T1055.011)"}),id:"T1055.011",name:"Extra Window Memory Injection",reference:"https://attack.mitre.org/techniques/T1055/011",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"extraWindowMemoryInjection"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.fastFluxDnsT1568Description",{defaultMessage:"Fast Flux DNS (T1568.001)"}),id:"T1568.001",name:"Fast Flux DNS",reference:"https://attack.mitre.org/techniques/T1568/001",tactics:"command-and-control",techniqueId:"T1568",value:"fastFluxDns"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.fileDeletionT1070Description",{defaultMessage:"File Deletion (T1070.004)"}),id:"T1070.004",name:"File Deletion",reference:"https://attack.mitre.org/techniques/T1070/004",tactics:"defense-evasion",techniqueId:"T1070",value:"fileDeletion"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.fileTransferProtocolsT1071Description",{defaultMessage:"File Transfer Protocols (T1071.002)"}),id:"T1071.002",name:"File Transfer Protocols",reference:"https://attack.mitre.org/techniques/T1071/002",tactics:"command-and-control",techniqueId:"T1071",value:"fileTransferProtocols"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.firmwareT1592Description",{defaultMessage:"Firmware (T1592.003)"}),id:"T1592.003",name:"Firmware",reference:"https://attack.mitre.org/techniques/T1592/003",tactics:"reconnaissance",techniqueId:"T1592",value:"firmware"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.guiInputCaptureT1056Description",{defaultMessage:"GUI Input Capture (T1056.002)"}),id:"T1056.002",name:"GUI Input Capture",reference:"https://attack.mitre.org/techniques/T1056/002",tactics:"collection,credential-access",techniqueId:"T1056",value:"guiInputCapture"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.gatekeeperBypassT1553Description",{defaultMessage:"Gatekeeper Bypass (T1553.001)"}),id:"T1553.001",name:"Gatekeeper Bypass",reference:"https://attack.mitre.org/techniques/T1553/001",tactics:"defense-evasion",techniqueId:"T1553",value:"gatekeeperBypass"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.goldenTicketT1558Description",{defaultMessage:"Golden Ticket (T1558.001)"}),id:"T1558.001",name:"Golden Ticket",reference:"https://attack.mitre.org/techniques/T1558/001",tactics:"credential-access",techniqueId:"T1558",value:"goldenTicket"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.groupPolicyPreferencesT1552Description",{defaultMessage:"Group Policy Preferences (T1552.006)"}),id:"T1552.006",name:"Group Policy Preferences",reference:"https://attack.mitre.org/techniques/T1552/006",tactics:"credential-access",techniqueId:"T1552",value:"groupPolicyPreferences"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hardwareT1592Description",{defaultMessage:"Hardware (T1592.001)"}),id:"T1592.001",name:"Hardware",reference:"https://attack.mitre.org/techniques/T1592/001",tactics:"reconnaissance",techniqueId:"T1592",value:"hardware"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hiddenFileSystemT1564Description",{defaultMessage:"Hidden File System (T1564.005)"}),id:"T1564.005",name:"Hidden File System",reference:"https://attack.mitre.org/techniques/T1564/005",tactics:"defense-evasion",techniqueId:"T1564",value:"hiddenFileSystem"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hiddenFilesAndDirectoriesT1564Description",{defaultMessage:"Hidden Files and Directories (T1564.001)"}),id:"T1564.001",name:"Hidden Files and Directories",reference:"https://attack.mitre.org/techniques/T1564/001",tactics:"defense-evasion",techniqueId:"T1564",value:"hiddenFilesAndDirectories"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hiddenUsersT1564Description",{defaultMessage:"Hidden Users (T1564.002)"}),id:"T1564.002",name:"Hidden Users",reference:"https://attack.mitre.org/techniques/T1564/002",tactics:"defense-evasion",techniqueId:"T1564",value:"hiddenUsers"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hiddenWindowT1564Description",{defaultMessage:"Hidden Window (T1564.003)"}),id:"T1564.003",name:"Hidden Window",reference:"https://attack.mitre.org/techniques/T1564/003",tactics:"defense-evasion",techniqueId:"T1564",value:"hiddenWindow"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.ipAddressesT1590Description",{defaultMessage:"IP Addresses (T1590.005)"}),id:"T1590.005",name:"IP Addresses",reference:"https://attack.mitre.org/techniques/T1590/005",tactics:"reconnaissance",techniqueId:"T1590",value:"ipAddresses"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.identifyBusinessTempoT1591Description",{defaultMessage:"Identify Business Tempo (T1591.003)"}),id:"T1591.003",name:"Identify Business Tempo",reference:"https://attack.mitre.org/techniques/T1591/003",tactics:"reconnaissance",techniqueId:"T1591",value:"identifyBusinessTempo"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.identifyRolesT1591Description",{defaultMessage:"Identify Roles (T1591.004)"}),id:"T1591.004",name:"Identify Roles",reference:"https://attack.mitre.org/techniques/T1591/004",tactics:"reconnaissance",techniqueId:"T1591",value:"identifyRoles"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.imageFileExecutionOptionsInjectionT1546Description",{defaultMessage:"Image File Execution Options Injection (T1546.012)"}),id:"T1546.012",name:"Image File Execution Options Injection",reference:"https://attack.mitre.org/techniques/T1546/012",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"imageFileExecutionOptionsInjection"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.impairCommandHistoryLoggingT1562Description",{defaultMessage:"Impair Command History Logging (T1562.003)"}),id:"T1562.003",name:"Impair Command History Logging",reference:"https://attack.mitre.org/techniques/T1562/003",tactics:"defense-evasion",techniqueId:"T1562",value:"impairCommandHistoryLogging"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.indicatorBlockingT1562Description",{defaultMessage:"Indicator Blocking (T1562.006)"}),id:"T1562.006",name:"Indicator Blocking",reference:"https://attack.mitre.org/techniques/T1562/006",tactics:"defense-evasion",techniqueId:"T1562",value:"indicatorBlocking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.indicatorRemovalFromToolsT1027Description",{defaultMessage:"Indicator Removal from Tools (T1027.005)"}),id:"T1027.005",name:"Indicator Removal from Tools",reference:"https://attack.mitre.org/techniques/T1027/005",tactics:"defense-evasion",techniqueId:"T1027",value:"indicatorRemovalFromTools"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.installRootCertificateT1553Description",{defaultMessage:"Install Root Certificate (T1553.004)"}),id:"T1553.004",name:"Install Root Certificate",reference:"https://attack.mitre.org/techniques/T1553/004",tactics:"defense-evasion",techniqueId:"T1553",value:"installRootCertificate"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.installUtilT1218Description",{defaultMessage:"InstallUtil (T1218.004)"}),id:"T1218.004",name:"InstallUtil",reference:"https://attack.mitre.org/techniques/T1218/004",tactics:"defense-evasion",techniqueId:"T1218",value:"installUtil"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.internalDefacementT1491Description",{defaultMessage:"Internal Defacement (T1491.001)"}),id:"T1491.001",name:"Internal Defacement",reference:"https://attack.mitre.org/techniques/T1491/001",tactics:"impact",techniqueId:"T1491",value:"internalDefacement"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.internalProxyT1090Description",{defaultMessage:"Internal Proxy (T1090.001)"}),id:"T1090.001",name:"Internal Proxy",reference:"https://attack.mitre.org/techniques/T1090/001",tactics:"command-and-control",techniqueId:"T1090",value:"internalProxy"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.invalidCodeSignatureT1036Description",{defaultMessage:"Invalid Code Signature (T1036.001)"}),id:"T1036.001",name:"Invalid Code Signature",reference:"https://attack.mitre.org/techniques/T1036/001",tactics:"defense-evasion",techniqueId:"T1036",value:"invalidCodeSignature"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.javaScriptJScriptT1059Description",{defaultMessage:"JavaScript/JScript (T1059.007)"}),id:"T1059.007",name:"JavaScript/JScript",reference:"https://attack.mitre.org/techniques/T1059/007",tactics:"execution",techniqueId:"T1059",value:"javaScriptJScript"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.junkDataT1001Description",{defaultMessage:"Junk Data (T1001.001)"}),id:"T1001.001",name:"Junk Data",reference:"https://attack.mitre.org/techniques/T1001/001",tactics:"command-and-control",techniqueId:"T1001",value:"junkData"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.kerberoastingT1558Description",{defaultMessage:"Kerberoasting (T1558.003)"}),id:"T1558.003",name:"Kerberoasting",reference:"https://attack.mitre.org/techniques/T1558/003",tactics:"credential-access",techniqueId:"T1558",value:"kerberoasting"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.kernelModulesAndExtensionsT1547Description",{defaultMessage:"Kernel Modules and Extensions (T1547.006)"}),id:"T1547.006",name:"Kernel Modules and Extensions",reference:"https://attack.mitre.org/techniques/T1547/006",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"kernelModulesAndExtensions"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.keychainT1555Description",{defaultMessage:"Keychain (T1555.001)"}),id:"T1555.001",name:"Keychain",reference:"https://attack.mitre.org/techniques/T1555/001",tactics:"credential-access",techniqueId:"T1555",value:"keychain"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.keyloggingT1056Description",{defaultMessage:"Keylogging (T1056.001)"}),id:"T1056.001",name:"Keylogging",reference:"https://attack.mitre.org/techniques/T1056/001",tactics:"collection,credential-access",techniqueId:"T1056",value:"keylogging"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.lcLoadDylibAdditionT1546Description",{defaultMessage:"LC_LOAD_DYLIB Addition (T1546.006)"}),id:"T1546.006",name:"LC_LOAD_DYLIB Addition",reference:"https://attack.mitre.org/techniques/T1546/006",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"lcLoadDylibAddition"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.ldPreloadT1574Description",{defaultMessage:"LD_PRELOAD (T1574.006)"}),id:"T1574.006",name:"LD_PRELOAD",reference:"https://attack.mitre.org/techniques/T1574/006",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"ldPreload"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.llmnrNbtNsPoisoningAndSmbRelayT1557Description",{defaultMessage:"LLMNR/NBT-NS Poisoning and SMB Relay (T1557.001)"}),id:"T1557.001",name:"LLMNR/NBT-NS Poisoning and SMB Relay",reference:"https://attack.mitre.org/techniques/T1557/001",tactics:"credential-access,collection",techniqueId:"T1557",value:"llmnrNbtNsPoisoningAndSmbRelay"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.lsaSecretsT1003Description",{defaultMessage:"LSA Secrets (T1003.004)"}),id:"T1003.004",name:"LSA Secrets",reference:"https://attack.mitre.org/techniques/T1003/004",tactics:"credential-access",techniqueId:"T1003",value:"lsaSecrets"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.lsassDriverT1547Description",{defaultMessage:"LSASS Driver (T1547.008)"}),id:"T1547.008",name:"LSASS Driver",reference:"https://attack.mitre.org/techniques/T1547/008",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"lsassDriver"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.lsassMemoryT1003Description",{defaultMessage:"LSASS Memory (T1003.001)"}),id:"T1003.001",name:"LSASS Memory",reference:"https://attack.mitre.org/techniques/T1003/001",tactics:"credential-access",techniqueId:"T1003",value:"lsassMemory"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.launchAgentT1543Description",{defaultMessage:"Launch Agent (T1543.001)"}),id:"T1543.001",name:"Launch Agent",reference:"https://attack.mitre.org/techniques/T1543/001",tactics:"persistence,privilege-escalation",techniqueId:"T1543",value:"launchAgent"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.launchDaemonT1543Description",{defaultMessage:"Launch Daemon (T1543.004)"}),id:"T1543.004",name:"Launch Daemon",reference:"https://attack.mitre.org/techniques/T1543/004",tactics:"persistence,privilege-escalation",techniqueId:"T1543",value:"launchDaemon"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.launchctlT1569Description",{defaultMessage:"Launchctl (T1569.001)"}),id:"T1569.001",name:"Launchctl",reference:"https://attack.mitre.org/techniques/T1569/001",tactics:"execution",techniqueId:"T1569",value:"launchctl"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.launchdT1053Description",{defaultMessage:"Launchd (T1053.004)"}),id:"T1053.004",name:"Launchd",reference:"https://attack.mitre.org/techniques/T1053/004",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"launchd"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.linuxAndMacFileAndDirectoryPermissionsModificationT1222Description",{defaultMessage:"Linux and Mac File and Directory Permissions Modification (T1222.002)"}),id:"T1222.002",name:"Linux and Mac File and Directory Permissions Modification",reference:"https://attack.mitre.org/techniques/T1222/002",tactics:"defense-evasion",techniqueId:"T1222",value:"linuxAndMacFileAndDirectoryPermissionsModification"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localAccountT1136Description",{defaultMessage:"Local Account (T1136.001)"}),id:"T1136.001",name:"Local Account",reference:"https://attack.mitre.org/techniques/T1136/001",tactics:"persistence",techniqueId:"T1136",value:"localAccount"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localAccountT1087Description",{defaultMessage:"Local Account (T1087.001)"}),id:"T1087.001",name:"Local Account",reference:"https://attack.mitre.org/techniques/T1087/001",tactics:"discovery",techniqueId:"T1087",value:"localAccount"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localAccountsT1078Description",{defaultMessage:"Local Accounts (T1078.003)"}),id:"T1078.003",name:"Local Accounts",reference:"https://attack.mitre.org/techniques/T1078/003",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",techniqueId:"T1078",value:"localAccounts"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localDataStagingT1074Description",{defaultMessage:"Local Data Staging (T1074.001)"}),id:"T1074.001",name:"Local Data Staging",reference:"https://attack.mitre.org/techniques/T1074/001",tactics:"collection",techniqueId:"T1074",value:"localDataStaging"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localEmailCollectionT1114Description",{defaultMessage:"Local Email Collection (T1114.001)"}),id:"T1114.001",name:"Local Email Collection",reference:"https://attack.mitre.org/techniques/T1114/001",tactics:"collection",techniqueId:"T1114",value:"localEmailCollection"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localGroupsT1069Description",{defaultMessage:"Local Groups (T1069.001)"}),id:"T1069.001",name:"Local Groups",reference:"https://attack.mitre.org/techniques/T1069/001",tactics:"discovery",techniqueId:"T1069",value:"localGroups"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.logonScriptMacT1037Description",{defaultMessage:"Logon Script (Mac) (T1037.002)"}),id:"T1037.002",name:"Logon Script (Mac)",reference:"https://attack.mitre.org/techniques/T1037/002",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"logonScriptMac"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.logonScriptWindowsT1037Description",{defaultMessage:"Logon Script (Windows) (T1037.001)"}),id:"T1037.001",name:"Logon Script (Windows)",reference:"https://attack.mitre.org/techniques/T1037/001",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"logonScriptWindows"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.msBuildT1127Description",{defaultMessage:"MSBuild (T1127.001)"}),id:"T1127.001",name:"MSBuild",reference:"https://attack.mitre.org/techniques/T1127/001",tactics:"defense-evasion",techniqueId:"T1127",value:"msBuild"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.mailProtocolsT1071Description",{defaultMessage:"Mail Protocols (T1071.003)"}),id:"T1071.003",name:"Mail Protocols",reference:"https://attack.mitre.org/techniques/T1071/003",tactics:"command-and-control",techniqueId:"T1071",value:"mailProtocols"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.makeAndImpersonateTokenT1134Description",{defaultMessage:"Make and Impersonate Token (T1134.003)"}),id:"T1134.003",name:"Make and Impersonate Token",reference:"https://attack.mitre.org/techniques/T1134/003",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"makeAndImpersonateToken"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.maliciousFileT1204Description",{defaultMessage:"Malicious File (T1204.002)"}),id:"T1204.002",name:"Malicious File",reference:"https://attack.mitre.org/techniques/T1204/002",tactics:"execution",techniqueId:"T1204",value:"maliciousFile"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.maliciousLinkT1204Description",{defaultMessage:"Malicious Link (T1204.001)"}),id:"T1204.001",name:"Malicious Link",reference:"https://attack.mitre.org/techniques/T1204/001",tactics:"execution",techniqueId:"T1204",value:"maliciousLink"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.malwareT1587Description",{defaultMessage:"Malware (T1587.001)"}),id:"T1587.001",name:"Malware",reference:"https://attack.mitre.org/techniques/T1587/001",tactics:"resource-development",techniqueId:"T1587",value:"malware"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.malwareT1588Description",{defaultMessage:"Malware (T1588.001)"}),id:"T1588.001",name:"Malware",reference:"https://attack.mitre.org/techniques/T1588/001",tactics:"resource-development",techniqueId:"T1588",value:"malware"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.masqueradeTaskOrServiceT1036Description",{defaultMessage:"Masquerade Task or Service (T1036.004)"}),id:"T1036.004",name:"Masquerade Task or Service",reference:"https://attack.mitre.org/techniques/T1036/004",tactics:"defense-evasion",techniqueId:"T1036",value:"masqueradeTaskOrService"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.matchLegitimateNameOrLocationT1036Description",{defaultMessage:"Match Legitimate Name or Location (T1036.005)"}),id:"T1036.005",name:"Match Legitimate Name or Location",reference:"https://attack.mitre.org/techniques/T1036/005",tactics:"defense-evasion",techniqueId:"T1036",value:"matchLegitimateNameOrLocation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.mshtaT1218Description",{defaultMessage:"Mshta (T1218.005)"}),id:"T1218.005",name:"Mshta",reference:"https://attack.mitre.org/techniques/T1218/005",tactics:"defense-evasion",techniqueId:"T1218",value:"mshta"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.msiexecT1218Description",{defaultMessage:"Msiexec (T1218.007)"}),id:"T1218.007",name:"Msiexec",reference:"https://attack.mitre.org/techniques/T1218/007",tactics:"defense-evasion",techniqueId:"T1218",value:"msiexec"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.multiHopProxyT1090Description",{defaultMessage:"Multi-hop Proxy (T1090.003)"}),id:"T1090.003",name:"Multi-hop Proxy",reference:"https://attack.mitre.org/techniques/T1090/003",tactics:"command-and-control",techniqueId:"T1090",value:"multiHopProxy"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.ntdsT1003Description",{defaultMessage:"NTDS (T1003.003)"}),id:"T1003.003",name:"NTDS",reference:"https://attack.mitre.org/techniques/T1003/003",tactics:"credential-access",techniqueId:"T1003",value:"ntds"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.ntfsFileAttributesT1564Description",{defaultMessage:"NTFS File Attributes (T1564.004)"}),id:"T1564.004",name:"NTFS File Attributes",reference:"https://attack.mitre.org/techniques/T1564/004",tactics:"defense-evasion",techniqueId:"T1564",value:"ntfsFileAttributes"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.netshHelperDllT1546Description",{defaultMessage:"Netsh Helper DLL (T1546.007)"}),id:"T1546.007",name:"Netsh Helper DLL",reference:"https://attack.mitre.org/techniques/T1546/007",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"netshHelperDll"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkAddressTranslationTraversalT1599Description",{defaultMessage:"Network Address Translation Traversal (T1599.001)"}),id:"T1599.001",name:"Network Address Translation Traversal",reference:"https://attack.mitre.org/techniques/T1599/001",tactics:"defense-evasion",techniqueId:"T1599",value:"networkAddressTranslationTraversal"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkDeviceAuthenticationT1556Description",{defaultMessage:"Network Device Authentication (T1556.004)"}),id:"T1556.004",name:"Network Device Authentication",reference:"https://attack.mitre.org/techniques/T1556/004",tactics:"credential-access,defense-evasion",techniqueId:"T1556",value:"networkDeviceAuthentication"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkDeviceCliT1059Description",{defaultMessage:"Network Device CLI (T1059.008)"}),id:"T1059.008",name:"Network Device CLI",reference:"https://attack.mitre.org/techniques/T1059/008",tactics:"execution",techniqueId:"T1059",value:"networkDeviceCli"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkDeviceConfigurationDumpT1602Description",{defaultMessage:"Network Device Configuration Dump (T1602.002)"}),id:"T1602.002",name:"Network Device Configuration Dump",reference:"https://attack.mitre.org/techniques/T1602/002",tactics:"collection",techniqueId:"T1602",value:"networkDeviceConfigurationDump"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkLogonScriptT1037Description",{defaultMessage:"Network Logon Script (T1037.003)"}),id:"T1037.003",name:"Network Logon Script",reference:"https://attack.mitre.org/techniques/T1037/003",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"networkLogonScript"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkSecurityAppliancesT1590Description",{defaultMessage:"Network Security Appliances (T1590.006)"}),id:"T1590.006",name:"Network Security Appliances",reference:"https://attack.mitre.org/techniques/T1590/006",tactics:"reconnaissance",techniqueId:"T1590",value:"networkSecurityAppliances"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkShareConnectionRemovalT1070Description",{defaultMessage:"Network Share Connection Removal (T1070.005)"}),id:"T1070.005",name:"Network Share Connection Removal",reference:"https://attack.mitre.org/techniques/T1070/005",tactics:"defense-evasion",techniqueId:"T1070",value:"networkShareConnectionRemoval"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkTopologyT1590Description",{defaultMessage:"Network Topology (T1590.004)"}),id:"T1590.004",name:"Network Topology",reference:"https://attack.mitre.org/techniques/T1590/004",tactics:"reconnaissance",techniqueId:"T1590",value:"networkTopology"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkTrustDependenciesT1590Description",{defaultMessage:"Network Trust Dependencies (T1590.003)"}),id:"T1590.003",name:"Network Trust Dependencies",reference:"https://attack.mitre.org/techniques/T1590/003",tactics:"reconnaissance",techniqueId:"T1590",value:"networkTrustDependencies"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.nonStandardEncodingT1132Description",{defaultMessage:"Non-Standard Encoding (T1132.002)"}),id:"T1132.002",name:"Non-Standard Encoding",reference:"https://attack.mitre.org/techniques/T1132/002",tactics:"command-and-control",techniqueId:"T1132",value:"nonStandardEncoding"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.osExhaustionFloodT1499Description",{defaultMessage:"OS Exhaustion Flood (T1499.001)"}),id:"T1499.001",name:"OS Exhaustion Flood",reference:"https://attack.mitre.org/techniques/T1499/001",tactics:"impact",techniqueId:"T1499",value:"osExhaustionFlood"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.odbcconfT1218Description",{defaultMessage:"Odbcconf (T1218.008)"}),id:"T1218.008",name:"Odbcconf",reference:"https://attack.mitre.org/techniques/T1218/008",tactics:"defense-evasion",techniqueId:"T1218",value:"odbcconf"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.officeTemplateMacrosT1137Description",{defaultMessage:"Office Template Macros (T1137.001)"}),id:"T1137.001",name:"Office Template Macros",reference:"https://attack.mitre.org/techniques/T1137/001",tactics:"persistence",techniqueId:"T1137",value:"officeTemplateMacros"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.officeTestT1137Description",{defaultMessage:"Office Test (T1137.002)"}),id:"T1137.002",name:"Office Test",reference:"https://attack.mitre.org/techniques/T1137/002",tactics:"persistence",techniqueId:"T1137",value:"officeTest"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.oneWayCommunicationT1102Description",{defaultMessage:"One-Way Communication (T1102.003)"}),id:"T1102.003",name:"One-Way Communication",reference:"https://attack.mitre.org/techniques/T1102/003",tactics:"command-and-control",techniqueId:"T1102",value:"oneWayCommunication"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.outlookFormsT1137Description",{defaultMessage:"Outlook Forms (T1137.003)"}),id:"T1137.003",name:"Outlook Forms",reference:"https://attack.mitre.org/techniques/T1137/003",tactics:"persistence",techniqueId:"T1137",value:"outlookForms"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.outlookHomePageT1137Description",{defaultMessage:"Outlook Home Page (T1137.004)"}),id:"T1137.004",name:"Outlook Home Page",reference:"https://attack.mitre.org/techniques/T1137/004",tactics:"persistence",techniqueId:"T1137",value:"outlookHomePage"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.outlookRulesT1137Description",{defaultMessage:"Outlook Rules (T1137.005)"}),id:"T1137.005",name:"Outlook Rules",reference:"https://attack.mitre.org/techniques/T1137/005",tactics:"persistence",techniqueId:"T1137",value:"outlookRules"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.parentPidSpoofingT1134Description",{defaultMessage:"Parent PID Spoofing (T1134.004)"}),id:"T1134.004",name:"Parent PID Spoofing",reference:"https://attack.mitre.org/techniques/T1134/004",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"parentPidSpoofing"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passTheHashT1550Description",{defaultMessage:"Pass the Hash (T1550.002)"}),id:"T1550.002",name:"Pass the Hash",reference:"https://attack.mitre.org/techniques/T1550/002",tactics:"defense-evasion,lateral-movement",techniqueId:"T1550",value:"passTheHash"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passTheTicketT1550Description",{defaultMessage:"Pass the Ticket (T1550.003)"}),id:"T1550.003",name:"Pass the Ticket",reference:"https://attack.mitre.org/techniques/T1550/003",tactics:"defense-evasion,lateral-movement",techniqueId:"T1550",value:"passTheTicket"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordCrackingT1110Description",{defaultMessage:"Password Cracking (T1110.002)"}),id:"T1110.002",name:"Password Cracking",reference:"https://attack.mitre.org/techniques/T1110/002",tactics:"credential-access",techniqueId:"T1110",value:"passwordCracking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordFilterDllT1556Description",{defaultMessage:"Password Filter DLL (T1556.002)"}),id:"T1556.002",name:"Password Filter DLL",reference:"https://attack.mitre.org/techniques/T1556/002",tactics:"credential-access,defense-evasion",techniqueId:"T1556",value:"passwordFilterDll"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordGuessingT1110Description",{defaultMessage:"Password Guessing (T1110.001)"}),id:"T1110.001",name:"Password Guessing",reference:"https://attack.mitre.org/techniques/T1110/001",tactics:"credential-access",techniqueId:"T1110",value:"passwordGuessing"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordSprayingT1110Description",{defaultMessage:"Password Spraying (T1110.003)"}),id:"T1110.003",name:"Password Spraying",reference:"https://attack.mitre.org/techniques/T1110/003",tactics:"credential-access",techniqueId:"T1110",value:"passwordSpraying"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.patchSystemImageT1601Description",{defaultMessage:"Patch System Image (T1601.001)"}),id:"T1601.001",name:"Patch System Image",reference:"https://attack.mitre.org/techniques/T1601/001",tactics:"defense-evasion",techniqueId:"T1601",value:"patchSystemImage"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pathInterceptionByPathEnvironmentVariableT1574Description",{defaultMessage:"Path Interception by PATH Environment Variable (T1574.007)"}),id:"T1574.007",name:"Path Interception by PATH Environment Variable",reference:"https://attack.mitre.org/techniques/T1574/007",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"pathInterceptionByPathEnvironmentVariable"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pathInterceptionBySearchOrderHijackingT1574Description",{defaultMessage:"Path Interception by Search Order Hijacking (T1574.008)"}),id:"T1574.008",name:"Path Interception by Search Order Hijacking",reference:"https://attack.mitre.org/techniques/T1574/008",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"pathInterceptionBySearchOrderHijacking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pathInterceptionByUnquotedPathT1574Description",{defaultMessage:"Path Interception by Unquoted Path (T1574.009)"}),id:"T1574.009",name:"Path Interception by Unquoted Path",reference:"https://attack.mitre.org/techniques/T1574/009",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"pathInterceptionByUnquotedPath"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.plistModificationT1547Description",{defaultMessage:"Plist Modification (T1547.011)"}),id:"T1547.011",name:"Plist Modification",reference:"https://attack.mitre.org/techniques/T1547/011",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"plistModification"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pluggableAuthenticationModulesT1556Description",{defaultMessage:"Pluggable Authentication Modules (T1556.003)"}),id:"T1556.003",name:"Pluggable Authentication Modules",reference:"https://attack.mitre.org/techniques/T1556/003",tactics:"credential-access,defense-evasion",techniqueId:"T1556",value:"pluggableAuthenticationModules"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.portKnockingT1205Description",{defaultMessage:"Port Knocking (T1205.001)"}),id:"T1205.001",name:"Port Knocking",reference:"https://attack.mitre.org/techniques/T1205/001",tactics:"defense-evasion,persistence,command-and-control",techniqueId:"T1205",value:"portKnocking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.portMonitorsT1547Description",{defaultMessage:"Port Monitors (T1547.010)"}),id:"T1547.010",name:"Port Monitors",reference:"https://attack.mitre.org/techniques/T1547/010",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"portMonitors"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.portableExecutableInjectionT1055Description",{defaultMessage:"Portable Executable Injection (T1055.002)"}),id:"T1055.002",name:"Portable Executable Injection",reference:"https://attack.mitre.org/techniques/T1055/002",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"portableExecutableInjection"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.powerShellT1059Description",{defaultMessage:"PowerShell (T1059.001)"}),id:"T1059.001",name:"PowerShell",reference:"https://attack.mitre.org/techniques/T1059/001",tactics:"execution",techniqueId:"T1059",value:"powerShell"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.powerShellProfileT1546Description",{defaultMessage:"PowerShell Profile (T1546.013)"}),id:"T1546.013",name:"PowerShell Profile",reference:"https://attack.mitre.org/techniques/T1546/013",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"powerShellProfile"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.printProcessorsT1547Description",{defaultMessage:"Print Processors (T1547.012)"}),id:"T1547.012",name:"Print Processors",reference:"https://attack.mitre.org/techniques/T1547/012",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"printProcessors"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.privateKeysT1552Description",{defaultMessage:"Private Keys (T1552.004)"}),id:"T1552.004",name:"Private Keys",reference:"https://attack.mitre.org/techniques/T1552/004",tactics:"credential-access",techniqueId:"T1552",value:"privateKeys"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.procFilesystemT1003Description",{defaultMessage:"Proc Filesystem (T1003.007)"}),id:"T1003.007",name:"Proc Filesystem",reference:"https://attack.mitre.org/techniques/T1003/007",tactics:"credential-access",techniqueId:"T1003",value:"procFilesystem"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.procMemoryT1055Description",{defaultMessage:"Proc Memory (T1055.009)"}),id:"T1055.009",name:"Proc Memory",reference:"https://attack.mitre.org/techniques/T1055/009",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"procMemory"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.processDoppelgangingT1055Description",{defaultMessage:"Process Doppelgänging (T1055.013)"}),id:"T1055.013",name:"Process Doppelgänging",reference:"https://attack.mitre.org/techniques/T1055/013",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"processDoppelganging"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.processHollowingT1055Description",{defaultMessage:"Process Hollowing (T1055.012)"}),id:"T1055.012",name:"Process Hollowing",reference:"https://attack.mitre.org/techniques/T1055/012",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"processHollowing"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.protocolImpersonationT1001Description",{defaultMessage:"Protocol Impersonation (T1001.003)"}),id:"T1001.003",name:"Protocol Impersonation",reference:"https://attack.mitre.org/techniques/T1001/003",tactics:"command-and-control",techniqueId:"T1001",value:"protocolImpersonation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.ptraceSystemCallsT1055Description",{defaultMessage:"Ptrace System Calls (T1055.008)"}),id:"T1055.008",name:"Ptrace System Calls",reference:"https://attack.mitre.org/techniques/T1055/008",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"ptraceSystemCalls"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pubPrnT1216Description",{defaultMessage:"PubPrn (T1216.001)"}),id:"T1216.001",name:"PubPrn",reference:"https://attack.mitre.org/techniques/T1216/001",tactics:"defense-evasion",techniqueId:"T1216",value:"pubPrn"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.purchaseTechnicalDataT1597Description",{defaultMessage:"Purchase Technical Data (T1597.002)"}),id:"T1597.002",name:"Purchase Technical Data",reference:"https://attack.mitre.org/techniques/T1597/002",tactics:"reconnaissance",techniqueId:"T1597",value:"purchaseTechnicalData"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pythonT1059Description",{defaultMessage:"Python (T1059.006)"}),id:"T1059.006",name:"Python",reference:"https://attack.mitre.org/techniques/T1059/006",tactics:"execution",techniqueId:"T1059",value:"python"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rdpHijackingT1563Description",{defaultMessage:"RDP Hijacking (T1563.002)"}),id:"T1563.002",name:"RDP Hijacking",reference:"https://attack.mitre.org/techniques/T1563/002",tactics:"lateral-movement",techniqueId:"T1563",value:"rdpHijacking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rommoNkitT1542Description",{defaultMessage:"ROMMONkit (T1542.004)"}),id:"T1542.004",name:"ROMMONkit",reference:"https://attack.mitre.org/techniques/T1542/004",tactics:"defense-evasion,persistence",techniqueId:"T1542",value:"rommoNkit"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rcCommonT1037Description",{defaultMessage:"Rc.common (T1037.004)"}),id:"T1037.004",name:"Rc.common",reference:"https://attack.mitre.org/techniques/T1037/004",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"rcCommon"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.reOpenedApplicationsT1547Description",{defaultMessage:"Re-opened Applications (T1547.007)"}),id:"T1547.007",name:"Re-opened Applications",reference:"https://attack.mitre.org/techniques/T1547/007",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"reOpenedApplications"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.reduceKeySpaceT1600Description",{defaultMessage:"Reduce Key Space (T1600.001)"}),id:"T1600.001",name:"Reduce Key Space",reference:"https://attack.mitre.org/techniques/T1600/001",tactics:"defense-evasion",techniqueId:"T1600",value:"reduceKeySpace"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.reflectionAmplificationT1498Description",{defaultMessage:"Reflection Amplification (T1498.002)"}),id:"T1498.002",name:"Reflection Amplification",reference:"https://attack.mitre.org/techniques/T1498/002",tactics:"impact",techniqueId:"T1498",value:"reflectionAmplification"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.registryRunKeysStartupFolderT1547Description",{defaultMessage:"Registry Run Keys / Startup Folder (T1547.001)"}),id:"T1547.001",name:"Registry Run Keys / Startup Folder",reference:"https://attack.mitre.org/techniques/T1547/001",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"registryRunKeysStartupFolder"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.regsvcsRegasmT1218Description",{defaultMessage:"Regsvcs/Regasm (T1218.009)"}),id:"T1218.009",name:"Regsvcs/Regasm",reference:"https://attack.mitre.org/techniques/T1218/009",tactics:"defense-evasion",techniqueId:"T1218",value:"regsvcsRegasm"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.regsvr32T1218Description",{defaultMessage:"Regsvr32 (T1218.010)"}),id:"T1218.010",name:"Regsvr32",reference:"https://attack.mitre.org/techniques/T1218/010",tactics:"defense-evasion",techniqueId:"T1218",value:"regsvr32"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.remoteDataStagingT1074Description",{defaultMessage:"Remote Data Staging (T1074.002)"}),id:"T1074.002",name:"Remote Data Staging",reference:"https://attack.mitre.org/techniques/T1074/002",tactics:"collection",techniqueId:"T1074",value:"remoteDataStaging"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.remoteDesktopProtocolT1021Description",{defaultMessage:"Remote Desktop Protocol (T1021.001)"}),id:"T1021.001",name:"Remote Desktop Protocol",reference:"https://attack.mitre.org/techniques/T1021/001",tactics:"lateral-movement",techniqueId:"T1021",value:"remoteDesktopProtocol"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.remoteEmailCollectionT1114Description",{defaultMessage:"Remote Email Collection (T1114.002)"}),id:"T1114.002",name:"Remote Email Collection",reference:"https://attack.mitre.org/techniques/T1114/002",tactics:"collection",techniqueId:"T1114",value:"remoteEmailCollection"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.renameSystemUtilitiesT1036Description",{defaultMessage:"Rename System Utilities (T1036.003)"}),id:"T1036.003",name:"Rename System Utilities",reference:"https://attack.mitre.org/techniques/T1036/003",tactics:"defense-evasion",techniqueId:"T1036",value:"renameSystemUtilities"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.revertCloudInstanceT1578Description",{defaultMessage:"Revert Cloud Instance (T1578.004)"}),id:"T1578.004",name:"Revert Cloud Instance",reference:"https://attack.mitre.org/techniques/T1578/004",tactics:"defense-evasion",techniqueId:"T1578",value:"revertCloudInstance"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rightToLeftOverrideT1036Description",{defaultMessage:"Right-to-Left Override (T1036.002)"}),id:"T1036.002",name:"Right-to-Left Override",reference:"https://attack.mitre.org/techniques/T1036/002",tactics:"defense-evasion",techniqueId:"T1036",value:"rightToLeftOverride"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.runVirtualInstanceT1564Description",{defaultMessage:"Run Virtual Instance (T1564.006)"}),id:"T1564.006",name:"Run Virtual Instance",reference:"https://attack.mitre.org/techniques/T1564/006",tactics:"defense-evasion",techniqueId:"T1564",value:"runVirtualInstance"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rundll32T1218Description",{defaultMessage:"Rundll32 (T1218.011)"}),id:"T1218.011",name:"Rundll32",reference:"https://attack.mitre.org/techniques/T1218/011",tactics:"defense-evasion",techniqueId:"T1218",value:"rundll32"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.runtimeDataManipulationT1565Description",{defaultMessage:"Runtime Data Manipulation (T1565.003)"}),id:"T1565.003",name:"Runtime Data Manipulation",reference:"https://attack.mitre.org/techniques/T1565/003",tactics:"impact",techniqueId:"T1565",value:"runtimeDataManipulation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sidHistoryInjectionT1134Description",{defaultMessage:"SID-History Injection (T1134.005)"}),id:"T1134.005",name:"SID-History Injection",reference:"https://attack.mitre.org/techniques/T1134/005",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"sidHistoryInjection"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sipAndTrustProviderHijackingT1553Description",{defaultMessage:"SIP and Trust Provider Hijacking (T1553.003)"}),id:"T1553.003",name:"SIP and Trust Provider Hijacking",reference:"https://attack.mitre.org/techniques/T1553/003",tactics:"defense-evasion",techniqueId:"T1553",value:"sipAndTrustProviderHijacking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.smbWindowsAdminSharesT1021Description",{defaultMessage:"SMB/Windows Admin Shares (T1021.002)"}),id:"T1021.002",name:"SMB/Windows Admin Shares",reference:"https://attack.mitre.org/techniques/T1021/002",tactics:"lateral-movement",techniqueId:"T1021",value:"smbWindowsAdminShares"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.snmpMibDumpT1602Description",{defaultMessage:"SNMP (MIB Dump) (T1602.001)"}),id:"T1602.001",name:"SNMP (MIB Dump)",reference:"https://attack.mitre.org/techniques/T1602/001",tactics:"collection",techniqueId:"T1602",value:"snmpMibDump"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sqlStoredProceduresT1505Description",{defaultMessage:"SQL Stored Procedures (T1505.001)"}),id:"T1505.001",name:"SQL Stored Procedures",reference:"https://attack.mitre.org/techniques/T1505/001",tactics:"persistence",techniqueId:"T1505",value:"sqlStoredProcedures"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sshT1021Description",{defaultMessage:"SSH (T1021.004)"}),id:"T1021.004",name:"SSH",reference:"https://attack.mitre.org/techniques/T1021/004",tactics:"lateral-movement",techniqueId:"T1021",value:"ssh"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sshAuthorizedKeysT1098Description",{defaultMessage:"SSH Authorized Keys (T1098.004)"}),id:"T1098.004",name:"SSH Authorized Keys",reference:"https://attack.mitre.org/techniques/T1098/004",tactics:"persistence",techniqueId:"T1098",value:"sshAuthorizedKeys"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sshHijackingT1563Description",{defaultMessage:"SSH Hijacking (T1563.001)"}),id:"T1563.001",name:"SSH Hijacking",reference:"https://attack.mitre.org/techniques/T1563/001",tactics:"lateral-movement",techniqueId:"T1563",value:"sshHijacking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.scanDatabasesT1596Description",{defaultMessage:"Scan Databases (T1596.005)"}),id:"T1596.005",name:"Scan Databases",reference:"https://attack.mitre.org/techniques/T1596/005",tactics:"reconnaissance",techniqueId:"T1596",value:"scanDatabases"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.scanningIpBlocksT1595Description",{defaultMessage:"Scanning IP Blocks (T1595.001)"}),id:"T1595.001",name:"Scanning IP Blocks",reference:"https://attack.mitre.org/techniques/T1595/001",tactics:"reconnaissance",techniqueId:"T1595",value:"scanningIpBlocks"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.scheduledTaskT1053Description",{defaultMessage:"Scheduled Task (T1053.005)"}),id:"T1053.005",name:"Scheduled Task",reference:"https://attack.mitre.org/techniques/T1053/005",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"scheduledTask"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.screensaverT1546Description",{defaultMessage:"Screensaver (T1546.002)"}),id:"T1546.002",name:"Screensaver",reference:"https://attack.mitre.org/techniques/T1546/002",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"screensaver"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.searchEnginesT1593Description",{defaultMessage:"Search Engines (T1593.002)"}),id:"T1593.002",name:"Search Engines",reference:"https://attack.mitre.org/techniques/T1593/002",tactics:"reconnaissance",techniqueId:"T1593",value:"searchEngines"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.securityAccountManagerT1003Description",{defaultMessage:"Security Account Manager (T1003.002)"}),id:"T1003.002",name:"Security Account Manager",reference:"https://attack.mitre.org/techniques/T1003/002",tactics:"credential-access",techniqueId:"T1003",value:"securityAccountManager"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.securitySoftwareDiscoveryT1518Description",{defaultMessage:"Security Software Discovery (T1518.001)"}),id:"T1518.001",name:"Security Software Discovery",reference:"https://attack.mitre.org/techniques/T1518/001",tactics:"discovery",techniqueId:"T1518",value:"securitySoftwareDiscovery"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.securitySupportProviderT1547Description",{defaultMessage:"Security Support Provider (T1547.005)"}),id:"T1547.005",name:"Security Support Provider",reference:"https://attack.mitre.org/techniques/T1547/005",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"securitySupportProvider"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.securitydMemoryT1555Description",{defaultMessage:"Securityd Memory (T1555.002)"}),id:"T1555.002",name:"Securityd Memory",reference:"https://attack.mitre.org/techniques/T1555/002",tactics:"credential-access",techniqueId:"T1555",value:"securitydMemory"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.serverT1583Description",{defaultMessage:"Server (T1583.004)"}),id:"T1583.004",name:"Server",reference:"https://attack.mitre.org/techniques/T1583/004",tactics:"resource-development",techniqueId:"T1583",value:"server"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.serverT1584Description",{defaultMessage:"Server (T1584.004)"}),id:"T1584.004",name:"Server",reference:"https://attack.mitre.org/techniques/T1584/004",tactics:"resource-development",techniqueId:"T1584",value:"server"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.serviceExecutionT1569Description",{defaultMessage:"Service Execution (T1569.002)"}),id:"T1569.002",name:"Service Execution",reference:"https://attack.mitre.org/techniques/T1569/002",tactics:"execution",techniqueId:"T1569",value:"serviceExecution"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.serviceExhaustionFloodT1499Description",{defaultMessage:"Service Exhaustion Flood (T1499.002)"}),id:"T1499.002",name:"Service Exhaustion Flood",reference:"https://attack.mitre.org/techniques/T1499/002",tactics:"impact",techniqueId:"T1499",value:"serviceExhaustionFlood"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.servicesFilePermissionsWeaknessT1574Description",{defaultMessage:"Services File Permissions Weakness (T1574.010)"}),id:"T1574.010",name:"Services File Permissions Weakness",reference:"https://attack.mitre.org/techniques/T1574/010",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"servicesFilePermissionsWeakness"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.servicesRegistryPermissionsWeaknessT1574Description",{defaultMessage:"Services Registry Permissions Weakness (T1574.011)"}),id:"T1574.011",name:"Services Registry Permissions Weakness",reference:"https://attack.mitre.org/techniques/T1574/011",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"servicesRegistryPermissionsWeakness"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.setuidAndSetgidT1548Description",{defaultMessage:"Setuid and Setgid (T1548.001)"}),id:"T1548.001",name:"Setuid and Setgid",reference:"https://attack.mitre.org/techniques/T1548/001",tactics:"privilege-escalation,defense-evasion",techniqueId:"T1548",value:"setuidAndSetgid"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sharepointT1213Description",{defaultMessage:"Sharepoint (T1213.002)"}),id:"T1213.002",name:"Sharepoint",reference:"https://attack.mitre.org/techniques/T1213/002",tactics:"collection",techniqueId:"T1213",value:"sharepoint"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.shortcutModificationT1547Description",{defaultMessage:"Shortcut Modification (T1547.009)"}),id:"T1547.009",name:"Shortcut Modification",reference:"https://attack.mitre.org/techniques/T1547/009",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"shortcutModification"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.silverTicketT1558Description",{defaultMessage:"Silver Ticket (T1558.002)"}),id:"T1558.002",name:"Silver Ticket",reference:"https://attack.mitre.org/techniques/T1558/002",tactics:"credential-access",techniqueId:"T1558",value:"silverTicket"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.socialMediaT1593Description",{defaultMessage:"Social Media (T1593.001)"}),id:"T1593.001",name:"Social Media",reference:"https://attack.mitre.org/techniques/T1593/001",tactics:"reconnaissance",techniqueId:"T1593",value:"socialMedia"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.socialMediaAccountsT1585Description",{defaultMessage:"Social Media Accounts (T1585.001)"}),id:"T1585.001",name:"Social Media Accounts",reference:"https://attack.mitre.org/techniques/T1585/001",tactics:"resource-development",techniqueId:"T1585",value:"socialMediaAccounts"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.socialMediaAccountsT1586Description",{defaultMessage:"Social Media Accounts (T1586.001)"}),id:"T1586.001",name:"Social Media Accounts",reference:"https://attack.mitre.org/techniques/T1586/001",tactics:"resource-development",techniqueId:"T1586",value:"socialMediaAccounts"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.softwareT1592Description",{defaultMessage:"Software (T1592.002)"}),id:"T1592.002",name:"Software",reference:"https://attack.mitre.org/techniques/T1592/002",tactics:"reconnaissance",techniqueId:"T1592",value:"software"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.softwarePackingT1027Description",{defaultMessage:"Software Packing (T1027.002)"}),id:"T1027.002",name:"Software Packing",reference:"https://attack.mitre.org/techniques/T1027/002",tactics:"defense-evasion",techniqueId:"T1027",value:"softwarePacking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spaceAfterFilenameT1036Description",{defaultMessage:"Space after Filename (T1036.006)"}),id:"T1036.006",name:"Space after Filename",reference:"https://attack.mitre.org/techniques/T1036/006",tactics:"defense-evasion",techniqueId:"T1036",value:"spaceAfterFilename"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingAttachmentT1566Description",{defaultMessage:"Spearphishing Attachment (T1566.001)"}),id:"T1566.001",name:"Spearphishing Attachment",reference:"https://attack.mitre.org/techniques/T1566/001",tactics:"initial-access",techniqueId:"T1566",value:"spearphishingAttachment"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingAttachmentT1598Description",{defaultMessage:"Spearphishing Attachment (T1598.002)"}),id:"T1598.002",name:"Spearphishing Attachment",reference:"https://attack.mitre.org/techniques/T1598/002",tactics:"reconnaissance",techniqueId:"T1598",value:"spearphishingAttachment"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingLinkT1566Description",{defaultMessage:"Spearphishing Link (T1566.002)"}),id:"T1566.002",name:"Spearphishing Link",reference:"https://attack.mitre.org/techniques/T1566/002",tactics:"initial-access",techniqueId:"T1566",value:"spearphishingLink"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingLinkT1598Description",{defaultMessage:"Spearphishing Link (T1598.003)"}),id:"T1598.003",name:"Spearphishing Link",reference:"https://attack.mitre.org/techniques/T1598/003",tactics:"reconnaissance",techniqueId:"T1598",value:"spearphishingLink"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingServiceT1598Description",{defaultMessage:"Spearphishing Service (T1598.001)"}),id:"T1598.001",name:"Spearphishing Service",reference:"https://attack.mitre.org/techniques/T1598/001",tactics:"reconnaissance",techniqueId:"T1598",value:"spearphishingService"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingViaServiceT1566Description",{defaultMessage:"Spearphishing via Service (T1566.003)"}),id:"T1566.003",name:"Spearphishing via Service",reference:"https://attack.mitre.org/techniques/T1566/003",tactics:"initial-access",techniqueId:"T1566",value:"spearphishingViaService"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.standardEncodingT1132Description",{defaultMessage:"Standard Encoding (T1132.001)"}),id:"T1132.001",name:"Standard Encoding",reference:"https://attack.mitre.org/techniques/T1132/001",tactics:"command-and-control",techniqueId:"T1132",value:"standardEncoding"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.startupItemsT1037Description",{defaultMessage:"Startup Items (T1037.005)"}),id:"T1037.005",name:"Startup Items",reference:"https://attack.mitre.org/techniques/T1037/005",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"startupItems"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.steganographyT1027Description",{defaultMessage:"Steganography (T1027.003)"}),id:"T1027.003",name:"Steganography",reference:"https://attack.mitre.org/techniques/T1027/003",tactics:"defense-evasion",techniqueId:"T1027",value:"steganography"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.steganographyT1001Description",{defaultMessage:"Steganography (T1001.002)"}),id:"T1001.002",name:"Steganography",reference:"https://attack.mitre.org/techniques/T1001/002",tactics:"command-and-control",techniqueId:"T1001",value:"steganography"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.storedDataManipulationT1565Description",{defaultMessage:"Stored Data Manipulation (T1565.001)"}),id:"T1565.001",name:"Stored Data Manipulation",reference:"https://attack.mitre.org/techniques/T1565/001",tactics:"impact",techniqueId:"T1565",value:"storedDataManipulation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sudoAndSudoCachingT1548Description",{defaultMessage:"Sudo and Sudo Caching (T1548.003)"}),id:"T1548.003",name:"Sudo and Sudo Caching",reference:"https://attack.mitre.org/techniques/T1548/003",tactics:"privilege-escalation,defense-evasion",techniqueId:"T1548",value:"sudoAndSudoCaching"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.symmetricCryptographyT1573Description",{defaultMessage:"Symmetric Cryptography (T1573.001)"}),id:"T1573.001",name:"Symmetric Cryptography",reference:"https://attack.mitre.org/techniques/T1573/001",tactics:"command-and-control",techniqueId:"T1573",value:"symmetricCryptography"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.systemChecksT1497Description",{defaultMessage:"System Checks (T1497.001)"}),id:"T1497.001",name:"System Checks",reference:"https://attack.mitre.org/techniques/T1497/001",tactics:"defense-evasion,discovery",techniqueId:"T1497",value:"systemChecks"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.systemFirmwareT1542Description",{defaultMessage:"System Firmware (T1542.001)"}),id:"T1542.001",name:"System Firmware",reference:"https://attack.mitre.org/techniques/T1542/001",tactics:"persistence,defense-evasion",techniqueId:"T1542",value:"systemFirmware"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.systemdServiceT1543Description",{defaultMessage:"Systemd Service (T1543.002)"}),id:"T1543.002",name:"Systemd Service",reference:"https://attack.mitre.org/techniques/T1543/002",tactics:"persistence,privilege-escalation",techniqueId:"T1543",value:"systemdService"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.systemdTimersT1053Description",{defaultMessage:"Systemd Timers (T1053.006)"}),id:"T1053.006",name:"Systemd Timers",reference:"https://attack.mitre.org/techniques/T1053/006",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"systemdTimers"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.tftpBootT1542Description",{defaultMessage:"TFTP Boot (T1542.005)"}),id:"T1542.005",name:"TFTP Boot",reference:"https://attack.mitre.org/techniques/T1542/005",tactics:"defense-evasion,persistence",techniqueId:"T1542",value:"tftpBoot"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.threadExecutionHijackingT1055Description",{defaultMessage:"Thread Execution Hijacking (T1055.003)"}),id:"T1055.003",name:"Thread Execution Hijacking",reference:"https://attack.mitre.org/techniques/T1055/003",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"threadExecutionHijacking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.threadLocalStorageT1055Description",{defaultMessage:"Thread Local Storage (T1055.005)"}),id:"T1055.005",name:"Thread Local Storage",reference:"https://attack.mitre.org/techniques/T1055/005",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"threadLocalStorage"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.threatIntelVendorsT1597Description",{defaultMessage:"Threat Intel Vendors (T1597.001)"}),id:"T1597.001",name:"Threat Intel Vendors",reference:"https://attack.mitre.org/techniques/T1597/001",tactics:"reconnaissance",techniqueId:"T1597",value:"threatIntelVendors"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.timeBasedEvasionT1497Description",{defaultMessage:"Time Based Evasion (T1497.003)"}),id:"T1497.003",name:"Time Based Evasion",reference:"https://attack.mitre.org/techniques/T1497/003",tactics:"defense-evasion,discovery",techniqueId:"T1497",value:"timeBasedEvasion"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.timeProvidersT1547Description",{defaultMessage:"Time Providers (T1547.003)"}),id:"T1547.003",name:"Time Providers",reference:"https://attack.mitre.org/techniques/T1547/003",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"timeProviders"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.timestompT1070Description",{defaultMessage:"Timestomp (T1070.006)"}),id:"T1070.006",name:"Timestomp",reference:"https://attack.mitre.org/techniques/T1070/006",tactics:"defense-evasion",techniqueId:"T1070",value:"timestomp"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.tokenImpersonationTheftT1134Description",{defaultMessage:"Token Impersonation/Theft (T1134.001)"}),id:"T1134.001",name:"Token Impersonation/Theft",reference:"https://attack.mitre.org/techniques/T1134/001",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"tokenImpersonationTheft"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.toolT1588Description",{defaultMessage:"Tool (T1588.002)"}),id:"T1588.002",name:"Tool",reference:"https://attack.mitre.org/techniques/T1588/002",tactics:"resource-development",techniqueId:"T1588",value:"tool"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.trafficDuplicationT1020Description",{defaultMessage:"Traffic Duplication (T1020.001)"}),id:"T1020.001",name:"Traffic Duplication",reference:"https://attack.mitre.org/techniques/T1020/001",tactics:"exfiltration",techniqueId:"T1020",value:"trafficDuplication"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.transmittedDataManipulationT1565Description",{defaultMessage:"Transmitted Data Manipulation (T1565.002)"}),id:"T1565.002",name:"Transmitted Data Manipulation",reference:"https://attack.mitre.org/techniques/T1565/002",tactics:"impact",techniqueId:"T1565",value:"transmittedDataManipulation"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.transportAgentT1505Description",{defaultMessage:"Transport Agent (T1505.002)"}),id:"T1505.002",name:"Transport Agent",reference:"https://attack.mitre.org/techniques/T1505/002",tactics:"persistence",techniqueId:"T1505",value:"transportAgent"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.trapT1546Description",{defaultMessage:"Trap (T1546.005)"}),id:"T1546.005",name:"Trap",reference:"https://attack.mitre.org/techniques/T1546/005",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"trap"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.unixShellT1059Description",{defaultMessage:"Unix Shell (T1059.004)"}),id:"T1059.004",name:"Unix Shell",reference:"https://attack.mitre.org/techniques/T1059/004",tactics:"execution",techniqueId:"T1059",value:"unixShell"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.userActivityBasedChecksT1497Description",{defaultMessage:"User Activity Based Checks (T1497.002)"}),id:"T1497.002",name:"User Activity Based Checks",reference:"https://attack.mitre.org/techniques/T1497/002",tactics:"defense-evasion,discovery",techniqueId:"T1497",value:"userActivityBasedChecks"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vbaStompingT1564Description",{defaultMessage:"VBA Stomping (T1564.007)"}),id:"T1564.007",name:"VBA Stomping",reference:"https://attack.mitre.org/techniques/T1564/007",tactics:"defense-evasion",techniqueId:"T1564",value:"vbaStomping"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vdsoHijackingT1055Description",{defaultMessage:"VDSO Hijacking (T1055.014)"}),id:"T1055.014",name:"VDSO Hijacking",reference:"https://attack.mitre.org/techniques/T1055/014",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"vdsoHijacking"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vncT1021Description",{defaultMessage:"VNC (T1021.005)"}),id:"T1021.005",name:"VNC",reference:"https://attack.mitre.org/techniques/T1021/005",tactics:"lateral-movement",techniqueId:"T1021",value:"vnc"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.verclsidT1218Description",{defaultMessage:"Verclsid (T1218.012)"}),id:"T1218.012",name:"Verclsid",reference:"https://attack.mitre.org/techniques/T1218/012",tactics:"defense-evasion",techniqueId:"T1218",value:"verclsid"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.virtualPrivateServerT1583Description",{defaultMessage:"Virtual Private Server (T1583.003)"}),id:"T1583.003",name:"Virtual Private Server",reference:"https://attack.mitre.org/techniques/T1583/003",tactics:"resource-development",techniqueId:"T1583",value:"virtualPrivateServer"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.virtualPrivateServerT1584Description",{defaultMessage:"Virtual Private Server (T1584.003)"}),id:"T1584.003",name:"Virtual Private Server",reference:"https://attack.mitre.org/techniques/T1584/003",tactics:"resource-development",techniqueId:"T1584",value:"virtualPrivateServer"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.visualBasicT1059Description",{defaultMessage:"Visual Basic (T1059.005)"}),id:"T1059.005",name:"Visual Basic",reference:"https://attack.mitre.org/techniques/T1059/005",tactics:"execution",techniqueId:"T1059",value:"visualBasic"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vulnerabilitiesT1588Description",{defaultMessage:"Vulnerabilities (T1588.006)"}),id:"T1588.006",name:"Vulnerabilities",reference:"https://attack.mitre.org/techniques/T1588/006",tactics:"resource-development",techniqueId:"T1588",value:"vulnerabilities"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vulnerabilityScanningT1595Description",{defaultMessage:"Vulnerability Scanning (T1595.002)"}),id:"T1595.002",name:"Vulnerability Scanning",reference:"https://attack.mitre.org/techniques/T1595/002",tactics:"reconnaissance",techniqueId:"T1595",value:"vulnerabilityScanning"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.whoisT1596Description",{defaultMessage:"WHOIS (T1596.002)"}),id:"T1596.002",name:"WHOIS",reference:"https://attack.mitre.org/techniques/T1596/002",tactics:"reconnaissance",techniqueId:"T1596",value:"whois"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webPortalCaptureT1056Description",{defaultMessage:"Web Portal Capture (T1056.003)"}),id:"T1056.003",name:"Web Portal Capture",reference:"https://attack.mitre.org/techniques/T1056/003",tactics:"collection,credential-access",techniqueId:"T1056",value:"webPortalCapture"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webProtocolsT1071Description",{defaultMessage:"Web Protocols (T1071.001)"}),id:"T1071.001",name:"Web Protocols",reference:"https://attack.mitre.org/techniques/T1071/001",tactics:"command-and-control",techniqueId:"T1071",value:"webProtocols"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webServicesT1583Description",{defaultMessage:"Web Services (T1583.006)"}),id:"T1583.006",name:"Web Services",reference:"https://attack.mitre.org/techniques/T1583/006",tactics:"resource-development",techniqueId:"T1583",value:"webServices"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webServicesT1584Description",{defaultMessage:"Web Services (T1584.006)"}),id:"T1584.006",name:"Web Services",reference:"https://attack.mitre.org/techniques/T1584/006",tactics:"resource-development",techniqueId:"T1584",value:"webServices"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webSessionCookieT1550Description",{defaultMessage:"Web Session Cookie (T1550.004)"}),id:"T1550.004",name:"Web Session Cookie",reference:"https://attack.mitre.org/techniques/T1550/004",tactics:"defense-evasion,lateral-movement",techniqueId:"T1550",value:"webSessionCookie"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webShellT1505Description",{defaultMessage:"Web Shell (T1505.003)"}),id:"T1505.003",name:"Web Shell",reference:"https://attack.mitre.org/techniques/T1505/003",tactics:"persistence",techniqueId:"T1505",value:"webShell"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsCommandShellT1059Description",{defaultMessage:"Windows Command Shell (T1059.003)"}),id:"T1059.003",name:"Windows Command Shell",reference:"https://attack.mitre.org/techniques/T1059/003",tactics:"execution",techniqueId:"T1059",value:"windowsCommandShell"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsFileAndDirectoryPermissionsModificationT1222Description",{defaultMessage:"Windows File and Directory Permissions Modification (T1222.001)"}),id:"T1222.001",name:"Windows File and Directory Permissions Modification",reference:"https://attack.mitre.org/techniques/T1222/001",tactics:"defense-evasion",techniqueId:"T1222",value:"windowsFileAndDirectoryPermissionsModification"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsManagementInstrumentationEventSubscriptionT1546Description",{defaultMessage:"Windows Management Instrumentation Event Subscription (T1546.003)"}),id:"T1546.003",name:"Windows Management Instrumentation Event Subscription",reference:"https://attack.mitre.org/techniques/T1546/003",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"windowsManagementInstrumentationEventSubscription"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsRemoteManagementT1021Description",{defaultMessage:"Windows Remote Management (T1021.006)"}),id:"T1021.006",name:"Windows Remote Management",reference:"https://attack.mitre.org/techniques/T1021/006",tactics:"lateral-movement",techniqueId:"T1021",value:"windowsRemoteManagement"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsServiceT1543Description",{defaultMessage:"Windows Service (T1543.003)"}),id:"T1543.003",name:"Windows Service",reference:"https://attack.mitre.org/techniques/T1543/003",tactics:"persistence,privilege-escalation",techniqueId:"T1543",value:"windowsService"},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.winlogonHelperDllT1547Description",{defaultMessage:"Winlogon Helper DLL (T1547.004)"}),id:"T1547.004",name:"Winlogon Helper DLL",reference:"https://attack.mitre.org/techniques/T1547/004",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"winlogonHelperDll"}];const mockThreatData={tactic:{name:"Privilege Escalation",id:"TA0004",reference:"https://attack.mitre.org/tactics/TA0004"},technique:{name:"Event Triggered Execution",id:"T1546",reference:"https://attack.mitre.org/techniques/T1546",tactics:["privilege-escalation","persistence"]},subtechnique:{name:".bash_profile and .bashrc",id:"T1546.004",reference:"https://attack.mitre.org/techniques/T1546/004",tactics:["privilege-escalation","persistence"],techniqueId:"T1546"}};const FILTERS_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.filtersLabel",{defaultMessage:"Filters"});const QUERY_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.QueryLabel",{defaultMessage:"Custom query"});const THREAT_QUERY_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.threatQueryLabel",{defaultMessage:"Indicator index query"});const SAVED_ID_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.savedIdLabel",{defaultMessage:"Saved query name"});const ML_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.mlRuleTypeDescription",{defaultMessage:"Machine Learning"});const EQL_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.eqlRuleTypeDescription",{defaultMessage:"Event Correlation"});const QUERY_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.queryRuleTypeDescription",{defaultMessage:"Query"});const THRESHOLD_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.thresholdRuleTypeDescription",{defaultMessage:"Threshold"});const THREAT_MATCH_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.threatMatchRuleTypeDescription",{defaultMessage:"Indicator Match"});const ML_JOB_STARTED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStartedDescription",{defaultMessage:"Started"});const ML_JOB_STOPPED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStoppedDescription",{defaultMessage:"Stopped"});const THRESHOLD_RESULTS_ALL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAllDescription",{defaultMessage:"All results"});const THRESHOLD_RESULTS_AGGREGATED_BY=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAggregatedByDescription",{defaultMessage:"Results aggregated by"});const SeverityBadgeComponent=({value:value})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{"data-test-subj":"severity",color:value==="low"?external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis0:value==="medium"?external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis5:value==="high"?external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis7:external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis9},Object(external_kbnSharedDeps_LodashFp_["upperFirst"])(value));const SeverityBadge=external_kbnSharedDeps_React_default.a.memo(SeverityBadgeComponent);var list_tree_icon=__webpack_require__(1085);var list_tree_icon_default=__webpack_require__.n(list_tree_icon);var empty_value=__webpack_require__(114);const NoteDescriptionContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"NoteDescriptionContainer",componentId:"sc-123zi2b-0"})(["height:105px;overflow-y:hidden;"]);const isNotEmptyArray=values=>!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(values.join(""));const EuiBadgeWrap=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiBadge"]).withConfig({displayName:"EuiBadgeWrap",componentId:"sc-123zi2b-1"})([".euiBadge__text{white-space:pre-wrap !important;}"]);const Query=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Query",componentId:"sc-123zi2b-2"})(["white-space:pre-wrap;"]);const buildQueryBarDescription=({field:field,filters:filters,filterManager:filterManager,query:query,savedId:savedId,indexPatterns:indexPatterns,queryLabel:queryLabel})=>{let items=[];if(!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(filters)){filterManager.setFilters(filters);items=[...items,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,FILTERS_LABEL," "),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true,responsive:false,gutterSize:"xs"},filterManager.getFilters().map((filter,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,key:`${field}-filter-${index}`},external_kbnSharedDeps_React_default.a.createElement(EuiBadgeWrap,{color:"hollow"},indexPatterns!=null?external_kbnSharedDeps_React_default.a.createElement(public_["esFilters"].FilterLabel,{filter:filter,valueLabel:public_["esFilters"].getDisplayValueFromFilter(filter,[indexPatterns])}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"})))))}]}if(!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(query)){items=[...items,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,queryLabel!==null&&queryLabel!==void 0?queryLabel:QUERY_LABEL),description:external_kbnSharedDeps_React_default.a.createElement(Query,null,query)}]}if(!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(savedId)){items=[...items,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,SAVED_ID_LABEL," "),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,savedId," ")}]}return items};const ThreatEuiFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"ThreatEuiFlexGroup",componentId:"sc-123zi2b-3"})([".euiFlexItem{margin-bottom:0px;}"]);const SubtechniqueFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"SubtechniqueFlexItem",componentId:"sc-123zi2b-4"})(["margin-left:",";"],({theme:theme})=>theme.eui.paddingSizes.m);const TechniqueLinkItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"]).withConfig({displayName:"TechniqueLinkItem",componentId:"sc-123zi2b-5"})([".euiIcon{width:8px;height:8px;}align-self:flex-start;"]);const buildThreatDescription=({label:label,threat:threat})=>{if(threat.length>0){return[{title:label,description:external_kbnSharedDeps_React_default.a.createElement(ThreatEuiFlexGroup,{direction:"column"},threat.map((singleThreat,index)=>{const tactic=tacticsOptions.find(t=>t.id===singleThreat.tactic.id);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:`${singleThreat.tactic.name}-${index}`},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{"data-test-subj":"threatTacticLink",href:singleThreat.tactic.reference,target:"_blank"},tactic!=null?tactic.text:`${singleThreat.tactic.name} (${singleThreat.tactic.id})`),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",alignItems:"flexStart",direction:"column"},singleThreat.technique&&singleThreat.technique.map((technique,techniqueIndex)=>{var _myTechnique$id;const myTechnique=techniquesOptions.find(t=>t.id===technique.id);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:(_myTechnique$id=myTechnique===null||myTechnique===void 0?void 0:myTechnique.id)!==null&&_myTechnique$id!==void 0?_myTechnique$id:techniqueIndex},external_kbnSharedDeps_React_default.a.createElement(TechniqueLinkItem,{"data-test-subj":"threatTechniqueLink",href:technique.reference,target:"_blank",iconType:list_tree_icon_default.a,size:"xs"},myTechnique!=null?myTechnique.label:`${technique.name} (${technique.id})`),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",alignItems:"flexStart",direction:"column"},technique.subtechnique!=null&&technique.subtechnique.map((subtechnique,subtechniqueIndex)=>{var _mySubtechnique$id;const mySubtechnique=subtechniquesOptions.find(t=>t.id===subtechnique.id);return external_kbnSharedDeps_React_default.a.createElement(SubtechniqueFlexItem,{key:(_mySubtechnique$id=mySubtechnique===null||mySubtechnique===void 0?void 0:mySubtechnique.id)!==null&&_mySubtechnique$id!==void 0?_mySubtechnique$id:subtechniqueIndex},external_kbnSharedDeps_React_default.a.createElement(TechniqueLinkItem,{"data-test-subj":"threatSubtechniqueLink",href:subtechnique.reference,target:"_blank",iconType:list_tree_icon_default.a,size:"xs"},mySubtechnique!=null?mySubtechnique.label:`${subtechnique.name} (${subtechnique.id})`))})))})))}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null))}]}return[]};const buildUnorderedListArrayDescription=(label,field,values)=>{if(isNotEmptyArray(values)){return[{title:label,description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("ul",null,values.map(val=>Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(val)?null:external_kbnSharedDeps_React_default.a.createElement("li",{"data-test-subj":"unorderedListArrayDescriptionItem",key:`${field}-${val}`},val))))}]}return[]};const buildStringArrayDescription=(label,field,values)=>{if(isNotEmptyArray(values)){return[{title:label,description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"xs",wrap:true},values.map(val=>Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(val)?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,key:`${field}-${val}`},external_kbnSharedDeps_React_default.a.createElement(EuiBadgeWrap,{"data-test-subj":"stringArrayDescriptionBadgeItem",color:"hollow"},val))))}]}return[]};const OverrideColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"OverrideColumn",componentId:"sc-123zi2b-6"})(["width:125px;max-width:125px;overflow:hidden;text-overflow:ellipsis;"]);const buildSeverityDescription=severity=>[{title:DEFAULT_SEVERITY,description:external_kbnSharedDeps_React_default.a.createElement(SeverityBadge,{value:severity.value})},...severity.isMappingChecked?severity.mapping.filter(severityItem=>severityItem.field!=="").map((severityItem,index)=>({title:index===0?SEVERITY_MAPPING:"",description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(OverrideColumn,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:severityItem.field,"data-test-subj":`severityOverrideField${index}`},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,`${severityItem.field}:`))),external_kbnSharedDeps_React_default.a.createElement(OverrideColumn,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:severityItem.value,"data-test-subj":`severityOverrideValue${index}`},Object(empty_value["a"])(severityItem.value))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"sortRight"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(SeverityBadge,{"data-test-subj":`severityOverrideSeverity${index}`,value:severityItem.severity})))})):[]];const buildRiskScoreDescription=riskScore=>[{title:RISK_SCORE,description:riskScore.value},...riskScore.isMappingChecked?riskScore.mapping.filter(riskScoreItem=>riskScoreItem.field!=="").map((riskScoreItem,index)=>({title:index===0?RISK_SCORE_MAPPING:"",description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(OverrideColumn,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:riskScoreItem.field,"data-test-subj":`riskScoreOverrideField${index}`},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,riskScoreItem.field))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"sortRight"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,"signal.rule.risk_score"))})):[]];const MyRefUrlLink=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiLink"]).withConfig({displayName:"MyRefUrlLink",componentId:"sc-123zi2b-7"})(["word-break:break-word;"]);const buildUrlsDescription=(label,values)=>{if(isNotEmptyArray(values)){return[{title:label,description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("ul",null,values.filter(v=>!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(v)).map((val,index)=>external_kbnSharedDeps_React_default.a.createElement("li",{"data-test-subj":"urlsDescriptionReferenceLinkItem",key:`${index}-${val}`},external_kbnSharedDeps_React_default.a.createElement(MyRefUrlLink,{href:val,external:true,target:"_blank"},val)))))}]}return[]};const buildNoteDescription=(label,note)=>{if(note.trim()!==""){return[{title:label,description:external_kbnSharedDeps_React_default.a.createElement(NoteDescriptionContainer,null,external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"noteDescriptionItem",className:"eui-yScrollWithShadows"},note))}]}return[]};const buildRuleTypeDescription=(label,ruleType)=>{switch(ruleType){case"machine_learning":{return[{title:label,description:ML_TYPE_DESCRIPTION}]}case"query":case"saved_query":{return[{title:label,description:QUERY_TYPE_DESCRIPTION}]}case"threshold":{return[{title:label,description:THRESHOLD_TYPE_DESCRIPTION}]}case"eql":{return[{title:label,description:EQL_TYPE_DESCRIPTION}]}case"threat_match":{return[{title:label,description:THREAT_MATCH_TYPE_DESCRIPTION}]}default:return Object(utility_types["a"])(ruleType)}};const buildThresholdDescription=(label,threshold)=>[{title:label,description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(threshold.field[0])?`${THRESHOLD_RESULTS_ALL} >= ${threshold.value}`:`${THRESHOLD_RESULTS_AGGREGATED_BY} ${Array.isArray(threshold.field)?threshold.field.join(","):threshold.field} >= ${threshold.value}`)}];const buildThreatMappingDescription=(title,threatMapping)=>{const description=threatMapping.reduce((accumThreatMaps,threatMap,threatMapIndex,{length:threatMappingLength})=>{const matches=threatMap.entries.reduce((accumItems,item,itemsIndex,{length:threatMapLength})=>{if(threatMapLength===1){return`${item.field} ${MATCHES} ${item.value}`}else if(itemsIndex===0){return`(${item.field} ${MATCHES} ${item.value})`}else{return`${accumItems} ${AND} (${item.field} ${MATCHES} ${item.value})`}},"");if(threatMappingLength===1){return`${matches}`}else if(threatMapIndex===0){return`(${matches})`}else{return`${accumThreatMaps} ${OR} (${matches})`}},"");return[{title:title,description:description}]};var ml_public_=__webpack_require__(90);var use_security_jobs=__webpack_require__(514);var MessageLevels;(function(MessageLevels){MessageLevels["info"]="info";MessageLevels["warning"]="warning";MessageLevels["error"]="error"})(MessageLevels||(MessageLevels={}));const AuditIconComponent=({message:message})=>{if(!message){return null}let color="primary";let icon="alert";if(message.level===MessageLevels.info){icon="iInCircle"}else if(message.level===MessageLevels.warning){color="warning"}else if(message.level===MessageLevels.error){color="danger"}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:message.text},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:icon,color:color}))};const AuditIcon=external_kbnSharedDeps_React_default.a.memo(AuditIconComponent);const JobStatusBadgeComponent=({job:job})=>{const isStarted=Object(helpers["c"])(job.jobState,job.datafeedState);const color=isStarted?"secondary":"danger";const text=isStarted?ML_JOB_STARTED:ML_JOB_STOPPED;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{"data-test-subj":"machineLearningJobStatus",color:color},text)};const JobStatusBadge=external_kbnSharedDeps_React_default.a.memo(JobStatusBadgeComponent);const JobLink=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiLink"]).withConfig({displayName:"JobLink",componentId:"c3w1h4-0"})(["margin-right:",";"],({theme:theme})=>theme.eui.euiSizeS);const Wrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Wrapper",componentId:"c3w1h4-1"})(["overflow:hidden;"]);const MlJobDescriptionComponent=({jobId:jobId})=>{const{jobs:jobs}=Object(use_security_jobs["a"])(false);const{services:{http:http,ml:ml}}=Object(lib_kibana["h"])();const jobUrl=Object(ml_public_["useMlHref"])(ml,http.basePath.get(),{page:ml_public_["ML_PAGES"].ANOMALY_DETECTION_JOBS_MANAGE,pageState:{jobId:[jobId]}});const job=jobs.find(({id:id})=>id===jobId);const jobIdSpan=external_kbnSharedDeps_React_default.a.createElement("span",{"data-test-subj":"machineLearningJobId"},jobId);return job!=null?external_kbnSharedDeps_React_default.a.createElement(Wrapper,null,external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(JobLink,{href:jobUrl,target:"_blank"},jobIdSpan),external_kbnSharedDeps_React_default.a.createElement(AuditIcon,{message:job.auditMessage})),external_kbnSharedDeps_React_default.a.createElement(JobStatusBadge,{job:job})):jobIdSpan};const MlJobDescription=external_kbnSharedDeps_React_default.a.memo(MlJobDescriptionComponent);const buildMlJobDescription=(jobId,label)=>({title:label,description:external_kbnSharedDeps_React_default.a.createElement(MlJobDescription,{jobId:jobId})});const ActionsDescription=({actions:actions})=>{if(!actions.length)return null;return external_kbnSharedDeps_React_default.a.createElement("ul",null,actions.map((action,index)=>external_kbnSharedDeps_React_default.a.createElement("li",{key:index},getActionTypeName(action.actionTypeId))))};const buildActionsDescription=(actions,title)=>({title:actions.length?title:"",description:external_kbnSharedDeps_React_default.a.createElement(ActionsDescription,{actions:actions})});const getActionTypeName=actionTypeId=>{if(!actionTypeId)return"";const actionType=actionTypeId.split(".")[1];if(!actionType)return"";return Object(external_kbnSharedDeps_LodashFp_["startCase"])(actionType)};function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}const THROTTLE_OPTIONS=[{value:constants["X"],text:"Perform no actions"},{value:constants["Y"],text:"On each rule execution"},{value:"1h",text:"Hourly"},{value:"1d",text:"Daily"},{value:"7d",text:"Weekly"}];const DEFAULT_THROTTLE_OPTION=THROTTLE_OPTIONS[0];const ThrottleSelectField=props=>{const{setValue:setValue}=props.field;const onChange=Object(external_kbnSharedDeps_React_["useCallback"])(e=>{const throttle=e.target.value;setValue(throttle)},[setValue]);const newEuiFieldProps={...props.euiFieldProps,onChange:onChange};return external_kbnSharedDeps_React_default.a.createElement(shared_imports["i"],_extends({},props,{euiFieldProps:newEuiFieldProps}))};const buildThrottleDescription=(value=DEFAULT_THROTTLE_OPTION.value,title)=>{const throttleOption=Object(external_kbnSharedDeps_LodashFp_["find"])(["value",value],THROTTLE_OPTIONS);return{title:title,description:throttleOption?throttleOption.text:value}};const DescriptionListContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiDescriptionList"]).withConfig({displayName:"DescriptionListContainer",componentId:"sc-1jqwta0-0"})(["&.euiDescriptionList--column .euiDescriptionList__title{width:30%;}&.euiDescriptionList--column .euiDescriptionList__description{width:70%;overflow-wrap:anywhere;}"]);const StepRuleDescriptionComponent=({data:data,columns:columns="multi",indexPatterns:indexPatterns,schema:schema})=>{const kibana=Object(lib_kibana["h"])();const[filterManager]=Object(external_kbnSharedDeps_React_["useState"])(new public_["FilterManager"](kibana.services.uiSettings));const keys=Object.keys(schema);const listItems=keys.reduce((acc,key)=>{if(key==="machineLearningJobId"){return[...acc,buildMlJobDescription(Object(external_kbnSharedDeps_LodashFp_["get"])(key,data),Object(external_kbnSharedDeps_LodashFp_["get"])(key,schema).label)]}if(key==="throttle"){return[...acc,buildThrottleDescription(Object(external_kbnSharedDeps_LodashFp_["get"])(key,data),Object(external_kbnSharedDeps_LodashFp_["get"])([key,"label"],schema))]}if(key==="actions"){return[...acc,buildActionsDescription(Object(external_kbnSharedDeps_LodashFp_["get"])(key,data),Object(external_kbnSharedDeps_LodashFp_["get"])([key,"label"],schema))]}return[...acc,...buildListItems(data,Object(external_kbnSharedDeps_LodashFp_["pick"])(key,schema),filterManager,indexPatterns)]},[]);if(columns==="multi"){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,Object(external_kbnSharedDeps_LodashFp_["chunk"])(Math.ceil(listItems.length/2),listItems).map((chunkListItems,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"listItemColumnStepRuleDescription",key:`description-step-rule-${index}`},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionList"],{listItems:chunkListItems}))))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"listItemColumnStepRuleDescription"},columns==="single"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionList"],{listItems:listItems}):external_kbnSharedDeps_React_default.a.createElement(DescriptionListContainer,{"data-test-subj":"singleSplitStepRuleDescriptionList",type:"column",listItems:listItems})))};const StepRuleDescription=Object(external_kbnSharedDeps_React_["memo"])(StepRuleDescriptionComponent);const buildListItems=(data,schema,filterManager,indexPatterns)=>Object.keys(schema).reduce((acc,field)=>[...acc,...getDescriptionItem(field,Object(external_kbnSharedDeps_LodashFp_["get"])([field,"label"],schema),data,filterManager,indexPatterns)],[]);const addFilterStateIfNotThere=filters=>filters.map(filter=>{if(filter.$state==null){return{$state:{store:public_["esFilters"].FilterStateStore.APP_STATE},...filter}}else{return filter}});const getDescriptionItem=(field,label,data,filterManager,indexPatterns)=>{if(field==="queryBar"){var _get;const filters=addFilterStateIfNotThere((_get=Object(external_kbnSharedDeps_LodashFp_["get"])("queryBar.filters",data))!==null&&_get!==void 0?_get:[]);const query=Object(external_kbnSharedDeps_LodashFp_["get"])("queryBar.query.query",data);const savedId=Object(external_kbnSharedDeps_LodashFp_["get"])("queryBar.saved_id",data);return buildQueryBarDescription({field:field,filters:filters,filterManager:filterManager,query:query,savedId:savedId,indexPatterns:indexPatterns})}else if(field==="threat"){const threats=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);return buildThreatDescription({label:label,threat:filterEmptyThreats(threats)})}else if(field==="threshold"){const threshold=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);return buildThresholdDescription(label,threshold)}else if(field==="references"){const urls=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);return buildUrlsDescription(label,urls)}else if(field==="falsePositives"){const values=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);return buildUnorderedListArrayDescription(label,field,values)}else if(Array.isArray(Object(external_kbnSharedDeps_LodashFp_["get"])(field,data))&&field!=="threatMapping"){const values=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);return buildStringArrayDescription(label,field,values)}else if(field==="riskScore"){const values=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);return buildRiskScoreDescription(values)}else if(field==="severity"){const values=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);return buildSeverityDescription(values)}else if(field==="timeline"){var _timeline$title;const timeline=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);return[{title:label,description:(_timeline$title=timeline.title)!==null&&_timeline$title!==void 0?_timeline$title:timeline_translations["b"]}]}else if(field==="note"){const val=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);return buildNoteDescription(label,val)}else if(field==="ruleType"){const ruleType=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);return buildRuleTypeDescription(label,ruleType)}else if(field==="kibanaSiemAppUrl"){return[]}else if(field==="threatQueryBar"){var _get2;const filters=addFilterStateIfNotThere((_get2=Object(external_kbnSharedDeps_LodashFp_["get"])("threatQueryBar.filters",data))!==null&&_get2!==void 0?_get2:[]);const query=Object(external_kbnSharedDeps_LodashFp_["get"])("threatQueryBar.query.query",data);const savedId=Object(external_kbnSharedDeps_LodashFp_["get"])("threatQueryBar.saved_id",data);return buildQueryBarDescription({field:field,filters:filters,filterManager:filterManager,query:query,savedId:savedId,indexPatterns:indexPatterns,queryLabel:THREAT_QUERY_LABEL})}else if(field==="threatMapping"){const threatMap=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);return buildThreatMappingDescription(label,threatMap)}const description=Object(external_kbnSharedDeps_LodashFp_["get"])(field,data);if(Object(external_kbnSharedDeps_LodashFp_["isNumber"])(description)||!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(description)){return[{title:label,description:description}]}return[]};var external_kbnSharedDeps_Rxjs_=__webpack_require__(15);var fast_deep_equal=__webpack_require__(107);var fast_deep_equal_default=__webpack_require__.n(fast_deep_equal);var open_timeline_modal=__webpack_require__(704);var query_bar=__webpack_require__(394);var timeline_helpers=__webpack_require__(119);var timeline_query_bar=__webpack_require__(495);var keury=__webpack_require__(158);var saved_query_services=__webpack_require__(395);const IMPORT_TIMELINE_MODAL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.importTimelineModalTitle",{defaultMessage:"Import query from saved timeline"});const StyledEuiFormRow=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFormRow"]).withConfig({displayName:"StyledEuiFormRow",componentId:"sc-8c6vgp-0"})([".kbnTypeahead__items{max-height:45vh !important;}.globalQueryBar{padding:4px 0px 0px 0px;.kbnQueryBar{& > div:first-child{margin:0px 0px 0px 4px;}}}"]);const QueryBarDefineRule=({browserFields:browserFields,dataTestSubj:dataTestSubj,field:field,idAria:idAria,indexPattern:indexPattern,isLoading:isLoading=false,onCloseTimelineSearch:onCloseTimelineSearch,openTimelineSearch:openTimelineSearch=false,resizeParentContainer:resizeParentContainer,onValidityChange:onValidityChange})=>{const{value:fieldValue,setValue:setFieldValue}=field;const[originalHeight,setOriginalHeight]=Object(external_kbnSharedDeps_React_["useState"])(-1);const[loadingTimeline,setLoadingTimeline]=Object(external_kbnSharedDeps_React_["useState"])(false);const[savedQuery,setSavedQuery]=Object(external_kbnSharedDeps_React_["useState"])(undefined);const{isInvalid:isInvalid,errorMessage:errorMessage}=Object(shared_imports["w"])(field);const{uiSettings:uiSettings}=Object(lib_kibana["h"])().services;const[filterManager]=Object(external_kbnSharedDeps_React_["useState"])(new public_["FilterManager"](uiSettings));const savedQueryServices=Object(saved_query_services["a"])();Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(onValidityChange!=null){onValidityChange(!isInvalid)}},[isInvalid,onValidityChange]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;const subscriptions=new external_kbnSharedDeps_Rxjs_["Subscription"];filterManager.setFilters([]);subscriptions.add(filterManager.getUpdates$().subscribe({next:()=>{if(isSubscribed){const newFilters=filterManager.getFilters();const{filters:filters}=fieldValue;if(!fast_deep_equal_default()(filters,newFilters)){setFieldValue({...fieldValue,filters:newFilters})}}}}));return()=>{isSubscribed=false;subscriptions.unsubscribe()}},[fieldValue,filterManager,setFieldValue]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;async function updateFilterQueryFromValue(){const{filters:filters,saved_id:savedId}=fieldValue;if(!fast_deep_equal_default()(filters,filterManager.getFilters())){filterManager.setFilters(filters)}if(savedId!=null&&savedQuery!=null&&savedId!==savedQuery.id||savedId!=null&&savedQuery==null){try{const mySavedQuery=await savedQueryServices.getSavedQuery(savedId);if(isSubscribed&&mySavedQuery!=null){setSavedQuery(mySavedQuery)}}catch{setSavedQuery(undefined)}}else if(savedId==null&&savedQuery!=null){setSavedQuery(undefined)}}updateFilterQueryFromValue();return()=>{isSubscribed=false}},[fieldValue,filterManager,savedQuery,savedQueryServices]);const onSubmitQuery=Object(external_kbnSharedDeps_React_["useCallback"])(newQuery=>{const{query:query}=fieldValue;if(!fast_deep_equal_default()(query,newQuery)){setFieldValue({...fieldValue,query:newQuery})}},[fieldValue,setFieldValue]);const onChangedQuery=Object(external_kbnSharedDeps_React_["useCallback"])(newQuery=>{const{query:query}=fieldValue;if(!fast_deep_equal_default()(query,newQuery)){setFieldValue({...fieldValue,query:newQuery})}},[fieldValue,setFieldValue]);const onSavedQuery=Object(external_kbnSharedDeps_React_["useCallback"])(newSavedQuery=>{if(newSavedQuery!=null){const{saved_id:savedId}=fieldValue;if(newSavedQuery.id!==savedId){var _newSavedQuery$attrib;setSavedQuery(newSavedQuery);setFieldValue({filters:(_newSavedQuery$attrib=newSavedQuery.attributes.filters)!==null&&_newSavedQuery$attrib!==void 0?_newSavedQuery$attrib:[],query:newSavedQuery.attributes.query,saved_id:newSavedQuery.id})}else{setSavedQuery(newSavedQuery);setFieldValue({filters:[],query:{query:"",language:"kuery"},saved_id:undefined})}}},[fieldValue,setFieldValue]);const onCloseTimelineModal=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setLoadingTimeline(true);onCloseTimelineSearch()},[onCloseTimelineSearch]);const onOpenTimeline=Object(external_kbnSharedDeps_React_["useCallback"])(timeline=>{var _timeline$kqlQuery$fi,_timeline$kqlQuery$fi2,_timeline$kqlQuery$fi3,_timeline$kqlQuery$fi4,_timeline$kqlQuery$fi5,_timeline$kqlQuery$fi6,_timeline$filters;setLoadingTimeline(false);const newQuery={query:(_timeline$kqlQuery$fi=(_timeline$kqlQuery$fi2=timeline.kqlQuery.filterQuery)===null||_timeline$kqlQuery$fi2===void 0?void 0:(_timeline$kqlQuery$fi3=_timeline$kqlQuery$fi2.kuery)===null||_timeline$kqlQuery$fi3===void 0?void 0:_timeline$kqlQuery$fi3.expression)!==null&&_timeline$kqlQuery$fi!==void 0?_timeline$kqlQuery$fi:"",language:(_timeline$kqlQuery$fi4=(_timeline$kqlQuery$fi5=timeline.kqlQuery.filterQuery)===null||_timeline$kqlQuery$fi5===void 0?void 0:(_timeline$kqlQuery$fi6=_timeline$kqlQuery$fi5.kuery)===null||_timeline$kqlQuery$fi6===void 0?void 0:_timeline$kqlQuery$fi6.kind)!==null&&_timeline$kqlQuery$fi4!==void 0?_timeline$kqlQuery$fi4:"kuery"};const dataProvidersDsl=timeline.dataProviders!=null&&timeline.dataProviders.length>0?Object(keury["a"])(Object(timeline_helpers["i"])(timeline.dataProviders,browserFields),indexPattern):"";const newFilters=(_timeline$filters=timeline.filters)!==null&&_timeline$filters!==void 0?_timeline$filters:[];setFieldValue({filters:dataProvidersDsl!==""?[...newFilters,Object(timeline_query_bar["b"])(dataProvidersDsl)]:newFilters,query:newQuery,saved_id:undefined})},[browserFields,indexPattern,setFieldValue]);const onMutation=()=>{if(resizeParentContainer!=null){const suggestionContainer=document.getElementById("kbnTypeahead__items");if(suggestionContainer!=null){const box=suggestionContainer.getBoundingClientRect();const accordionContainer=document.getElementById("define-rule");if(accordionContainer!=null){const accordionBox=accordionContainer.getBoundingClientRect();if(originalHeight===-1||accordionBox.height<originalHeight+box.height){resizeParentContainer(originalHeight+box.height-100)}if(originalHeight===-1){setOriginalHeight(accordionBox.height)}}}else{resizeParentContainer(-1)}}};const actionTimelineToHide=Object(external_kbnSharedDeps_React_["useMemo"])(()=>["duplicate"],[]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(StyledEuiFormRow,{label:field.label,labelAppend:field.labelAppend,helpText:field.helpText,error:errorMessage,isInvalid:isInvalid,fullWidth:true,"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiMutationObserver"],{observerOptions:{subtree:true,attributes:true,childList:true},onMutation:onMutation},mutationRef=>external_kbnSharedDeps_React_default.a.createElement("div",{ref:mutationRef},external_kbnSharedDeps_React_default.a.createElement(query_bar["a"],{indexPattern:indexPattern,isLoading:isLoading||loadingTimeline,isRefreshPaused:false,filterQuery:fieldValue.query,filterManager:filterManager,filters:filterManager.getFilters()||[],onChangedQuery:onChangedQuery,onSubmitQuery:onSubmitQuery,savedQuery:savedQuery,onSavedQuery:onSavedQuery,hideSavedQuery:false})))),openTimelineSearch?external_kbnSharedDeps_React_default.a.createElement(open_timeline_modal["a"],{hideActions:actionTimelineToHide,modalTitle:IMPORT_TIMELINE_MODAL,onClose:onCloseTimelineModal,onOpen:onOpenTimeline}):null)};const EQL_TYPE_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.eqlTypeTitle",{defaultMessage:"Event Correlation"});const translations_EQL_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.eqlTypeDescription",{defaultMessage:"Use Event Query Language (EQL) to match events, generate sequences, and stack data"});const QUERY_TYPE_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.queryTypeTitle",{defaultMessage:"Custom query"});const translations_QUERY_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.queryTypeDescription",{defaultMessage:"Use KQL or Lucene to detect issues across indices."});const ML_TYPE_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeTitle",{defaultMessage:"Machine Learning"});const translations_ML_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeDescription",{defaultMessage:"Select ML job to detect anomalous activity."});const THRESHOLD_TYPE_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.thresholdTypeTitle",{defaultMessage:"Threshold"});const translations_THRESHOLD_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.thresholdTypeDescription",{defaultMessage:"Aggregate query results to detect when number of matches exceeds threshold."});const THREAT_MATCH_TYPE_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.threatMatchTitle",{defaultMessage:"Indicator Match"});const translations_THREAT_MATCH_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.threatMatchDescription",{defaultMessage:"Use indicators from intelligence sources to detect matching events and alerts."});var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(74);const SmallText=external_kbnSharedDeps_StyledComponents_default.a.span.withConfig({displayName:"SmallText",componentId:"lss4m0-0"})(["font-size:",";"],({theme:theme})=>theme.eui.euiFontSizeS);const MlCardDescriptionComponent=({subscriptionUrl:subscriptionUrl,hasValidLicense:hasValidLicense=false})=>external_kbnSharedDeps_React_default.a.createElement(SmallText,null,hasValidLicense?translations_ML_TYPE_DESCRIPTION:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeDisabledDescription",defaultMessage:"Access to ML requires a {subscriptionsLink}.",values:{subscriptionsLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:subscriptionUrl,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.components.stepDefineRule.ruleTypeField.subscriptionsLink",defaultMessage:"Platinum subscription"}))}}));MlCardDescriptionComponent.displayName="MlCardDescriptionComponent";const MlCardDescription=external_kbnSharedDeps_React_default.a.memo(MlCardDescriptionComponent);MlCardDescription.displayName="MlCardDescription";const SelectRuleType=({describedByIds:describedByIds=[],field:field,isUpdateView:isUpdateView,hasValidLicense:hasValidLicense,isMlAdmin:isMlAdmin})=>{const ruleType=field.value;const setType=Object(external_kbnSharedDeps_React_["useCallback"])(type=>{field.setValue(type)},[field]);const setEql=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setType("eql"),[setType]);const setMl=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setType("machine_learning"),[setType]);const setQuery=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setType("query"),[setType]);const setThreshold=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setType("threshold"),[setType]);const setThreatMatch=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setType("threat_match"),[setType]);const licensingUrl=Object(lib_kibana["h"])().services.application.getUrlForApp("kibana",{path:"#/management/stack/license_management"});const eqlSelectableConfig=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({onClick:setEql,isSelected:Object(utils["d"])(ruleType)}),[ruleType,setEql]);const querySelectableConfig=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({onClick:setQuery,isSelected:Object(utils["e"])(ruleType)}),[ruleType,setQuery]);const mlSelectableConfig=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({isDisabled:!hasValidLicense||!isMlAdmin,onClick:setMl,isSelected:Object(helpers["d"])(ruleType)}),[ruleType,setMl,hasValidLicense,isMlAdmin]);const thresholdSelectableConfig=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({onClick:setThreshold,isSelected:Object(utils["g"])(ruleType)}),[ruleType,setThreshold]);const threatMatchSelectableConfig=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({onClick:setThreatMatch,isSelected:Object(utils["f"])(ruleType)}),[ruleType,setThreatMatch]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true,"data-test-subj":"selectRuleType",describedByIds:describedByIds,label:field.label},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGrid"],{columns:3},(!isUpdateView||querySelectableConfig.isSelected)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCard"],{"data-test-subj":"customRuleType",title:QUERY_TYPE_TITLE,titleSize:"xs",description:translations_QUERY_TYPE_DESCRIPTION,icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"xl",type:"search"}),selectable:querySelectableConfig,layout:"horizontal",textAlign:"left"})),(!isUpdateView||mlSelectableConfig.isSelected)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCard"],{"data-test-subj":"machineLearningRuleType",title:ML_TYPE_TITLE,titleSize:"xs",description:external_kbnSharedDeps_React_default.a.createElement(MlCardDescription,{subscriptionUrl:licensingUrl,hasValidLicense:hasValidLicense}),icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"l",type:"machineLearningApp"}),isDisabled:mlSelectableConfig.isDisabled&&!mlSelectableConfig.isSelected,selectable:mlSelectableConfig,layout:"horizontal",textAlign:"left"})),(!isUpdateView||thresholdSelectableConfig.isSelected)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCard"],{"data-test-subj":"thresholdRuleType",title:THRESHOLD_TYPE_TITLE,titleSize:"xs",description:translations_THRESHOLD_TYPE_DESCRIPTION,icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"l",type:"indexFlush"}),selectable:thresholdSelectableConfig,layout:"horizontal",textAlign:"left"})),(!isUpdateView||eqlSelectableConfig.isSelected)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCard"],{"data-test-subj":"eqlRuleType",title:EQL_TYPE_TITLE,titleSize:"xs",description:translations_EQL_TYPE_DESCRIPTION,icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"l",type:"eql"}),selectable:eqlSelectableConfig,layout:"horizontal",textAlign:"left"})),(!isUpdateView||threatMatchSelectableConfig.isSelected)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCard"],{"data-test-subj":"threatMatchRuleType",title:THREAT_MATCH_TYPE_TITLE,titleSize:"xs",description:translations_THREAT_MATCH_TYPE_DESCRIPTION,icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"l",type:"list"}),selectable:threatMatchSelectableConfig,layout:"horizontal",textAlign:"left"}))))};const AnomalyThresholdSlider=({describedByIds:describedByIds=[],field:field})=>{const threshold=field.value;const onThresholdChange=Object(external_kbnSharedDeps_React_["useCallback"])(event=>{const thresholdValue=Number(event.target.value);field.setValue(thresholdValue)},[field]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:field.label,"data-test-subj":"anomalyThresholdSlider",describedByIds:describedByIds},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiRange"],{value:threshold,onChange:onThresholdChange,fullWidth:true,showInput:true,showRange:true,showTicks:true,tickInterval:25}))))};const CUSTOM_QUERY_REQUIRED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldRequiredError",{defaultMessage:"A custom query is required."});const INVALID_CUSTOM_QUERY=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldInvalidError",{defaultMessage:"The KQL is invalid"});const CONFIG_INDICES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.indicesFromConfigDescription",{defaultMessage:"Use Elasticsearch indices from Security Solution advanced settings"});const CUSTOM_INDICES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.indicesCustomDescription",{defaultMessage:"Provide custom list of indices"});const INDEX_HELPER_TEXT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.indicesHelperDescription",{defaultMessage:"Enter the pattern of Elasticsearch indices where you would like this rule to run. By default, these will include index patterns defined in Security Solution advanced settings."});const RESET_DEFAULT_INDEX=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.resetDefaultIndicesButton",{defaultMessage:"Reset to default index patterns"});const IMPORT_TIMELINE_QUERY=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.importTimelineQueryButton",{defaultMessage:"Import query from saved timeline"});const ML_JOB_SELECT_PLACEHOLDER_TEXT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlJobSelectPlaceholderText",{defaultMessage:"Select a job"});const ENABLE_ML_JOB_WARNING=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlEnableJobWarningTitle",{defaultMessage:'This ML job is not currently running. Please set this job to run via "ML job settings" before activating this rule.'});const QUERY_BAR_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldQuerBarLabel",{defaultMessage:"Custom query"});const EQL_QUERY_BAR_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.EqlQueryBarLabel",{defaultMessage:"EQL query"});const THREAT_MATCH_INDEX_HELPER_TEXT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchingIcesHelperDescription",{defaultMessage:"Select threat indices"});const THREAT_MATCH_REQUIRED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredError",{defaultMessage:"At least one indicator match is required."});const THREAT_MATCH_EMPTIES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredEmptyError",{defaultMessage:"All matches require both a field and threat index field."});const HelpTextWarningContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"HelpTextWarningContainer",componentId:"sc-1kiq2lp-0"})(["margin-top:10px;"]);const MlJobSelectEuiFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"MlJobSelectEuiFlexGroup",componentId:"sc-1kiq2lp-1"})(["margin-bottom:5px;"]);const HelpText=({href:href,showEnableWarning:showEnableWarning=false})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningJobIdHelpText",defaultMessage:"We've provided a few common jobs to get you started. To add your own custom jobs, assign a group of “security” to those jobs in the {machineLearning} application to make them appear here.",values:{machineLearning:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:href,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.components.mlJobSelect.machineLearningLink",defaultMessage:"Machine Learning"}))}}),showEnableWarning&&external_kbnSharedDeps_React_default.a.createElement(HelpTextWarningContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"warning"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"alert"}),external_kbnSharedDeps_React_default.a.createElement("span",null,ENABLE_ML_JOB_WARNING))));const JobDisplay=({title:title,description:description})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("strong",null,title),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,description)));const MlJobSelect=({describedByIds:describedByIds=[],field:field})=>{const jobId=field.value;const{isInvalid:isInvalid,errorMessage:errorMessage}=Object(shared_imports["w"])(field);const{loading:loading,jobs:jobs}=Object(use_security_jobs["a"])(false);const mlUrl=Object(lib_kibana["h"])().services.application.getUrlForApp("ml");const handleJobChange=Object(external_kbnSharedDeps_React_["useCallback"])(machineLearningJobId=>{field.setValue(machineLearningJobId)},[field]);const placeholderOption={value:"placeholder",inputDisplay:ML_JOB_SELECT_PLACEHOLDER_TEXT,dropdownDisplay:ML_JOB_SELECT_PLACEHOLDER_TEXT,disabled:true};const jobOptions=jobs.map(job=>({value:job.id,inputDisplay:job.id,dropdownDisplay:external_kbnSharedDeps_React_default.a.createElement(JobDisplay,{title:job.id,description:job.description})}));const options=[placeholderOption,...jobOptions];const isJobRunning=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const job=jobs.find(({id:id})=>id===jobId);return job==null||Object(helpers["c"])(job.jobState,job.datafeedState)},[jobs,jobId]);return external_kbnSharedDeps_React_default.a.createElement(MlJobSelectEuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:field.label,helpText:external_kbnSharedDeps_React_default.a.createElement(HelpText,{href:mlUrl,showEnableWarning:!isJobRunning}),isInvalid:isInvalid,error:errorMessage,"data-test-subj":"mlJobSelect",describedByIds:describedByIds},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSuperSelect"],{hasDividers:true,isLoading:loading,onChange:handleJobChange,options:options,valueOfSelected:jobId||"placeholder"}))))))};var selectable_timeline=__webpack_require__(667);const StyledEuiFieldText=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFieldText"]).withConfig({displayName:"StyledEuiFieldText",componentId:"oqcycb-0"})(["padding-left:12px;padding-right:40px;&[readonly]{cursor:pointer;background-size:0 100%;background-repeat:no-repeat;&:focus{background-color:#fff;background-image:linear-gradient( to top,#006bb4,#006bb4 2px,transparent 2px,transparent 100% );background-size:100% 100%;}}& + .euiFormControlLayoutIcons{left:unset;right:12px;}"]);const getBasicSelectableOptions=timelineId=>[{description:timeline_translations["a"],favorite:[],label:timeline_translations["b"],id:undefined,title:timeline_translations["b"],checked:timelineId==="-1"?"on":undefined}];const SearchTimelineSuperSelectComponent=({isDisabled:isDisabled,hideUntitled:hideUntitled=false,timelineId:timelineId,timelineTitle:timelineTitle,timelineType:timelineType=types_timeline["i"].template,onTimelineChange:onTimelineChange})=>{const[isPopoverOpen,setIsPopoverOpen]=Object(external_kbnSharedDeps_React_["useState"])(false);const handleClosePopover=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setIsPopoverOpen(false)},[]);const handleOpenPopover=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setIsPopoverOpen(true)},[]);const superSelect=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(StyledEuiFieldText,{readOnly:true,disabled:isDisabled,onFocus:handleOpenPopover,value:timelineTitle!==null&&timelineTitle!==void 0?timelineTitle:timeline_translations["b"],icon:"arrowDown"}),[handleOpenPopover,isDisabled,timelineTitle]);const handleGetSelectableOptions=Object(external_kbnSharedDeps_React_["useCallback"])(({timelines:timelines,onlyFavorites:onlyFavorites,searchTimelineValue:searchTimelineValue})=>[...!onlyFavorites&&searchTimelineValue===""?getBasicSelectableOptions(timelineId==null?"-1":timelineId):[],...timelines.filter(t=>!hideUntitled||t.title!=="").map((t,index)=>({description:t.description,favorite:t.favorite,label:t.title,id:timelineType===types_timeline["i"].template?t.templateTimelineId:t.savedObjectId,key:`${t.title}-${index}`,title:t.title,checked:[t.savedObjectId,t.templateTimelineId].includes(timelineId)?"on":undefined}))],[hideUntitled,timelineId,timelineType]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiInputPopover"],{id:"searchTimelinePopover",input:superSelect,isOpen:isPopoverOpen,closePopover:handleClosePopover},external_kbnSharedDeps_React_default.a.createElement(selectable_timeline["a"],{hideUntitled:hideUntitled,getSelectableOptions:handleGetSelectableOptions,onClosePopover:handleClosePopover,onTimelineChange:onTimelineChange,timelineType:timelineType}))};const SearchTimelineSuperSelect=Object(external_kbnSharedDeps_React_["memo"])(SearchTimelineSuperSelectComponent);const PickTimeline=({dataTestSubj:dataTestSubj,field:field,idAria:idAria,isDisabled:isDisabled=false})=>{const[timelineId,setTimelineId]=Object(external_kbnSharedDeps_React_["useState"])(null);const[timelineTitle,setTimelineTitle]=Object(external_kbnSharedDeps_React_["useState"])(null);const{isInvalid:isInvalid,errorMessage:errorMessage}=Object(shared_imports["w"])(field);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const{id:id,title:title}=field.value;if(timelineTitle!==title&&timelineId!==id){setTimelineId(id);setTimelineTitle(title)}},[field.value]);const handleOnTimelineChange=Object(external_kbnSharedDeps_React_["useCallback"])((title,id)=>{if(id===null){field.setValue({id:id,title:null})}else if(timelineTitle!==title&&timelineId!==id){field.setValue({id:id,title:title})}},[field]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:field.label,labelAppend:field.labelAppend,helpText:field.helpText,error:errorMessage,isInvalid:isInvalid,"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:undefined},external_kbnSharedDeps_React_default.a.createElement(SearchTimelineSuperSelect,{isDisabled:isDisabled,hideUntitled:true,timelineId:timelineId,timelineTitle:timelineTitle,onTimelineChange:handleOnTimelineChange}))};const StyledDiv=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"StyledDiv",componentId:"sc-1adamx3-0"})(["padding-left:",";"],({addPadding:addPadding})=>addPadding&&"53px");StyledDiv.defaultProps={addPadding:false};const StepContentWrapper=external_kbnSharedDeps_React_default.a.memo(StyledDiv);StepContentWrapper.displayName="StepContentWrapper";var rules_translations=__webpack_require__(128);const NextStep=external_kbnSharedDeps_React_default.a.memo(({onClick:onClick,isDisabled:isDisabled,dataTestSubj:dataTestSubj="nextStep-continue"})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",justifyContent:"flexEnd",gutterSize:"xs",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:true,onClick:onClick,isDisabled:isDisabled,"data-test-subj":dataTestSubj},rules_translations["F"])))));NextStep.displayName="NextStep";var edit_data_provider_helpers=__webpack_require__(604);const THRESHOLD_FIELD_PLACEHOLDER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.thresholdField.thresholdFieldPlaceholderText",{defaultMessage:"All results"});const FIELD_COMBO_BOX_WIDTH=410;const OperatorWrapper=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"OperatorWrapper",componentId:"sc-10hzoxx-0"})(["align-self:center;"]);const fieldDescribedByIds=["detectionEngineStepDefineRuleThresholdField"];const valueDescribedByIds=["detectionEngineStepDefineRuleThresholdValue"];const cardinalityFieldDescribedByIds=["detectionEngineStepDefineRuleThresholdCardinalityField"];const cardinalityValueDescribedByIds=["detectionEngineStepDefineRuleThresholdCardinalityValue"];const ThresholdInputComponent=({thresholdField:thresholdField,thresholdValue:thresholdValue,browserFields:browserFields,thresholdCardinalityField:thresholdCardinalityField,thresholdCardinalityValue:thresholdCardinalityValue})=>{const fieldEuiFieldProps=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({fullWidth:true,noSuggestions:false,options:Object(edit_data_provider_helpers["a"])(browserFields),placeholder:THRESHOLD_FIELD_PLACEHOLDER,onCreateOption:undefined,style:{width:`${FIELD_COMBO_BOX_WIDTH}px`}}),[browserFields]);const cardinalityFieldEuiProps=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({fullWidth:true,noSuggestions:false,options:Object(edit_data_provider_helpers["a"])(browserFields),placeholder:THRESHOLD_FIELD_PLACEHOLDER,onCreateOption:undefined,style:{width:`${FIELD_COMBO_BOX_WIDTH}px`},singleSelection:{asPlainText:true}}),[browserFields]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",style:{marginLeft:0}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(shared_imports["d"],{field:thresholdField,idAria:fieldDescribedByIds[0],"data-test-subj":fieldDescribedByIds[0],describedByIds:fieldDescribedByIds,type:thresholdField.type,euiFieldProps:fieldEuiFieldProps})),external_kbnSharedDeps_React_default.a.createElement(OperatorWrapper,{grow:false},">="),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(shared_imports["d"],{field:thresholdValue,idAria:valueDescribedByIds[0],"data-test-subj":valueDescribedByIds[0],describedByIds:valueDescribedByIds,type:thresholdValue.type}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(shared_imports["d"],{field:thresholdCardinalityField,idAria:cardinalityFieldDescribedByIds[0],"data-test-subj":cardinalityFieldDescribedByIds[0],describedByIds:cardinalityFieldDescribedByIds,type:thresholdCardinalityField.type,euiFieldProps:cardinalityFieldEuiProps})),external_kbnSharedDeps_React_default.a.createElement(OperatorWrapper,{grow:false},">="),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(shared_imports["d"],{field:thresholdCardinalityValue,idAria:cardinalityValueDescribedByIds[0],"data-test-subj":cardinalityValueDescribedByIds[0],describedByIds:cardinalityValueDescribedByIds,type:thresholdCardinalityValue.type}))))};const ThresholdInput=external_kbnSharedDeps_React_default.a.memo(ThresholdInputComponent);var external_kbnSharedDeps_Lodash_=__webpack_require__(19);var uuid=__webpack_require__(20);var uuid_default=__webpack_require__.n(uuid);var add_remove_id_to_item=__webpack_require__(30);const getFormattedEntry=(indexPattern,threatIndexPatterns,item,itemIndex,uuidGen=uuid_default.a.v4)=>{var _maybeId$id;const{fields:fields}=indexPattern;const{fields:threatFields}=threatIndexPatterns;const field=item.field;const threatField=item.value;const[foundField]=fields.filter(({name:name})=>field!=null&&field===name);const[threatFoundField]=threatFields.filter(({name:name})=>threatField!=null&&threatField===name);const maybeId=item;return{id:(_maybeId$id=maybeId.id)!==null&&_maybeId$id!==void 0?_maybeId$id:uuidGen(),field:foundField,type:"mapping",value:threatFoundField,entryIndex:itemIndex}};const getFormattedEntries=(indexPattern,threatIndexPatterns,entries)=>entries.reduce((acc,item,index)=>{const newItemEntry=getFormattedEntry(indexPattern,threatIndexPatterns,item,index);return[...acc,newItemEntry]},[]);const getUpdatedEntriesOnDelete=(item,entryIndex)=>({...item,entries:[...item.entries.slice(0,entryIndex),...item.entries.slice(entryIndex+1)]});const getEntryOnFieldChange=(item,newField)=>{const{entryIndex:entryIndex}=item;return{updatedEntry:{id:item.id,field:newField!=null?newField.name:"",type:"mapping",value:item.value!=null?item.value.name:""},index:entryIndex}};const getEntryOnThreatFieldChange=(item,newField)=>{const{entryIndex:entryIndex}=item;return{updatedEntry:{id:item.id,field:item.field!=null?item.field.name:"",type:"mapping",value:newField!=null?newField.name:""},index:entryIndex}};const getDefaultEmptyEntry=()=>Object(add_remove_id_to_item["a"])({field:"",type:"mapping",value:""});const getNewItem=()=>Object(add_remove_id_to_item["a"])({entries:[Object(add_remove_id_to_item["a"])({field:"",type:"mapping",value:""})]});const filterItems=items=>items.reduce((acc,item)=>{const newItem={...item,entries:item.entries};if(types["c"].is(newItem)){return[...acc,newItem]}else{return acc}},[]);const containsInvalidItems=items=>items.some(item=>item.entries.some(subEntry=>subEntry.field===""||subEntry.value===""));const singleEntryThreat=items=>items.length===1&&items[0].entries.length===1&&items[0].entries[0].field===""&&items[0].entries[0].value==="";var validators=__webpack_require__(322);const schema_schema={index:{fieldsToValidateOnChange:["index","queryBar"],type:shared_imports["c"].COMBO_BOX,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fiedIndexPatternsLabel",{defaultMessage:"Index patterns"}),helpText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},INDEX_HELPER_TEXT),validations:[{validator:(...args)=>{const[{formData:formData}]=args;const needsValidation=!Object(helpers["d"])(formData.ruleType);if(!needsValidation){return}return shared_imports["v"].emptyField(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.outputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...args)}}]},queryBar:{validations:[{validator:(...args)=>{const[{value:value,path:path,formData:formData}]=args;const{query:query,filters:filters}=value;const needsValidation=!Object(helpers["d"])(formData.ruleType);if(!needsValidation){return}return Object(external_kbnSharedDeps_Lodash_["isEmpty"])(query.query)&&Object(external_kbnSharedDeps_Lodash_["isEmpty"])(filters)?{code:"ERR_FIELD_MISSING",path:path,message:CUSTOM_QUERY_REQUIRED}:undefined}},{validator:(...args)=>{const[{value:value,path:path,formData:formData}]=args;const{query:query}=value;const needsValidation=!Object(helpers["d"])(formData.ruleType);if(!needsValidation){return}if(!Object(external_kbnSharedDeps_Lodash_["isEmpty"])(query.query)&&query.language==="kuery"){try{public_["esKuery"].fromKueryExpression(query.query)}catch(err){return{code:"ERR_FIELD_FORMAT",path:path,message:INVALID_CUSTOM_QUERY}}}}},{validator:Object(validators["a"])(validators["b"],300)}]},ruleType:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldRuleTypeLabel",{defaultMessage:"Rule type"}),validations:[]},anomalyThreshold:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldAnomalyThresholdLabel",{defaultMessage:"Anomaly score threshold"}),validations:[]},machineLearningJobId:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldMachineLearningJobIdLabel",{defaultMessage:"Machine Learning job"}),validations:[{validator:(...args)=>{const[{formData:formData}]=args;const needsValidation=Object(helpers["d"])(formData.ruleType);if(!needsValidation){return}return shared_imports["v"].emptyField(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningJobIdRequired",{defaultMessage:"A Machine Learning job is required."}))(...args)}}]},timeline:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateLabel",{defaultMessage:"Timeline template"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateHelpText",{defaultMessage:"Select which timeline to use when investigating generated alerts."})},threshold:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdLabel",{defaultMessage:"Threshold"}),field:{type:shared_imports["c"].COMBO_BOX,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldLabel",{defaultMessage:"Group by"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldHelpText",{defaultMessage:"Select fields to group by. Fields are joined together with 'AND'"}),validations:[{validator:(...args)=>{const[{formData:formData}]=args;const needsValidation=Object(utils["g"])(formData.ruleType);if(!needsValidation){return}return shared_imports["v"].maxLengthField({length:3,message:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.validations.thresholdFieldFieldData.arrayLengthGreaterThanMaxErrorMessage",{defaultMessage:"Number of fields must be 3 or less."})})(...args)}}]},value:{type:shared_imports["c"].NUMBER,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdValueLabel",{defaultMessage:"Threshold"}),validations:[{validator:(...args)=>{const[{formData:formData}]=args;const needsValidation=Object(utils["g"])(formData.ruleType);if(!needsValidation){return}return shared_imports["v"].numberGreaterThanField({than:1,message:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.validations.thresholdValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal to one."}),allowEquality:true})(...args)}}]},cardinality:{field:{defaultValue:[],fieldsToValidateOnChange:["threshold.cardinality.field","threshold.cardinality.value"],type:shared_imports["c"].COMBO_BOX,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdCardinalityFieldLabel",{defaultMessage:"Count"}),validations:[{validator:(...args)=>{const[{formData:formData}]=args;const needsValidation=Object(utils["g"])(formData.ruleType);if(!needsValidation){return}if(Object(external_kbnSharedDeps_Lodash_["isEmpty"])(formData["threshold.cardinality.field"])&&!Object(external_kbnSharedDeps_Lodash_["isEmpty"])(formData["threshold.cardinality.value"])){return shared_imports["v"].emptyField(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.validations.thresholdCardinalityFieldFieldData.thresholdCardinalityFieldNotSuppliedMessage",{defaultMessage:"A Cardinality Field is required."}))(...args)}}}],helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdFieldCardinalityFieldHelpText",{defaultMessage:"Select a field to check cardinality"})},value:{fieldsToValidateOnChange:["threshold.cardinality.field","threshold.cardinality.value"],type:shared_imports["c"].NUMBER,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdCardinalityValueFieldLabel",{defaultMessage:"Unique values"}),validations:[{validator:(...args)=>{const[{formData:formData}]=args;const needsValidation=Object(utils["g"])(formData.ruleType);if(!needsValidation){return}if(!Object(external_kbnSharedDeps_Lodash_["isEmpty"])(formData["threshold.cardinality.field"])){return shared_imports["v"].numberGreaterThanField({than:1,message:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.validations.thresholdCardinalityValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal to one."}),allowEquality:true})(...args)}}}]}}},threatIndex:{type:shared_imports["c"].COMBO_BOX,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatIndexPatternsLabel",{defaultMessage:"Indicator index patterns"}),helpText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},THREAT_MATCH_INDEX_HELPER_TEXT),validations:[{validator:(...args)=>{const[{formData:formData}]=args;const needsValidation=Object(utils["f"])(formData.ruleType);if(!needsValidation){return}return shared_imports["v"].emptyField(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchoutputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...args)}}]},threatMapping:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatMappingLabel",{defaultMessage:"Indicator mapping"}),validations:[{validator:(...args)=>{const[{path:path,formData:formData}]=args;const needsValidation=Object(utils["f"])(formData.ruleType);if(!needsValidation){return}if(singleEntryThreat(formData.threatMapping)){return{code:"ERR_FIELD_MISSING",path:path,message:THREAT_MATCH_REQUIRED}}else if(containsInvalidItems(formData.threatMapping)){return{code:"ERR_FIELD_MISSING",path:path,message:THREAT_MATCH_EMPTIES}}else{return undefined}}}]},threatQueryBar:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatQueryBarLabel",{defaultMessage:"Indicator index query"}),validations:[{validator:(...args)=>{const[{value:value,path:path,formData:formData}]=args;const needsValidation=Object(utils["f"])(formData.ruleType);if(!needsValidation){return}const{query:query,filters:filters}=value;return Object(external_kbnSharedDeps_Lodash_["isEmpty"])(query.query)&&Object(external_kbnSharedDeps_Lodash_["isEmpty"])(filters)?{code:"ERR_FIELD_MISSING",path:path,message:CUSTOM_QUERY_REQUIRED}:undefined}},{validator:(...args)=>{const[{value:value,path:path,formData:formData}]=args;const needsValidation=Object(utils["f"])(formData.ruleType);if(!needsValidation){return}const{query:query}=value;if(!Object(external_kbnSharedDeps_Lodash_["isEmpty"])(query.query)&&query.language==="kuery"){try{public_["esKuery"].fromKueryExpression(query.query)}catch(err){return{code:"ERR_FIELD_FORMAT",path:path,message:INVALID_CUSTOM_QUERY}}}}}]}};var eql_query_bar=__webpack_require__(507);var autocomplete_field=__webpack_require__(303);const FlexItemWithLabel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"FlexItemWithLabel",componentId:"sc-1i1appc-0"})(["padding-top:20px;text-align:center;"]);const FlexItemWithoutLabel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"FlexItemWithoutLabel",componentId:"sc-1i1appc-1"})(["text-align:center;"]);const EntryItem=({entry:entry,indexPattern:indexPattern,threatIndexPatterns:threatIndexPatterns,showLabel:showLabel,onChange:onChange})=>{const handleFieldChange=Object(external_kbnSharedDeps_React_["useCallback"])(([newField])=>{const{updatedEntry:updatedEntry,index:index}=getEntryOnFieldChange(entry,newField);onChange(updatedEntry,index)},[onChange,entry]);const handleThreatFieldChange=Object(external_kbnSharedDeps_React_["useCallback"])(([newField])=>{const{updatedEntry:updatedEntry,index:index}=getEntryOnThreatFieldChange(entry,newField);onChange(updatedEntry,index)},[onChange,entry]);const renderFieldInput=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const comboBox=external_kbnSharedDeps_React_default.a.createElement(autocomplete_field["a"],{placeholder:FIELD_PLACEHOLDER,indexPattern:indexPattern,selectedField:entry.field,isClearable:false,isLoading:false,isDisabled:indexPattern==null,onChange:handleFieldChange,"data-test-subj":"entryField",fieldInputWidth:360});if(showLabel){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:FIELD,"data-test-subj":"entryItemFieldInputFormRow"},comboBox)}else{return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:"","data-test-subj":"entryItemFieldInputFormRow"},comboBox)}},[handleFieldChange,indexPattern,entry,showLabel]);const renderThreatFieldInput=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const comboBox=external_kbnSharedDeps_React_default.a.createElement(autocomplete_field["a"],{placeholder:FIELD_PLACEHOLDER,indexPattern:threatIndexPatterns,selectedField:entry.value,isClearable:false,isLoading:false,isDisabled:threatIndexPatterns==null,onChange:handleThreatFieldChange,"data-test-subj":"threatEntryField",fieldInputWidth:360});if(showLabel){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:THREAT_FIELD,"data-test-subj":"threatFieldInputFormRow"},comboBox)}else{return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:"","data-test-subj":"threatFieldInputFormRow"},comboBox)}},[handleThreatFieldChange,threatIndexPatterns,entry,showLabel]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"row",gutterSize:"s",alignItems:"center",justifyContent:"spaceAround","data-test-subj":"itemEntryContainer"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},renderFieldInput),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceAround",alignItems:"center"},showLabel?external_kbnSharedDeps_React_default.a.createElement(FlexItemWithLabel,{grow:true},MATCHES):external_kbnSharedDeps_React_default.a.createElement(FlexItemWithoutLabel,{grow:true},MATCHES))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},renderThreatFieldInput))};EntryItem.displayName="EntryItem";const MyFirstRowContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyFirstRowContainer",componentId:"sc-136w498-0"})(["padding-top:20px;"]);const EntryDeleteButtonComponent=external_kbnSharedDeps_React_default.a.memo(({entries:entries,isOnlyItem:isOnlyItem,entryIndex:entryIndex,itemIndex:itemIndex,onDelete:onDelete})=>{const isDisabled=isOnlyItem&&entries.length===1&&itemIndex===0&&(entries[0].field==null||entries[0].field==="");const handleDelete=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{onDelete(entryIndex)},[onDelete,entryIndex]);const button=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{color:"danger",iconType:"trash",onClick:handleDelete,isDisabled:isDisabled,"aria-label":"entryDeleteButton",className:"itemEntryDeleteButton","data-test-subj":"itemEntryDeleteButton"});if(entryIndex===0&&itemIndex===0){return external_kbnSharedDeps_React_default.a.createElement(MyFirstRowContainer,{grow:false,"data-test-subj":"firstRowDeleteButton"},button)}else{return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,"data-test-subj":"deleteButton"},button)}});EntryDeleteButtonComponent.displayName="EntryDeleteButton";var and_or_badge=__webpack_require__(188);const MyInvisibleAndBadge=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyInvisibleAndBadge",componentId:"d6yaa8-0"})(["visibility:hidden;"]);const and_badge_MyFirstRowContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyFirstRowContainer",componentId:"d6yaa8-1"})(["padding-top:20px;"]);const AndBadgeComponent=external_kbnSharedDeps_React_default.a.memo(({entriesLength:entriesLength,entryItemIndex:entryItemIndex})=>{const badge=external_kbnSharedDeps_React_default.a.createElement(and_or_badge["a"],{includeAntennas:true,type:"and"});if(entriesLength>1&&entryItemIndex===0){return external_kbnSharedDeps_React_default.a.createElement(and_badge_MyFirstRowContainer,{grow:false,"data-test-subj":"entryItemEntryFirstRowAndBadge"},badge)}else if(entriesLength<=1){return external_kbnSharedDeps_React_default.a.createElement(MyInvisibleAndBadge,{grow:false,"data-test-subj":"entryItemEntryInvisibleAndBadge"},badge)}else{return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,"data-test-subj":"entryItemEntryAndBadge"},badge)}});AndBadgeComponent.displayName="AndBadge";const MyOverflowContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyOverflowContainer",componentId:"o1uavm-0"})(["overflow:hidden;width:100%;"]);const ListItemComponent=external_kbnSharedDeps_React_default.a.memo(({listItem:listItem,listItemIndex:listItemIndex,indexPattern:indexPattern,threatIndexPatterns:threatIndexPatterns,isOnlyItem:isOnlyItem,andLogicIncluded:andLogicIncluded,onDeleteEntryItem:onDeleteEntryItem,onChangeEntryItem:onChangeEntryItem})=>{const handleEntryChange=Object(external_kbnSharedDeps_React_["useCallback"])((entry,entryIndex)=>{const updatedEntries=[...listItem.entries.slice(0,entryIndex),{...entry},...listItem.entries.slice(entryIndex+1)];const updatedEntryItem={...listItem,entries:updatedEntries};onChangeEntryItem(updatedEntryItem,listItemIndex)},[onChangeEntryItem,listItem,listItemIndex]);const handleDeleteEntry=Object(external_kbnSharedDeps_React_["useCallback"])(entryIndex=>{const updatedEntryItem=getUpdatedEntriesOnDelete(listItem,entryIndex);onDeleteEntryItem(updatedEntryItem,listItemIndex)},[listItem,onDeleteEntryItem,listItemIndex]);const entries=Object(external_kbnSharedDeps_React_["useMemo"])(()=>indexPattern!=null&&listItem.entries.length>0?getFormattedEntries(indexPattern,threatIndexPatterns,listItem.entries):[],[listItem.entries,indexPattern,threatIndexPatterns]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s","data-test-subj":"entriesContainer"},andLogicIncluded&&external_kbnSharedDeps_React_default.a.createElement(AndBadgeComponent,{entriesLength:listItem.entries.length,entryItemIndex:listItemIndex}),external_kbnSharedDeps_React_default.a.createElement(MyOverflowContainer,{grow:6},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",direction:"column"},entries.map((item,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:item.id,grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"xs",alignItems:"center",direction:"row"},external_kbnSharedDeps_React_default.a.createElement(MyOverflowContainer,{grow:1},external_kbnSharedDeps_React_default.a.createElement(EntryItem,{entry:item,threatIndexPatterns:threatIndexPatterns,indexPattern:indexPattern,showLabel:listItemIndex===0&&index===0,onChange:handleEntryChange})),external_kbnSharedDeps_React_default.a.createElement(EntryDeleteButtonComponent,{entries:listItem.entries,isOnlyItem:isOnlyItem,entryIndex:item.entryIndex,itemIndex:listItemIndex,onDelete:handleDeleteEntry}))))))))});ListItemComponent.displayName="ListItem";const MyEuiButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiButton"]).withConfig({displayName:"MyEuiButton",componentId:"sc-1dsnlky-0"})(["min-width:95px;"]);const LogicButtons=({isOrDisabled:isOrDisabled=false,isAndDisabled:isAndDisabled=false,onAndClicked:onAndClicked,onOrClicked:onOrClicked})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(MyEuiButton,{fill:true,size:"s",iconType:"plusInCircle",onClick:onAndClicked,"data-test-subj":"andButton",isDisabled:isAndDisabled},AND)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(MyEuiButton,{fill:true,size:"s",iconType:"plusInCircle",onClick:onOrClicked,isDisabled:isOrDisabled,"data-test-subj":"orButton"},OR)));const reducer_reducer=()=>(state,action)=>{switch(action.type){case"setEntries":{const isAndLogicIncluded=action.entries.filter(({entries:entries})=>entries.length>1).length>0;const returnState={...state,andLogicIncluded:isAndLogicIncluded,entries:action.entries};return returnState}case"setDefault":{return{...state,...action.initialState,entries:[{...action.lastEntry,entries:[getDefaultEmptyEntry()]}]}}default:return state}};const threat_match_MyInvisibleAndBadge=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyInvisibleAndBadge",componentId:"ph2s87-0"})(["visibility:hidden;"]);const MyAndBadge=external_kbnSharedDeps_StyledComponents_default()(and_or_badge["a"]).withConfig({displayName:"MyAndBadge",componentId:"ph2s87-1"})(["& > .euiFlexItem{margin:0;}"]);const MyButtonsContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyButtonsContainer",componentId:"ph2s87-2"})(["margin:16px 0;"]);const threat_match_initialState={andLogicIncluded:false,entries:[],entriesToDelete:[]};const ThreatMatchComponent=({listItems:listItems,indexPatterns:indexPatterns,threatIndexPatterns:threatIndexPatterns,onChange:onChange})=>{const[{entries:entries,entriesToDelete:entriesToDelete,andLogicIncluded:andLogicIncluded},dispatch]=Object(external_kbnSharedDeps_React_["useReducer"])(reducer_reducer(),{...threat_match_initialState});const setUpdateEntries=Object(external_kbnSharedDeps_React_["useCallback"])(items=>{dispatch({type:"setEntries",entries:items})},[dispatch]);const setDefaultEntries=Object(external_kbnSharedDeps_React_["useCallback"])(item=>{dispatch({type:"setDefault",initialState:threat_match_initialState,lastEntry:item})},[dispatch]);const handleEntryItemChange=Object(external_kbnSharedDeps_React_["useCallback"])((item,index)=>{const updatedEntries=[...entries.slice(0,index),{...item},...entries.slice(index+1)];setUpdateEntries(updatedEntries)},[setUpdateEntries,entries]);const handleDeleteEntryItem=Object(external_kbnSharedDeps_React_["useCallback"])((item,itemIndex)=>{if(item.entries.length===0){const updatedEntries=[...entries.slice(0,itemIndex),...entries.slice(itemIndex+1)];if(updatedEntries.length===0){setDefaultEntries(item)}else{setUpdateEntries([...entries.slice(0,itemIndex),...entries.slice(itemIndex+1)])}}else{handleEntryItemChange(item,itemIndex)}},[handleEntryItemChange,setUpdateEntries,entries,setDefaultEntries]);const handleAddNewEntryItemEntry=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{const lastEntry=entries[entries.length-1];const{entries:innerEntries}=lastEntry;const updatedEntry={...lastEntry,entries:[...innerEntries,getDefaultEmptyEntry()]};setUpdateEntries([...entries.slice(0,entries.length-1),{...updatedEntry}])},[setUpdateEntries,entries]);const handleAddNewEntryItem=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{const newItem=getNewItem();setUpdateEntries([...entries,{...newItem}])},[setUpdateEntries,entries]);const handleAddClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{handleAddNewEntryItemEntry()},[handleAddNewEntryItemEntry]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{onChange({entryItems:filterItems(entries),entriesToDelete:entriesToDelete})},[onChange,entriesToDelete,entries]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(entries.length===0||entries.length===1&&entries[0].entries!=null&&entries[0].entries.length===0){handleAddNewEntryItem()}},[entries,handleAddNewEntryItem]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(listItems.length>0){setUpdateEntries(listItems)}},[]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",direction:"column"},entries.map((entryListItem,index)=>{var _id;const key=(_id=entryListItem.id)!==null&&_id!==void 0?_id:`${index}`;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1,key:key},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",direction:"column"},index!==0&&(andLogicIncluded?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",direction:"row"},external_kbnSharedDeps_React_default.a.createElement(threat_match_MyInvisibleAndBadge,{grow:false},external_kbnSharedDeps_React_default.a.createElement(MyAndBadge,{includeAntennas:true,type:"and"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(MyAndBadge,{type:"or"})))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(MyAndBadge,{type:"or"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(ListItemComponent,{key:key,listItem:entryListItem,indexPattern:indexPatterns,threatIndexPatterns:threatIndexPatterns,listItemIndex:index,andLogicIncluded:andLogicIncluded,isOnlyItem:entries.length===1,onDeleteEntryItem:handleDeleteEntryItem,onChangeEntryItem:handleEntryItemChange}))))}),external_kbnSharedDeps_React_default.a.createElement(MyButtonsContainer,{"data-test-subj":"andOrOperatorButtons"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},andLogicIncluded&&external_kbnSharedDeps_React_default.a.createElement(threat_match_MyInvisibleAndBadge,{grow:false},external_kbnSharedDeps_React_default.a.createElement(and_or_badge["a"],{includeAntennas:true,type:"and"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(LogicButtons,{isOrDisabled:false,isAndDisabled:false,onOrClicked:handleAddNewEntryItem,onAndClicked:handleAddClick})))))};ThreatMatchComponent.displayName="ThreatMatch";const CommonUseField=Object(shared_imports["x"])({component:shared_imports["d"]});const ThreatMatchInputComponent=({threatMapping:threatMapping,indexPatterns:indexPatterns,threatIndexPatterns:threatIndexPatterns,threatIndexPatternsLoading:threatIndexPatternsLoading,threatBrowserFields:threatBrowserFields})=>{const{setValue:setValue,value:threatItems}=threatMapping;const{isInvalid:isInvalid,errorMessage:errorMessage}=Object(shared_imports["w"])(threatMapping);const handleBuilderOnChange=Object(external_kbnSharedDeps_React_["useCallback"])(({entryItems:entryItems})=>{setValue(entryItems)},[setValue]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(CommonUseField,{path:"threatIndex",config:{...schema_schema.threatIndex,labelAppend:null},componentProps:{idAria:"detectionEngineStepDefineRuleThreatMatchIndices","data-test-subj":"detectionEngineStepDefineRuleThreatMatchIndices",euiFieldProps:{fullWidth:true,isDisabled:false,placeholder:""}}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"threatQueryBar",config:{...schema_schema.threatQueryBar,labelAppend:null},component:QueryBarDefineRule,componentProps:{browserFields:threatBrowserFields,idAria:"detectionEngineStepDefineThreatRuleQueryBar",indexPattern:threatIndexPatterns,isDisabled:false,isLoading:threatIndexPatternsLoading,dataTestSubj:"detectionEngineStepDefineThreatRuleQueryBar",openTimelineSearch:false}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:threatMapping.label,labelAppend:threatMapping.labelAppend,helpText:threatMapping.helpText,error:errorMessage,isInvalid:isInvalid,fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(ThreatMatchComponent,{listItems:threatItems,indexPatterns:indexPatterns,threatIndexPatterns:threatIndexPatterns,"data-test-subj":"threatmatch-builder","id-aria":"threatmatch-builder",onChange:handleBuilderOnChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}))};const ThreatMatchInput=external_kbnSharedDeps_React_default.a.memo(ThreatMatchInputComponent);var source=__webpack_require__(175);const QUERY_PREVIEW_BUTTON=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.stepDefineRule.previewQueryButton",{defaultMessage:"Preview results"});const QUERY_PREVIEW_SELECT_ARIA=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.stepDefineRule.previewQueryAriaLabel",{defaultMessage:"Query preview timeframe select"});const QUERY_PREVIEW_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewLabel",{defaultMessage:"Quick query preview"});const QUERY_PREVIEW_HELP_TEXT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewHelpText",{defaultMessage:"Select a timeframe of data to preview query results"});const QUERY_GRAPH_COUNT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphCountLabel",{defaultMessage:"Count"});const THRESHOLD_QUERY_GRAPH_COUNT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryThresholdGraphCountLabel",{defaultMessage:"Cumulative Threshold Count"});const QUERY_GRAPH_HITS_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphHitsTitle",{defaultMessage:"Hits"});const QUERY_PREVIEW_TITLE=hits=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewGraphTitle",{values:{hits:hits},defaultMessage:"{hits} {hits, plural, =1 {hit} other {hits}}"});const QUERY_PREVIEW_THRESHOLD_WITH_FIELD_TITLE=buckets=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewGraphThresholdWithFieldTitle",{values:{buckets:buckets},defaultMessage:"{buckets} {buckets, plural, =1 {unique hit} other {unique hits}}"});const QUERY_PREVIEW_INSPECT_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewInspectTitle",{defaultMessage:"query preview"});const QUERY_PREVIEW_NOISE_WARNING=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewNoiseWarning",{defaultMessage:"Noise warning: This rule may cause a lot of noise. Consider narrowing your query. This is based on a linear progression of 1 alert per hour."});const QUERY_PREVIEW_NO_HITS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryNoHits",{defaultMessage:"No hits were found."});const QUERY_PREVIEW_ERROR=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewError",{defaultMessage:"Error fetching preview"});const QUERY_PREVIEW_DISCLAIMER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphDisclaimer",{defaultMessage:"Note: This preview excludes effects of rule exceptions and timestamp overrides."});const QUERY_PREVIEW_DISCLAIMER_EQL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphDisclaimerEql",{defaultMessage:"Note: This preview excludes effects of rule exceptions and timestamp overrides, and is limited to 100 results."});const QUERY_PREVIEW_SUBTITLE_LOADING=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewSubtitleLoading",{defaultMessage:"...loading"});const QUERY_PREVIEW_EQL_SEQUENCE_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewEqlSequenceTitle",{defaultMessage:"No histogram available"});const QUERY_PREVIEW_EQL_SEQUENCE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewEqlSequenceDescription",{defaultMessage:"No histogram is available at this time for EQL sequence queries. You can use the inspect in the top right corner to view query details."});var matrix_histogram=__webpack_require__(790);var security_solution_matrix_histogram=__webpack_require__(291);var external_kbnSharedDeps_ElasticCharts_=__webpack_require__(84);var components_utils=__webpack_require__(228);var get_query_filter=__webpack_require__(796);const isNoisy=(hits,timeframe)=>{if(timeframe==="h"){return hits>1}else if(timeframe==="d"){return hits/24>1}else if(timeframe==="M"){return hits/730>1}return false};const getTimeframeOptions=ruleType=>{if(ruleType==="eql"){return[{value:"h",text:"Last hour"},{value:"d",text:"Last day"}]}else{return[{value:"h",text:"Last hour"},{value:"d",text:"Last day"},{value:"M",text:"Last month"}]}};const getInfoFromQueryBar=(queryBar,index,ruleType)=>{const queryString=typeof queryBar.query.query==="string"?queryBar.query.query:"";const language=queryBar.query.language;const filters=queryBar.filters;try{const queryFilter=ruleType!=="eql"?Object(get_query_filter["a"])(queryString,language,filters,index,[],true):undefined;return{queryString:queryString,language:language,filters:filters,queryFilter:queryFilter}}catch{return{queryString:queryString,language:language,filters:filters,queryFilter:undefined}}};const getHistogramConfig=(to,from,showLegend=false)=>({series:{xScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Time,yScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear,stackAccessors:["g"]},axis:{xTickFormatter:Object(components_utils["a"])([to,from]),yTickFormatter:value=>value.toLocaleString(),tickSize:8},yAxisTitle:QUERY_GRAPH_COUNT,settings:{legendPosition:external_kbnSharedDeps_ElasticCharts_["Position"].Right,showLegend:showLegend,showLegendExtra:showLegend,theme:{scales:{barsPadding:.08},chartMargins:{left:0,right:0,top:0,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0}}},customHeight:200});const getThresholdHistogramConfig=()=>({series:{xScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Ordinal,yScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear,stackAccessors:["g"]},axis:{yTickFormatter:value=>value.toLocaleString(),tickSize:8},yAxisTitle:THRESHOLD_QUERY_GRAPH_COUNT,settings:{legendPosition:external_kbnSharedDeps_ElasticCharts_["Position"].Right,showLegend:true,showLegendExtra:true,theme:{scales:{barsPadding:.08},chartMargins:{left:0,right:0,top:0,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0}}},customHeight:200});var use_global_time=__webpack_require__(159);var barchart=__webpack_require__(453);var panel=__webpack_require__(205);var header_section=__webpack_require__(146);const LoadingChart=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiLoadingChart"]).withConfig({displayName:"LoadingChart",componentId:"sc-1sjd0mf-0"})(["display:block;margin:0 auto;"]);const PreviewHistogram=({id:id,data:data,dataTestSubj:dataTestSubj,barConfig:barConfig,title:title,subtitle:subtitle,disclaimer:disclaimer,isLoading:isLoading})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(panel["a"],{height:300,"data-test-subj":dataTestSubj},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{id:id,title:title,titleSize:"xs",subtitle:subtitle})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},isLoading?external_kbnSharedDeps_React_default.a.createElement(LoadingChart,{size:"l","data-test-subj":"queryPreviewLoading"}):external_kbnSharedDeps_React_default.a.createElement(barchart["a"],{configs:barConfig,barChart:data,stackByField:undefined,timelineId:undefined,"data-test-subj":"sharedPreviewQueryHistogram"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,disclaimer)))))));const ID="queryEqlPreviewHistogramQuery";const PreviewEqlQueryHistogram=({from:from,to:to,totalCount:totalCount,data:data,inspect:inspect,refetch:refetch,isLoading:isLoading})=>{const{setQuery:setQuery,isInitializing:isInitializing}=Object(use_global_time["a"])();Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!isInitializing){setQuery({id:ID,inspect:inspect,loading:false,refetch:refetch})}},[setQuery,inspect,isInitializing,refetch]);const barConfig=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getHistogramConfig(to,from),[from,to]);const subtitle=Object(external_kbnSharedDeps_React_["useMemo"])(()=>isLoading?QUERY_PREVIEW_SUBTITLE_LOADING:QUERY_PREVIEW_TITLE(totalCount),[isLoading,totalCount]);const chartData=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[{key:"hits",value:data}],[data]);return external_kbnSharedDeps_React_default.a.createElement(PreviewHistogram,{id:ID,data:chartData,barConfig:barConfig,title:QUERY_GRAPH_HITS_TITLE,subtitle:subtitle,disclaimer:QUERY_PREVIEW_DISCLAIMER_EQL,isLoading:isLoading,dataTestSubj:"queryPreviewEqlHistogram"})};var external_kbnSharedDeps_RxjsOperators_=__webpack_require__(29);var hooks_translations=__webpack_require__(590);var common_=__webpack_require__(79);var kibanaUtils_common_=__webpack_require__(98);const EQL_QUERY_EVENT_SIZE=100;const calculateBucketForHour=(eventTimestamp,relativeNow)=>{const diff=Math.abs(relativeNow-eventTimestamp);const minutes=Math.floor(diff/6e4);return Math.ceil(minutes/2)*2};const calculateBucketForDay=(eventTimestamp,relativeNow)=>{const diff=Math.abs(relativeNow-eventTimestamp);const minutes=Math.floor(diff/6e4);return Math.ceil(minutes/60)};const formatInspect=(response,indices)=>{const body=response.rawResponse.meta.request.params.body;const bodyParse=typeof body==="string"?JSON.parse(body):body;return{dsl:[JSON.stringify({...response.rawResponse.meta.request.params,index:indices,body:bodyParse},null,2)],response:[JSON.stringify(response.rawResponse.body,null,2)]}};const getEventsToBucket=(isSequence,response)=>{var _response$rawResponse;const hits=(_response$rawResponse=response.rawResponse.body.hits)!==null&&_response$rawResponse!==void 0?_response$rawResponse:[];if(isSequence){var _hits$sequences$map,_hits$sequences;return(_hits$sequences$map=(_hits$sequences=hits.sequences)===null||_hits$sequences===void 0?void 0:_hits$sequences.map(seq=>seq.events[seq.events.length-1]))!==null&&_hits$sequences$map!==void 0?_hits$sequences$map:[]}else{var _hits$events;return(_hits$events=hits.events)!==null&&_hits$events!==void 0?_hits$events:[]}};const getEqlAggsData=(response,range,to,refetch,indices,isSequence)=>{const{dsl:dsl,response:inspectResponse}=formatInspect(response,indices);const relativeNow=Date.parse(to);const accumulator=getInterval(range,relativeNow);const events=getEventsToBucket(isSequence,response);const totalCount=response.rawResponse.body.hits.total.value;const buckets=events.reduce((acc,hit)=>{const timestamp=hit._source["@timestamp"];if(timestamp==null){return acc}const eventDate=new Date(timestamp).toISOString();const eventTimestamp=Date.parse(eventDate);const bucket=range==="h"?calculateBucketForHour(eventTimestamp,relativeNow):calculateBucketForDay(eventTimestamp,relativeNow);if(acc[bucket]!=null){acc[bucket].total+=1}return acc},accumulator);const data=Object.keys(buckets).map(key=>({x:Number(buckets[key].timestamp),y:buckets[key].total,g:"hits"}));const isAllZeros=data.every(({y:y})=>y===0);return{data:data,totalCount:isAllZeros?0:totalCount,inspect:{dsl:dsl,response:inspectResponse},refetch:refetch}};const createIntervalArray=(start,end,multiplier)=>Array(end-start+1).fill(0).map((_,idx)=>start+idx*multiplier);const getInterval=(range,relativeNow)=>{switch(range){case"h":return createIntervalArray(0,30,2).reduce((acc,int)=>({...acc,[int]:{timestamp:external_kbnSharedDeps_Moment_default()(relativeNow).subtract(int,"m").format("x"),total:0}}),{});case"d":return createIntervalArray(0,24,1).reduce((acc,int)=>({...acc,[int]:{timestamp:external_kbnSharedDeps_Moment_default()(relativeNow).subtract(int,"h").format("x"),total:0}}),{});default:throw new RangeError('Invalid time range selected. Must be "Last hour" or "Last day".')}};var parse_schedule_dates=__webpack_require__(56);var dataEnhanced_public_=__webpack_require__(91);const useEqlPreview=()=>{const{data:data,notifications:notifications}=Object(lib_kibana["h"])().services;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const unsubscribeStream=Object(external_kbnSharedDeps_React_["useRef"])(new external_kbnSharedDeps_Rxjs_["Subject"]);const[loading,setLoading]=Object(external_kbnSharedDeps_React_["useState"])(false);const didCancel=Object(external_kbnSharedDeps_React_["useRef"])(false);const[response,setResponse]=Object(external_kbnSharedDeps_React_["useState"])({data:[],inspect:{dsl:[],response:[]},refetch:refetch.current,totalCount:0});const searchEql=Object(external_kbnSharedDeps_React_["useCallback"])(({from:from,to:to,query:query,index:index,interval:interval})=>{if(Object(parse_schedule_dates["a"])(to)==null||Object(parse_schedule_dates["a"])(from)==null){notifications.toasts.addWarning("Time intervals are not defined.");return}const asyncSearch=async()=>{abortCtrl.current=new AbortController;setLoading(true);setResponse(prevResponse=>({...prevResponse,data:[],inspect:{dsl:[],response:[]},totalCount:0}));data.search.search({params:{index:index.join(),body:{filter:{range:{"@timestamp":{gte:from,lte:to,format:"strict_date_optional_time"}}},query:query,size:100}}},{strategy:dataEnhanced_public_["EQL_SEARCH_STRATEGY"],abortSignal:abortCtrl.current.signal}).pipe(Object(external_kbnSharedDeps_RxjsOperators_["takeUntil"])(unsubscribeStream.current)).subscribe({next:res=>{if(Object(common_["isCompleteResponse"])(res)){if(!didCancel.current){setLoading(false);setResponse(prev=>{const{inspect:inspect,...rest}=getEqlAggsData(res,interval,to,refetch.current,index,Object(utils["b"])(query));const inspectDsl=prev.inspect.dsl[0]?prev.inspect.dsl:inspect.dsl;const inspectResp=prev.inspect.response[0]?prev.inspect.response:inspect.response;return{...prev,...rest,inspect:{dsl:inspectDsl,response:inspectResp}}})}unsubscribeStream.current.next()}else if(Object(common_["isPartialResponse"])(res)){setResponse(prev=>({...prev,inspect:formatInspect(res,index)}))}else if(Object(common_["isErrorResponse"])(res)){setLoading(false);notifications.toasts.addWarning(hooks_translations["c"]);unsubscribeStream.current.next()}},error:err=>{if(!(err instanceof kibanaUtils_common_["AbortError"])){setLoading(false);setResponse({data:[],inspect:{dsl:[],response:[]},refetch:refetch.current,totalCount:0});notifications.toasts.addError(err,{title:hooks_translations["c"]})}}})};abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch},[data.search,notifications.toasts]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>()=>{didCancel.current=true;abortCtrl.current.abort();unsubscribeStream.current.complete()},[]);return[loading,searchEql,response]};const threshold_histogram_ID="queryPreviewThresholdHistogramQuery";const PreviewThresholdQueryHistogram=({buckets:buckets,inspect:inspect,refetch:refetch,isLoading:isLoading})=>{const{setQuery:setQuery,isInitializing:isInitializing}=Object(use_global_time["a"])();Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!isLoading&&!isInitializing){setQuery({id:threshold_histogram_ID,inspect:inspect,loading:isLoading,refetch:refetch})}},[setQuery,inspect,isLoading,isInitializing,refetch]);const{data:data,totalCount:totalCount}=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const total=buckets.length;const dataBuckets=buckets.map(({key:key,doc_count:docCount})=>({x:key,y:docCount,g:key}));return{data:[{key:"hits",value:dataBuckets}],totalCount:total}},[buckets]);const barConfig=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getThresholdHistogramConfig(),[]);const subtitle=Object(external_kbnSharedDeps_React_["useMemo"])(()=>isLoading?QUERY_PREVIEW_SUBTITLE_LOADING:QUERY_PREVIEW_THRESHOLD_WITH_FIELD_TITLE(totalCount),[isLoading,totalCount]);return external_kbnSharedDeps_React_default.a.createElement(PreviewHistogram,{id:threshold_histogram_ID,data:data,barConfig:barConfig,title:QUERY_GRAPH_HITS_TITLE,subtitle:subtitle,disclaimer:QUERY_PREVIEW_DISCLAIMER,isLoading:isLoading,dataTestSubj:"thresholdQueryPreviewHistogram"})};var super_date_picker=__webpack_require__(244);const queryPreviewReducer=()=>(state,action)=>{switch(action.type){case"setQueryInfo":{if(action.queryBar!=null){const{queryString:queryString,language:language,filters:filters,queryFilter:queryFilter}=getInfoFromQueryBar(action.queryBar,action.index,action.ruleType);return{...state,queryString:queryString,language:language,filters:filters,queryFilter:queryFilter,showHistogram:false}}return{...state,showHistogram:false}}case"setTimeframeSelect":{return{...state,timeframe:action.timeframe,showHistogram:false,warnings:[]}}case"setResetRuleTypeChange":{const showNonEqlHist=action.ruleType==="query"||action.ruleType==="saved_query"||action.ruleType==="threshold"&&!state.thresholdFieldExists;return{...state,showHistogram:false,timeframe:"h",timeframeOptions:getTimeframeOptions(action.ruleType),showNonEqlHistogram:showNonEqlHist,warnings:[]}}case"setWarnings":{return{...state,warnings:action.warnings}}case"setShowHistogram":{return{...state,showHistogram:action.show}}case"setThresholdQueryVals":{const thresholdField=action.threshold!=null&&action.threshold.field!=null&&action.threshold.field.length>0&&action.threshold.field.every(field=>field.trim()!=="");const showNonEqlHist=action.ruleType==="query"||action.ruleType==="saved_query"||action.ruleType==="threshold"&&!thresholdField;return{...state,thresholdFieldExists:thresholdField,showNonEqlHistogram:showNonEqlHist,showHistogram:false,warnings:[]}}case"setToFrom":{return{...state,fromTime:Object(super_date_picker["c"])("now"),toTime:Object(super_date_picker["c"])(`now-1${state.timeframe}`)}}case"setNoiseWarning":{return{...state,warnings:[...state.warnings,QUERY_PREVIEW_NOISE_WARNING]}}default:return state}};const custom_histogram_ID="queryPreviewCustomHistogramQuery";const PreviewCustomQueryHistogram=({to:to,from:from,data:data,totalCount:totalCount,inspect:inspect,refetch:refetch,isLoading:isLoading})=>{const{setQuery:setQuery,isInitializing:isInitializing}=Object(use_global_time["a"])();Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!isLoading&&!isInitializing){setQuery({id:custom_histogram_ID,inspect:inspect,loading:isLoading,refetch:refetch})}},[setQuery,inspect,isLoading,isInitializing,refetch]);const barConfig=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getHistogramConfig(to,from,true),[from,to]);const subtitle=Object(external_kbnSharedDeps_React_["useMemo"])(()=>isLoading?QUERY_PREVIEW_SUBTITLE_LOADING:QUERY_PREVIEW_TITLE(totalCount),[isLoading,totalCount]);const chartData=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[{key:"hits",value:data}],[data]);return external_kbnSharedDeps_React_default.a.createElement(PreviewHistogram,{id:custom_histogram_ID,data:chartData,barConfig:barConfig,title:QUERY_GRAPH_HITS_TITLE,subtitle:subtitle,disclaimer:QUERY_PREVIEW_DISCLAIMER,isLoading:isLoading,dataTestSubj:"queryPreviewCustomHistogram"})};const Select=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiSelect"]).withConfig({displayName:"Select",componentId:"sc-111a7av-0"})(["width:",";"],({theme:theme})=>theme.eui.euiSuperDatePickerWidth);const PreviewButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiButton"]).withConfig({displayName:"PreviewButton",componentId:"sc-111a7av-1"})(["margin-left:0;"]);const query_preview_initialState={timeframeOptions:[],showHistogram:false,timeframe:"h",warnings:[],queryFilter:undefined,toTime:"",fromTime:"",queryString:"",language:"kuery",filters:[],thresholdFieldExists:false,showNonEqlHistogram:false};const PreviewQuery=({ruleType:ruleType,dataTestSubj:dataTestSubj,idAria:idAria,query:query,index:index,threshold:threshold,isDisabled:isDisabled})=>{const[eqlQueryLoading,startEql,{totalCount:eqlQueryTotal,data:eqlQueryData,refetch:eqlQueryRefetch,inspect:eqlQueryInspect}]=useEqlPreview();const[{thresholdFieldExists:thresholdFieldExists,showNonEqlHistogram:showNonEqlHistogram,timeframeOptions:timeframeOptions,showHistogram:showHistogram,timeframe:timeframe,warnings:warnings,queryFilter:queryFilter,toTime:toTime,fromTime:fromTime,queryString:queryString},dispatch]=Object(external_kbnSharedDeps_React_["useReducer"])(queryPreviewReducer(),{...query_preview_initialState,toTime:Object(super_date_picker["c"])("now-1h"),fromTime:Object(super_date_picker["c"])("now")});const[isMatrixHistogramLoading,{inspect:inspect,totalCount:matrixHistTotal,refetch:refetch,data:matrixHistoData,buckets:buckets},startNonEql]=Object(matrix_histogram["a"])({errorMessage:QUERY_PREVIEW_ERROR,endDate:fromTime,startDate:toTime,filterQuery:queryFilter,indexNames:index,histogramType:security_solution_matrix_histogram["MatrixHistogramType"].events,stackByField:"event.category",threshold:ruleType==="threshold"?threshold:undefined,skip:true});const setQueryInfo=Object(external_kbnSharedDeps_React_["useCallback"])((queryBar,indices,type)=>{dispatch({type:"setQueryInfo",queryBar:queryBar,index:indices,ruleType:type})},[dispatch]);const debouncedSetQueryInfo=Object(external_kbnSharedDeps_React_["useRef"])(Object(external_kbnSharedDeps_LodashFp_["debounce"])(500,setQueryInfo));const setTimeframeSelect=Object(external_kbnSharedDeps_React_["useCallback"])(selection=>{dispatch({type:"setTimeframeSelect",timeframe:selection})},[dispatch]);const setRuleTypeChange=Object(external_kbnSharedDeps_React_["useCallback"])(type=>{dispatch({type:"setResetRuleTypeChange",ruleType:type})},[dispatch]);const setWarnings=Object(external_kbnSharedDeps_React_["useCallback"])(yikes=>{dispatch({type:"setWarnings",warnings:yikes})},[dispatch]);const setNoiseWarning=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{dispatch({type:"setNoiseWarning"})},[dispatch]);const setShowHistogram=Object(external_kbnSharedDeps_React_["useCallback"])(show=>{dispatch({type:"setShowHistogram",show:show})},[dispatch]);const setThresholdValues=Object(external_kbnSharedDeps_React_["useCallback"])((thresh,type)=>{dispatch({type:"setThresholdQueryVals",threshold:thresh,ruleType:type})},[dispatch]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{debouncedSetQueryInfo.current(query,index,ruleType)},[index,query,ruleType]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setThresholdValues(threshold,ruleType)},[setThresholdValues,threshold,ruleType]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setRuleTypeChange(ruleType)},[ruleType,setRuleTypeChange]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{switch(ruleType){case"eql":if(isNoisy(eqlQueryTotal,timeframe)){setNoiseWarning()}break;case"threshold":const totalHits=thresholdFieldExists?buckets.length:matrixHistTotal;if(isNoisy(totalHits,timeframe)){setNoiseWarning()}break;default:if(isNoisy(matrixHistTotal,timeframe)){setNoiseWarning()}}},[timeframe,matrixHistTotal,eqlQueryTotal,ruleType,setNoiseWarning,thresholdFieldExists,buckets.length]);const handlePreviewEqlQuery=Object(external_kbnSharedDeps_React_["useCallback"])((to,from)=>{startEql({index:index,query:queryString,from:from,to:to,interval:timeframe})},[startEql,index,queryString,timeframe]);const handleSelectPreviewTimeframe=Object(external_kbnSharedDeps_React_["useCallback"])(({target:{value:value}})=>{setTimeframeSelect(value)},[setTimeframeSelect]);const handlePreviewClicked=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{const to=Object(super_date_picker["c"])("now");const from=Object(super_date_picker["c"])(`now-1${timeframe}`);setWarnings([]);setShowHistogram(true);if(ruleType==="eql"){handlePreviewEqlQuery(to,from)}else{startNonEql(to,from)}},[setWarnings,setShowHistogram,ruleType,handlePreviewEqlQuery,startNonEql,timeframe]);const previewButtonDisabled=Object(external_kbnSharedDeps_React_["useMemo"])(()=>isMatrixHistogramLoading||eqlQueryLoading||isDisabled||query==null||query!=null&&query.query.query===""&&query.filters.length===0,[eqlQueryLoading,isDisabled,isMatrixHistogramLoading,query]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:QUERY_PREVIEW_LABEL,helpText:QUERY_PREVIEW_HELP_TEXT,error:undefined,isInvalid:false,"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(Select,{id:"queryPreviewSelect",options:timeframeOptions,value:timeframe,onChange:handleSelectPreviewTimeframe,"aria-label":QUERY_PREVIEW_SELECT_ARIA,disabled:isDisabled,"data-test-subj":"queryPreviewTimeframeSelect"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(PreviewButton,{fill:true,isDisabled:previewButtonDisabled,onClick:handlePreviewClicked,"data-test-subj":"queryPreviewButton"},QUERY_PREVIEW_BUTTON)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),showNonEqlHistogram&&showHistogram&&external_kbnSharedDeps_React_default.a.createElement(PreviewCustomQueryHistogram,{to:toTime,from:fromTime,data:matrixHistoData,totalCount:matrixHistTotal,inspect:inspect,refetch:refetch,isLoading:isMatrixHistogramLoading}),ruleType==="threshold"&&thresholdFieldExists&&showHistogram&&external_kbnSharedDeps_React_default.a.createElement(PreviewThresholdQueryHistogram,{isLoading:isMatrixHistogramLoading,buckets:buckets,inspect:inspect,refetch:refetch}),ruleType==="eql"&&showHistogram&&external_kbnSharedDeps_React_default.a.createElement(PreviewEqlQueryHistogram,{to:toTime,from:fromTime,totalCount:eqlQueryTotal,data:eqlQueryData,inspect:eqlQueryInspect,refetch:eqlQueryRefetch,isLoading:eqlQueryLoading}),showHistogram&&warnings.length>0&&warnings.map((warning,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],{key:`${warning}-${i}`},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{color:"warning",iconType:"help","data-test-subj":"previewQueryWarning"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("p",null,warning))))))};const step_define_rule_CommonUseField=Object(shared_imports["x"])({component:shared_imports["d"]});const stepDefineDefaultValue={anomalyThreshold:50,index:[],machineLearningJobId:"",ruleType:"query",threatIndex:[],queryBar:{query:{query:"",language:"kuery"},filters:[],saved_id:undefined},threatQueryBar:{query:{query:"*:*",language:"kuery"},filters:[],saved_id:undefined},threatMapping:[],threshold:{field:[],value:"200",cardinality:{field:[],value:""}},timeline:{id:null,title:timeline_translations["b"]}};const threatQueryBarDefaultValue={...stepDefineDefaultValue.queryBar,query:{...stepDefineDefaultValue.queryBar.query,query:"*:*"}};const MyLabelButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"]).withConfig({displayName:"MyLabelButton",componentId:"f0vskm-0"})(["height:18px;font-size:12px;.euiIcon{width:14px;height:14px;}"]);MyLabelButton.defaultProps={flush:"right"};const RuleTypeEuiFormRow=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFormRow"]).attrs(({$isVisible:$isVisible})=>({style:{display:$isVisible?"flex":"none"}})).withConfig({displayName:"RuleTypeEuiFormRow",componentId:"f0vskm-1"})([""]);const StepDefineRuleComponent=({addPadding:addPadding=false,defaultValues:defaultValues,descriptionColumns:descriptionColumns="singleSplit",isReadOnlyView:isReadOnlyView,isLoading:isLoading,isUpdateView:isUpdateView=false,onSubmit:onSubmit,setForm:setForm})=>{const mlCapabilities=Object(use_ml_capabilities["a"])();const[openTimelineSearch,setOpenTimelineSearch]=Object(external_kbnSharedDeps_React_["useState"])(false);const[indexModified,setIndexModified]=Object(external_kbnSharedDeps_React_["useState"])(false);const[indicesConfig]=Object(lib_kibana["l"])(constants["u"]);const initialState=defaultValues!==null&&defaultValues!==void 0?defaultValues:{...stepDefineDefaultValue,index:indicesConfig};const{form:form}=Object(shared_imports["I"])({defaultValue:initialState,options:{stripEmptyFields:false},schema:schema_schema});const{getFields:getFields,getFormData:getFormData,reset:reset,submit:submit}=form;const[{index:formIndex,ruleType:formRuleType,queryBar:formQuery,threatIndex:formThreatIndex,threshold:formThreshold}]=Object(shared_imports["K"])({form:form,watch:["index","ruleType","queryBar","threshold","threshold.field","threshold.value","threshold.cardinality.field","threshold.cardinality.value","threatIndex"]});const[isQueryBarValid,setIsQueryBarValid]=Object(external_kbnSharedDeps_React_["useState"])(false);const index=formIndex||initialState.index;const threatIndex=formThreatIndex||initialState.threatIndex;const ruleType=formRuleType||initialState.ruleType;const[indexPatternsLoading,{browserFields:browserFields,indexPatterns:indexPatterns}]=Object(source["b"])(index);const aggregatableFields=Object.entries(browserFields).reduce((groupAcc,[groupName,groupValue])=>{var _groupValue$fields;return{...groupAcc,[groupName]:{fields:Object.entries((_groupValue$fields=groupValue.fields)!==null&&_groupValue$fields!==void 0?_groupValue$fields:{}).reduce((fieldAcc,[fieldName,fieldValue])=>{if(fieldValue.aggregatable===true){fieldAcc[fieldName]=fieldValue}return fieldAcc},{})}}},{});const[threatIndexPatternsLoading,{browserFields:threatBrowserFields,indexPatterns:threatIndexPatterns}]=Object(source["b"])(threatIndex);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{reset({resetValues:false})},[reset,ruleType]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setIndexModified(!isEqual_default()(index,indicesConfig))},[index,indicesConfig]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const{queryBar:queryBar}=getFields();if(queryBar!=null){const{queryBar:defaultQueryBar}=stepDefineDefaultValue;if(Object(utils["f"])(ruleType)&&queryBar.value===defaultQueryBar){queryBar.reset({defaultValue:threatQueryBarDefaultValue})}else if(queryBar.value===threatQueryBarDefaultValue){queryBar.reset({defaultValue:defaultQueryBar})}}},[ruleType,getFields]);const handleSubmit=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(onSubmit){onSubmit()}},[onSubmit]);const getData=Object(external_kbnSharedDeps_React_["useCallback"])(async()=>{const result=await submit();return result.isValid?result:{isValid:false,data:getFormData()}},[getFormData,submit]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let didCancel=false;if(setForm&&!didCancel){setForm(rules_types["a"].defineRule,getData)}return()=>{didCancel=true}},[getData,setForm]);const handleResetIndices=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{const indexField=getFields().index;indexField.setValue(indicesConfig)},[getFields,indicesConfig]);const handleOpenTimelineSearch=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setOpenTimelineSearch(true)},[]);const handleCloseTimelineSearch=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setOpenTimelineSearch(false)},[]);const ThresholdInputChildren=Object(external_kbnSharedDeps_React_["useCallback"])(({thresholdField:thresholdField,thresholdValue:thresholdValue,thresholdCardinalityField:thresholdCardinalityField,thresholdCardinalityValue:thresholdCardinalityValue})=>external_kbnSharedDeps_React_default.a.createElement(ThresholdInput,{browserFields:aggregatableFields,thresholdField:thresholdField,thresholdValue:thresholdValue,thresholdCardinalityField:thresholdCardinalityField,thresholdCardinalityValue:thresholdCardinalityValue}),[aggregatableFields]);const ThreatMatchInputChildren=Object(external_kbnSharedDeps_React_["useCallback"])(({threatMapping:threatMapping})=>external_kbnSharedDeps_React_default.a.createElement(ThreatMatchInput,{threatBrowserFields:threatBrowserFields,indexPatterns:indexPatterns,threatIndexPatterns:threatIndexPatterns,threatMapping:threatMapping,threatIndexPatternsLoading:threatIndexPatternsLoading}),[threatBrowserFields,threatIndexPatternsLoading,threatIndexPatterns,indexPatterns]);return isReadOnlyView?external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{"data-test-subj":"definitionRule",addPadding:addPadding},external_kbnSharedDeps_React_default.a.createElement(StepRuleDescription,{columns:descriptionColumns,indexPatterns:indexPatterns,schema:filterRuleFieldsForType(schema_schema,ruleType),data:filterRuleFieldsForType(initialState,ruleType)})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{addPadding:!isUpdateView},external_kbnSharedDeps_React_default.a.createElement(shared_imports["e"],{form:form,"data-test-subj":"stepDefineRule"},external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"ruleType",component:SelectRuleType,componentProps:{describedByIds:["detectionEngineStepDefineRuleType"],isUpdateView:isUpdateView,hasValidLicense:Object(has_ml_license["a"])(mlCapabilities),isMlAdmin:Object(has_ml_admin_permissions["a"])(mlCapabilities)}}),external_kbnSharedDeps_React_default.a.createElement(RuleTypeEuiFormRow,{$isVisible:!Object(helpers["d"])(ruleType),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(step_define_rule_CommonUseField,{path:"index",config:{...schema_schema.index,labelAppend:indexModified?external_kbnSharedDeps_React_default.a.createElement(MyLabelButton,{onClick:handleResetIndices,iconType:"refresh"},RESET_DEFAULT_INDEX):null},componentProps:{idAria:"detectionEngineStepDefineRuleIndices","data-test-subj":"detectionEngineStepDefineRuleIndices",euiFieldProps:{fullWidth:true,isDisabled:isLoading,placeholder:""}}}),Object(utils["d"])(ruleType)?external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{key:"EqlQueryBar",path:"queryBar",component:eql_query_bar["a"],componentProps:{onValidityChange:setIsQueryBarValid,idAria:"detectionEngineStepDefineRuleEqlQueryBar",isDisabled:isLoading,isLoading:indexPatternsLoading,dataTestSubj:"detectionEngineStepDefineRuleEqlQueryBar"},config:{...schema_schema.queryBar,label:EQL_QUERY_BAR_LABEL}}):external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{key:"QueryBarDefineRule",path:"queryBar",config:{...schema_schema.queryBar,label:QUERY_BAR_LABEL,labelAppend:external_kbnSharedDeps_React_default.a.createElement(MyLabelButton,{"data-test-subj":"importQueryFromSavedTimeline",onClick:handleOpenTimelineSearch},IMPORT_TIMELINE_QUERY)},component:QueryBarDefineRule,componentProps:{browserFields:browserFields,idAria:"detectionEngineStepDefineRuleQueryBar",indexPattern:indexPatterns,isDisabled:isLoading,isLoading:indexPatternsLoading,dataTestSubj:"detectionEngineStepDefineRuleQueryBar",openTimelineSearch:openTimelineSearch,onValidityChange:setIsQueryBarValid,onCloseTimelineSearch:handleCloseTimelineSearch}}))),external_kbnSharedDeps_React_default.a.createElement(RuleTypeEuiFormRow,{$isVisible:Object(helpers["d"])(ruleType),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"machineLearningJobId",component:MlJobSelect,componentProps:{describedByIds:["detectionEngineStepDefineRulemachineLearningJobId"]}}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"anomalyThreshold",component:AnomalyThresholdSlider,componentProps:{describedByIds:["detectionEngineStepDefineRuleAnomalyThreshold"]}}))),external_kbnSharedDeps_React_default.a.createElement(RuleTypeEuiFormRow,{$isVisible:Object(utils["g"])(ruleType),"data-test-subj":"thresholdInput",fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(shared_imports["k"],{fields:{thresholdField:{path:"threshold.field"},thresholdValue:{path:"threshold.value"},thresholdCardinalityField:{path:"threshold.cardinality.field"},thresholdCardinalityValue:{path:"threshold.cardinality.value"}}},ThresholdInputChildren))),external_kbnSharedDeps_React_default.a.createElement(RuleTypeEuiFormRow,{$isVisible:Object(utils["f"])(ruleType),"data-test-subj":"threatMatchInput",fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(shared_imports["k"],{fields:{threatMapping:{path:"threatMapping"}}},ThreatMatchInputChildren))),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"timeline",component:PickTimeline,componentProps:{idAria:"detectionEngineStepDefineRuleTimeline",isDisabled:isLoading,dataTestSubj:"detectionEngineStepDefineRuleTimeline"}})),ruleType!=="machine_learning"&&ruleType!=="threat_match"&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(PreviewQuery,{dataTestSubj:"ruleCreationQueryPreview",idAria:"ruleCreationQueryPreview",ruleType:ruleType,index:index,query:formQuery,isDisabled:!isQueryBarValid||index.length===0,threshold:formThreshold}))),!isUpdateView&&external_kbnSharedDeps_React_default.a.createElement(NextStep,{dataTestSubj:"define-continue",onClick:handleSubmit,isDisabled:isLoading}))};const StepDefineRule=Object(external_kbnSharedDeps_React_["memo"])(StepDefineRuleComponent);function add_item_form_extends(){add_item_form_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return add_item_form_extends.apply(this,arguments)}const MyEuiFormRow=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFormRow"]).withConfig({displayName:"MyEuiFormRow",componentId:"sc-1urlknr-0"})([".euiFormRow__labelWrapper{.euiText{padding-right:32px;}}"]);const MyAddItemButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"]).withConfig({displayName:"MyAddItemButton",componentId:"sc-1urlknr-1"})(["margin:4px 0px;&.euiButtonEmpty--small{font-size:12px;}.euiIcon{width:12px;height:12px;}"]);MyAddItemButton.defaultProps={flush:"left",iconType:"plusInCircle",size:"s"};const AddItem=({addText:addText,dataTestSubj:dataTestSubj,field:field,idAria:idAria,isDisabled:isDisabled,validate:validate})=>{const[showValidation,setShowValidation]=Object(external_kbnSharedDeps_React_["useState"])(false);const{isInvalid:isInvalid,errorMessage:errorMessage}=Object(shared_imports["w"])(field);const[haveBeenKeyboardDeleted,setHaveBeenKeyboardDeleted]=Object(external_kbnSharedDeps_React_["useState"])(-1);const inputsRef=Object(external_kbnSharedDeps_React_["useRef"])([]);const removeItem=Object(external_kbnSharedDeps_React_["useCallback"])(index=>{const values=field.value;const newValues=[...values.slice(0,index),...values.slice(index+1)];field.setValue(newValues.length===0?[""]:newValues);inputsRef.current=[...inputsRef.current.slice(0,index),...inputsRef.current.slice(index+1)];inputsRef.current=inputsRef.current.map((ref,i)=>{if(i>=index&&inputsRef.current[index]!=null){ref.value="re-render"}return ref})},[field]);const addItem=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{const values=field.value;field.setValue([...values,""])},[field]);const updateItem=Object(external_kbnSharedDeps_React_["useCallback"])((event,index)=>{event.persist();const values=field.value;const value=event.target.value;field.setValue([...values.slice(0,index),value,...values.slice(index+1)])},[field]);const handleLastInputRef=Object(external_kbnSharedDeps_React_["useCallback"])((index,element)=>{if(element!=null){inputsRef.current=[...inputsRef.current.slice(0,index),element,...inputsRef.current.slice(index+1)]}},[inputsRef]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(haveBeenKeyboardDeleted!==-1&&!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(inputsRef.current)&&inputsRef.current[haveBeenKeyboardDeleted]!=null){inputsRef.current[haveBeenKeyboardDeleted].focus();setHaveBeenKeyboardDeleted(-1)}},[haveBeenKeyboardDeleted,inputsRef.current]);const values=field.value;return external_kbnSharedDeps_React_default.a.createElement(MyEuiFormRow,{label:field.label,labelAppend:field.labelAppend,error:showValidation?errorMessage:null,isInvalid:showValidation&&isInvalid,fullWidth:true,"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,values.map((item,index)=>{const euiFieldProps={disabled:isDisabled,...index===values.length-1?{inputRef:handleLastInputRef.bind(null,index)}:{},value:item,isInvalid:validate==null?false:showValidation&&validate(item)};return external_kbnSharedDeps_React_default.a.createElement("div",{key:index},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],add_item_form_extends({onBlur:()=>setShowValidation(true),onChange:e=>updateItem(e,index),fullWidth:true},euiFieldProps))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{color:"danger",iconType:"trash",isDisabled:isDisabled||Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(item)&&values.length===1,onClick:()=>removeItem(index),"aria-label":rules_translations["J"]}))),values.length-1!==index&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}))}),external_kbnSharedDeps_React_default.a.createElement(MyAddItemButton,{onClick:addItem,isDisabled:isDisabled},addText)))};const threatDefault=[{framework:"MITRE ATT&CK",tactic:{id:"none",name:"none",reference:"none"},technique:[]}];const stepAboutDefaultValue={author:[],name:"",description:"",isAssociatedToEndpointList:false,isBuildingBlock:false,severity:{value:"low",mapping:fillEmptySeverityMappings([]),isMappingChecked:false},riskScore:{value:21,mapping:[],isMappingChecked:false},references:[""],falsePositives:[""],license:"",ruleNameOverride:"",tags:[],timestampOverride:"",threat:threatDefault,note:""};const THREATS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttack.threatsDescription",{defaultMessage:"threats"});const TACTIC=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttack.tacticsDescription",{defaultMessage:"tactic"});const TECHNIQUE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttack.techniquesDescription",{defaultMessage:"technique"});const SUBTECHNIQUE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttack.subtechniquesDescription",{defaultMessage:"subtechnique"});const ADD_MITRE_TACTIC=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttack.addTacticTitle",{defaultMessage:"Add tactic"});const ADD_MITRE_TECHNIQUE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttack.addTechniqueTitle",{defaultMessage:"Add technique"});const ADD_MITRE_SUBTECHNIQUE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttack.addSubtechniqueTitle",{defaultMessage:"Add subtechnique"});const TACTIC_PLACEHOLDER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttack.tacticPlaceHolderDescription",{defaultMessage:"Select a tactic ..."});const TECHNIQUE_PLACEHOLDER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttack.techniquePlaceHolderDescription",{defaultMessage:"Select a technique ..."});const SUBTECHNIQUE_PLACEHOLDER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mitreAttack.subtechniquePlaceHolderDescription",{defaultMessage:"Select a subtechnique ..."});const hasSubtechniqueOptions=technique=>subtechniquesOptions.some(subtechnique=>subtechnique.techniqueId===technique.id);const SubtechniqueContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"SubtechniqueContainer",componentId:"sc-1cb5h5o-0"})(["margin-left:48px;"]);const MitreAttackSubtechniqueFields=({field:field,idAria:idAria,isDisabled:isDisabled,threatIndex:threatIndex,techniqueIndex:techniqueIndex,onFieldChange:onFieldChange})=>{const values=field.value;const technique=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _values$threatIndex$t;return[...(_values$threatIndex$t=values[threatIndex].technique)!==null&&_values$threatIndex$t!==void 0?_values$threatIndex$t:[]]},[values,threatIndex]);const removeSubtechnique=Object(external_kbnSharedDeps_React_["useCallback"])(index=>{var _technique$techniqueI;const threats=[...field.value];const subtechniques=(_technique$techniqueI=technique[techniqueIndex].subtechnique)!==null&&_technique$techniqueI!==void 0?_technique$techniqueI:[];if(subtechniques!=null){subtechniques.splice(index,1);technique[techniqueIndex]={...technique[techniqueIndex],subtechnique:subtechniques};threats[threatIndex].technique=technique;onFieldChange(threats)}},[field,onFieldChange,techniqueIndex,technique,threatIndex]);const addMitreAttackSubtechnique=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{const threats=[...field.value];const subtechniques=technique[techniqueIndex].subtechnique;if(subtechniques!=null){technique[techniqueIndex]={...technique[techniqueIndex],subtechnique:[...subtechniques,{id:"none",name:"none",reference:"none"}]}}else{technique[techniqueIndex]={...technique[techniqueIndex],subtechnique:[{id:"none",name:"none",reference:"none"}]}}threats[threatIndex].technique=technique;onFieldChange(threats)},[field,onFieldChange,techniqueIndex,technique,threatIndex]);const updateSubtechnique=Object(external_kbnSharedDeps_React_["useCallback"])((index,value)=>{const threats=[...field.value];const{id:id,reference:reference,name:name}=subtechniquesOptions.find(t=>t.value===value)||{id:"",name:"",reference:""};const subtechniques=technique[techniqueIndex].subtechnique;if(subtechniques!=null){onFieldChange([...threats.slice(0,threatIndex),{...threats[threatIndex],technique:[...technique.slice(0,techniqueIndex),{...technique[techniqueIndex],subtechnique:[...subtechniques.slice(0,index),{id:id,reference:reference,name:name},...subtechniques.slice(index+1)]},...technique.slice(techniqueIndex+1)]},...threats.slice(threatIndex+1)])}},[threatIndex,techniqueIndex,onFieldChange,field,technique]);const getSelectSubtechnique=Object(external_kbnSharedDeps_React_["useCallback"])((index,disabled,subtechnique)=>{const options=subtechniquesOptions.filter(t=>t.techniqueId===technique[techniqueIndex].id);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSuperSelect"],{id:"mitreAttackSubtechnique",options:[...subtechnique.name==="none"?[{inputDisplay:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,SUBTECHNIQUE_PLACEHOLDER),value:"none",disabled:disabled}]:[],...options.map(option=>({inputDisplay:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,option.label),value:option.value,disabled:disabled}))],prepend:`${field.label} ${SUBTECHNIQUE}`,"aria-label":"",onChange:updateSubtechnique.bind(null,index),fullWidth:true,valueOfSelected:Object(external_kbnSharedDeps_LodashFp_["camelCase"])(subtechnique.name),"data-test-subj":"mitreAttackSubtechnique",disabled:disabled,placeholder:SUBTECHNIQUE_PLACEHOLDER}))},[field,updateSubtechnique,technique,techniqueIndex]);const subtechniques=Object(external_kbnSharedDeps_React_["useMemo"])(()=>technique[techniqueIndex].subtechnique,[technique,techniqueIndex]);return external_kbnSharedDeps_React_default.a.createElement(SubtechniqueContainer,null,subtechniques!=null&&subtechniques.map((subtechnique,index)=>external_kbnSharedDeps_React_default.a.createElement("div",{key:index},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true,describedByIds:idAria?[`${idAria} ${SUBTECHNIQUE}`]:undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},getSelectSubtechnique(index,isDisabled,subtechnique)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{color:"danger",iconType:"trash",isDisabled:isDisabled,onClick:()=>removeSubtechnique(index),"aria-label":rules_translations["J"]})))))),external_kbnSharedDeps_React_default.a.createElement(MyAddItemButton,{"data-test-subj":"addMitreAttackSubtechnique",onClick:addMitreAttackSubtechnique,isDisabled:isDisabled},ADD_MITRE_SUBTECHNIQUE))};const TechniqueContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"TechniqueContainer",componentId:"sc-1fugnao-0"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["margin-left:24px;padding-left:24px;border-left:2px solid ",";"],theme.eui.euiColorLightestShade));const MitreAttackTechniqueFields=({field:field,idAria:idAria,isDisabled:isDisabled,threatIndex:threatIndex,onFieldChange:onFieldChange})=>{var _values$threatIndex$t;const values=field.value;const removeTechnique=Object(external_kbnSharedDeps_React_["useCallback"])(index=>{var _threats$threatIndex$;const threats=[...field.value];const techniques=(_threats$threatIndex$=threats[threatIndex].technique)!==null&&_threats$threatIndex$!==void 0?_threats$threatIndex$:[];techniques.splice(index,1);threats[threatIndex]={...threats[threatIndex],technique:techniques};onFieldChange(threats)},[field,threatIndex,onFieldChange]);const addMitreAttackTechnique=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{var _threats$threatIndex$2;const threats=[...field.value];threats[threatIndex]={...threats[threatIndex],technique:[...(_threats$threatIndex$2=threats[threatIndex].technique)!==null&&_threats$threatIndex$2!==void 0?_threats$threatIndex$2:[],{id:"none",name:"none",reference:"none",subtechnique:[]}]};onFieldChange(threats)},[field,threatIndex,onFieldChange]);const updateTechnique=Object(external_kbnSharedDeps_React_["useCallback"])((index,value)=>{var _threats$threatIndex$3;const threats=[...field.value];const{id:id,reference:reference,name:name}=techniquesOptions.find(t=>t.value===value)||{id:"",name:"",reference:""};const technique=(_threats$threatIndex$3=threats[threatIndex].technique)!==null&&_threats$threatIndex$3!==void 0?_threats$threatIndex$3:[];onFieldChange([...threats.slice(0,threatIndex),{...threats[threatIndex],technique:[...technique.slice(0,index),{id:id,reference:reference,name:name,subtechnique:[]},...technique.slice(index+1)]},...threats.slice(threatIndex+1)])},[threatIndex,onFieldChange,field]);const getSelectTechnique=Object(external_kbnSharedDeps_React_["useCallback"])((tacticName,index,disabled,technique)=>{const options=techniquesOptions.filter(t=>t.tactics.includes(Object(external_kbnSharedDeps_LodashFp_["kebabCase"])(tacticName)));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSuperSelect"],{id:"mitreAttackTechnique",options:[...technique.name==="none"?[{inputDisplay:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,TECHNIQUE_PLACEHOLDER),value:"none",disabled:disabled}]:[],...options.map(option=>({inputDisplay:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,option.label),value:option.value,disabled:disabled}))],prepend:`${field.label} ${TECHNIQUE}`,"aria-label":"",onChange:updateTechnique.bind(null,index),fullWidth:true,valueOfSelected:Object(external_kbnSharedDeps_LodashFp_["camelCase"])(technique.name),"data-test-subj":"mitreAttackTechnique",disabled:disabled,placeholder:TECHNIQUE_PLACEHOLDER}))},[field,updateTechnique]);const techniques=(_values$threatIndex$t=values[threatIndex].technique)!==null&&_values$threatIndex$t!==void 0?_values$threatIndex$t:[];return external_kbnSharedDeps_React_default.a.createElement(TechniqueContainer,null,techniques.map((technique,index)=>external_kbnSharedDeps_React_default.a.createElement("div",{key:index},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true,describedByIds:idAria?[`${idAria} ${TECHNIQUE}`]:undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},getSelectTechnique(values[threatIndex].tactic.name,index,isDisabled,technique)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{color:"danger",iconType:"trash",isDisabled:isDisabled,onClick:()=>removeTechnique(index),"aria-label":rules_translations["J"]})))),external_kbnSharedDeps_React_default.a.createElement(MitreAttackSubtechniqueFields,{field:field,idAria:idAria,isDisabled:isDisabled||technique.name==="none"||hasSubtechniqueOptions(technique)===false,threatIndex:threatIndex,techniqueIndex:index,onFieldChange:onFieldChange}))),external_kbnSharedDeps_React_default.a.createElement(MyAddItemButton,{"data-test-subj":"addMitreAttackTechnique",onClick:addMitreAttackTechnique,isDisabled:isDisabled},ADD_MITRE_TECHNIQUE))};const MitreAttackContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"MitreAttackContainer",componentId:"bsl0gv-0"})(["margin-top:16px;"]);const InitialMitreAttackFormRow=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFormRow"]).withConfig({displayName:"InitialMitreAttackFormRow",componentId:"bsl0gv-1"})([".euiFormRow__labelWrapper{.euiText{padding-right:32px;}}"]);const AddMitreAttackThreat=Object(external_kbnSharedDeps_React_["memo"])(({field:field,idAria:idAria,isDisabled:isDisabled})=>{const removeTactic=Object(external_kbnSharedDeps_React_["useCallback"])(index=>{const values=[...field.value];values.splice(index,1);if(Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(values)){field.setValue(threatDefault)}else{field.setValue(values)}},[field]);const addMitreAttackTactic=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{const values=[...field.value];if(!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(values[values.length-1])){field.setValue([...values,{tactic:{id:"none",name:"none",reference:"none"},technique:[]}])}else{field.setValue([{tactic:{id:"none",name:"none",reference:"none"},technique:[]}])}},[field]);const updateTactic=Object(external_kbnSharedDeps_React_["useCallback"])((index,value)=>{const values=[...field.value];const{id:id,reference:reference,name:name}=tacticsOptions.find(t=>t.value===value)||{id:"",name:"",reference:""};values.splice(index,1,{...values[index],tactic:{id:id,reference:reference,name:name},technique:[]});field.setValue([...values])},[field]);const values=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[...field.value],[field]);const getSelectTactic=Object(external_kbnSharedDeps_React_["useCallback"])((threat,index,disabled)=>{const tacticName=threat.tactic.name;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSuperSelect"],{id:"mitreAttackTactic",options:[...tacticName==="none"?[{inputDisplay:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,TACTIC_PLACEHOLDER),value:"none",disabled:disabled}]:[],...tacticsOptions.map(t=>({inputDisplay:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,t.text),value:t.value,disabled:disabled}))],prepend:`${field.label} ${TACTIC}`,"aria-label":"",onChange:updateTactic.bind(null,index),fullWidth:true,valueOfSelected:Object(external_kbnSharedDeps_LodashFp_["camelCase"])(tacticName),"data-test-subj":"mitreAttackTactic",placeholder:TACTIC_PLACEHOLDER})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{color:"danger",iconType:"trash",isDisabled:isDisabled||Object(external_kbnSharedDeps_Lodash_["isEqual"])(values,threatDefault),onClick:()=>removeTactic(index),"aria-label":rules_translations["J"]})))},[field,isDisabled,removeTactic,updateTactic,values]);const onFieldChange=Object(external_kbnSharedDeps_React_["useCallback"])(threats=>{field.setValue(threats)},[field]);return external_kbnSharedDeps_React_default.a.createElement(MitreAttackContainer,null,values.map((threat,index)=>external_kbnSharedDeps_React_default.a.createElement("div",{key:index},index===0?external_kbnSharedDeps_React_default.a.createElement(InitialMitreAttackFormRow,{fullWidth:true,label:`${field.label} ${THREATS}`,labelAppend:field.labelAppend,describedByIds:idAria?[`${idAria} ${TACTIC}`]:undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,getSelectTactic(threat,index,isDisabled))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true,describedByIds:idAria?[`${idAria} ${TACTIC}`]:undefined},getSelectTactic(threat,index,isDisabled)),external_kbnSharedDeps_React_default.a.createElement(MitreAttackTechniqueFields,{field:field,threatIndex:index,isDisabled:isDisabled||threat.tactic.name==="none",idAria:idAria,onFieldChange:onFieldChange}))),external_kbnSharedDeps_React_default.a.createElement(MyAddItemButton,{"data-test-subj":"addMitreAttackTactic",onClick:addMitreAttackTactic,isDisabled:isDisabled},ADD_MITRE_TACTIC))});var utils_validators=__webpack_require__(368);const OptionalFieldLabel=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"xs"},rules_translations["fb"]);const{emptyField:emptyField}=shared_imports["v"];const step_about_rule_schema_schema={author:{type:shared_imports["c"].COMBO_BOX,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorLabel",{defaultMessage:"Author"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorHelpText",{defaultMessage:"Type one or more authors for this rule. Press enter after each author to add a new one."}),labelAppend:OptionalFieldLabel},name:{type:shared_imports["c"].TEXT,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldNameLabel",{defaultMessage:"Name"}),validations:[{validator:emptyField(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.nameFieldRequiredError",{defaultMessage:"A name is required."}))}]},description:{type:shared_imports["c"].TEXTAREA,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldDescriptionLabel",{defaultMessage:"Description"}),validations:[{validator:emptyField(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.descriptionFieldRequiredError",{defaultMessage:"A description is required."}))}]},isBuildingBlock:{type:shared_imports["c"].CHECKBOX,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldBuildingBlockLabel",{defaultMessage:'Mark all generated alerts as "building block" alerts'}),labelAppend:OptionalFieldLabel},isAssociatedToEndpointList:{type:shared_imports["c"].CHECKBOX,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAssociatedToEndpointListLabel",{defaultMessage:"Add existing Endpoint exceptions to the rule"}),labelAppend:OptionalFieldLabel},severity:{value:{},mapping:{},isMappingChecked:{}},riskScore:{value:{},mapping:{},isMappingChecked:{}},references:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldReferenceUrlsLabel",{defaultMessage:"Reference URLs"}),labelAppend:OptionalFieldLabel,validations:[{validator:(...args)=>{const[{value:value,path:path}]=args;let hasError=false;value.forEach(url=>{if(Object(utils_validators["a"])(url)){hasError=true}});return hasError?{code:"ERR_FIELD_FORMAT",path:path,message:URL_FORMAT_INVALID}:undefined}}]},falsePositives:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldFalsePositiveLabel",{defaultMessage:"False positive examples"}),labelAppend:OptionalFieldLabel},license:{type:shared_imports["c"].TEXT,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseLabel",{defaultMessage:"License"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseHelpText",{defaultMessage:"Add a license name"}),labelAppend:OptionalFieldLabel},ruleNameOverride:{type:shared_imports["c"].TEXT,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideLabel",{defaultMessage:"Rule name override"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideHelpText",{defaultMessage:"Choose a field from the source event to populate the rule name in the alert list."}),labelAppend:OptionalFieldLabel},threat:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldMitreThreatLabel",{defaultMessage:"MITRE ATT&CK\\u2122"}),labelAppend:OptionalFieldLabel},threatIndicatorPath:{type:shared_imports["c"].TEXT,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathLabel",{defaultMessage:"Indicator prefix override"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathHelpText",{defaultMessage:"Specify the document prefix containing your indicator fields. Used for enrichment of indicator match alerts."}),labelAppend:OptionalFieldLabel},timestampOverride:{type:shared_imports["c"].TEXT,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideLabel",{defaultMessage:"Timestamp override"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideHelpText",{defaultMessage:"Choose timestamp field used when executing rule. Pick field with timestamp closest to ingest time (e.g. event.ingested)."}),labelAppend:OptionalFieldLabel},tags:{type:shared_imports["c"].COMBO_BOX,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsLabel",{defaultMessage:"Tags"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsHelpText",{defaultMessage:"Type one or more custom identifying tags for this rule. Press enter after each tag to begin a new one."}),labelAppend:OptionalFieldLabel},note:{type:shared_imports["c"].TEXTAREA,label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideLabel",{defaultMessage:"Investigation guide"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideHelpText",{defaultMessage:"Provide helpful information for analysts that are investigating detection alerts. This guide will appear on the rule details page and in timelines (as notes) created from detection alerts generated by this rule."}),labelAppend:OptionalFieldLabel}};var eui_form=__webpack_require__(302);var field_value_match=__webpack_require__(692);const NestedContent=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"NestedContent",componentId:"sc-1o9f6e3-0"})(["margin-left:24px;"]);const EuiFlexItemComboBoxColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"EuiFlexItemComboBoxColumn",componentId:"sc-1o9f6e3-1"})(["max-width:376px;"]);const EuiFlexItemIconColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"EuiFlexItemIconColumn",componentId:"sc-1o9f6e3-2"})(["width:20px;"]);const EuiFlexItemSeverityColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"EuiFlexItemSeverityColumn",componentId:"sc-1o9f6e3-3"})(["width:80px;"]);const SeverityField=({dataTestSubj:dataTestSubj,field:field,idAria:idAria,indices:indices,isDisabled:isDisabled,options:options})=>{const{value:value,isMappingChecked:isMappingChecked,mapping:mapping}=field.value;const{setValue:setValue}=field;const handleFieldValueChange=Object(external_kbnSharedDeps_React_["useCallback"])((newMappingItems,index)=>{setValue({value:value,isMappingChecked:isMappingChecked,mapping:[...mapping.slice(0,index),...newMappingItems,...mapping.slice(index+1)]})},[value,isMappingChecked,mapping,setValue]);const handleFieldChange=Object(external_kbnSharedDeps_React_["useCallback"])((index,severity,[newField])=>{var _newField$name;const newMappingItems=[{...mapping[index],field:(_newField$name=newField===null||newField===void 0?void 0:newField.name)!==null&&_newField$name!==void 0?_newField$name:"",value:newField!=null?mapping[index].value:"",operator:"equals",severity:severity}];handleFieldValueChange(newMappingItems,index)},[mapping,handleFieldValueChange]);const handleDefaultSeverityChange=Object(external_kbnSharedDeps_React_["useCallback"])(newValue=>{setValue({value:newValue,isMappingChecked:isMappingChecked,mapping:mapping})},[isMappingChecked,mapping,setValue]);const handleFieldMatchValueChange=Object(external_kbnSharedDeps_React_["useCallback"])((index,severity,newMatchValue)=>{const newMappingItems=[{...mapping[index],field:mapping[index].field,value:mapping[index].field!=null&&mapping[index].field!==""?newMatchValue:"",operator:"equals",severity:severity}];handleFieldValueChange(newMappingItems,index)},[mapping,handleFieldValueChange]);const handleSeverityMappingChecked=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setValue({value:value,mapping:[...mapping],isMappingChecked:!isMappingChecked})},[isMappingChecked,mapping,value,setValue]);const severityLabel=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,SEVERITY)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},SEVERITY_DESCRIPTION)),[]);const severityMappingLabel=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"s",onClick:!isDisabled?handleSeverityMappingChecked:external_kbnSharedDeps_LodashFp_["noop"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCheckbox"],{id:`severity-mapping-override`,checked:isMappingChecked,disabled:isDisabled,onChange:handleSeverityMappingChecked})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,SEVERITY_MAPPING)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(NestedContent,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},SEVERITY_MAPPING_DESCRIPTION))),[handleSeverityMappingChecked,isDisabled,isMappingChecked]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:severityLabel,labelAppend:field.labelAppend,helpText:field.helpText,error:"errorMessage",isInvalid:false,fullWidth:true,"data-test-subj":"detectionEngineStepAboutRuleSeverity",describedByIds:["detectionEngineStepAboutRuleSeverity"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSuperSelect"],{fullWidth:false,disabled:false,valueOfSelected:value,onChange:handleDefaultSeverityChange,options:options,"data-test-subj":"select"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:severityMappingLabel,labelAppend:field.labelAppend,helpText:isMappingChecked?external_kbnSharedDeps_React_default.a.createElement(NestedContent,null,SEVERITY_MAPPING_DETAILS):"",error:"errorMessage",isInvalid:false,fullWidth:true,"data-test-subj":`${dataTestSubj}-severityOverride`,describedByIds:idAria?[idAria]:undefined},external_kbnSharedDeps_React_default.a.createElement(NestedContent,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),isMappingChecked&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemComboBoxColumn,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,SOURCE_FIELD)),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemComboBoxColumn,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,SOURCE_VALUE)),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemIconColumn,{grow:false}),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemSeverityColumn,{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,DEFAULT_SEVERITY)))),mapping.map((severityMappingItem,index)=>{var _options$find;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:`${severityMappingItem.severity}-${index}`},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{"data-test-subj":"severityOverrideRow",alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemComboBoxColumn,null,external_kbnSharedDeps_React_default.a.createElement(autocomplete_field["a"],{placeholder:"",selectedField:getFieldTypeByMapping(severityMappingItem,indices),isLoading:false,isDisabled:isDisabled,isClearable:false,indexPattern:indices,onChange:handleFieldChange.bind(null,index,severityMappingItem.severity),"data-test-subj":`detectionEngineStepAboutRuleSeverityMappingField-${severityMappingItem.severity}-${index}`,"aria-label":`detectionEngineStepAboutRuleSeverityMappingField-${severityMappingItem.severity}-${index}`})),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemComboBoxColumn,null,external_kbnSharedDeps_React_default.a.createElement(field_value_match["a"],{placeholder:"",selectedField:getFieldTypeByMapping(severityMappingItem,indices),selectedValue:severityMappingItem.value,isClearable:false,isDisabled:isDisabled,isLoading:false,indexPattern:indices,onChange:handleFieldMatchValueChange.bind(null,index,severityMappingItem.severity),"data-test-subj":`detectionEngineStepAboutRuleSeverityMappingValue-${severityMappingItem.severity}-${index}`,"aria-label":`detectionEngineStepAboutRuleSeverityMappingValue-${severityMappingItem.severity}-${index}`})),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemIconColumn,{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"sortRight"})),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemSeverityColumn,{grow:false},(_options$find=options.find(o=>o.value===severityMappingItem.severity))===null||_options$find===void 0?void 0:_options$find.inputDisplay)))}))))))};const getFieldTypeByMapping=(mapping,pattern)=>{const{field:field}=mapping;const[knownFieldType]=pattern.fields.filter(({name:name})=>field===name);return knownFieldType!==null&&knownFieldType!==void 0?knownFieldType:{name:field,type:"string"}};const risk_score_mapping_NestedContent=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"NestedContent",componentId:"sc-1k1nimg-0"})(["margin-left:24px;"]);const risk_score_mapping_EuiFlexItemComboBoxColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"EuiFlexItemComboBoxColumn",componentId:"sc-1k1nimg-1"})(["max-width:376px;"]);const risk_score_mapping_EuiFlexItemIconColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"EuiFlexItemIconColumn",componentId:"sc-1k1nimg-2"})(["width:20px;"]);const EuiFlexItemRiskScoreColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"EuiFlexItemRiskScoreColumn",componentId:"sc-1k1nimg-3"})(["width:160px;"]);const RiskScoreField=({dataTestSubj:dataTestSubj,field:field,idAria:idAria,indices:indices,isDisabled:isDisabled,placeholder:placeholder})=>{const{value:value,isMappingChecked:isMappingChecked,mapping:mapping}=field.value;const{setValue:setValue}=field;const fieldTypeFilter=Object(external_kbnSharedDeps_React_["useMemo"])(()=>["number"],[]);const selectedField=Object(external_kbnSharedDeps_React_["useMemo"])(()=>risk_score_mapping_getFieldTypeByMapping(mapping,indices),[mapping,indices]);const handleDefaultRiskScoreChange=Object(external_kbnSharedDeps_React_["useCallback"])(e=>{const range=e.target.value;setValue({value:Number(range.trim()),isMappingChecked:isMappingChecked,mapping:mapping})},[setValue,isMappingChecked,mapping]);const handleRiskScoreMappingChange=Object(external_kbnSharedDeps_React_["useCallback"])(([newField])=>{var _newField$name;setValue({value:value,isMappingChecked:isMappingChecked,mapping:[{field:(_newField$name=newField===null||newField===void 0?void 0:newField.name)!==null&&_newField$name!==void 0?_newField$name:"",operator:"equals",value:"",risk_score:undefined}]})},[setValue,value,isMappingChecked]);const handleRiskScoreMappingChecked=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setValue({value:value,isMappingChecked:!isMappingChecked,mapping:[...mapping]})},[setValue,value,isMappingChecked,mapping]);const riskScoreLabel=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,DEFAULT_RISK_SCORE)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},RISK_SCORE_DESCRIPTION)),[]);const riskScoreMappingLabel=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"s",onClick:!isDisabled?handleRiskScoreMappingChecked:external_kbnSharedDeps_LodashFp_["noop"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCheckbox"],{id:`risk_score-mapping-override`,checked:isMappingChecked,disabled:isDisabled,onChange:handleRiskScoreMappingChecked})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,RISK_SCORE_MAPPING)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(risk_score_mapping_NestedContent,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},RISK_SCORE_MAPPING_DESCRIPTION))),[isMappingChecked,handleRiskScoreMappingChecked,isDisabled]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:riskScoreLabel,labelAppend:field.labelAppend,helpText:field.helpText,error:"errorMessage",isInvalid:false,fullWidth:true,"data-test-subj":`${dataTestSubj}-defaultRisk`,describedByIds:idAria?[idAria]:undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiRange"],{value:value,onChange:handleDefaultRiskScoreChange,max:100,min:0,showRange:true,showInput:true,fullWidth:false,showTicks:true,tickInterval:25,"data-test-subj":`${dataTestSubj}-defaultRiskRange`}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:riskScoreMappingLabel,labelAppend:field.labelAppend,helpText:isMappingChecked?external_kbnSharedDeps_React_default.a.createElement(risk_score_mapping_NestedContent,null,RISK_SCORE_MAPPING_DETAILS):"",error:"errorMessage",isInvalid:false,fullWidth:true,"data-test-subj":`${dataTestSubj}-riskOverride`,describedByIds:idAria?[idAria]:undefined},external_kbnSharedDeps_React_default.a.createElement(risk_score_mapping_NestedContent,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),isMappingChecked&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(risk_score_mapping_EuiFlexItemComboBoxColumn,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,translations_SOURCE_FIELD)),external_kbnSharedDeps_React_default.a.createElement(risk_score_mapping_EuiFlexItemIconColumn,{grow:false}),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemRiskScoreColumn,{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormLabel"],null,DEFAULT_RISK_SCORE)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(risk_score_mapping_EuiFlexItemComboBoxColumn,null,external_kbnSharedDeps_React_default.a.createElement(autocomplete_field["a"],{placeholder:placeholder!==null&&placeholder!==void 0?placeholder:"",indexPattern:indices,selectedField:selectedField,fieldTypeFilter:fieldTypeFilter,isLoading:false,isClearable:false,isDisabled:isDisabled,onChange:handleRiskScoreMappingChange,"data-test-subj":dataTestSubj,"aria-label":idAria})),external_kbnSharedDeps_React_default.a.createElement(risk_score_mapping_EuiFlexItemIconColumn,{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"sortRight"})),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemRiskScoreColumn,{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},RISK_SCORE_FIELD)))))))))};const risk_score_mapping_getFieldTypeByMapping=(mapping,pattern)=>{var _mapping$0$field,_mapping$;const field=(_mapping$0$field=mapping===null||mapping===void 0?void 0:(_mapping$=mapping[0])===null||_mapping$===void 0?void 0:_mapping$.field)!==null&&_mapping$0$field!==void 0?_mapping$0$field:"";const[knownFieldType]=pattern.fields.filter(({name:name})=>field!=null&&field===name);return knownFieldType!==null&&knownFieldType!==void 0?knownFieldType:{name:field,type:"number"}};const AutocompleteField=({dataTestSubj:dataTestSubj,field:field,idAria:idAria,indices:indices,isDisabled:isDisabled,fieldType:fieldType,placeholder:placeholder})=>{const handleFieldChange=Object(external_kbnSharedDeps_React_["useCallback"])(([newField])=>{var _newField$name;field.setValue((_newField$name=newField===null||newField===void 0?void 0:newField.name)!==null&&_newField$name!==void 0?_newField$name:"")},[field]);const selectedField=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _ref;const existingField=(_ref=field.value)!==null&&_ref!==void 0?_ref:"";const[newSelectedField]=indices.fields.filter(({name:name})=>existingField!=null&&existingField===name);return newSelectedField},[field.value,indices]);const fieldTypeFilter=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[fieldType],[fieldType]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:undefined,fullWidth:true,helpText:field.helpText,label:field.label,labelAppend:field.labelAppend},external_kbnSharedDeps_React_default.a.createElement(autocomplete_field["a"],{placeholder:placeholder!==null&&placeholder!==void 0?placeholder:"",indexPattern:indices,selectedField:selectedField,fieldTypeFilter:fieldTypeFilter,isLoading:false,isDisabled:isDisabled,isClearable:false,onChange:handleFieldChange,"data-test-subj":dataTestSubj,"aria-label":idAria,fieldInputWidth:500}))};const step_about_rule_CommonUseField=Object(shared_imports["x"])({component:shared_imports["d"]});const ThreeQuartersContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"ThreeQuartersContainer",componentId:"sc-1nsr0kk-0"})(["max-width:740px;"]);ThreeQuartersContainer.displayName="ThreeQuartersContainer";const TagContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"TagContainer",componentId:"sc-1nsr0kk-1"})(["margin-top:16px;"]);TagContainer.displayName="TagContainer";const StepAboutRuleComponent=({addPadding:addPadding=false,defaultValues:defaultValues,defineRuleData:defineRuleData,descriptionColumns:descriptionColumns="singleSplit",isReadOnlyView:isReadOnlyView,isUpdateView:isUpdateView=false,isLoading:isLoading,onSubmit:onSubmit,setForm:setForm})=>{var _defineRuleData$index;const initialState=defaultValues!==null&&defaultValues!==void 0?defaultValues:stepAboutDefaultValue;const[severityValue,setSeverityValue]=Object(external_kbnSharedDeps_React_["useState"])(initialState.severity.value);const[indexPatternLoading,{indexPatterns:indexPatterns}]=Object(source["b"])((_defineRuleData$index=defineRuleData===null||defineRuleData===void 0?void 0:defineRuleData.index)!==null&&_defineRuleData$index!==void 0?_defineRuleData$index:[]);const{form:form}=Object(shared_imports["I"])({defaultValue:initialState,options:{stripEmptyFields:false},schema:step_about_rule_schema_schema});const{getFields:getFields,getFormData:getFormData,submit:submit}=form;const[{severity:formSeverity}]=Object(shared_imports["K"])({form:form,watch:["severity"]});Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const formSeverityValue=formSeverity===null||formSeverity===void 0?void 0:formSeverity.value;if(formSeverityValue!=null&&formSeverityValue!==severityValue){setSeverityValue(formSeverityValue);const newRiskScoreValue=defaultRiskScoreBySeverity[formSeverityValue];if(newRiskScoreValue!=null){const riskScoreField=getFields().riskScore;riskScoreField.setValue({...riskScoreField.value,value:newRiskScoreValue})}}},[formSeverity===null||formSeverity===void 0?void 0:formSeverity.value,getFields,severityValue]);const getData=Object(external_kbnSharedDeps_React_["useCallback"])(async()=>{const result=await submit();return result!==null&&result!==void 0&&result.isValid?result:{isValid:false,data:getFormData()}},[getFormData,submit]);const handleSubmit=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(onSubmit){onSubmit()}},[onSubmit]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let didCancel=false;if(setForm&&!didCancel){setForm(rules_types["a"].aboutRule,getData)}return()=>{didCancel=true}},[getData,setForm]);return isReadOnlyView?external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{"data-test-subj":"aboutStep",addPadding:addPadding},external_kbnSharedDeps_React_default.a.createElement(StepRuleDescription,{columns:descriptionColumns,schema:step_about_rule_schema_schema,data:initialState})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{addPadding:!isUpdateView},external_kbnSharedDeps_React_default.a.createElement(shared_imports["e"],{form:form},external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"name",componentProps:{idAria:"detectionEngineStepAboutRuleName","data-test-subj":"detectionEngineStepAboutRuleName",euiFieldProps:{fullWidth:true,disabled:isLoading}}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"description",componentProps:{idAria:"detectionEngineStepAboutRuleDescription","data-test-subj":"detectionEngineStepAboutRuleDescription",euiFieldProps:{disabled:isLoading,compressed:true,fullWidth:true}}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"severity",component:SeverityField,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleSeverityField",idAria:"detectionEngineStepAboutRuleSeverityField",isDisabled:isLoading||indexPatternLoading,options:severityOptions,indices:indexPatterns}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"riskScore",component:RiskScoreField,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleRiskScore",idAria:"detectionEngineStepAboutRuleRiskScore",isDisabled:isLoading||indexPatternLoading,indices:indexPatterns}})),external_kbnSharedDeps_React_default.a.createElement(TagContainer,null,external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"tags",componentProps:{idAria:"detectionEngineStepAboutRuleTags","data-test-subj":"detectionEngineStepAboutRuleTags",euiFieldProps:{fullWidth:true,isDisabled:isLoading||indexPatternLoading,placeholder:""}}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAccordion"],{"data-test-subj":"advancedSettings",id:"advancedSettingsAccordion",buttonContent:ADVANCED_SETTINGS},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"references",component:AddItem,componentProps:{addText:ADD_REFERENCE,idAria:"detectionEngineStepAboutRuleReferenceUrls",isDisabled:isLoading,dataTestSubj:"detectionEngineStepAboutRuleReferenceUrls",validate:utils_validators["a"]}}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"falsePositives",component:AddItem,componentProps:{addText:ADD_FALSE_POSITIVE,idAria:"detectionEngineStepAboutRuleFalsePositives",isDisabled:isLoading,dataTestSubj:"detectionEngineStepAboutRuleFalsePositives"}}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"threat",component:AddMitreAttackThreat,componentProps:{idAria:"detectionEngineStepAboutRuleMitreThreat",isDisabled:isLoading,dataTestSubj:"detectionEngineStepAboutRuleMitreThreat"}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"note",component:eui_form["a"],componentProps:{idAria:"detectionEngineStepAboutRuleNote",isDisabled:isLoading,dataTestSubj:"detectionEngineStepAboutRuleNote",placeholder:ADD_RULE_NOTE_HELP_TEXT}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"author",componentProps:{idAria:"detectionEngineStepAboutRuleAuthor","data-test-subj":"detectionEngineStepAboutRuleAuthor",euiFieldProps:{fullWidth:true,isDisabled:isLoading,placeholder:""}}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"license",componentProps:{idAria:"detectionEngineStepAboutRuleLicense","data-test-subj":"detectionEngineStepAboutRuleLicense",euiFieldProps:{fullWidth:true,disabled:isLoading,placeholder:""}}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:GLOBAL_ENDPOINT_EXCEPTION_LIST,fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"isAssociatedToEndpointList",componentProps:{idAria:"detectionEngineStepAboutRuleAssociatedToEndpointList","data-test-subj":"detectionEngineStepAboutRuleAssociatedToEndpointList",euiFieldProps:{disabled:isLoading}}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:BUILDING_BLOCK,fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"isBuildingBlock",componentProps:{idAria:"detectionEngineStepAboutRuleBuildingBlock","data-test-subj":"detectionEngineStepAboutRuleBuildingBlock",euiFieldProps:{disabled:isLoading}}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),Object(utils["f"])(defineRuleData===null||defineRuleData===void 0?void 0:defineRuleData.ruleType)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"threatIndicatorPath",componentProps:{idAria:"detectionEngineStepAboutThreatIndicatorPath","data-test-subj":"detectionEngineStepAboutThreatIndicatorPath",euiFieldProps:{fullWidth:true,disabled:isLoading,placeholder:constants["w"]}}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"ruleNameOverride",component:AutocompleteField,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleRuleNameOverride",fieldType:"string",idAria:"detectionEngineStepAboutRuleRuleNameOverride",indices:indexPatterns,isDisabled:isLoading||indexPatternLoading,placeholder:""}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"timestampOverride",component:AutocompleteField,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleTimestampOverride",fieldType:"date",idAria:"detectionEngineStepAboutRuleTimestampOverride",indices:indexPatterns,isDisabled:isLoading||indexPatternLoading,placeholder:""}})))),!isUpdateView&&external_kbnSharedDeps_React_default.a.createElement(NextStep,{dataTestSubj:"about-continue",onClick:handleSubmit,isDisabled:isLoading}))};const StepAboutRule=Object(external_kbnSharedDeps_React_["memo"])(StepAboutRuleComponent);const SECONDS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.secondsOptionDescription",{defaultMessage:"Seconds"});const MINUTES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.minutesOptionDescription",{defaultMessage:"Minutes"});const HOURS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.hoursOptionDescription",{defaultMessage:"Hours"});const INVALID_TIME=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.invalidTimeMessageDescription",{defaultMessage:"A time is required."});function schedule_item_form_extends(){schedule_item_form_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return schedule_item_form_extends.apply(this,arguments)}const timeTypeOptions=[{value:"s",text:SECONDS},{value:"m",text:MINUTES},{value:"h",text:HOURS}];const StyledLabelAppend=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"StyledLabelAppend",componentId:"d3i8n6-0"})(["&.euiFlexItem.euiFlexItem--flexGrowZero{margin-left:31px;}"]);const schedule_item_form_StyledEuiFormRow=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFormRow"]).withConfig({displayName:"StyledEuiFormRow",componentId:"d3i8n6-1"})(["max-width:none;.euiFormControlLayout{max-width:200px !important;}.euiFormControlLayout__childrenWrapper > *:first-child{box-shadow:none;height:38px;}.euiFormControlLayout:not(:first-child){border-left:1px solid ",";}"],({theme:theme})=>theme.eui.euiColorLightShade);const MyEuiSelect=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiSelect"]).withConfig({displayName:"MyEuiSelect",componentId:"d3i8n6-2"})(["width:auto;"]);const getNumberFromUserInput=(input,defaultValue=0)=>{const number=parseInt(input,10);if(Number.isNaN(number)){return defaultValue}else{return Math.min(number,Number.MAX_SAFE_INTEGER)}};const ScheduleItem=({dataTestSubj:dataTestSubj,field:field,idAria:idAria,isDisabled:isDisabled,minimumValue:minimumValue=0})=>{const[timeType,setTimeType]=Object(external_kbnSharedDeps_React_["useState"])("s");const[timeVal,setTimeVal]=Object(external_kbnSharedDeps_React_["useState"])(0);const{isInvalid:isInvalid,errorMessage:errorMessage}=Object(shared_imports["w"])(field);const{value:value,setValue:setValue}=field;const onChangeTimeType=Object(external_kbnSharedDeps_React_["useCallback"])(e=>{setTimeType(e.target.value);setValue(`${timeVal}${e.target.value}`)},[setValue,timeVal]);const onChangeTimeVal=Object(external_kbnSharedDeps_React_["useCallback"])(e=>{const sanitizedValue=getNumberFromUserInput(e.target.value,minimumValue);setTimeVal(sanitizedValue);setValue(`${sanitizedValue}${timeType}`)},[minimumValue,setValue,timeType]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(value!==`${timeVal}${timeType}`){const filterTimeVal=value.match(/\d+/g);const filterTimeType=value.match(/[a-zA-Z]+/g);if(!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(filterTimeVal)&&filterTimeVal!=null&&!isNaN(Number(filterTimeVal[0]))&&Number(filterTimeVal[0])!==Number(timeVal)){setTimeVal(Number(filterTimeVal[0]))}if(!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(filterTimeType)&&filterTimeType!=null&&["s","m","h"].includes(filterTimeType[0])&&filterTimeType[0]!==timeType){setTimeType(filterTimeType[0])}}},[timeType,timeVal,value]);const rest={disabled:isDisabled};const label=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",justifyContent:"flexStart",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,component:"span"},field.label),external_kbnSharedDeps_React_default.a.createElement(StyledLabelAppend,{grow:false,component:"span"},field.labelAppend)),[field.label,field.labelAppend]);return external_kbnSharedDeps_React_default.a.createElement(schedule_item_form_StyledEuiFormRow,{label:label,helpText:field.helpText,error:errorMessage,isInvalid:isInvalid,fullWidth:false,"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormControlLayout"],{append:external_kbnSharedDeps_React_default.a.createElement(MyEuiSelect,schedule_item_form_extends({fullWidth:false,options:timeTypeOptions,onChange:onChangeTimeType,value:timeType,"data-test-subj":"timeType"},rest))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],schedule_item_form_extends({fullWidth:true,min:minimumValue,max:Number.MAX_SAFE_INTEGER,onChange:onChangeTimeVal,value:timeVal,"data-test-subj":"interval"},rest))))};const step_schedule_rule_schema_schema={interval:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalLabel",{defaultMessage:"Runs every"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalHelpText",{defaultMessage:"Rules run periodically and detect alerts within the specified time frame."})},from:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackLabel",{defaultMessage:"Additional look-back time"}),labelAppend:OptionalFieldLabel,helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackHelpText",{defaultMessage:"Adds time to the look-back period to prevent missed alerts."})}};const stepScheduleDefaultValue={interval:"5m",from:"1m"};const StepScheduleRuleComponent=({addPadding:addPadding=false,defaultValues:defaultValues,descriptionColumns:descriptionColumns="singleSplit",isReadOnlyView:isReadOnlyView,isLoading:isLoading,isUpdateView:isUpdateView=false,onSubmit:onSubmit,setForm:setForm})=>{const initialState=defaultValues!==null&&defaultValues!==void 0?defaultValues:stepScheduleDefaultValue;const{form:form}=Object(shared_imports["I"])({defaultValue:initialState,options:{stripEmptyFields:false},schema:step_schedule_rule_schema_schema});const{getFormData:getFormData,submit:submit}=form;const handleSubmit=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(onSubmit){onSubmit()}},[onSubmit]);const getData=Object(external_kbnSharedDeps_React_["useCallback"])(async()=>{const result=await submit();return result!==null&&result!==void 0&&result.isValid?result:{isValid:false,data:getFormData()}},[getFormData,submit]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let didCancel=false;if(setForm&&!didCancel){setForm(rules_types["a"].scheduleRule,getData)}return()=>{didCancel=true}},[getData,setForm]);return isReadOnlyView?external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{addPadding:addPadding},external_kbnSharedDeps_React_default.a.createElement(StepRuleDescription,{columns:descriptionColumns,schema:step_schedule_rule_schema_schema,data:initialState})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{addPadding:!isUpdateView},external_kbnSharedDeps_React_default.a.createElement(shared_imports["e"],{form:form,"data-test-subj":"stepScheduleRule"},external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"interval",component:ScheduleItem,componentProps:{idAria:"detectionEngineStepScheduleRuleInterval",isDisabled:isLoading,dataTestSubj:"detectionEngineStepScheduleRuleInterval"}}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"from",component:ScheduleItem,componentProps:{idAria:"detectionEngineStepScheduleRuleFrom",isDisabled:isLoading,dataTestSubj:"detectionEngineStepScheduleRuleFrom",minimumValue:1}}))),!isUpdateView&&external_kbnSharedDeps_React_default.a.createElement(NextStep,{dataTestSubj:"schedule-continue",onClick:handleSubmit,isDisabled:isLoading}))};const StepScheduleRule=Object(external_kbnSharedDeps_React_["memo"])(StepScheduleRuleComponent);var react_markdown=__webpack_require__(1086);var react_markdown_default=__webpack_require__.n(react_markdown);var triggersActionsUi_public_=__webpack_require__(99);const FORM_ERRORS_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.ruleActionsField.ruleActionsFormErrorsTitle",{defaultMessage:"Please fix issues listed below"});const DEFAULT_ACTION_GROUP_ID="default";const DEFAULT_ACTION_MESSAGE="Rule {{context.rule.name}} generated {{state.signals_count}} alerts";const FieldErrorsContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"FieldErrorsContainer",componentId:"sc-1brsijn-0"})(["p{margin-bottom:0;}"]);const ContainerActions=external_kbnSharedDeps_StyledComponents_default.a.div.attrs(({className:className="",$caseIndexes:$caseIndexes=[]})=>({className:className})).withConfig({displayName:"ContainerActions",componentId:"sc-1brsijn-1"})(["",""],({$caseIndexes:$caseIndexes})=>$caseIndexes.map(index=>`\n        div[id="${index}"].euiAccordion__childWrapper .euiAccordion__padding--l {\n          padding: 0px;\n          .euiFlexGroup {\n            display: none;\n          }\n          .euiSpacer.euiSpacer--xl {\n            height: 0px;\n          }\n        }\n      `));const getSupportedActions=(actionTypes,hasErrorOnCreationCaseAction)=>actionTypes.filter(actionType=>{if(actionType.id===".case"&&hasErrorOnCreationCaseAction){return false}return constants["W"].includes(actionType.id)});const RuleActionsField=({field:field,hasErrorOnCreationCaseAction:hasErrorOnCreationCaseAction,messageVariables:messageVariables})=>{const[fieldErrors,setFieldErrors]=Object(external_kbnSharedDeps_React_["useState"])(null);const[supportedActionTypes,setSupportedActionTypes]=Object(external_kbnSharedDeps_React_["useState"])();const form=Object(shared_imports["J"])();const{isSubmitted:isSubmitted,isSubmitting:isSubmitting,isValid:isValid}=form;const{http:http,triggersActionsUi:{actionTypeRegistry:actionTypeRegistry}}=Object(lib_kibana["h"])().services;const actions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(field.value)?field.value:[],[field.value]);const caseActionIndexes=Object(external_kbnSharedDeps_React_["useMemo"])(()=>actions.reduce((acc,action,actionIndex)=>{if(action.actionTypeId===".case"){return[...acc,`${actionIndex}`]}return acc},[]),[actions]);const setActionIdByIndex=Object(external_kbnSharedDeps_React_["useCallback"])((id,index)=>{const updatedActions=[...actions];updatedActions[index]=cjs_default()(updatedActions[index],{id:id});field.setValue(updatedActions)},[field.setValue,actions]);const setAlertActionsProperty=Object(external_kbnSharedDeps_React_["useCallback"])(updatedActions=>field.setValue(updatedActions),[field]);const setActionParamsProperty=Object(external_kbnSharedDeps_React_["useCallback"])((key,value,index)=>{const updatedActions=[...actions];updatedActions[index].params[key]=value;field.setValue(updatedActions)},[field.setValue,actions]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{(async function(){const actionTypes=await Object(triggersActionsUi_public_["loadActionTypes"])({http:http});const supportedTypes=getSupportedActions(actionTypes,hasErrorOnCreationCaseAction);setSupportedActionTypes(supportedTypes)})()},[hasErrorOnCreationCaseAction]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(isSubmitting||!field.errors.length){return setFieldErrors(null)}if(isSubmitted&&!isSubmitting&&isValid===false&&field.errors.length){const errorsString=field.errors.map(({message:message})=>message).join("\n");return setFieldErrors(errorsString)}},[isSubmitted,isSubmitting,field.isChangingValue,isValid,field.errors,setFieldErrors]);if(!supportedActionTypes)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null);return external_kbnSharedDeps_React_default.a.createElement(ContainerActions,{$caseIndexes:caseActionIndexes},fieldErrors?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(FieldErrorsContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:FORM_ERRORS_TITLE,color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement(react_markdown_default.a,{source:fieldErrors}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)):null,external_kbnSharedDeps_React_default.a.createElement(triggersActionsUi_public_["ActionForm"],{actions:actions,messageVariables:messageVariables,defaultActionGroupId:DEFAULT_ACTION_GROUP_ID,setActionIdByIndex:setActionIdByIndex,setActions:setAlertActionsProperty,setActionParamsProperty:setActionParamsProperty,actionTypeRegistry:actionTypeRegistry,actionTypes:supportedActionTypes,defaultActionMessage:DEFAULT_ACTION_MESSAGE}))};const COMPLETE_WITHOUT_ACTIVATING=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.completeWithoutActivatingTitle",{defaultMessage:"Create rule without activating it"});const COMPLETE_WITH_ACTIVATING=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.completeWithActivatingTitle",{defaultMessage:"Create & activate rule"});const NO_CONNECTOR_SELECTED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.noConnectorSelectedErrorMessage",{defaultMessage:"No connector selected"});const NO_ACTIONS_READ_PERMISSIONS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.noReadActionsPrivileges",{defaultMessage:'Cannot create rule actions. You do not have "Read" permissions for the "Actions" plugin.'});const INVALID_MUSTACHE_TEMPLATE=paramKey=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.invalidMustacheTemplateErrorMessage",{defaultMessage:"{key} is not valid mustache template",values:{key:Object(external_kbnSharedDeps_LodashFp_["startCase"])(paramKey)}});var mustache=__webpack_require__(1165);var mustache_default=__webpack_require__.n(mustache);const UUID_REGEX=/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i;const isUuid=id=>!!id.match(UUID_REGEX);const utils_getActionTypeName=actionTypeId=>{if(!actionTypeId)return"";const actionType=actionTypeId.split(".")[1];if(!actionType)return"";return Object(external_kbnSharedDeps_LodashFp_["startCase"])(actionType)};const validateMustache=params=>{const errors=[];Object.entries(params).forEach(([paramKey,paramValue])=>{if(!Object(external_kbnSharedDeps_LodashFp_["isString"])(paramValue))return;try{mustache_default.a.render(paramValue,{})}catch(e){errors.push(INVALID_MUSTACHE_TEMPLATE(paramKey))}});return errors};const validateActionParams=(actionItem,actionTypeRegistry)=>{var _actionTypeRegistry$g;const actionErrors=(_actionTypeRegistry$g=actionTypeRegistry.get(actionItem.actionTypeId))===null||_actionTypeRegistry$g===void 0?void 0:_actionTypeRegistry$g.validateParams(actionItem.params);if(actionErrors){const actionErrorsValues=Object.values(actionErrors.errors);if(actionErrorsValues.length){const filteredObjects=actionErrorsValues.filter(item=>Object(external_kbnSharedDeps_LodashFp_["isString"])(item)||Object(external_kbnSharedDeps_LodashFp_["isArray"])(item));const uniqActionErrors=Object(external_kbnSharedDeps_LodashFp_["uniq"])(Object(external_kbnSharedDeps_LodashFp_["flattenDeep"])(filteredObjects));if(uniqActionErrors.length){return uniqActionErrors}}}return[]};const validateSingleAction=(actionItem,actionTypeRegistry)=>{if(!isUuid(actionItem.id)){return[NO_CONNECTOR_SELECTED]}const actionParamsErrors=validateActionParams(actionItem,actionTypeRegistry);const mustacheErrors=validateMustache(actionItem.params);return[...actionParamsErrors,...mustacheErrors]};const validateRuleActionsField=actionTypeRegistry=>(...data)=>{const[{value:value,path:path}]=data;const errors=value.reduce((acc,actionItem)=>{const errorsArray=validateSingleAction(actionItem,actionTypeRegistry);if(errorsArray.length){const actionTypeName=utils_getActionTypeName(actionItem.actionTypeId);const errorsListItems=errorsArray.map(error=>`*   ${error}\n`);return[...acc,`\n**${actionTypeName}:**\n${errorsListItems.join("")}`]}return acc},[]);if(errors.length){return{code:"ERR_FIELD_FORMAT",path:path,message:`${errors.join("\n")}`}}};const getSchema=({actionTypeRegistry:actionTypeRegistry})=>({actions:{validations:[{validator:validateRuleActionsField(actionTypeRegistry)}]},enabled:{},kibanaSiemAppUrl:{},throttle:{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.fieldThrottleLabel",{defaultMessage:"Actions frequency"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.fieldThrottleHelpText",{defaultMessage:"Select when automated actions should be performed if a rule evaluates as true."})}});var common_constants=__webpack_require__(306);const CASE_ACTION_NAME="Cases";const useManageCaseAction=()=>{const hasInit=Object(external_kbnSharedDeps_React_["useRef"])(true);const[loading,setLoading]=Object(external_kbnSharedDeps_React_["useState"])(true);const[hasError,setHasError]=Object(external_kbnSharedDeps_React_["useState"])(false);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const abortCtrl=new AbortController;const fetchActions=async()=>{try{const actions=await lib_kibana["b"].get().http.fetch(common_constants["b"],{method:"GET",signal:abortCtrl.signal});if(!actions.some(a=>a.actionTypeId===".case"&&a.name===CASE_ACTION_NAME)){await lib_kibana["b"].get().http.post(`${common_constants["b"]}/action`,{method:"POST",body:JSON.stringify({actionTypeId:".case",config:{},name:CASE_ACTION_NAME,secrets:{}}),signal:abortCtrl.signal})}setLoading(false)}catch{setLoading(false);setHasError(true)}};if(hasInit.current){hasInit.current=false;fetchActions()}return()=>{abortCtrl.abort()}},[]);return[loading,hasError]};const stepActionsDefaultValue={enabled:true,actions:[],kibanaSiemAppUrl:"",throttle:DEFAULT_THROTTLE_OPTION.value};const GhostFormField=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null);const getThrottleOptions=throttle=>{if(throttle&&Object(external_kbnSharedDeps_LodashFp_["findIndex"])(["value",throttle],THROTTLE_OPTIONS)<0){return[...THROTTLE_OPTIONS,{value:throttle,text:throttle}]}return THROTTLE_OPTIONS};const StepRuleActionsComponent=({addPadding:addPadding=false,defaultValues:defaultValues,isReadOnlyView:isReadOnlyView,isLoading:isLoading,isUpdateView:isUpdateView=false,onSubmit:onSubmit,setForm:setForm,actionMessageParams:actionMessageParams})=>{const[isLoadingCaseAction,hasErrorOnCreationCaseAction]=useManageCaseAction();const{services:{application:application,triggersActionsUi:{actionTypeRegistry:actionTypeRegistry}}}=Object(lib_kibana["h"])();const kibanaAbsoluteUrl=Object(external_kbnSharedDeps_React_["useMemo"])(()=>application.getUrlForApp(`${constants["f"]}`,{absolute:true}),[application]);const initialState={...defaultValues!==null&&defaultValues!==void 0?defaultValues:stepActionsDefaultValue,kibanaSiemAppUrl:kibanaAbsoluteUrl};const schema=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getSchema({actionTypeRegistry:actionTypeRegistry}),[actionTypeRegistry]);const{form:form}=Object(shared_imports["I"])({defaultValue:initialState,options:{stripEmptyFields:false},schema:schema});const{getFields:getFields,getFormData:getFormData,submit:submit}=form;const[{throttle:formThrottle}]=Object(shared_imports["K"])({form:form,watch:["throttle"]});const throttle=formThrottle||initialState.throttle;const handleSubmit=Object(external_kbnSharedDeps_React_["useCallback"])(enabled=>{getFields().enabled.setValue(enabled);if(onSubmit){onSubmit()}},[getFields,onSubmit]);const getData=Object(external_kbnSharedDeps_React_["useCallback"])(async()=>{const result=await submit();return result!==null&&result!==void 0&&result.isValid?result:{isValid:false,data:getFormData()}},[getFormData,submit]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let didCancel=false;if(setForm&&!didCancel){setForm(rules_types["a"].ruleActions,getData)}return()=>{didCancel=true}},[getData,setForm]);const throttleOptions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getThrottleOptions(throttle),[throttle]);const throttleFieldComponentProps=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({idAria:"detectionEngineStepRuleActionsThrottle",isDisabled:isLoading,isLoading:isLoadingCaseAction,dataTestSubj:"detectionEngineStepRuleActionsThrottle",hasNoInitialSelection:false,euiFieldProps:{options:throttleOptions}}),[isLoading,isLoadingCaseAction,throttleOptions]);const displayActionsOptions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>throttle!==stepActionsDefaultValue.throttle?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"actions",component:RuleActionsField,componentProps:{messageVariables:actionMessageParams,hasErrorOnCreationCaseAction:hasErrorOnCreationCaseAction}})):external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"actions",component:GhostFormField}),[throttle,actionMessageParams,hasErrorOnCreationCaseAction]);const displayActionsDropDown=Object(external_kbnSharedDeps_React_["useMemo"])(()=>application.capabilities.actions.show?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"throttle",component:ThrottleSelectField,componentProps:throttleFieldComponentProps}),displayActionsOptions,external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"kibanaSiemAppUrl",component:GhostFormField}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"enabled",component:GhostFormField})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,NO_ACTIONS_READ_PERMISSIONS),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"throttle",componentProps:throttleFieldComponentProps,component:GhostFormField}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"actions",component:GhostFormField}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"kibanaSiemAppUrl",component:GhostFormField}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"enabled",component:GhostFormField})),[application.capabilities.actions.show,displayActionsOptions,throttleFieldComponentProps]);if(isReadOnlyView){return external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{addPadding:addPadding},external_kbnSharedDeps_React_default.a.createElement(StepRuleDescription,{schema:schema,data:initialState,columns:"single"}))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{addPadding:!isUpdateView},external_kbnSharedDeps_React_default.a.createElement(shared_imports["e"],{form:form,"data-test-subj":"stepRuleActions"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiForm"],null,displayActionsDropDown))),!isUpdateView&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",justifyContent:"flexEnd",gutterSize:"xs",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:false,isDisabled:isLoading,isLoading:isLoading,onClick:()=>handleSubmit(false)},COMPLETE_WITHOUT_ACTIVATING)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:true,isDisabled:isLoading,isLoading:isLoading,onClick:()=>handleSubmit(true),"data-test-subj":"create-activate"},COMPLETE_WITH_ACTIVATING)))))};const StepRuleActions=Object(external_kbnSharedDeps_React_["memo"])(StepRuleActionsComponent);var header_page=__webpack_require__(196);function detection_engine_header_page_extends(){detection_engine_header_page_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return detection_engine_header_page_extends.apply(this,arguments)}const DetectionEngineHeaderPageComponent=props=>external_kbnSharedDeps_React_default.a.createElement(header_page["a"],detection_engine_header_page_extends({hideSourcerer:true},props));const DetectionEngineHeaderPage=external_kbnSharedDeps_React_default.a.memo(DetectionEngineHeaderPageComponent);DetectionEngineHeaderPage.displayName="DetectionEngineHeaderPage";const PAGE_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.pageTitle",{defaultMessage:"Create new rule"});const BACK_TO_RULES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.backToRulesDescription",{defaultMessage:"Back to detection rules"});const EDIT_RULE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.createRule.editRuleButton",{defaultMessage:"Edit"});const SUCCESSFULLY_CREATED_RULES=ruleName=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.create.successfullyCreatedRuleTitle",{values:{ruleName:ruleName},defaultMessage:"{ruleName} was created"});var app_types=__webpack_require__(3);var rules_utils=__webpack_require__(492);const formHookNoop=async()=>undefined;const MyEuiPanel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiPanel"]).withConfig({displayName:"MyEuiPanel",componentId:"wzrzmg-0"})(["position:relative;z-index:",";> .euiAccordion > .euiAccordion__triggerWrapper{.euiAccordion__button{cursor:default !important;&:hover{text-decoration:none !important;}}.euiAccordion__iconWrapper{display:none;}}"],props=>props.zindex);MyEuiPanel.displayName="MyEuiPanel";const StepDefineRuleAccordion=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiAccordion"]).withConfig({displayName:"StepDefineRuleAccordion",componentId:"wzrzmg-1"})([".euiAccordion__childWrapper{overflow:visible;}"]);StepDefineRuleAccordion.displayName="StepDefineRuleAccordion";const CreateRulePageComponent=()=>{var _stepsData$current$Ru,_stepsData$current$Ru2;const[{loading:userInfoLoading,isSignalIndexExists:isSignalIndexExists,isAuthenticated:isAuthenticated,hasEncryptionKey:hasEncryptionKey,canUserCRUD:canUserCRUD}]=Object(user_info["b"])();const{loading:listsConfigLoading,needsConfiguration:needsListsConfiguration}=useListsConfig();const loading=userInfoLoading||listsConfigLoading;const[,dispatchToaster]=Object(toasters["h"])();const[activeStep,setActiveStep]=Object(external_kbnSharedDeps_React_["useState"])(rules_types["a"].defineRule);const getNextStep=step=>rules_utils["b"][rules_utils["b"].indexOf(step)+1];const defineRuleRef=Object(external_kbnSharedDeps_React_["useRef"])(null);const aboutRuleRef=Object(external_kbnSharedDeps_React_["useRef"])(null);const scheduleRuleRef=Object(external_kbnSharedDeps_React_["useRef"])(null);const ruleActionsRef=Object(external_kbnSharedDeps_React_["useRef"])(null);const formHooks=Object(external_kbnSharedDeps_React_["useRef"])({[rules_types["a"].defineRule]:formHookNoop,[rules_types["a"].aboutRule]:formHookNoop,[rules_types["a"].scheduleRule]:formHookNoop,[rules_types["a"].ruleActions]:formHookNoop});const setFormHook=Object(external_kbnSharedDeps_React_["useCallback"])((step,hook)=>{formHooks.current[step]=hook},[]);const stepsData=Object(external_kbnSharedDeps_React_["useRef"])({[rules_types["a"].defineRule]:{isValid:false,data:undefined},[rules_types["a"].aboutRule]:{isValid:false,data:undefined},[rules_types["a"].scheduleRule]:{isValid:false,data:undefined},[rules_types["a"].ruleActions]:{isValid:false,data:undefined}});const setStepData=(step,data)=>{stepsData.current[step]=data};const[openSteps,setOpenSteps]=Object(external_kbnSharedDeps_React_["useState"])({[rules_types["a"].defineRule]:false,[rules_types["a"].aboutRule]:false,[rules_types["a"].scheduleRule]:false,[rules_types["a"].ruleActions]:false});const[{isLoading:isLoading,isSaved:isSaved},setRule]=useCreateRule();const ruleType=(_stepsData$current$Ru=stepsData.current[rules_types["a"].defineRule].data)===null||_stepsData$current$Ru===void 0?void 0:_stepsData$current$Ru.ruleType;const ruleName=(_stepsData$current$Ru2=stepsData.current[rules_types["a"].aboutRule].data)===null||_stepsData$current$Ru2===void 0?void 0:_stepsData$current$Ru2.name;const actionMessageParams=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getActionMessageParams(ruleType),[ruleType]);const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const handleAccordionToggle=Object(external_kbnSharedDeps_React_["useCallback"])((step,isOpen)=>setOpenSteps(_openSteps=>({..._openSteps,[step]:isOpen})),[]);const goToStep=Object(external_kbnSharedDeps_React_["useCallback"])(step=>{if(rules_utils["b"].indexOf(step)>rules_utils["b"].indexOf(activeStep)&&!openSteps[step]){toggleStepAccordion(step)}setActiveStep(step)},[activeStep,openSteps]);const toggleStepAccordion=step=>{if(step===rules_types["a"].defineRule){var _defineRuleRef$curren;(_defineRuleRef$curren=defineRuleRef.current)===null||_defineRuleRef$curren===void 0?void 0:_defineRuleRef$curren.onToggle()}else if(step===rules_types["a"].aboutRule){var _aboutRuleRef$current;(_aboutRuleRef$current=aboutRuleRef.current)===null||_aboutRuleRef$current===void 0?void 0:_aboutRuleRef$current.onToggle()}else if(step===rules_types["a"].scheduleRule){var _scheduleRuleRef$curr;(_scheduleRuleRef$curr=scheduleRuleRef.current)===null||_scheduleRuleRef$curr===void 0?void 0:_scheduleRuleRef$curr.onToggle()}else if(step===rules_types["a"].ruleActions){var _ruleActionsRef$curre;(_ruleActionsRef$curre=ruleActionsRef.current)===null||_ruleActionsRef$curre===void 0?void 0:_ruleActionsRef$curre.onToggle()}};const editStep=Object(external_kbnSharedDeps_React_["useCallback"])(async step=>{const activeStepData=await formHooks.current[activeStep]();if(activeStepData!==null&&activeStepData!==void 0&&activeStepData.isValid){setStepData(activeStep,activeStepData);goToStep(step)}},[activeStep,goToStep]);const submitStep=Object(external_kbnSharedDeps_React_["useCallback"])(async step=>{const stepData=await formHooks.current[step]();if(stepData!==null&&stepData!==void 0&&stepData.isValid){setStepData(step,stepData);const nextStep=getNextStep(step);if(nextStep!=null){goToStep(nextStep)}else{const defineStep=stepsData.current[rules_types["a"].defineRule];const aboutStep=stepsData.current[rules_types["a"].aboutRule];const scheduleStep=stepsData.current[rules_types["a"].scheduleRule];const actionsStep=stepsData.current[rules_types["a"].ruleActions];if(stepIsValid(defineStep)&&stepIsValid(aboutStep)&&stepIsValid(scheduleStep)&&stepIsValid(actionsStep)){setRule(formatRule(defineStep.data,aboutStep.data,scheduleStep.data,actionsStep.data))}}}},[goToStep,setRule]);const getAccordionType=Object(external_kbnSharedDeps_React_["useCallback"])(step=>{if(step===activeStep){return"active"}else if(stepsData.current[step].isValid){return"valid"}return"passive"},[activeStep]);const defineRuleButton=external_kbnSharedDeps_React_default.a.createElement(AccordionTitle,{name:"1",title:rules_translations["H"],type:getAccordionType(rules_types["a"].defineRule)});const aboutRuleButton=external_kbnSharedDeps_React_default.a.createElement(AccordionTitle,{name:"2",title:rules_translations["b"],type:getAccordionType(rules_types["a"].aboutRule)});const scheduleRuleButton=external_kbnSharedDeps_React_default.a.createElement(AccordionTitle,{name:"3",title:rules_translations["rb"],type:getAccordionType(rules_types["a"].scheduleRule)});const ruleActionsButton=external_kbnSharedDeps_React_default.a.createElement(AccordionTitle,{name:"4",title:rules_translations["pb"],type:getAccordionType(rules_types["a"].ruleActions)});if(isSaved&&ruleName){Object(toasters["e"])(SUCCESSFULLY_CREATED_RULES(ruleName),dispatchToaster);history.replace(Object(redirect_to_detection_engine["f"])());return null}if(redirectToDetections(isSignalIndexExists,isAuthenticated,hasEncryptionKey,needsListsConfiguration)){history.replace(Object(redirect_to_detection_engine["c"])());return null}else if(helpers_userHasNoPermissions(canUserCRUD)){history.replace(Object(redirect_to_detection_engine["f"])());return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"row",justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(MaxWidthEuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{backOptions:{href:Object(redirect_to_detection_engine["f"])(),text:BACK_TO_RULES,pageId:app_types["a"].detections},border:true,isLoading:isLoading||loading,title:PAGE_TITLE}),external_kbnSharedDeps_React_default.a.createElement(MyEuiPanel,{zindex:4},external_kbnSharedDeps_React_default.a.createElement(StepDefineRuleAccordion,{initialIsOpen:true,id:rules_types["a"].defineRule,buttonContent:defineRuleButton,paddingSize:"xs",ref:defineRuleRef,onToggle:handleAccordionToggle.bind(null,rules_types["a"].defineRule),extraAction:stepsData.current[rules_types["a"].defineRule].isValid&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"edit-define-rule",iconType:"pencil",size:"xs",onClick:()=>editStep(rules_types["a"].defineRule)},EDIT_RULE)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"m"}),external_kbnSharedDeps_React_default.a.createElement(StepDefineRule,{addPadding:true,defaultValues:stepsData.current[rules_types["a"].defineRule].data,isReadOnlyView:activeStep!==rules_types["a"].defineRule,isLoading:isLoading||loading,setForm:setFormHook,onSubmit:()=>submitStep(rules_types["a"].defineRule),descriptionColumns:"singleSplit"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(MyEuiPanel,{zindex:3},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAccordion"],{initialIsOpen:false,id:rules_types["a"].aboutRule,buttonContent:aboutRuleButton,paddingSize:"xs",ref:aboutRuleRef,onToggle:handleAccordionToggle.bind(null,rules_types["a"].aboutRule),extraAction:stepsData.current[rules_types["a"].aboutRule].isValid&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"edit-about-rule",iconType:"pencil",size:"xs",onClick:()=>editStep(rules_types["a"].aboutRule)},EDIT_RULE)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"m"}),external_kbnSharedDeps_React_default.a.createElement(StepAboutRule,{addPadding:true,defaultValues:stepsData.current[rules_types["a"].aboutRule].data,defineRuleData:stepsData.current[rules_types["a"].defineRule].data,descriptionColumns:"singleSplit",isReadOnlyView:activeStep!==rules_types["a"].aboutRule,isLoading:isLoading||loading,setForm:setFormHook,onSubmit:()=>submitStep(rules_types["a"].aboutRule)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(MyEuiPanel,{zindex:2},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAccordion"],{initialIsOpen:false,id:rules_types["a"].scheduleRule,buttonContent:scheduleRuleButton,paddingSize:"xs",ref:scheduleRuleRef,onToggle:handleAccordionToggle.bind(null,rules_types["a"].scheduleRule),extraAction:stepsData.current[rules_types["a"].scheduleRule].isValid&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{iconType:"pencil",size:"xs",onClick:()=>editStep(rules_types["a"].scheduleRule)},EDIT_RULE)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"m"}),external_kbnSharedDeps_React_default.a.createElement(StepScheduleRule,{addPadding:true,defaultValues:stepsData.current[rules_types["a"].scheduleRule].data,descriptionColumns:"singleSplit",isReadOnlyView:activeStep!==rules_types["a"].scheduleRule,isLoading:isLoading||loading,setForm:setFormHook,onSubmit:()=>submitStep(rules_types["a"].scheduleRule)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(MyEuiPanel,{zindex:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAccordion"],{initialIsOpen:false,id:rules_types["a"].ruleActions,buttonContent:ruleActionsButton,paddingSize:"xs",ref:ruleActionsRef,onToggle:handleAccordionToggle.bind(null,rules_types["a"].ruleActions),extraAction:stepsData.current[rules_types["a"].ruleActions].isValid&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{iconType:"pencil",size:"xs",onClick:()=>editStep(rules_types["a"].ruleActions)},EDIT_RULE)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"m"}),external_kbnSharedDeps_React_default.a.createElement(StepRuleActions,{addPadding:true,defaultValues:stepsData.current[rules_types["a"].ruleActions].data,isReadOnlyView:activeStep!==rules_types["a"].ruleActions,isLoading:isLoading||loading,setForm:setFormHook,onSubmit:()=>submitStep(rules_types["a"].ruleActions),actionMessageParams:actionMessageParams})))))),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].detections}))};const CreateRulePage=external_kbnSharedDeps_React_default.a.memo(CreateRulePageComponent);var react_redux_lib=__webpack_require__(105);var use_selector=__webpack_require__(109);var accessibility_helpers=__webpack_require__(134);var filters_global=__webpack_require__(252);var search_bar=__webpack_require__(253);var inputs=__webpack_require__(149);var inputs_actions=__webpack_require__(151);var use_query=__webpack_require__(379);const buildLastAlertsQuery=ruleId=>{const queryFilter=[{bool:{should:[{match:{"signal.status":"open"}}],minimum_should_match:1}}];return{aggs:{lastSeen:{max:{field:"@timestamp"}}},query:{bool:{filter:ruleId!=null?[...queryFilter,{bool:{should:[{match:{"signal.rule.id":ruleId}}],minimum_should_match:1}}]:queryFilter}},size:1,track_total_hits:true}};const useAlertInfo=({ruleId:ruleId=null})=>{const[lastAlerts,setLastAlerts]=Object(external_kbnSharedDeps_React_["useState"])(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"}));const[totalAlerts,setTotalAlerts]=Object(external_kbnSharedDeps_React_["useState"])(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"}));const{loading:loading,data:alerts}=Object(use_query["a"])(buildLastAlertsQuery(ruleId));Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(alerts!=null){var _myAlerts$aggregation,_myAlerts$aggregation2,_myAlerts$aggregation3;const myAlerts=alerts;setLastAlerts(((_myAlerts$aggregation=myAlerts.aggregations)===null||_myAlerts$aggregation===void 0?void 0:_myAlerts$aggregation.lastSeen.value)!=null?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedRelative"],{value:new Date((_myAlerts$aggregation2=(_myAlerts$aggregation3=myAlerts.aggregations)===null||_myAlerts$aggregation3===void 0?void 0:_myAlerts$aggregation3.lastSeen.value_as_string)!==null&&_myAlerts$aggregation2!==void 0?_myAlerts$aggregation2:"")}):null);setTotalAlerts(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,myAlerts.hits.total.value))}else{setLastAlerts(null);setTotalAlerts(null)}},[loading,alerts]);return[lastAlerts,totalAlerts]};var events_viewer=__webpack_require__(518);var store=__webpack_require__(122);var store_timeline=__webpack_require__(108);var defaults=__webpack_require__(118);var manage_timeline=__webpack_require__(152);var alerts_table_actions=__webpack_require__(375);var default_config=__webpack_require__(204);var alerts_filter_group=__webpack_require__(476);var external_kbnSharedDeps_ElasticNumeral_=__webpack_require__(83);var external_kbnSharedDeps_ElasticNumeral_default=__webpack_require__.n(external_kbnSharedDeps_ElasticNumeral_);var link_icon=__webpack_require__(483);var utility_bar=__webpack_require__(321);const SHOWING_ALERTS=(totalAlertsFormatted,totalAlerts)=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.showingAlertsTitle",{values:{totalAlertsFormatted:totalAlertsFormatted,totalAlerts:totalAlerts},defaultMessage:"Showing {totalAlertsFormatted} {totalAlerts, plural, =1 {alert} other {alerts}}"});const SELECTED_ALERTS=(selectedAlertsFormatted,selectedAlerts)=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.selectedAlertsTitle",{values:{selectedAlertsFormatted:selectedAlertsFormatted,selectedAlerts:selectedAlerts},defaultMessage:"Selected {selectedAlertsFormatted} {selectedAlerts, plural, =1 {alert} other {alerts}}"});const SELECT_ALL_ALERTS=(totalAlertsFormatted,totalAlerts)=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.selectAllAlertsTitle",{values:{totalAlertsFormatted:totalAlertsFormatted,totalAlerts:totalAlerts},defaultMessage:"Select all {totalAlertsFormatted} {totalAlerts, plural, =1 {alert} other {alerts}}"});const ADDITIONAL_FILTERS_ACTIONS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersTitle",{defaultMessage:"Additional filters"});const ADDITIONAL_FILTERS_ACTIONS_SHOW_BUILDING_BLOCK=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersActions.showBuildingBlockTitle",{defaultMessage:"Include building block alerts"});const CLEAR_SELECTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.clearSelectionTitle",{defaultMessage:"Clear selection"});const TAKE_ACTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.takeActionTitle",{defaultMessage:"Take action"});const BATCH_ACTIONS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.batchActionsTitle",{defaultMessage:"Batch actions"});const BATCH_ACTION_VIEW_SELECTED_IN_HOSTS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.batchActions.viewSelectedInHostsTitle",{defaultMessage:"View selected in hosts"});const BATCH_ACTION_VIEW_SELECTED_IN_NETWORK=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.batchActions.viewSelectedInNetworkTitle",{defaultMessage:"View selected in network"});const BATCH_ACTION_VIEW_SELECTED_IN_TIMELINE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.batchActions.viewSelectedInTimelineTitle",{defaultMessage:"View selected in timeline"});const BATCH_ACTION_OPEN_SELECTED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.batchActions.openSelectedTitle",{defaultMessage:"Open selected"});const BATCH_ACTION_CLOSE_SELECTED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.batchActions.closeSelectedTitle",{defaultMessage:"Close selected"});const BATCH_ACTION_IN_PROGRESS_SELECTED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.batchActions.inProgressSelectedTitle",{defaultMessage:"Mark in progress"});const UtilityBarFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"UtilityBarFlexGroup",componentId:"jqzk8o-0"})(["min-width:175px;"]);const BuildingBlockContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"BuildingBlockContainer",componentId:"jqzk8o-1"})(["background:repeating-linear-gradient( 127deg,rgba(245,167,0,0.2),rgba(245,167,0,0.2) 1px,rgba(245,167,0,0.05) 2px,rgba(245,167,0,0.05) 10px );padding:",";"],({theme:theme})=>`${theme.eui.paddingSizes.xs}`);const AlertsUtilityBarComponent=({hasIndexWrite:hasIndexWrite,hasIndexMaintenance:hasIndexMaintenance,areEventsLoading:areEventsLoading,clearSelection:clearSelection,totalCount:totalCount,selectedEventIds:selectedEventIds,currentFilter:currentFilter,selectAll:selectAll,showBuildingBlockAlerts:showBuildingBlockAlerts,onShowBuildingBlockAlertsChanged:onShowBuildingBlockAlertsChanged,showClearSelection:showClearSelection,updateAlertsStatus:updateAlertsStatus})=>{const[defaultNumberFormat]=Object(lib_kibana["l"])(constants["B"]);const handleUpdateStatus=Object(external_kbnSharedDeps_React_["useCallback"])(async selectedStatus=>{await updateAlertsStatus({alertIds:Object.keys(selectedEventIds),status:currentFilter,selectedStatus:selectedStatus})},[currentFilter,selectedEventIds,updateAlertsStatus]);const formattedTotalCount=external_kbnSharedDeps_ElasticNumeral_default()(totalCount).format(defaultNumberFormat);const formattedSelectedEventsCount=external_kbnSharedDeps_ElasticNumeral_default()(Object.keys(selectedEventIds).length).format(defaultNumberFormat);const UtilityBarPopoverContent=closePopover=>external_kbnSharedDeps_React_default.a.createElement(UtilityBarFlexGroup,{direction:"column"},currentFilter!==alerts_filter_group["d"]&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(link_icon["a"],{"aria-label":"openSelectedAlerts",onClick:()=>{closePopover();handleUpdateStatus("open")},color:"text","data-test-subj":"openSelectedAlertsButton"},BATCH_ACTION_OPEN_SELECTED)),currentFilter!==alerts_filter_group["b"]&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(link_icon["a"],{"aria-label":"closeSelectedAlerts",onClick:()=>{closePopover();handleUpdateStatus("closed")},color:"text","data-test-subj":"closeSelectedAlertsButton"},BATCH_ACTION_CLOSE_SELECTED)),currentFilter!==alerts_filter_group["c"]&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(link_icon["a"],{"aria-label":"markSelectedAlertsInProgress",onClick:()=>{closePopover();handleUpdateStatus("in-progress")},color:"text","data-test-subj":"markSelectedAlertsInProgressButton"},BATCH_ACTION_IN_PROGRESS_SELECTED)));const UtilityBarAdditionalFiltersContent=closePopover=>external_kbnSharedDeps_React_default.a.createElement(UtilityBarFlexGroup,{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(BuildingBlockContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCheckbox"],{id:"showBuildingBlockAlertsCheckbox","aria-label":"showBuildingBlockAlerts",onChange:e=>{closePopover();onShowBuildingBlockAlertsChanged(e.target.checked)},checked:showBuildingBlockAlerts,color:"text","data-test-subj":"showBuildingBlockAlertsCheckbox",label:ADDITIONAL_FILTERS_ACTIONS_SHOW_BUILDING_BLOCK})));const handleSelectAllAlertsClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(!showClearSelection){selectAll()}else{clearSelection()}},[clearSelection,selectAll,showClearSelection]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["a"],null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["d"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(utility_bar["c"],null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["f"],{dataTestSubj:"showingAlerts"},SHOWING_ALERTS(formattedTotalCount,totalCount))),external_kbnSharedDeps_React_default.a.createElement(utility_bar["c"],{grow:true},hasIndexWrite&&hasIndexMaintenance&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["f"],{dataTestSubj:"selectedAlerts"},SELECTED_ALERTS(showClearSelection?formattedTotalCount:formattedSelectedEventsCount,showClearSelection?totalCount:Object.keys(selectedEventIds).length)),external_kbnSharedDeps_React_default.a.createElement(utility_bar["b"],{dataTestSubj:"alertActionPopover",disabled:areEventsLoading||Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(selectedEventIds)&&showClearSelection===false,iconType:"arrowDown",iconSide:"right",ownFocus:false,popoverContent:UtilityBarPopoverContent},TAKE_ACTION),external_kbnSharedDeps_React_default.a.createElement(utility_bar["b"],{"aria-label":"selectAllAlerts",dataTestSubj:"selectAllAlertsButton",iconType:showClearSelection?"cross":"pagesSelect",onClick:handleSelectAllAlertsClick},showClearSelection?CLEAR_SELECTION:SELECT_ALL_ALERTS(formattedTotalCount,totalCount))),external_kbnSharedDeps_React_default.a.createElement(utility_bar["e"],null),external_kbnSharedDeps_React_default.a.createElement(utility_bar["b"],{dataTestSubj:"additionalFilters",disabled:areEventsLoading,iconType:"arrowDown",iconSide:"right",ownFocus:true,popoverContent:UtilityBarAdditionalFiltersContent},ADDITIONAL_FILTERS_ACTIONS)))))};const AlertsUtilityBar=external_kbnSharedDeps_React_default.a.memo(AlertsUtilityBarComponent,(prevProps,nextProps)=>prevProps.areEventsLoading===nextProps.areEventsLoading&&prevProps.selectedEventIds===nextProps.selectedEventIds&&prevProps.totalCount===nextProps.totalCount&&prevProps.showClearSelection===nextProps.showClearSelection&&prevProps.showBuildingBlockAlerts===nextProps.showBuildingBlockAlerts);var common_translations=__webpack_require__(376);var alerts_table_translations=__webpack_require__(263);var model=__webpack_require__(117);var sourcerer=__webpack_require__(124);var alerts_table_helpers=__webpack_require__(691);const AlertsTableComponent=({timelineId:timelineId,clearEventsDeleted:clearEventsDeleted,clearEventsLoading:clearEventsLoading,clearSelected:clearSelected,defaultFilters:defaultFilters,from:from,globalFilters:globalFilters,globalQuery:globalQuery,hasIndexWrite:hasIndexWrite,hasIndexMaintenance:hasIndexMaintenance,isSelectAllChecked:isSelectAllChecked,loading:loading,loadingEventIds:loadingEventIds,onRuleChange:onRuleChange,selectedEventIds:selectedEventIds,setEventsDeleted:setEventsDeleted,setEventsLoading:setEventsLoading,showBuildingBlockAlerts:showBuildingBlockAlerts,onShowBuildingBlockAlertsChanged:onShowBuildingBlockAlertsChanged,to:to})=>{const[showClearSelectionAction,setShowClearSelectionAction]=Object(external_kbnSharedDeps_React_["useState"])(false);const[filterGroup,setFilterGroup]=Object(external_kbnSharedDeps_React_["useState"])(alerts_filter_group["d"]);const{browserFields:browserFields,indexPattern:indexPatterns,loading:indexPatternsLoading,selectedPatterns:selectedPatterns}=Object(sourcerer["b"])(model["SourcererScopeName"].detections);const kibana=Object(lib_kibana["h"])();const[,dispatchToaster]=Object(toasters["h"])();const{addWarning:addWarning}=Object(use_app_toasts["a"])();const{initializeTimeline:initializeTimeline,setSelectAll:setSelectAll}=Object(manage_timeline["b"])();const getGlobalQuery=Object(external_kbnSharedDeps_React_["useCallback"])(customFilters=>{if(browserFields!=null&&indexPatterns!=null){return Object(timeline_helpers["k"])({config:public_["esQuery"].getEsQueryConfig(kibana.services.uiSettings),dataProviders:[],indexPattern:indexPatterns,browserFields:browserFields,filters:[...defaultFilters!==null&&defaultFilters!==void 0?defaultFilters:[],...globalFilters,...customFilters,...Object(alerts_table_helpers["a"])(from,to)],kqlQuery:globalQuery,kqlMode:globalQuery.language,isEventViewer:true})}return null},[browserFields,defaultFilters,globalFilters,globalQuery,indexPatterns,kibana,to,from]);const setEventsLoadingCallback=Object(external_kbnSharedDeps_React_["useCallback"])(({eventIds:eventIds,isLoading:isLoading})=>{setEventsLoading({id:timelineId,eventIds:eventIds,isLoading:isLoading})},[setEventsLoading,timelineId]);const setEventsDeletedCallback=Object(external_kbnSharedDeps_React_["useCallback"])(({eventIds:eventIds,isDeleted:isDeleted})=>{setEventsDeleted({id:timelineId,eventIds:eventIds,isDeleted:isDeleted})},[setEventsDeleted,timelineId]);const onAlertStatusUpdateSuccess=Object(external_kbnSharedDeps_React_["useCallback"])((updated,conflicts,status)=>{if(conflicts>0){addWarning({title:common_translations["i"](conflicts),text:common_translations["j"](updated,conflicts)})}else{let title;switch(status){case"closed":title=alerts_table_translations["s"](updated);break;case"open":title=alerts_table_translations["z"](updated);break;case"in-progress":title=alerts_table_translations["v"](updated)}Object(toasters["e"])(title,dispatchToaster)}},[addWarning,dispatchToaster]);const onAlertStatusUpdateFailure=Object(external_kbnSharedDeps_React_["useCallback"])((status,error)=>{let title;switch(status){case"closed":title=alerts_table_translations["r"];break;case"open":title=alerts_table_translations["y"];break;case"in-progress":title=alerts_table_translations["u"]}Object(toasters["d"])(title,[error.message],dispatchToaster)},[dispatchToaster]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(isSelectAllChecked){setSelectAll({id:timelineId,selectAll:false})}else{setShowClearSelectionAction(false)}},[isSelectAllChecked,setSelectAll,timelineId]);const onFilterGroupChangedCallback=Object(external_kbnSharedDeps_React_["useCallback"])(newFilterGroup=>{clearEventsLoading({id:timelineId});clearEventsDeleted({id:timelineId});clearSelected({id:timelineId});setFilterGroup(newFilterGroup)},[clearEventsLoading,clearEventsDeleted,clearSelected,setFilterGroup,timelineId]);const clearSelectionCallback=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{clearSelected({id:timelineId});setSelectAll({id:timelineId,selectAll:false});setShowClearSelectionAction(false)},[clearSelected,setSelectAll,setShowClearSelectionAction,timelineId]);const selectAllOnAllPagesCallback=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setSelectAll({id:timelineId,selectAll:true});setShowClearSelectionAction(true)},[setSelectAll,setShowClearSelectionAction,timelineId]);const updateAlertsStatusCallback=Object(external_kbnSharedDeps_React_["useCallback"])(async(refetchQuery,{status:status,selectedStatus:selectedStatus})=>{var _getGlobalQuery;const currentStatusFilter=Object(default_config["c"])(status);await Object(alerts_table_actions["c"])({query:showClearSelectionAction?(_getGlobalQuery=getGlobalQuery(currentStatusFilter))===null||_getGlobalQuery===void 0?void 0:_getGlobalQuery.filterQuery:undefined,alertIds:Object.keys(selectedEventIds),selectedStatus:selectedStatus,setEventsDeleted:setEventsDeletedCallback,setEventsLoading:setEventsLoadingCallback,onAlertStatusUpdateSuccess:onAlertStatusUpdateSuccess,onAlertStatusUpdateFailure:onAlertStatusUpdateFailure});refetchQuery()},[getGlobalQuery,selectedEventIds,setEventsDeletedCallback,setEventsLoadingCallback,showClearSelectionAction,onAlertStatusUpdateSuccess,onAlertStatusUpdateFailure]);const utilityBarCallback=Object(external_kbnSharedDeps_React_["useCallback"])((refetchQuery,totalCount)=>external_kbnSharedDeps_React_default.a.createElement(AlertsUtilityBar,{areEventsLoading:loadingEventIds.length>0,clearSelection:clearSelectionCallback,hasIndexWrite:hasIndexWrite,hasIndexMaintenance:hasIndexMaintenance,currentFilter:filterGroup,selectAll:selectAllOnAllPagesCallback,selectedEventIds:selectedEventIds,showBuildingBlockAlerts:showBuildingBlockAlerts,onShowBuildingBlockAlertsChanged:onShowBuildingBlockAlertsChanged,showClearSelection:showClearSelectionAction,totalCount:totalCount,updateAlertsStatus:updateAlertsStatusCallback.bind(null,refetchQuery)}),[hasIndexWrite,hasIndexMaintenance,clearSelectionCallback,filterGroup,showBuildingBlockAlerts,onShowBuildingBlockAlertsChanged,loadingEventIds.length,selectAllOnAllPagesCallback,selectedEventIds,showClearSelectionAction,updateAlertsStatusCallback]);const defaultFiltersMemo=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(defaultFilters)){return Object(default_config["c"])(filterGroup)}else if(defaultFilters!=null&&!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(defaultFilters)){return[...defaultFilters,...Object(default_config["c"])(filterGroup)]}},[defaultFilters,filterGroup]);const{filterManager:filterManager}=Object(lib_kibana["h"])().services.data.query;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{initializeTimeline({defaultModel:default_config["a"],documentType:alerts_table_translations["h"],filterManager:filterManager,footerText:alerts_table_translations["B"],id:timelineId,loadingText:alerts_table_translations["w"],selectAll:false,queryFields:default_config["f"],title:""})},[]);const headerFilterGroup=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(alerts_filter_group["a"],{onFilterGroupChanged:onFilterGroupChangedCallback}),[onFilterGroupChangedCallback]);if(loading||indexPatternsLoading||Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(selectedPatterns)){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{title:""}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingContent"],{"data-test-subj":"loading-alerts-panel"}))}return external_kbnSharedDeps_React_default.a.createElement(events_viewer["a"],{pageFilters:defaultFiltersMemo,defaultModel:default_config["a"],end:to,headerFilterGroup:headerFilterGroup,id:timelineId,onRuleChange:onRuleChange,scopeId:model["SourcererScopeName"].detections,start:from,utilityBar:utilityBarCallback})};const makeMapStateToProps=()=>{const getTimeline=store_timeline["b"].getTimelineByIdSelector();const getGlobalInputs=store["inputsSelectors"].globalSelector();const mapStateToProps=(state,ownProps)=>{var _getTimeline;const{timelineId:timelineId}=ownProps;const timeline=(_getTimeline=getTimeline(state,timelineId))!==null&&_getTimeline!==void 0?_getTimeline:defaults["a"];const{deletedEventIds:deletedEventIds,isSelectAllChecked:isSelectAllChecked,loadingEventIds:loadingEventIds,selectedEventIds:selectedEventIds}=timeline;const globalInputs=getGlobalInputs(state);const{query:query,filters:filters}=globalInputs;return{globalQuery:query,globalFilters:filters,deletedEventIds:deletedEventIds,isSelectAllChecked:isSelectAllChecked,loadingEventIds:loadingEventIds,selectedEventIds:selectedEventIds}};return mapStateToProps};const mapDispatchToProps=dispatch=>({clearSelected:({id:id})=>dispatch(store_timeline["a"].clearSelected({id:id})),setEventsLoading:({id:id,eventIds:eventIds,isLoading:isLoading})=>dispatch(store_timeline["a"].setEventsLoading({id:id,eventIds:eventIds,isLoading:isLoading})),clearEventsLoading:({id:id})=>dispatch(store_timeline["a"].clearEventsLoading({id:id})),setEventsDeleted:({id:id,eventIds:eventIds,isDeleted:isDeleted})=>dispatch(store_timeline["a"].setEventsDeleted({id:id,eventIds:eventIds,isDeleted:isDeleted})),clearEventsDeleted:({id:id})=>dispatch(store_timeline["a"].clearEventsDeleted({id:id}))});const alerts_table_connector=Object(react_redux_lib["connect"])(makeMapStateToProps,mapDispatchToProps);const AlertsTable=alerts_table_connector(external_kbnSharedDeps_React_default.a.memo(AlertsTableComponent));const NO_API_INTEGRATION_KEY_CALLOUT_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.noApiIntegrationKeyCallOutTitle",{defaultMessage:"API integration key required"});const NO_API_INTEGRATION_KEY_CALLOUT_MSG=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.noApiIntegrationKeyCallOutMsg",{defaultMessage:`A new encryption key is generated for saved objects each time you start Kibana. Without a persistent key, you cannot delete or modify rules after Kibana restarts. To set a persistent key, add the xpack.encryptedSavedObjects.encryptionKey setting with any text value of 32 or more characters to the kibana.yml file.`});const DISMISS_CALLOUT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.dismissNoApiIntegrationKeyButton",{defaultMessage:"Dismiss"});const NoApiIntegrationKeyCallOutComponent=()=>{const[showCallOut,setShowCallOut]=Object(external_kbnSharedDeps_React_["useState"])(true);const handleCallOut=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setShowCallOut(false),[setShowCallOut]);return showCallOut?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:NO_API_INTEGRATION_KEY_CALLOUT_TITLE,color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("p",null,NO_API_INTEGRATION_KEY_CALLOUT_MSG),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{color:"danger",onClick:handleCallOut},DISMISS_CALLOUT)):null};const NoApiIntegrationKeyCallOut=Object(external_kbnSharedDeps_React_["memo"])(NoApiIntegrationKeyCallOutComponent);var callouts=__webpack_require__(398);const ExternalLink=({url:url,children:children,ariaLabel:ariaLabel})=>{if(!children){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:url,position:"top","data-test-subj":"externalLinkTooltip"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:url,"aria-label":ariaLabel,external:true,target:"_blank",rel:"noopener","data-test-subj":"externalLink"},children))};const COMMON_ARIA_LABEL_ENDING=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.documentationLinks.ariaLabelEnding",{defaultMessage:"click to open documentation in a new tab"});const SOLUTION_REQUIREMENTS_LINK_PATH="sec-requirements.html";const SOLUTION_REQUIREMENTS_LINK_TEXT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.documentationLinks.solutionRequirements.text",{defaultMessage:"Elastic Security system requirements"});const DETECTIONS_REQUIREMENTS_LINK_PATH="detections-permissions-section.html";const DETECTIONS_REQUIREMENTS_LINK_TEXT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.documentationLinks.detectionsRequirements.text",{defaultMessage:"Detections prerequisites and requirements"});const ML_JOB_COMPATIBILITY_LINK_PATH="alerts-ui-monitor.html#ml-job-compatibility";const ML_JOB_COMPATIBILITY_LINK_TEXT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.documentationLinks.mlJobCompatibility.text",{defaultMessage:"ML job compatibility"});const DocLink=({guidePath:guidePath="security",docPath:docPath,linkText:linkText})=>{const{services:services}=Object(lib_kibana["h"])();const{ELASTIC_WEBSITE_URL:ELASTIC_WEBSITE_URL,DOC_LINK_VERSION:DOC_LINK_VERSION}=services.docLinks;const url=`${ELASTIC_WEBSITE_URL}guide/en/${guidePath}/${DOC_LINK_VERSION}/${docPath}`;const ariaLabel=`${linkText} - ${COMMON_ARIA_LABEL_ENDING}`;return external_kbnSharedDeps_React_default.a.createElement(ExternalLink,{url:url,ariaLabel:ariaLabel},linkText)};const DocLinkWrapper=Object(external_kbnSharedDeps_React_["memo"])(DocLink);const SecuritySolutionRequirementsLink=()=>external_kbnSharedDeps_React_default.a.createElement(DocLinkWrapper,{docPath:SOLUTION_REQUIREMENTS_LINK_PATH,linkText:SOLUTION_REQUIREMENTS_LINK_TEXT});const DetectionsRequirementsLink=()=>external_kbnSharedDeps_React_default.a.createElement(DocLinkWrapper,{docPath:DETECTIONS_REQUIREMENTS_LINK_PATH,linkText:DETECTIONS_REQUIREMENTS_LINK_TEXT});const MlJobCompatibilityLink=()=>external_kbnSharedDeps_React_default.a.createElement(DocLinkWrapper,{docPath:ML_JOB_COMPATIBILITY_LINK_PATH,linkText:ML_JOB_COMPATIBILITY_LINK_TEXT});const READ_ONLY_ALERTS_CALLOUT_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.readOnlyAlertsCallOut.messageTitle",{defaultMessage:"You cannot change alert states"});const readOnlyAlertsCallOutBody=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.detectionEngine.readOnlyAlertsCallOut.messageBody.messageDetail",defaultMessage:"{essence} Related documentation: {docs}",values:{essence:external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.detectionEngine.readOnlyAlertsCallOut.messageBody.essenceDescription",defaultMessage:"You only have permissions to view alerts. If you need to update alert states (open or close alerts), contact your Kibana administrator."})),docs:external_kbnSharedDeps_React_default.a.createElement("ul",null,external_kbnSharedDeps_React_default.a.createElement("li",null,external_kbnSharedDeps_React_default.a.createElement(DetectionsRequirementsLink,null)),external_kbnSharedDeps_React_default.a.createElement("li",null,external_kbnSharedDeps_React_default.a.createElement(SecuritySolutionRequirementsLink,null)))}});const readOnlyAccessToAlertsMessage={type:"primary",id:"read-only-access-to-alerts",title:READ_ONLY_ALERTS_CALLOUT_TITLE,description:readOnlyAlertsCallOutBody()};const ReadOnlyAlertsCallOutComponent=()=>{const[{hasIndexUpdateDelete:hasIndexUpdateDelete}]=Object(user_info["b"])();return external_kbnSharedDeps_React_default.a.createElement(callouts["CallOutSwitcher"],{namespace:"detections",condition:hasIndexUpdateDelete!=null&&!hasIndexUpdateDelete,message:readOnlyAccessToAlertsMessage})};const ReadOnlyAlertsCallOut=Object(external_kbnSharedDeps_React_["memo"])(ReadOnlyAlertsCallOutComponent);var alerts_histogram_panel=__webpack_require__(509);var alerts_histogram_panel_config=__webpack_require__(387);var overview_empty=__webpack_require__(211);var empty_page=__webpack_require__(382);var detection_engine_translations=__webpack_require__(249);const buildMessage=(needsListsIndex,needsSignalsIndex)=>{if(needsSignalsIndex&&needsListsIndex){return detection_engine_translations["h"](detection_engine_translations["j"])}else if(needsSignalsIndex){return detection_engine_translations["h"](detection_engine_translations["k"])}else if(needsListsIndex){return detection_engine_translations["h"](detection_engine_translations["i"])}else{return detection_engine_translations["h"]("")}};const DetectionEngineNoIndexComponent=({needsListsIndex:needsListsIndex,needsSignalsIndex:needsSignalsIndex})=>{const docLinks=Object(lib_kibana["h"])().services.docLinks;const actions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({detections:{icon:"documents",label:detection_engine_translations["d"],url:`${docLinks.ELASTIC_WEBSITE_URL}guide/en/security/${docLinks.DOC_LINK_VERSION}/detections-permissions-section.html`,target:"_blank"}}),[docLinks]);const message=buildMessage(needsListsIndex,needsSignalsIndex);return external_kbnSharedDeps_React_default.a.createElement(empty_page["a"],{actions:actions,"data-test-subj":"no_index",message:message,title:detection_engine_translations["l"]})};const DetectionEngineNoIndex=external_kbnSharedDeps_React_default.a.memo(DetectionEngineNoIndexComponent);const DetectionEngineUserUnauthenticated=external_kbnSharedDeps_React_default.a.memo(()=>{const docLinks=Object(lib_kibana["h"])().services.docLinks;const actions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({detectionUnauthenticated:{icon:"documents",label:detection_engine_translations["d"],url:`${docLinks.ELASTIC_WEBSITE_URL}guide/en/security/${docLinks.DOC_LINK_VERSION}/detections-permissions-section.html`,target:"_blank"}}),[docLinks]);return external_kbnSharedDeps_React_default.a.createElement(empty_page["a"],{actions:actions,message:detection_engine_translations["n"],"data-test-subj":"no_index",title:detection_engine_translations["o"]})});DetectionEngineUserUnauthenticated.displayName="DetectionEngineUserUnauthenticated";var links=__webpack_require__(113);var link_to=__webpack_require__(112);var use_full_screen=__webpack_require__(139);const Display=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Display",componentId:"sc-1njjyjq-0"})(["",";"],({show:show})=>show?"":"display: none;");Display.displayName="Display";const NEED_ADMIN_CALLOUT_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageTitle",{defaultMessage:"Administration permissions required for alert migration"});const needAdminForUpdateCallOutBody=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageBody.messageDetail",defaultMessage:"{essence} Related documentation: {docs}",values:{essence:external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageBody.essenceDescription",defaultMessage:"You are currently missing the required permissions to auto migrate your alert data. Please have your administrator visit this page one time to auto migrate your alert data."})),docs:external_kbnSharedDeps_React_default.a.createElement("ul",null,external_kbnSharedDeps_React_default.a.createElement("li",null,external_kbnSharedDeps_React_default.a.createElement(DetectionsRequirementsLink,null)),external_kbnSharedDeps_React_default.a.createElement("li",null,external_kbnSharedDeps_React_default.a.createElement(SecuritySolutionRequirementsLink,null)))}});const needAdminForUpdateRulesMessage={type:"primary",id:"need-admin-for-update-rules",title:NEED_ADMIN_CALLOUT_TITLE,description:needAdminForUpdateCallOutBody()};const NeedAdminForUpdateCallOutComponent=()=>{const[{signalIndexMappingOutdated:signalIndexMappingOutdated,hasIndexManage:hasIndexManage}]=Object(user_info["b"])();const signalIndexMappingIsOutdated=signalIndexMappingOutdated!=null&&signalIndexMappingOutdated;const userDoesntHaveIndexManage=hasIndexManage!=null&&!hasIndexManage;return external_kbnSharedDeps_React_default.a.createElement(callouts["CallOutPersistentSwitcher"],{condition:signalIndexMappingIsOutdated&&userDoesntHaveIndexManage,message:needAdminForUpdateRulesMessage})};const NeedAdminForUpdateRulesCallOut=Object(external_kbnSharedDeps_React_["memo"])(NeedAdminForUpdateCallOutComponent);const StyledFullHeightContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-7rr6ls-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]);const DetectionEnginePageComponent=()=>{const dispatch=Object(react_redux_lib["useDispatch"])();const containerElement=Object(external_kbnSharedDeps_React_["useRef"])(null);const getTimeline=Object(external_kbnSharedDeps_React_["useMemo"])(()=>store_timeline["b"].getTimelineByIdSelector(),[]);const graphEventId=Object(use_selector["b"])(state=>{var _getTimeline;return((_getTimeline=getTimeline(state,types_timeline["e"].detectionsPage))!==null&&_getTimeline!==void 0?_getTimeline:defaults["a"]).graphEventId});const getGlobalFiltersQuerySelector=Object(external_kbnSharedDeps_React_["useMemo"])(()=>inputs["d"].globalFiltersQuerySelector(),[]);const getGlobalQuerySelector=Object(external_kbnSharedDeps_React_["useMemo"])(()=>inputs["d"].globalQuerySelector(),[]);const query=Object(use_selector["a"])(getGlobalQuerySelector);const filters=Object(use_selector["a"])(getGlobalFiltersQuerySelector);const{to:to,from:from,deleteQuery:deleteQuery,setQuery:setQuery}=Object(use_global_time["a"])();const{globalFullScreen:globalFullScreen}=Object(use_full_screen["a"])();const[{loading:userInfoLoading,isSignalIndexExists:isSignalIndexExists,isAuthenticated:isUserAuthenticated,hasEncryptionKey:hasEncryptionKey,signalIndexName:signalIndexName,hasIndexWrite:hasIndexWrite,hasIndexMaintenance:hasIndexMaintenance}]=Object(user_info["b"])();const{loading:listsConfigLoading,needsConfiguration:needsListsConfiguration}=useListsConfig();const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const[lastAlerts]=useAlertInfo({});const{formatUrl:formatUrl}=Object(link_to["o"])(app_types["a"].detections);const[showBuildingBlockAlerts,setShowBuildingBlockAlerts]=Object(external_kbnSharedDeps_React_["useState"])(false);const loading=userInfoLoading||listsConfigLoading;const updateDateRangeCallback=Object(external_kbnSharedDeps_React_["useCallback"])(({x:x})=>{if(!x){return}const[min,max]=x;dispatch(Object(inputs_actions["setAbsoluteRangeDatePicker"])({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()}))},[dispatch]);const goToRules=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();history.push(Object(redirect_to_detection_engine["f"])())},[history]);const alertsHistogramDefaultFilters=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[...filters,...Object(default_config["e"])(showBuildingBlockAlerts)],[filters,showBuildingBlockAlerts]);const alertsTableDefaultFilters=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(default_config["e"])(showBuildingBlockAlerts),[showBuildingBlockAlerts]);const onShowBuildingBlockAlertsChangedCallback=Object(external_kbnSharedDeps_React_["useCallback"])(newShowBuildingBlockAlerts=>{setShowBuildingBlockAlerts(newShowBuildingBlockAlerts)},[setShowBuildingBlockAlerts]);const{indicesExist:indicesExist,indexPattern:indexPattern}=Object(sourcerer["b"])(model["SourcererScopeName"].detections);const onSkipFocusBeforeEventsTable=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{Object(timeline_helpers["m"])(containerElement.current)},[containerElement]);const onSkipFocusAfterEventsTable=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{Object(timeline_helpers["o"])()},[]);const onKeyDown=Object(external_kbnSharedDeps_React_["useCallback"])(keyboardEvent=>{if(Object(accessibility_helpers["r"])(keyboardEvent)){Object(timeline_helpers["n"])({containerElement:containerElement.current,keyboardEvent:keyboardEvent,onSkipFocusBeforeEventsTable:onSkipFocusBeforeEventsTable,onSkipFocusAfterEventsTable:onSkipFocusAfterEventsTable})}},[containerElement,onSkipFocusBeforeEventsTable,onSkipFocusAfterEventsTable]);if(isUserAuthenticated!=null&&!isUserAuthenticated&&!loading){return external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{border:true,title:detection_engine_translations["m"]}),external_kbnSharedDeps_React_default.a.createElement(DetectionEngineUserUnauthenticated,null))}if(!loading&&(isSignalIndexExists===false||needsListsConfiguration)){return external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{border:true,title:detection_engine_translations["m"]}),external_kbnSharedDeps_React_default.a.createElement(DetectionEngineNoIndex,{needsSignalsIndex:isSignalIndexExists===false,needsListsIndex:needsListsConfiguration}))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,hasEncryptionKey!=null&&!hasEncryptionKey&&external_kbnSharedDeps_React_default.a.createElement(NoApiIntegrationKeyCallOut,null),external_kbnSharedDeps_React_default.a.createElement(ReadOnlyAlertsCallOut,null),external_kbnSharedDeps_React_default.a.createElement(NeedAdminForUpdateRulesCallOut,null),indicesExist?external_kbnSharedDeps_React_default.a.createElement(StyledFullHeightContainer,{onKeyDown:onKeyDown,ref:containerElement},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiWindowEvent"],{event:"resize",handler:external_kbnSharedDeps_LodashFp_["noop"]}),external_kbnSharedDeps_React_default.a.createElement(filters_global["a"],{show:Object(timeline_helpers["q"])({globalFullScreen:globalFullScreen,graphEventId:graphEventId})},external_kbnSharedDeps_React_default.a.createElement(search_bar["a"],{id:"global",indexPattern:indexPattern})),external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],{noPadding:globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(Display,{show:!globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{subtitle:lastAlerts!=null&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,detection_engine_translations["e"],": ",lastAlerts),title:detection_engine_translations["m"]},external_kbnSharedDeps_React_default.a.createElement(links["g"],{fill:true,onClick:goToRules,href:formatUrl(Object(redirect_to_detection_engine["f"])()),iconType:"gear","data-test-subj":"manage-alert-detection-rules"},detection_engine_translations["c"])),external_kbnSharedDeps_React_default.a.createElement(alerts_histogram_panel["a"],{deleteQuery:deleteQuery,filters:alertsHistogramDefaultFilters,from:from,query:query,setQuery:setQuery,showTotalAlertsCount:true,signalIndexName:signalIndexName,stackByOptions:alerts_histogram_panel_config["a"],to:to,updateDateRange:updateDateRangeCallback}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"})),external_kbnSharedDeps_React_default.a.createElement(AlertsTable,{timelineId:types_timeline["e"].detectionsPage,loading:loading,hasIndexWrite:hasIndexWrite!==null&&hasIndexWrite!==void 0?hasIndexWrite:false,hasIndexMaintenance:hasIndexMaintenance!==null&&hasIndexMaintenance!==void 0?hasIndexMaintenance:false,from:from,defaultFilters:alertsTableDefaultFilters,showBuildingBlockAlerts:showBuildingBlockAlerts,onShowBuildingBlockAlertsChanged:onShowBuildingBlockAlertsChangedCallback,to:to}))):external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{border:true,title:detection_engine_translations["m"]}),external_kbnSharedDeps_React_default.a.createElement(overview_empty["a"],null)),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].detections}))};const DetectionEnginePage=external_kbnSharedDeps_React_default.a.memo(DetectionEnginePageComponent);const MyPanel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiPanel"]).withConfig({displayName:"MyPanel",componentId:"sc-177nzsv-0"})(["position:relative;"]);MyPanel.displayName="MyPanel";const StepPanelComponent=({children:children,loading:loading,title:title})=>external_kbnSharedDeps_React_default.a.createElement(MyPanel,null,loading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiProgress"],{size:"xs",color:"accent",position:"absolute"}),external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{title:title}),children);const StepPanel=Object(external_kbnSharedDeps_React_["memo"])(StepPanelComponent);const translations_PAGE_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.editRule.pageTitle",{defaultMessage:"Edit rule settings"});const CANCEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.editRule.cancelTitle",{defaultMessage:"Cancel"});const SAVE_CHANGES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.editRule.saveChangeTitle",{defaultMessage:"Save changes"});const SORRY_ERRORS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.editRule.errorMsgDescription",{defaultMessage:"Sorry"});const BACK_TO=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.editRule.backToDescription",{defaultMessage:"Back to"});const SUCCESSFULLY_SAVED_RULE=ruleName=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.update.successfullySavedRuleTitle",{values:{ruleName:ruleName},defaultMessage:"{ruleName} was saved"});const edit_formHookNoop=async()=>undefined;const EditRulePageComponent=()=>{var _rule$name2;const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const[,dispatchToaster]=Object(toasters["h"])();const[{loading:userInfoLoading,isSignalIndexExists:isSignalIndexExists,isAuthenticated:isAuthenticated,hasEncryptionKey:hasEncryptionKey,canUserCRUD:canUserCRUD}]=Object(user_info["b"])();const{loading:listsConfigLoading,needsConfiguration:needsListsConfiguration}=useListsConfig();const{detailName:ruleId}=Object(external_kbnSharedDeps_ReactRouterDom_["useParams"])();const[ruleLoading,rule]=useRule(ruleId);const loading=ruleLoading||userInfoLoading||listsConfigLoading;const formHooks=Object(external_kbnSharedDeps_React_["useRef"])({[rules_types["a"].defineRule]:edit_formHookNoop,[rules_types["a"].aboutRule]:edit_formHookNoop,[rules_types["a"].scheduleRule]:edit_formHookNoop,[rules_types["a"].ruleActions]:edit_formHookNoop});const stepsData=Object(external_kbnSharedDeps_React_["useRef"])({[rules_types["a"].defineRule]:{isValid:false,data:undefined},[rules_types["a"].aboutRule]:{isValid:false,data:undefined},[rules_types["a"].scheduleRule]:{isValid:false,data:undefined},[rules_types["a"].ruleActions]:{isValid:false,data:undefined}});const defineStep=stepsData.current[rules_types["a"].defineRule];const aboutStep=stepsData.current[rules_types["a"].aboutRule];const scheduleStep=stepsData.current[rules_types["a"].scheduleRule];const actionsStep=stepsData.current[rules_types["a"].ruleActions];const[activeStep,setActiveStep]=Object(external_kbnSharedDeps_React_["useState"])(rules_types["a"].defineRule);const invalidSteps=rules_utils["b"].filter(step=>{const stepData=stepsData.current[step];return stepData.data!=null&&!stepIsValid(stepData)});const[{isLoading:isLoading,isSaved:isSaved},setRule]=useUpdateRule();const actionMessageParams=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getActionMessageParams(rule===null||rule===void 0?void 0:rule.type),[rule===null||rule===void 0?void 0:rule.type]);const setFormHook=Object(external_kbnSharedDeps_React_["useCallback"])((step,hook)=>{formHooks.current[step]=hook;if(step===activeStep){hook()}},[activeStep]);const setStepData=Object(external_kbnSharedDeps_React_["useCallback"])((step,data,isValid)=>{stepsData.current[step]={...stepsData.current[step],data:data,isValid:isValid}},[]);const tabs=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[{"data-test-subj":"edit-rule-define-tab",id:rules_types["a"].defineRule,name:rules_translations["I"],disabled:rule===null||rule===void 0?void 0:rule.immutable,content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(StepPanel,{loading:loading,title:rules_translations["I"]},defineStep.data!=null&&external_kbnSharedDeps_React_default.a.createElement(StepDefineRule,{isReadOnlyView:false,isLoading:isLoading,isUpdateView:true,defaultValues:defineStep.data,setForm:setFormHook}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)))},{"data-test-subj":"edit-rule-about-tab",id:rules_types["a"].aboutRule,name:rules_translations["a"],disabled:rule===null||rule===void 0?void 0:rule.immutable,content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(StepPanel,{loading:loading,title:rules_translations["a"]},aboutStep.data!=null&&defineStep.data!=null&&external_kbnSharedDeps_React_default.a.createElement(StepAboutRule,{isReadOnlyView:false,isLoading:isLoading,isUpdateView:true,defaultValues:aboutStep.data,defineRuleData:defineStep.data,setForm:setFormHook}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)))},{"data-test-subj":"edit-rule-schedule-tab",id:rules_types["a"].scheduleRule,name:rules_translations["qb"],disabled:rule===null||rule===void 0?void 0:rule.immutable,content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(StepPanel,{loading:loading,title:rules_translations["qb"]},scheduleStep.data!=null&&external_kbnSharedDeps_React_default.a.createElement(StepScheduleRule,{isReadOnlyView:false,isLoading:isLoading,isUpdateView:true,defaultValues:scheduleStep.data,setForm:setFormHook}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)))},{"data-test-subj":"edit-rule-actions-tab",id:rules_types["a"].ruleActions,name:rules_translations["c"],content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(StepPanel,{loading:loading,title:rules_translations["c"]},actionsStep.data!=null&&external_kbnSharedDeps_React_default.a.createElement(StepRuleActions,{isReadOnlyView:false,isLoading:isLoading,isUpdateView:true,defaultValues:actionsStep.data,setForm:setFormHook,actionMessageParams:actionMessageParams}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)))}],[rule===null||rule===void 0?void 0:rule.immutable,loading,defineStep.data,isLoading,setFormHook,aboutStep.data,scheduleStep.data,actionsStep.data,actionMessageParams]);const onSubmit=Object(external_kbnSharedDeps_React_["useCallback"])(async()=>{const activeStepData=await formHooks.current[activeStep]();if((activeStepData===null||activeStepData===void 0?void 0:activeStepData.data)!=null){setStepData(activeStep,activeStepData.data,activeStepData.isValid)}const define=isDefineStep(activeStepData)?activeStepData:defineStep;const about=isAboutStep(activeStepData)?activeStepData:aboutStep;const schedule=isScheduleStep(activeStepData)?activeStepData:scheduleStep;const actions=isActionsStep(activeStepData)?activeStepData:actionsStep;if(stepIsValid(define)&&stepIsValid(about)&&stepIsValid(schedule)&&stepIsValid(actions)){setRule({...formatRule(define.data,about.data,schedule.data,actions.data,rule),...ruleId?{id:ruleId}:{},...rule!=null?{max_signals:rule.max_signals}:{}})}},[aboutStep,actionsStep,activeStep,defineStep,rule,ruleId,scheduleStep,setRule,setStepData]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(rule!=null){const{aboutRuleData:aboutRuleData,defineRuleData:defineRuleData,scheduleRuleData:scheduleRuleData,ruleActionsData:ruleActionsData}=getStepsData({rule:rule});setStepData(rules_types["a"].defineRule,defineRuleData,true);setStepData(rules_types["a"].aboutRule,aboutRuleData,true);setStepData(rules_types["a"].scheduleRule,scheduleRuleData,true);setStepData(rules_types["a"].ruleActions,ruleActionsData,true)}},[rule,setStepData]);const goToStep=Object(external_kbnSharedDeps_React_["useCallback"])(async step=>{setActiveStep(step);await formHooks.current[step]()},[]);const onTabClick=Object(external_kbnSharedDeps_React_["useCallback"])(async tab=>{const targetStep=tab.id;const activeStepData=await formHooks.current[activeStep]();if((activeStepData===null||activeStepData===void 0?void 0:activeStepData.data)!=null){setStepData(activeStep,activeStepData.data,activeStepData.isValid);goToStep(targetStep)}},[activeStep,goToStep,setStepData]);const goToDetailsRule=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();history.replace(Object(redirect_to_detection_engine["e"])(ruleId!==null&&ruleId!==void 0?ruleId:""))},[history,ruleId]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(rule!==null&&rule!==void 0&&rule.immutable){setActiveStep(rules_types["a"].ruleActions)}else{setActiveStep(rules_types["a"].defineRule)}},[rule]);if(isSaved){var _rule$name;Object(toasters["e"])(SUCCESSFULLY_SAVED_RULE((_rule$name=rule===null||rule===void 0?void 0:rule.name)!==null&&_rule$name!==void 0?_rule$name:""),dispatchToaster);history.replace(Object(redirect_to_detection_engine["e"])(ruleId!==null&&ruleId!==void 0?ruleId:""));return null}if(redirectToDetections(isSignalIndexExists,isAuthenticated,hasEncryptionKey,needsListsConfiguration)){history.replace(Object(redirect_to_detection_engine["c"])());return null}else if(helpers_userHasNoPermissions(canUserCRUD)){history.replace(Object(redirect_to_detection_engine["e"])(ruleId!==null&&ruleId!==void 0?ruleId:""));return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"row",justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(MaxWidthEuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{backOptions:{href:Object(redirect_to_detection_engine["e"])(ruleId!==null&&ruleId!==void 0?ruleId:""),text:`${BACK_TO} ${(_rule$name2=rule===null||rule===void 0?void 0:rule.name)!==null&&_rule$name2!==void 0?_rule$name2:""}`,pageId:app_types["a"].detections},isLoading:isLoading,title:translations_PAGE_TITLE}),invalidSteps.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:SORRY_ERRORS,color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.detectionEngine.rule.editRule.errorMsgDescription",defaultMessage:"You have an invalid input in {countError, plural, one {this tab} other {these tabs}}: {tabHasError}",values:{countError:invalidSteps.length,tabHasError:invalidSteps.map(t=>{if(t===rules_types["a"].aboutRule){return rules_translations["a"]}else if(t===rules_types["a"].defineRule){return rules_translations["I"]}else if(t===rules_types["a"].scheduleRule){return rules_translations["qb"]}else if(t===rules_types["a"].ruleActions){return rules_translations["pb"]}return t}).join(", ")}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabbedContent"],{initialSelectedTab:tabs[0],selectedTab:tabs.find(t=>t.id===activeStep),onTabClick:onTabClick,tabs:tabs}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"s",justifyContent:"flexEnd",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{iconType:"cross",onClick:goToDetailsRule},CANCEL)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"ruleEditSubmitButton",fill:true,onClick:onSubmit,iconType:"save",isLoading:isLoading,isDisabled:loading},SAVE_CHANGES)))))),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].detections,state:{ruleName:rule===null||rule===void 0?void 0:rule.name}}))};const EditRulePage=Object(external_kbnSharedDeps_React_["memo"])(EditRulePageComponent);var formatted_date=__webpack_require__(127);var markdown_editor=__webpack_require__(301);const ABOUT_PANEL_DETAILS_TAB=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.detailsLabel",{defaultMessage:"Details"});const ABOUT_TEXT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.aboutText",{defaultMessage:"About"});const ABOUT_PANEL_NOTES_TAB=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.investigationGuideLabel",{defaultMessage:"Investigation guide"});const ABOUT_CONTROL_LEGEND=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.controlLegend",{defaultMessage:"Viewing"});const step_about_rule_details_MyPanel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiPanel"]).withConfig({displayName:"MyPanel",componentId:"wtwaaw-0"})(["position:relative;"]);const FlexGroupFullHeight=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"FlexGroupFullHeight",componentId:"wtwaaw-1"})(["height:100%;"]);const VerticalOverflowContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"VerticalOverflowContainer",componentId:"wtwaaw-2"})(props=>({"max-height":`${props.maxHeight}px`,"overflow-y":"hidden"}));const VerticalOverflowContent=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"VerticalOverflowContent",componentId:"wtwaaw-3"})(props=>({"max-height":`${props.maxHeight}px`}));const AboutContent=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"AboutContent",componentId:"wtwaaw-4"})(["height:100%;"]);const toggleOptions=[{id:"details",label:ABOUT_PANEL_DETAILS_TAB,"data-test-subj":"stepAboutDetailsToggle-details"},{id:"notes",label:ABOUT_PANEL_NOTES_TAB,"data-test-subj":"stepAboutDetailsToggle-notes"}];const StepAboutRuleToggleDetailsComponent=({stepData:stepData,stepDataDetails:stepDataDetails,loading:loading})=>{const[selectedToggleOption,setToggleOption]=Object(external_kbnSharedDeps_React_["useState"])("details");const[aboutPanelHeight,setAboutPanelHeight]=Object(external_kbnSharedDeps_React_["useState"])(0);const onResize=Object(external_kbnSharedDeps_React_["useCallback"])(e=>{setAboutPanelHeight(e.height)},[setAboutPanelHeight]);return external_kbnSharedDeps_React_default.a.createElement(step_about_rule_details_MyPanel,null,loading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiProgress"],{size:"xs",color:"accent",position:"absolute"}),external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{title:ABOUT_TEXT})),stepData!=null&&stepDataDetails!=null&&external_kbnSharedDeps_React_default.a.createElement(FlexGroupFullHeight,{gutterSize:"xs",direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,key:"header"},external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{title:ABOUT_TEXT},!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(stepDataDetails.note)&&stepDataDetails.note.trim()!==""&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonGroup"],{options:toggleOptions,idSelected:selectedToggleOption,onChange:val=>{setToggleOption(val)},"data-test-subj":"stepAboutDetailsToggle",legend:ABOUT_CONTROL_LEGEND}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:"details"},selectedToggleOption==="details"?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiResizeObserver"],{"data-test-subj":"stepAboutDetailsContent",onResize:onResize},resizeRef=>external_kbnSharedDeps_React_default.a.createElement(AboutContent,{ref:resizeRef},external_kbnSharedDeps_React_default.a.createElement(VerticalOverflowContainer,{maxHeight:120},external_kbnSharedDeps_React_default.a.createElement(VerticalOverflowContent,{maxHeight:120,className:"eui-yScrollWithShadows"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s","data-test-subj":"stepAboutRuleDetailsToggleDescriptionText"},stepDataDetails.description))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(StepAboutRule,{descriptionColumns:"singleSplit",isReadOnlyView:true,isLoading:false,defaultValues:stepData}))):external_kbnSharedDeps_React_default.a.createElement(VerticalOverflowContainer,{"data-test-subj":"stepAboutDetailsNoteContent",maxHeight:aboutPanelHeight},external_kbnSharedDeps_React_default.a.createElement(VerticalOverflowContent,{maxHeight:aboutPanelHeight,className:"eui-yScrollWithShadows"},external_kbnSharedDeps_React_default.a.createElement(markdown_editor["MarkdownRenderer"],null,stepDataDetails.note))))))};const StepAboutRuleToggleDetails=Object(external_kbnSharedDeps_React_["memo"])(StepAboutRuleToggleDetailsComponent);const READ_ONLY_RULES_CALLOUT_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.readOnlyRulesCallOut.messageTitle",{defaultMessage:"Rule permissions required"});const readOnlyRulesCallOutBody=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.detectionEngine.readOnlyRulesCallOut.messageBody.messageDetail",defaultMessage:"{essence} Related documentation: {docs}",values:{essence:external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.detectionEngine.readOnlyRulesCallOut.messageBody.essenceDescription",defaultMessage:"You are currently missing the required permissions to create/edit detection engine rule. Please contact your administrator for further assistance."})),docs:external_kbnSharedDeps_React_default.a.createElement("ul",null,external_kbnSharedDeps_React_default.a.createElement("li",null,external_kbnSharedDeps_React_default.a.createElement(DetectionsRequirementsLink,null)),external_kbnSharedDeps_React_default.a.createElement("li",null,external_kbnSharedDeps_React_default.a.createElement(SecuritySolutionRequirementsLink,null)))}});const readOnlyAccessToRulesMessage={type:"primary",id:"read-only-access-to-rules",title:READ_ONLY_RULES_CALLOUT_TITLE,description:readOnlyRulesCallOutBody()};const ReadOnlyRulesCallOutComponent=()=>{const[{canUserCRUD:canUserCRUD}]=Object(user_info["b"])();return external_kbnSharedDeps_React_default.a.createElement(callouts["CallOutSwitcher"],{namespace:"detections",condition:canUserCRUD!=null&&!canUserCRUD,message:readOnlyAccessToRulesMessage})};const ReadOnlyRulesCallOut=Object(external_kbnSharedDeps_React_["memo"])(ReadOnlyRulesCallOutComponent);var telemetry=__webpack_require__(44);const bucketRulesResponse=response=>response.reduce((acc,cv)=>"error"in cv?{rules:[...acc.rules],errors:[...acc.errors,cv]}:{rules:[...acc.rules,cv],errors:[...acc.errors]},{rules:[],errors:[]});const showRulesTable=({rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled})=>rulesCustomInstalled!=null&&rulesCustomInstalled>0||rulesInstalled!=null&&rulesInstalled>0;const caseInsensitiveSort=tags=>tags.sort((a,b)=>a.toLowerCase().localeCompare(b.toLowerCase()));const getSearchFilters=({query:query,searchValue:searchValue,filterOptions:filterOptions,defaultSearchTerm:defaultSearchTerm})=>{const fieldClauses=query===null||query===void 0?void 0:query.ast.getFieldClauses();if(fieldClauses!=null&&fieldClauses.length>0){const filtersReduced=fieldClauses.reduce((acc,{field:field,value:value})=>{acc[field]=`${value}`;return acc},filterOptions);return filtersReduced}return{[defaultSearchTerm]:searchValue}};const editRuleAction=(rule,history)=>{history.push(Object(redirect_to_detection_engine["d"])(rule.id))};const duplicateRulesAction=async(rules,ruleIds,dispatch,dispatchToaster)=>{try{dispatch({type:"loadingRuleIds",ids:ruleIds,actionType:"duplicate"});const response=await Object(api["d"])({rules:rules.map(rule=>Object(transforms["b"])(rule))});const{errors:errors}=bucketRulesResponse(response);if(errors.length>0){Object(toasters["d"])(rules_translations["N"],errors.map(e=>e.error.message),dispatchToaster)}else{Object(toasters["e"])(rules_translations["yb"](ruleIds.length),dispatchToaster)}dispatch({type:"loadingRuleIds",ids:[],actionType:null})}catch(error){dispatch({type:"loadingRuleIds",ids:[],actionType:null});Object(toasters["g"])({title:rules_translations["N"],error:error,dispatchToaster:dispatchToaster})}};const exportRulesAction=(exportRuleId,dispatch)=>{dispatch({type:"exportRuleIds",ids:exportRuleId})};const deleteRulesAction=async(ruleIds,dispatch,dispatchToaster,onRuleDeleted)=>{try{dispatch({type:"loadingRuleIds",ids:ruleIds,actionType:"delete"});const response=await Object(api["c"])({ids:ruleIds});const{errors:errors}=bucketRulesResponse(response);dispatch({type:"loadingRuleIds",ids:[],actionType:null});if(errors.length>0){Object(toasters["d"])(rules_translations["o"](ruleIds.length),errors.map(e=>e.error.message),dispatchToaster)}else if(onRuleDeleted){onRuleDeleted()}}catch(error){dispatch({type:"loadingRuleIds",ids:[],actionType:null});Object(toasters["g"])({title:rules_translations["o"](ruleIds.length),error:error,dispatchToaster:dispatchToaster})}};const enableRulesAction=async(ids,enabled,dispatch,dispatchToaster)=>{const errorTitle=enabled?rules_translations["k"](ids.length):rules_translations["m"](ids.length);try{dispatch({type:"loadingRuleIds",ids:ids,actionType:enabled?"enable":"disable"});const response=await Object(api["e"])({ids:ids,enabled:enabled});const{rules:rules,errors:errors}=bucketRulesResponse(response);dispatch({type:"updateRules",rules:rules});if(errors.length>0){Object(toasters["d"])(errorTitle,errors.map(e=>e.error.message),dispatchToaster)}if(rules.some(rule=>rule.immutable)){Object(telemetry["e"])(telemetry["a"].COUNT,enabled?telemetry["b"].SIEM_RULE_ENABLED:telemetry["b"].SIEM_RULE_DISABLED)}if(rules.some(rule=>!rule.immutable)){Object(telemetry["e"])(telemetry["a"].COUNT,enabled?telemetry["b"].CUSTOM_RULE_ENABLED:telemetry["b"].CUSTOM_RULE_DISABLED)}}catch(e){Object(toasters["d"])(errorTitle,[e.message],dispatchToaster);dispatch({type:"loadingRuleIds",ids:[],actionType:null})}};const StaticSwitch=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiSwitch"]).withConfig({displayName:"StaticSwitch",componentId:"sc-12pilng-0"})([".euiSwitch__thumb,.euiSwitch__icon{transition:none;}"]);StaticSwitch.displayName="StaticSwitch";const RuleSwitchComponent=({dispatch:dispatch,id:id,isDisabled:isDisabled,isLoading:isLoading,enabled:enabled,optionLabel:optionLabel,onChange:onChange})=>{const[myIsLoading,setMyIsLoading]=Object(external_kbnSharedDeps_React_["useState"])(false);const[myEnabled,setMyEnabled]=Object(external_kbnSharedDeps_React_["useState"])(enabled!==null&&enabled!==void 0?enabled:false);const[,dispatchToaster]=Object(toasters["h"])();const onRuleStateChange=Object(external_kbnSharedDeps_React_["useCallback"])(async event=>{setMyIsLoading(true);if(dispatch!=null){await enableRulesAction([id],event.target.checked,dispatch,dispatchToaster)}else{const enabling=event.target.checked;const title=enabling?rules_translations["k"](1):rules_translations["m"](1);try{const response=await Object(api["e"])({ids:[id],enabled:enabling});const{rules:rules,errors:errors}=bucketRulesResponse(response);if(errors.length>0){setMyIsLoading(false);Object(toasters["d"])(title,errors.map(e=>e.error.message),dispatchToaster)}else{const[rule]=rules;setMyEnabled(rule.enabled);if(onChange!=null){onChange(rule.enabled)}}}catch(err){setMyIsLoading(false);Object(toasters["d"])(title,err.message,dispatchToaster)}}setMyIsLoading(false)},[dispatch,id]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(myEnabled!==enabled){setMyEnabled(enabled)}},[enabled]);const showLoader=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(myIsLoading!==isLoading){return isLoading!==null&&isLoading!==void 0?isLoading:false}return myIsLoading},[myIsLoading,isLoading]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},showLoader?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m","data-test-subj":"ruleSwitchLoader"}):external_kbnSharedDeps_React_default.a.createElement(StaticSwitch,{"data-test-subj":"ruleSwitch",label:optionLabel!==null&&optionLabel!==void 0?optionLabel:"",showLabel:!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(optionLabel),disabled:isDisabled,checked:myEnabled,onChange:onRuleStateChange})))};const RuleSwitch=external_kbnSharedDeps_React_default.a.memo(RuleSwitchComponent);RuleSwitch.displayName="RuleSwitch";const ALL_ACTIONS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.components.ruleActionsOverflow.allActionsTitle",{defaultMessage:"All actions"});var generic_downloader=__webpack_require__(520);const isBoolean=obj=>typeof obj==="boolean";const canEditRuleWithActions=(rule,privileges)=>{var _rule$actions;if(rule==null){return true}if(((_rule$actions=rule.actions)===null||_rule$actions===void 0?void 0:_rule$actions.length)>0&&isBoolean(privileges)){return privileges}return true};const getToolTipContent=(rule,hasMlPermissions,hasReadActionsPrivileges)=>{if(rule==null){return undefined}else if(Object(helpers["d"])(rule.type)&&!hasMlPermissions){return detection_engine_translations["f"]}else if(!canEditRuleWithActions(rule,hasReadActionsPrivileges)){return rules_translations["Q"]}else{return undefined}};const MyEuiButtonIcon=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"]).withConfig({displayName:"MyEuiButtonIcon",componentId:"wltxb1-0"})(["&.euiButtonIcon{svg{transform:rotate(90deg);}border:1px solid  ",";width:40px;height:40px;}"],({theme:theme})=>theme.euiColorPrimary);const RuleActionsOverflowComponent=({rule:rule,userHasNoPermissions:userHasNoPermissions,canDuplicateRuleWithActions:canDuplicateRuleWithActions})=>{const[isPopoverOpen,setIsPopoverOpen]=Object(external_kbnSharedDeps_React_["useState"])(false);const[rulesToExport,setRulesToExport]=Object(external_kbnSharedDeps_React_["useState"])([]);const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const[,dispatchToaster]=Object(toasters["h"])();const onRuleDeletedCallback=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{history.push(Object(redirect_to_detection_engine["f"])())},[history]);const actions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>rule!=null?[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:rules_translations["M"],icon:"copy",disabled:!canDuplicateRuleWithActions||userHasNoPermissions,"data-test-subj":"rules-details-duplicate-rule",onClick:async()=>{setIsPopoverOpen(false);await duplicateRulesAction([rule],[rule.id],external_kbnSharedDeps_LodashFp_["noop"],dispatchToaster)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"left",content:getToolTipContent(rule,true,canDuplicateRuleWithActions)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,rules_translations["M"]))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:rules_translations["U"],icon:"exportAction",disabled:userHasNoPermissions||rule.immutable,"data-test-subj":"rules-details-export-rule",onClick:()=>{setIsPopoverOpen(false);setRulesToExport([rule.rule_id])}},rules_translations["U"]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:rules_translations["K"],icon:"trash",disabled:userHasNoPermissions,"data-test-subj":"rules-details-delete-rule",onClick:async()=>{setIsPopoverOpen(false);await deleteRulesAction([rule.id],external_kbnSharedDeps_LodashFp_["noop"],dispatchToaster,onRuleDeletedCallback)}},rules_translations["K"])]:[],[rule,userHasNoPermissions]);const handlePopoverOpen=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setIsPopoverOpen(!isPopoverOpen)},[setIsPopoverOpen,isPopoverOpen]);const button=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:ALL_ACTIONS},external_kbnSharedDeps_React_default.a.createElement(MyEuiButtonIcon,{iconType:"boxesHorizontal","aria-label":ALL_ACTIONS,isDisabled:userHasNoPermissions,"data-test-subj":"rules-details-popover-button-icon",onClick:handlePopoverOpen})),[handlePopoverOpen,userHasNoPermissions]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{anchorPosition:"leftCenter",button:button,closePopover:()=>setIsPopoverOpen(false),id:"ruleActionsOverflow",isOpen:isPopoverOpen,"data-test-subj":"rules-details-popover",ownFocus:true,panelPaddingSize:"none",repositionOnScroll:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuPanel"],{"data-test-subj":"rules-details-menu-panel",items:actions})),external_kbnSharedDeps_React_default.a.createElement(generic_downloader["a"],{filename:`${rules_translations["T"]}.ndjson`,ids:rulesToExport,exportSelectedData:api["f"],"data-test-subj":"rules-details-generic-downloader",onExportSuccess:exportCount=>{Object(toasters["e"])(rules_translations["zb"](exportCount),dispatchToaster)}}))};const RuleActionsOverflow=external_kbnSharedDeps_React_default.a.memo(RuleActionsOverflowComponent);RuleActionsOverflow.displayName="RuleActionsOverflow";const details_translations_PAGE_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.pageTitle",{defaultMessage:"Rule details"});const translations_BACK_TO_RULES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.backToRulesDescription",{defaultMessage:"Back to detection rules"});const EXPERIMENTAL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.experimentalDescription",{defaultMessage:"Experimental"});const ACTIVATE_RULE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.activateRuleLabel",{defaultMessage:"Activate"});const UNKNOWN=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.unknownDescription",{defaultMessage:"Unknown"});const ERROR_CALLOUT_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.errorCalloutTitle",{defaultMessage:"Rule failure at"});const PARTIAL_FAILURE_CALLOUT_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.partialErrorCalloutTitle",{defaultMessage:"Warning at"});const FAILURE_HISTORY_TAB=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.failureHistoryTab",{defaultMessage:"Failure History"});const LAST_FIVE_ERRORS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.lastFiveErrorsTitle",{defaultMessage:"Last five errors"});const COLUMN_STATUS_TYPE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.statusTypeColumn",{defaultMessage:"Type"});const COLUMN_FAILED_AT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.statusFailedAtColumn",{defaultMessage:"Failed at"});const COLUMN_FAILED_MSG=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.statusFailedMsgColumn",{defaultMessage:"Failed message"});const TYPE_FAILED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.statusFailedDescription",{defaultMessage:"Failed"});const EXCEPTIONS_TAB=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleDetails.exceptionsTab",{defaultMessage:"Exceptions"});const RuleStatusFailedCallOutComponent=({date:date,message:message,color:color})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"xs",alignItems:"center",justifyContent:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},color==="warning"?PARTIAL_FAILURE_CALLOUT_TITLE:ERROR_CALLOUT_TITLE),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(formatted_date["a"],{value:date,fieldName:"last_failure_at"}))),color:color?color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("p",null,message));const RuleStatusFailedCallOut=Object(external_kbnSharedDeps_React_["memo"])(RuleStatusFailedCallOutComponent);const FailureHistoryComponent=({id:id})=>{const[loading,ruleStatus]=useRuleStatus(id);if(loading){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{title:LAST_FIVE_ERRORS}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingContent"],null))}const columns=[{name:COLUMN_STATUS_TYPE,render:()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:"danger"},TYPE_FAILED),truncateText:false,width:"16%"},{field:"last_failure_at",name:COLUMN_FAILED_AT,render:value=>external_kbnSharedDeps_React_default.a.createElement(formatted_date["a"],{value:value,fieldName:"last_failure_at"}),sortable:false,truncateText:false,width:"24%"},{field:"last_failure_message",name:COLUMN_FAILED_MSG,render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,value),sortable:false,truncateText:false,width:"60%"}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{title:LAST_FIVE_ERRORS}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBasicTable"],{columns:columns,loading:loading,items:ruleStatus!=null?ruleStatus===null||ruleStatus===void 0?void 0:ruleStatus.failures.filter(rs=>rs.last_failure_at!=null):[],sorting:{sort:{field:"status_date",direction:"desc"}}}))};const FailureHistory=Object(external_kbnSharedDeps_React_["memo"])(FailureHistoryComponent);const getStatusColor=status=>status==null?"subdued":status==="succeeded"?"success":status==="failed"?"danger":status==="executing"||status==="going to run"||status==="partial failure"||status==="warning"?"warning":"subdued";const STATUS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleStatus.statusDescription",{defaultMessage:"Last response"});const STATUS_AT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleStatus.statusAtDescription",{defaultMessage:"at"});const STATUS_DATE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleStatus.statusDateDescription",{defaultMessage:"Status date"});const REFRESH=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.ruleStatus.refreshButton",{defaultMessage:"Refresh"});const RuleStatusComponent=({children:children,statusDate:statusDate,status:status})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:getStatusColor(status!==null&&status!==void 0?status:null)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{"data-test-subj":"ruleStatus",size:"xs"},status!==null&&status!==void 0?status:Object(empty_value["d"])()))),statusDate!=null&&status!=null&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,STATUS_AT)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(formatted_date["a"],{value:statusDate,fieldName:STATUS_DATE}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},children));const RuleStatus=Object(external_kbnSharedDeps_React_["memo"])(RuleStatusComponent);var exceptions_translations=__webpack_require__(160);var loader=__webpack_require__(170);var lists_plugin_deps=__webpack_require__(161);const ExceptionsViewerHeaderComponent=({isInitLoading:isInitLoading,supportedListTypes:supportedListTypes,detectionsListItems:detectionsListItems,endpointListItems:endpointListItems,onFilterChange:onFilterChange,onAddExceptionClick:onAddExceptionClick})=>{const[filter,setFilter]=Object(external_kbnSharedDeps_React_["useState"])("");const[tags,setTags]=Object(external_kbnSharedDeps_React_["useState"])([]);const[showDetectionsListsOnly,setShowDetectionsList]=Object(external_kbnSharedDeps_React_["useState"])(false);const[showEndpointListsOnly,setShowEndpointList]=Object(external_kbnSharedDeps_React_["useState"])(false);const[isAddExceptionMenuOpen,setAddExceptionMenuOpen]=Object(external_kbnSharedDeps_React_["useState"])(false);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{onFilterChange({filter:{filter:filter,tags:tags},pagination:{pageIndex:0},showDetectionsListsOnly:showDetectionsListsOnly,showEndpointListsOnly:showEndpointListsOnly})},[filter,tags,showDetectionsListsOnly,showEndpointListsOnly,onFilterChange]);const onAddExceptionDropdownClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setAddExceptionMenuOpen(!isAddExceptionMenuOpen),[setAddExceptionMenuOpen,isAddExceptionMenuOpen]);const handleDetectionsListClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setShowDetectionsList(!showDetectionsListsOnly);setShowEndpointList(false)},[showDetectionsListsOnly,setShowDetectionsList,setShowEndpointList]);const handleEndpointListClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setShowEndpointList(!showEndpointListsOnly);setShowDetectionsList(false)},[showEndpointListsOnly,setShowEndpointList,setShowDetectionsList]);const handleOnSearch=Object(external_kbnSharedDeps_React_["useCallback"])(searchValue=>{const tagsRegex=/(tags:[^\s]*)/i;const tagsMatch=searchValue.match(tagsRegex);const foundTags=tagsMatch!=null?tagsMatch[0].split(":")[1]:"";const filterString=tagsMatch!=null?searchValue.replace(tagsRegex,""):searchValue;if(foundTags.length>0){setTags(foundTags.split(","))}setFilter(filterString.trim())},[setTags,setFilter]);const onAddException=Object(external_kbnSharedDeps_React_["useCallback"])(type=>{onAddExceptionClick(type);setAddExceptionMenuOpen(false)},[onAddExceptionClick,setAddExceptionMenuOpen]);const addExceptionButtonOptions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[{id:0,items:[{name:exceptions_translations["g"],onClick:()=>onAddException(lists_plugin_deps["a"].ENDPOINT),"data-test-subj":"addEndpointExceptionBtn"},{name:exceptions_translations["f"],onClick:()=>onAddException(lists_plugin_deps["a"].DETECTION),"data-test-subj":"addDetectionsExceptionBtn"}]}],[onAddException]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldSearch"],{"data-test-subj":"exceptionsHeaderSearch","aria-label":exceptions_translations["I"],placeholder:exceptions_translations["I"],onSearch:handleOnSearch,disabled:isInitLoading,incremental:false,fullWidth:true})),supportedListTypes.length<2&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"exceptionsHeaderAddExceptionBtn",onClick:()=>onAddException(supportedListTypes[0]),isDisabled:isInitLoading,fill:true},exceptions_translations["d"])),supportedListTypes.length>1&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterGroup"],{"data-test-subj":"exceptionsFilterGroupBtns"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterButton"],{"data-test-subj":"exceptionsDetectionFilterBtn",hasActiveFilters:showDetectionsListsOnly,onClick:handleDetectionsListClick,isDisabled:isInitLoading},exceptions_translations["r"],detectionsListItems!=null?` (${detectionsListItems})`:""),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterButton"],{"data-test-subj":"exceptionsEndpointFilterBtn",hasActiveFilters:showEndpointListsOnly,onClick:handleEndpointListClick,isDisabled:isInitLoading},exceptions_translations["v"],endpointListItems!=null?` (${endpointListItems})`:""))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"exceptionsHeaderAddExceptionPopoverBtn",onClick:onAddExceptionDropdownClick,isDisabled:isInitLoading,iconType:"arrowDown",iconSide:"right",fill:true},exceptions_translations["d"]),isOpen:isAddExceptionMenuOpen,closePopover:onAddExceptionDropdownClick,anchorPosition:"downCenter",panelPaddingSize:"none",repositionOnScroll:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenu"],{initialPanelId:0,panels:addExceptionButtonOptions}))))))};ExceptionsViewerHeaderComponent.displayName="ExceptionsViewerHeaderComponent";const ExceptionsViewerHeader=external_kbnSharedDeps_React_default.a.memo(ExceptionsViewerHeaderComponent);ExceptionsViewerHeader.displayName="ExceptionsViewerHeader";const allExceptionItemsReducer=()=>(state,action)=>{switch(action.type){case"setExceptions":{var _pagination$total;const{exceptions:exceptions,pagination:pagination}=action;return{...state,pagination:{...state.pagination,pageIndex:pagination.page-1,pageSize:pagination.perPage,totalItemCount:(_pagination$total=pagination.total)!==null&&_pagination$total!==void 0?_pagination$total:0},exceptions:exceptions}}case"updateFilterOptions":{const{filter:filter,pagination:pagination,showEndpointListsOnly:showEndpointListsOnly,showDetectionsListsOnly:showDetectionsListsOnly}=action.filters;return{...state,filterOptions:{...state.filterOptions,...filter},pagination:{...state.pagination,...pagination},showEndpointListsOnly:showEndpointListsOnly!==null&&showEndpointListsOnly!==void 0?showEndpointListsOnly:state.showEndpointListsOnly,showDetectionsListsOnly:showDetectionsListsOnly!==null&&showDetectionsListsOnly!==void 0?showDetectionsListsOnly:state.showDetectionsListsOnly}}case"setExceptionItemTotals":{return{...state,totalEndpointItems:action.totalEndpointItems==null?state.totalEndpointItems:action.totalEndpointItems,totalDetectionsItems:action.totalDetectionsItems==null?state.totalDetectionsItems:action.totalDetectionsItems}}case"updateIsInitLoading":{return{...state,isInitLoading:action.loading}}case"updateLoadingItemIds":{return{...state,loadingItemIds:[...state.loadingItemIds,...action.items]}}case"updateExceptionToEdit":{const{exception:exception,lists:lists}=action;const exceptionListToEdit=lists.find(list=>list!==null&&exception.list_id===list.listId);return{...state,exceptionToEdit:exception,exceptionListTypeToEdit:exceptionListToEdit?exceptionListToEdit.type:null}}case"updateModalOpen":{return{...state,currentModal:action.modalName}}case"updateExceptionListTypeToEdit":{return{...state,exceptionListTypeToEdit:action.exceptionListType}}default:return state}};const ExceptionsViewerPaginationComponent=({pagination:pagination,onPaginationChange:onPaginationChange})=>{const[isOpen,setIsOpen]=Object(external_kbnSharedDeps_React_["useState"])(false);const handleClosePerPageMenu=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setIsOpen(false),[setIsOpen]);const handlePerPageMenuClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setIsOpen(isPopoverOpen=>!isPopoverOpen),[setIsOpen]);const handlePageClick=Object(external_kbnSharedDeps_React_["useCallback"])(pageIndex=>{onPaginationChange({pagination:{pageIndex:pageIndex,pageSize:pagination.pageSize,totalItemCount:pagination.totalItemCount}})},[pagination,onPaginationChange]);const items=Object(external_kbnSharedDeps_React_["useMemo"])(()=>pagination.pageSizeOptions.map(rows=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:rows,icon:"empty",onClick:()=>{onPaginationChange({pagination:{pageIndex:0,pageSize:rows,totalItemCount:pagination.totalItemCount}});handleClosePerPageMenu()},"data-test-subj":"exceptionsPerPageItem"},exceptions_translations["D"](rows))),[pagination,onPaginationChange,handleClosePerPageMenu]);const totalPages=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(pagination.totalItemCount>0){return Math.ceil(pagination.totalItemCount/pagination.pageSize)}else{return 1}},[pagination]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{size:"s",color:"text",iconType:"arrowDown",iconSide:"right",onClick:handlePerPageMenuClick,"data-test-subj":"exceptionsPerPageBtn"},exceptions_translations["B"](pagination.pageSize)),isOpen:isOpen,closePopover:handleClosePerPageMenu,panelPaddingSize:"none",repositionOnScroll:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuPanel"],{items:items}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPagination"],{pageCount:totalPages,activePage:pagination.pageIndex,onPageClick:handlePageClick,"data-test-subj":"exceptionsPagination"})))};ExceptionsViewerPaginationComponent.displayName="ExceptionsViewerPaginationComponent";const ExceptionsViewerPagination=external_kbnSharedDeps_React_default.a.memo(ExceptionsViewerPaginationComponent);ExceptionsViewerPagination.displayName="ExceptionsViewerPagination";const StyledText=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiText"]).withConfig({displayName:"StyledText",componentId:"oztuyc-0"})(["font-style:italic;"]);const MyUtilities=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"MyUtilities",componentId:"oztuyc-1"})(["height:50px;"]);const ExceptionsViewerUtilityComponent=({pagination:pagination,showEndpointListsOnly:showEndpointListsOnly,showDetectionsListsOnly:showDetectionsListsOnly,ruleSettingsUrl:ruleSettingsUrl,onRefreshClick:onRefreshClick})=>{var _pagination$totalItem;return external_kbnSharedDeps_React_default.a.createElement(MyUtilities,{alignItems:"center",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(utility_bar["a"],null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["d"],null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["c"],null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["f"],{dataTestSubj:"exceptionsShowing"},exceptions_translations["J"]((_pagination$totalItem=pagination.totalItemCount)!==null&&_pagination$totalItem!==void 0?_pagination$totalItem:0))),external_kbnSharedDeps_React_default.a.createElement(utility_bar["c"],null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["b"],{dataTestSubj:"exceptionsRefresh",iconSide:"left",iconType:"refresh",onClick:onRefreshClick},exceptions_translations["G"]))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(StyledText,{size:"s"},showEndpointListsOnly&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.exceptions.viewer.exceptionEndpointDetailsDescription",defaultMessage:"All exceptions to this rule are applied to the endpoint and the detection rule. View {ruleSettings} for more details.","data-test-subj":"exceptionsEndpointMessage",values:{ruleSettings:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:ruleSettingsUrl,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.exceptions.viewer.exceptionEndpointDetailsDescription.ruleSettingsLink",defaultMessage:"rule settings"}))}}),showDetectionsListsOnly&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.exceptions.viewer.exceptionDetectionDetailsDescription",defaultMessage:"All exceptions to this rule are applied to the detection rule, not the endpoint. View {ruleSettings} for more details.","data-test-subj":"exceptionsDetectionsMessage",values:{ruleSettings:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:ruleSettingsUrl,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.exceptions.viewer.exceptionDetectionDetailsDescription.ruleSettingsLink",defaultMessage:"rule settings"}))}}))))};ExceptionsViewerUtilityComponent.displayName="ExceptionsViewerUtilityComponent";const ExceptionsViewerUtility=external_kbnSharedDeps_React_default.a.memo(ExceptionsViewerUtilityComponent);ExceptionsViewerUtility.displayName="ExceptionsViewerUtility";var exceptions_helpers=__webpack_require__(208);const formatEntry=({isNested:isNested,item:item})=>{var _item$field;const operator=Object(exceptions_helpers["l"])(item);const value=Object(exceptions_helpers["k"])(item);return{fieldName:(_item$field=item.field)!==null&&_item$field!==void 0?_item$field:"",operator:operator.message,value:value,isNested:isNested}};const helpers_getFormattedEntries=entries=>{const formattedEntries=entries.map(item=>{if(lists_plugin_deps["g"].is(item)){const parent={fieldName:item.field,operator:undefined,value:undefined,isNested:false};return item.entries.reduce((acc,nestedEntry)=>{const formattedEntry=formatEntry({isNested:true,item:nestedEntry});return[...acc,{...formattedEntry}]},[parent])}else{return formatEntry({isNested:false,item:item})}});return formattedEntries.flat()};const getDescriptionListContent=exceptionItem=>{const details=[{title:exceptions_translations["E"],value:Object(exceptions_helpers["j"])(exceptionItem.os_types)},{title:exceptions_translations["o"],value:external_kbnSharedDeps_Moment_default()(exceptionItem.created_at).format("MMMM Do YYYY @ HH:mm:ss")},{title:exceptions_translations["n"],value:exceptionItem.created_by},{title:exceptions_translations["q"],value:exceptionItem.description}];return details.reduce((acc,{value:value,title:title})=>{if(value!=null&&value.trim()!==""){return[...acc,{title:title,description:value}]}else{return acc}},[])};const MyExceptionDetails=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyExceptionDetails",componentId:"z36hrg-0"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["background-color:",";padding:",";"],theme.eui.euiColorLightestShade,theme.eui.euiSize));const MyDescriptionListTitle=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"]).withConfig({displayName:"MyDescriptionListTitle",componentId:"z36hrg-1"})(["width:40%;"]);const MyDescriptionListDescription=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"]).withConfig({displayName:"MyDescriptionListDescription",componentId:"z36hrg-2"})(["width:60%;"]);const ExceptionDetailsComponent=({showComments:showComments,onCommentsClick:onCommentsClick,exceptionItem:exceptionItem})=>{const descriptionListItems=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getDescriptionListContent(exceptionItem),[exceptionItem]);const commentsSection=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const{comments:comments}=exceptionItem;if(comments.length>0){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:onCommentsClick,flush:"left",size:"xs","data-test-subj":"exceptionsViewerItemCommentsBtn"},!showComments?exceptions_translations["l"](comments.length):exceptions_translations["k"](comments.length))}else{return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null)}},[showComments,onCommentsClick,exceptionItem]);return external_kbnSharedDeps_React_default.a.createElement(MyExceptionDetails,{grow:2},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionList"],{compressed:true,type:"column","data-test-subj":"exceptionsViewerItemDetails"},descriptionListItems.map(item=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],{key:`${item.title}`},external_kbnSharedDeps_React_default.a.createElement(MyDescriptionListTitle,null,item.title),external_kbnSharedDeps_React_default.a.createElement(MyDescriptionListDescription,null,item.description))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},commentsSection)))};ExceptionDetailsComponent.displayName="ExceptionDetailsComponent";const ExceptionDetails=external_kbnSharedDeps_React_default.a.memo(ExceptionDetailsComponent);ExceptionDetails.displayName="ExceptionDetails";var polished_lib=__webpack_require__(180);const MyEntriesDetails=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyEntriesDetails",componentId:"sc-1tpcxfd-0"})(["padding:",";"],({theme:theme})=>theme.eui.euiSize);const MyEditButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiButton"]).withConfig({displayName:"MyEditButton",componentId:"sc-1tpcxfd-1"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["background-color:",";border:none;font-weight:",";"],Object(polished_lib["transparentize"])(.9,theme.eui.euiColorPrimary),theme.eui.euiFontWeightSemiBold));const MyRemoveButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiButton"]).withConfig({displayName:"MyRemoveButton",componentId:"sc-1tpcxfd-2"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["background-color:",";border:none;font-weight:",";"],Object(polished_lib["transparentize"])(.9,theme.eui.euiColorDanger),theme.eui.euiFontWeightSemiBold));const MyAndOrBadgeContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyAndOrBadgeContainer",componentId:"sc-1tpcxfd-3"})(["padding-top:",";padding-bottom:",";"],({theme:theme})=>theme.eui.euiSizeXL,({theme:theme})=>theme.eui.euiSizeS);const MyActionButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyActionButton",componentId:"sc-1tpcxfd-4"})(["align-self:flex-end;"]);const MyNestedValueContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"MyNestedValueContainer",componentId:"sc-1tpcxfd-5"})(["margin-left:",";"],({theme:theme})=>theme.eui.euiSizeL);const MyNestedValue=external_kbnSharedDeps_StyledComponents_default.a.span.withConfig({displayName:"MyNestedValue",componentId:"sc-1tpcxfd-6"})(["margin-left:",";"],({theme:theme})=>theme.eui.euiSizeS);const ValueBadgeGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiBadgeGroup"]).withConfig({displayName:"ValueBadgeGroup",componentId:"sc-1tpcxfd-7"})(["width:100%;"]);const ExceptionEntriesComponent=({entries:entries,disableDelete:disableDelete,onDelete:onDelete,onEdit:onEdit})=>{const columns=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[{field:"fieldName",name:"Field",sortable:false,truncateText:true,textOnly:true,"data-test-subj":"exceptionFieldNameCell",width:"30%",render:(value,data)=>{if(value!=null&&data.isNested){return external_kbnSharedDeps_React_default.a.createElement(MyNestedValueContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{type:"nested",size:"s"}),external_kbnSharedDeps_React_default.a.createElement(MyNestedValue,null,value))}else{return value!==null&&value!==void 0?value:Object(empty_value["e"])()}}},{field:"operator",name:"Operator",sortable:false,truncateText:true,"data-test-subj":"exceptionFieldOperatorCell",width:"20%",render:value=>value!==null&&value!==void 0?value:Object(empty_value["e"])()},{field:"value",name:"Value",sortable:false,truncateText:true,"data-test-subj":"exceptionFieldValueCell",width:"60%",render:values=>{if(Array.isArray(values)){return external_kbnSharedDeps_React_default.a.createElement(ValueBadgeGroup,{gutterSize:"xs"},values.map(value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{color:"#DDD",key:value},value)))}else{return values!==null&&values!==void 0?values:Object(empty_value["e"])()}}}],[entries]);return external_kbnSharedDeps_React_default.a.createElement(MyEntriesDetails,{grow:5},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"row",gutterSize:"none"},entries.length>1&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHideFor"],{sizes:["xs","s"]},external_kbnSharedDeps_React_default.a.createElement(MyAndOrBadgeContainer,{grow:false},external_kbnSharedDeps_React_default.a.createElement(and_or_badge["a"],{type:"and",includeAntennas:true,"data-test-subj":"exceptionsViewerAndBadge"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBasicTable"],{isSelectable:false,itemId:"id",columns:columns,items:entries,responsive:true})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(MyActionButton,{grow:false},external_kbnSharedDeps_React_default.a.createElement(MyEditButton,{size:"s",color:"primary",onClick:onEdit,isDisabled:disableDelete,"data-test-subj":"exceptionsViewerEditBtn"},exceptions_translations["u"])),external_kbnSharedDeps_React_default.a.createElement(MyActionButton,{grow:false},external_kbnSharedDeps_React_default.a.createElement(MyRemoveButton,{size:"s",color:"danger",onClick:onDelete,isLoading:disableDelete,"data-test-subj":"exceptionsViewerDeleteBtn"},exceptions_translations["H"]))))))};ExceptionEntriesComponent.displayName="ExceptionEntriesComponent";const ExceptionEntries=external_kbnSharedDeps_React_default.a.memo(ExceptionEntriesComponent);ExceptionEntries.displayName="ExceptionEntries";const MyFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyFlexItem",componentId:"l5qlm8-0"})(["&.comments--show{padding:",";border-top:",";}"],({theme:theme})=>theme.eui.euiSize,({theme:theme})=>`${theme.eui.euiBorderThin}`);const ExceptionItemComponent=({loadingItemIds:loadingItemIds,exceptionItem:exceptionItem,commentsAccordionId:commentsAccordionId,onDeleteException:onDeleteException,onEditException:onEditException})=>{const[entryItems,setEntryItems]=Object(external_kbnSharedDeps_React_["useState"])([]);const[showComments,setShowComments]=Object(external_kbnSharedDeps_React_["useState"])(false);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const formattedEntries=helpers_getFormattedEntries(exceptionItem.entries);setEntryItems(formattedEntries)},[exceptionItem.entries]);const handleDelete=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{onDeleteException({id:exceptionItem.id,namespaceType:exceptionItem.namespace_type})},[onDeleteException,exceptionItem.id,exceptionItem.namespace_type]);const handleEdit=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{onEditException(exceptionItem)},[onEditException,exceptionItem]);const onCommentsClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setShowComments(!showComments)},[setShowComments,showComments]);const formattedComments=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(exceptions_helpers["m"])(exceptionItem.comments),[exceptionItem.comments]);const disableDelete=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const foundItems=loadingItemIds.filter(({id:id})=>id===exceptionItem.id);return foundItems.length>0},[loadingItemIds,exceptionItem.id]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],{paddingSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"row"},external_kbnSharedDeps_React_default.a.createElement(ExceptionDetails,{showComments:showComments,exceptionItem:exceptionItem,onCommentsClick:onCommentsClick}),external_kbnSharedDeps_React_default.a.createElement(ExceptionEntries,{disableDelete:disableDelete,entries:entryItems,onDelete:handleDelete,onEdit:handleEdit}))),external_kbnSharedDeps_React_default.a.createElement(MyFlexItem,{className:showComments?"comments--show":""},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAccordion"],{id:commentsAccordionId,arrowDisplay:"none",forceState:showComments?"open":"closed","data-test-subj":"exceptionsViewerCommentAccordion"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCommentList"],{comments:formattedComments})))))};ExceptionItemComponent.displayName="ExceptionItemComponent";const ExceptionItem=external_kbnSharedDeps_React_default.a.memo(ExceptionItemComponent);ExceptionItem.displayName="ExceptionItem";const exceptions_viewer_items_MyFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"MyFlexItem",componentId:"z8zhds-0"})(["margin:",";&:first-child{margin:",";}"],({theme:theme})=>`${theme.eui.euiSize} 0`,({theme:theme})=>`${theme.eui.euiSizeXS} 0 ${theme.eui.euiSize}`);const MyExceptionsContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"MyExceptionsContainer",componentId:"z8zhds-1"})(["height:600px;overflow:hidden;"]);const MyExceptionItemContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"MyExceptionItemContainer",componentId:"z8zhds-2"})(["margin:",";"],({theme:theme})=>`0 ${theme.eui.euiSize} ${theme.eui.euiSize} 0`);const ExceptionsViewerItemsComponent=({showEmpty:showEmpty,showNoResults:showNoResults,isInitLoading:isInitLoading,exceptions:exceptions,loadingItemIds:loadingItemIds,commentsAccordionId:commentsAccordionId,onDeleteException:onDeleteException,onEditExceptionItem:onEditExceptionItem})=>external_kbnSharedDeps_React_default.a.createElement(MyExceptionsContainer,{direction:"column",className:"eui-yScrollWithShadows"},showEmpty||showNoResults||isInitLoading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{iconType:showNoResults?"searchProfilerApp":"list",title:external_kbnSharedDeps_React_default.a.createElement("h2",{"data-test-subj":"exceptionsEmptyPromptTitle"},showNoResults?"":exceptions_translations["y"]),body:external_kbnSharedDeps_React_default.a.createElement("p",{"data-test-subj":"exceptionsEmptyPromptBody"},showNoResults?exceptions_translations["z"]:exceptions_translations["x"]),"data-test-subj":"exceptionsEmptyPrompt"})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,className:"eui-yScrollWithShadows"},external_kbnSharedDeps_React_default.a.createElement(MyExceptionItemContainer,{"data-test-subj":"exceptionsContainer",gutterSize:"none",direction:"column"},!isInitLoading&&exceptions.length>0&&exceptions.map((exception,index)=>external_kbnSharedDeps_React_default.a.createElement(exceptions_viewer_items_MyFlexItem,{"data-test-subj":"exceptionItemContainer",grow:false,key:exception.id},index!==0?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(and_or_badge["a"],{"data-test-subj":"exceptionItemOrBadge",type:"or"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(ExceptionItem,{loadingItemIds:loadingItemIds,commentsAccordionId:commentsAccordionId,exceptionItem:exception,onDeleteException:onDeleteException,onEditException:onEditExceptionItem}))))));ExceptionsViewerItemsComponent.displayName="ExceptionsViewerItemsComponent";const ExceptionsViewerItems=external_kbnSharedDeps_React_default.a.memo(ExceptionsViewerItemsComponent);ExceptionsViewerItems.displayName="ExceptionsViewerItems";var use_signal_index=__webpack_require__(283);var use_rule_async=__webpack_require__(378);const translations_CANCEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.cancel",{defaultMessage:"Cancel"});const EDIT_EXCEPTION_SAVE_BUTTON=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.editExceptionSaveButton",{defaultMessage:"Save"});const EDIT_EXCEPTION_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.editExceptionTitle",{defaultMessage:"Edit Rule Exception"});const EDIT_ENDPOINT_EXCEPTION_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.editEndpointExceptionTitle",{defaultMessage:"Edit Endpoint Exception"});const EDIT_EXCEPTION_ERROR=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.error",{defaultMessage:"Failed to update exception"});const EDIT_EXCEPTION_SUCCESS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.success",{defaultMessage:"Successfully updated exception"});const BULK_CLOSE_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.bulkCloseLabel",{defaultMessage:"Close all alerts that match this exception and were generated by this rule"});const BULK_CLOSE_LABEL_DISABLED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.bulkCloseLabel.disabled",{defaultMessage:"Close all alerts that match this exception and were generated by this rule (Lists and non-ECS fields are not supported)"});const ENDPOINT_QUARANTINE_TEXT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.endpointQuarantineText",{defaultMessage:"On all Endpoint hosts, quarantined files that match the exception are automatically restored to their original locations. This exception applies to all rules using Endpoint exceptions."});const EXCEPTION_BUILDER_INFO=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.infoLabel",{defaultMessage:"Alerts are generated when the rule's conditions are met, except when:"});const VERSION_CONFLICT_ERROR_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.versionConflictTitle",{defaultMessage:"Sorry, there was an error"});const VERSION_CONFLICT_ERROR_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.versionConflictDescription",{defaultMessage:"It appears this exception was updated since you first selected to edit it. Try clicking 'Cancel' and editing the exception again."});const EDIT_EXCEPTION_SEQUENCE_WARNING=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.editException.sequenceWarning",{defaultMessage:"This rule's query contains an EQL sequence statement. The exception modified will apply to all events in the sequence."});var builder=__webpack_require__(751);var use_add_exception=__webpack_require__(694);var add_exception_comments=__webpack_require__(695);var error_callout=__webpack_require__(792);var use_get_jobs=__webpack_require__(793);const Modal=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiModal"]).withConfig({displayName:"Modal",componentId:"sc-1xmfgey-0"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["width:",";max-width:",";"],theme.eui.euiBreakpoints.l,theme.eui.euiBreakpoints.l));const ModalHeader=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiModalHeader"]).withConfig({displayName:"ModalHeader",componentId:"sc-1xmfgey-1"})(["flex-direction:column;align-items:flex-start;"]);const ModalHeaderSubtitle=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"ModalHeaderSubtitle",componentId:"sc-1xmfgey-2"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["color:",";"],theme.eui.euiColorMediumShade));const ModalBodySection=external_kbnSharedDeps_StyledComponents_default.a.section.withConfig({displayName:"ModalBodySection",componentId:"sc-1xmfgey-3"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["padding:"," ",";&.builder-section{overflow-y:scroll;}"],theme.eui.euiSizeS,theme.eui.euiSizeL));const edit_exception_modal_EditExceptionModal=Object(external_kbnSharedDeps_React_["memo"])((function EditExceptionModal({ruleName:ruleName,ruleId:ruleId,ruleIndices:ruleIndices,exceptionItem:exceptionItem,exceptionListType:exceptionListType,onCancel:onCancel,onConfirm:onConfirm,onRuleChange:onRuleChange}){const{http:http}=Object(lib_kibana["h"])().services;const[comment,setComment]=Object(external_kbnSharedDeps_React_["useState"])("");const[errorsExist,setErrorExists]=Object(external_kbnSharedDeps_React_["useState"])(false);const{rule:maybeRule,loading:isRuleLoading}=Object(use_rule_async["a"])(ruleId);const[updateError,setUpdateError]=Object(external_kbnSharedDeps_React_["useState"])(null);const[hasVersionConflict,setHasVersionConflict]=Object(external_kbnSharedDeps_React_["useState"])(false);const[shouldBulkCloseAlert,setShouldBulkCloseAlert]=Object(external_kbnSharedDeps_React_["useState"])(false);const[shouldDisableBulkClose,setShouldDisableBulkClose]=Object(external_kbnSharedDeps_React_["useState"])(false);const[exceptionItemsToAdd,setExceptionItemsToAdd]=Object(external_kbnSharedDeps_React_["useState"])([]);const{addError:addError,addSuccess:addSuccess}=Object(use_app_toasts["a"])();const{loading:isSignalIndexLoading,signalIndexName:signalIndexName}=Object(use_signal_index["a"])();const memoSignalIndexName=Object(external_kbnSharedDeps_React_["useMemo"])(()=>signalIndexName!==null?[signalIndexName]:[],[signalIndexName]);const[isSignalIndexPatternLoading,{indexPatterns:signalIndexPatterns}]=Object(source["b"])(memoSignalIndexName);const memoMlJobIds=Object(external_kbnSharedDeps_React_["useMemo"])(()=>(maybeRule===null||maybeRule===void 0?void 0:maybeRule.machine_learning_job_id)!=null?[maybeRule.machine_learning_job_id]:[],[maybeRule]);const{loading:mlJobLoading,jobs:jobs}=Object(use_get_jobs["a"])(memoMlJobIds);const memoRuleIndices=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(jobs.length>0){return jobs[0].results_index_name?[`.ml-anomalies-${jobs[0].results_index_name}`]:[]}else{return ruleIndices}},[jobs,ruleIndices]);const[isIndexPatternLoading,{indexPatterns:indexPatterns}]=Object(source["b"])(memoRuleIndices);const handleExceptionUpdateError=Object(external_kbnSharedDeps_React_["useCallback"])((error,statusCode,message)=>{if(error.message.includes("Conflict")){setHasVersionConflict(true)}else{setUpdateError({reason:error.message,code:statusCode,details:message,listListId:exceptionItem.list_id})}},[setUpdateError,setHasVersionConflict,exceptionItem.list_id]);const handleDissasociationSuccess=Object(external_kbnSharedDeps_React_["useCallback"])(id=>{addSuccess(exceptions_translations["t"](id));if(onRuleChange){onRuleChange()}onCancel()},[addSuccess,onCancel,onRuleChange]);const handleDissasociationError=Object(external_kbnSharedDeps_React_["useCallback"])(error=>{addError(error,{title:exceptions_translations["s"]});onCancel()},[addError,onCancel]);const handleExceptionUpdateSuccess=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{addSuccess(EDIT_EXCEPTION_SUCCESS);onConfirm()},[addSuccess,onConfirm]);const[{isLoading:addExceptionIsLoading},addOrUpdateExceptionItems]=Object(use_add_exception["a"])({http:http,onSuccess:handleExceptionUpdateSuccess,onError:handleExceptionUpdateError});Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(isSignalIndexPatternLoading===false&&isSignalIndexLoading===false){setShouldDisableBulkClose(Object(exceptions_helpers["f"])(exceptionItemsToAdd)||Object(exceptions_helpers["g"])(exceptionItemsToAdd,signalIndexPatterns)||exceptionItemsToAdd.every(item=>item.entries.length===0))}},[setShouldDisableBulkClose,exceptionItemsToAdd,isSignalIndexPatternLoading,isSignalIndexLoading,signalIndexPatterns]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(shouldDisableBulkClose===true){setShouldBulkCloseAlert(false)}},[shouldDisableBulkClose]);const isSubmitButtonDisabled=Object(external_kbnSharedDeps_React_["useMemo"])(()=>exceptionItemsToAdd.every(item=>item.entries.length===0)||hasVersionConflict||errorsExist,[exceptionItemsToAdd,hasVersionConflict,errorsExist]);const handleBuilderOnChange=Object(external_kbnSharedDeps_React_["useCallback"])(({exceptionItems:exceptionItems,errorExists:errorExists})=>{setExceptionItemsToAdd(exceptionItems);setErrorExists(errorExists)},[setExceptionItemsToAdd]);const onCommentChange=Object(external_kbnSharedDeps_React_["useCallback"])(value=>{setComment(value)},[setComment]);const onBulkCloseAlertCheckboxChange=Object(external_kbnSharedDeps_React_["useCallback"])(event=>{setShouldBulkCloseAlert(event.currentTarget.checked)},[setShouldBulkCloseAlert]);const enrichExceptionItems=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{const[exceptionItemToEdit]=exceptionItemsToAdd;let enriched=[{...Object(exceptions_helpers["d"])(exceptionItemToEdit,[...exceptionItem.comments,...comment.trim()!==""?[{comment:comment}]:[]])}];if(exceptionListType==="endpoint"){enriched=Object(exceptions_helpers["o"])(Object(exceptions_helpers["c"])(enriched,exceptionItem.os_types))}return enriched},[exceptionItemsToAdd,exceptionItem,comment,exceptionListType]);const onEditExceptionConfirm=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(addOrUpdateExceptionItems!==null){const bulkCloseIndex=shouldBulkCloseAlert&&signalIndexName!==null?[signalIndexName]:undefined;addOrUpdateExceptionItems(ruleId,enrichExceptionItems(),undefined,bulkCloseIndex)}},[addOrUpdateExceptionItems,ruleId,enrichExceptionItems,shouldBulkCloseAlert,signalIndexName]);const isRuleEQLSequenceStatement=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(maybeRule!=null){return Object(utils["d"])(maybeRule.type)&&Object(utils["b"])(maybeRule.query)}return false},[maybeRule]);return external_kbnSharedDeps_React_default.a.createElement(Modal,{onClose:onCancel,"data-test-subj":"add-exception-modal"},external_kbnSharedDeps_React_default.a.createElement(ModalHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModalHeaderTitle"],null,exceptionListType==="endpoint"?EDIT_ENDPOINT_EXCEPTION_TITLE:EDIT_EXCEPTION_TITLE),external_kbnSharedDeps_React_default.a.createElement(ModalHeaderSubtitle,{className:"eui-textTruncate",title:ruleName},ruleName)),(addExceptionIsLoading||isIndexPatternLoading||isSignalIndexLoading)&&external_kbnSharedDeps_React_default.a.createElement(loader["a"],{"data-test-subj":"loadingEditExceptionModal",size:"xl"}),!isSignalIndexLoading&&!addExceptionIsLoading&&!isIndexPatternLoading&&!isRuleLoading&&!mlJobLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ModalBodySection,{className:"builder-section"},isRuleEQLSequenceStatement&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{"data-test-subj":"eql-sequence-callout",title:EDIT_EXCEPTION_SEQUENCE_WARNING}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,EXCEPTION_BUILDER_INFO),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(builder["a"],{exceptionListItems:[exceptionItem],listType:exceptionListType,listId:exceptionItem.list_id,listNamespaceType:exceptionItem.namespace_type,ruleName:ruleName,isOrDisabled:true,isAndDisabled:false,isNestedDisabled:false,"data-test-subj":"edit-exception-modal-builder","id-aria":"edit-exception-modal-builder",onChange:handleBuilderOnChange,indexPatterns:indexPatterns,ruleType:maybeRule===null||maybeRule===void 0?void 0:maybeRule.type}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(add_exception_comments["a"],{exceptionItemComments:exceptionItem.comments,newCommentValue:comment,newCommentOnChange:onCommentChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_kbnSharedDeps_React_default.a.createElement(ModalBodySection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCheckbox"],{"data-test-subj":"close-alert-on-add-edit-exception-checkbox",id:"close-alert-on-add-edit-exception-checkbox",label:shouldDisableBulkClose?BULK_CLOSE_LABEL_DISABLED:BULK_CLOSE_LABEL,checked:shouldBulkCloseAlert,onChange:onBulkCloseAlertCheckboxChange,disabled:shouldDisableBulkClose})),exceptionListType==="endpoint"&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{"data-test-subj":"edit-exception-endpoint-text",color:"subdued",size:"s"},ENDPOINT_QUARANTINE_TEXT)))),updateError!=null&&external_kbnSharedDeps_React_default.a.createElement(ModalBodySection,null,external_kbnSharedDeps_React_default.a.createElement(error_callout["a"],{http:http,errorInfo:updateError,rule:maybeRule,onCancel:onCancel,onSuccess:handleDissasociationSuccess,onError:handleDissasociationError})),hasVersionConflict&&external_kbnSharedDeps_React_default.a.createElement(ModalBodySection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:VERSION_CONFLICT_ERROR_TITLE,color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("p",null,VERSION_CONFLICT_ERROR_DESCRIPTION))),updateError==null&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModalFooter"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"cancelExceptionAddButton",onClick:onCancel},translations_CANCEL),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"edit-exception-confirm-button",onClick:onEditExceptionConfirm,isLoading:addExceptionIsLoading,isDisabled:isSubmitButtonDisabled,fill:true},EDIT_EXCEPTION_SAVE_BUTTON)))}));var add_exception_modal=__webpack_require__(769);const viewer_initialState={filterOptions:{filter:"",tags:[]},pagination:{pageIndex:0,pageSize:20,totalItemCount:0,pageSizeOptions:[5,10,20,50,100,200,300]},exceptions:[],exceptionToEdit:null,loadingItemIds:[],isInitLoading:true,currentModal:null,exceptionListTypeToEdit:null,totalEndpointItems:0,totalDetectionsItems:0,showEndpointListsOnly:false,showDetectionsListsOnly:false};const ExceptionsViewerComponent=({ruleId:ruleId,ruleName:ruleName,ruleIndices:ruleIndices,exceptionListsMeta:exceptionListsMeta,availableListTypes:availableListTypes,commentsAccordionId:commentsAccordionId,onRuleChange:onRuleChange})=>{const{services:services}=Object(lib_kibana["h"])();const[,dispatchToaster]=Object(toasters["h"])();const onDispatchToaster=Object(external_kbnSharedDeps_React_["useCallback"])(({title:title,color:color,iconType:iconType})=>()=>{dispatchToaster({type:"addToaster",toast:{id:uuid_default.a.v4(),title:title,color:color,iconType:iconType}})},[dispatchToaster]);const[{exceptions:exceptions,filterOptions:filterOptions,pagination:pagination,loadingItemIds:loadingItemIds,isInitLoading:isInitLoading,currentModal:currentModal,exceptionToEdit:exceptionToEdit,exceptionListTypeToEdit:exceptionListTypeToEdit,totalEndpointItems:totalEndpointItems,totalDetectionsItems:totalDetectionsItems,showDetectionsListsOnly:showDetectionsListsOnly,showEndpointListsOnly:showEndpointListsOnly},dispatch]=Object(external_kbnSharedDeps_React_["useReducer"])(allExceptionItemsReducer(),{...viewer_initialState});const{deleteExceptionItem:deleteExceptionItem,getExceptionListsItems:getExceptionListsItems}=Object(lists_plugin_deps["j"])(services.http);const setExceptions=Object(external_kbnSharedDeps_React_["useCallback"])(({exceptions:newExceptions,pagination:newPagination})=>{dispatch({type:"setExceptions",lists:exceptionListsMeta,exceptions:newExceptions,pagination:newPagination})},[dispatch,exceptionListsMeta]);const[loadingList,,,fetchListItems]=Object(lists_plugin_deps["k"])({http:services.http,lists:exceptionListsMeta,filterOptions:filterOptions.filter!==""||filterOptions.tags.length>0?[filterOptions]:[],pagination:{page:pagination.pageIndex+1,perPage:pagination.pageSize,total:pagination.totalItemCount},showDetectionsListsOnly:showDetectionsListsOnly,showEndpointListsOnly:showEndpointListsOnly,matchFilters:true,onSuccess:setExceptions,onError:onDispatchToaster({color:"danger",title:exceptions_translations["A"],iconType:"alert"})});const setCurrentModal=Object(external_kbnSharedDeps_React_["useCallback"])(modalName=>{dispatch({type:"updateModalOpen",modalName:modalName})},[dispatch]);const setExceptionItemTotals=Object(external_kbnSharedDeps_React_["useCallback"])((endpointItemTotals,detectionItemTotals)=>{dispatch({type:"setExceptionItemTotals",totalEndpointItems:endpointItemTotals,totalDetectionsItems:detectionItemTotals})},[dispatch]);const handleGetTotals=Object(external_kbnSharedDeps_React_["useCallback"])(async()=>{await getExceptionListsItems({lists:exceptionListsMeta,filterOptions:[],pagination:{page:0,perPage:1,total:0},showDetectionsListsOnly:true,showEndpointListsOnly:false,onSuccess:({pagination:detectionPagination})=>{var _detectionPagination$;setExceptionItemTotals(null,(_detectionPagination$=detectionPagination.total)!==null&&_detectionPagination$!==void 0?_detectionPagination$:0)},onError:()=>{const dispatchToasterError=onDispatchToaster({color:"danger",title:exceptions_translations["K"],iconType:"alert"});dispatchToasterError()}});await getExceptionListsItems({lists:exceptionListsMeta,filterOptions:[],pagination:{page:0,perPage:1,total:0},showDetectionsListsOnly:false,showEndpointListsOnly:true,onSuccess:({pagination:endpointPagination})=>{var _endpointPagination$t;setExceptionItemTotals((_endpointPagination$t=endpointPagination.total)!==null&&_endpointPagination$t!==void 0?_endpointPagination$t:0,null)},onError:()=>{const dispatchToasterError=onDispatchToaster({color:"danger",title:exceptions_translations["K"],iconType:"alert"});dispatchToasterError()}})},[setExceptionItemTotals,exceptionListsMeta,getExceptionListsItems,onDispatchToaster]);const handleFetchList=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(fetchListItems!=null){fetchListItems();handleGetTotals()}},[fetchListItems,handleGetTotals]);const handleFilterChange=Object(external_kbnSharedDeps_React_["useCallback"])(filters=>{dispatch({type:"updateFilterOptions",filters:filters})},[dispatch]);const handleAddException=Object(external_kbnSharedDeps_React_["useCallback"])(type=>{dispatch({type:"updateExceptionListTypeToEdit",exceptionListType:type});setCurrentModal("addModal")},[setCurrentModal]);const handleEditException=Object(external_kbnSharedDeps_React_["useCallback"])(exception=>{dispatch({type:"updateExceptionToEdit",lists:exceptionListsMeta,exception:exception});setCurrentModal("editModal")},[setCurrentModal,exceptionListsMeta]);const handleOnCancelExceptionModal=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setCurrentModal(null);handleFetchList()},[setCurrentModal,handleFetchList]);const handleOnConfirmExceptionModal=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setCurrentModal(null);handleFetchList()},[setCurrentModal,handleFetchList]);const setLoadingItemIds=Object(external_kbnSharedDeps_React_["useCallback"])(items=>{dispatch({type:"updateLoadingItemIds",items:items})},[dispatch]);const handleDeleteException=Object(external_kbnSharedDeps_React_["useCallback"])(({id:itemId,namespaceType:namespaceType})=>{setLoadingItemIds([{id:itemId,namespaceType:namespaceType}]);deleteExceptionItem({id:itemId,namespaceType:namespaceType,onSuccess:()=>{setLoadingItemIds(loadingItemIds.filter(({id:id})=>id!==itemId));handleFetchList()},onError:()=>{const dispatchToasterError=onDispatchToaster({color:"danger",title:exceptions_translations["p"],iconType:"alert"});dispatchToasterError();setLoadingItemIds(loadingItemIds.filter(({id:id})=>id!==itemId))}})},[setLoadingItemIds,deleteExceptionItem,loadingItemIds,handleFetchList,onDispatchToaster]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(isInitLoading&&!loadingList&&(exceptions.length===0||exceptions!=null)){handleGetTotals();dispatch({type:"updateIsInitLoading",loading:false})}},[handleGetTotals,isInitLoading,exceptions,loadingList,dispatch]);const ruleSettingsUrl=services.application.getUrlForApp(`security/detections/rules/id/${encodeURI(ruleId)}/edit`);const showEmpty=!isInitLoading&&!loadingList&&totalEndpointItems===0&&totalDetectionsItems===0;const showNoResults=exceptions.length===0&&(totalEndpointItems>0||totalDetectionsItems>0);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,currentModal==="editModal"&&exceptionToEdit!=null&&exceptionListTypeToEdit!=null&&external_kbnSharedDeps_React_default.a.createElement(edit_exception_modal_EditExceptionModal,{ruleName:ruleName,ruleId:ruleId,ruleIndices:ruleIndices,exceptionListType:exceptionListTypeToEdit,exceptionItem:exceptionToEdit,onCancel:handleOnCancelExceptionModal,onConfirm:handleOnConfirmExceptionModal,onRuleChange:onRuleChange}),currentModal==="addModal"&&exceptionListTypeToEdit!=null&&external_kbnSharedDeps_React_default.a.createElement(add_exception_modal["a"],{ruleName:ruleName,ruleIndices:ruleIndices,ruleId:ruleId,exceptionListType:exceptionListTypeToEdit,onCancel:handleOnCancelExceptionModal,onConfirm:handleOnConfirmExceptionModal,onRuleChange:onRuleChange}),external_kbnSharedDeps_React_default.a.createElement(panel["a"],{loading:isInitLoading||loadingList},(isInitLoading||loadingList)&&external_kbnSharedDeps_React_default.a.createElement(loader["a"],{"data-test-subj":"loadingPanelAllRulesTable",overlay:true,size:"xl"}),external_kbnSharedDeps_React_default.a.createElement(ExceptionsViewerHeader,{isInitLoading:isInitLoading,supportedListTypes:availableListTypes,detectionsListItems:totalDetectionsItems,endpointListItems:totalEndpointItems,onFilterChange:handleFilterChange,onAddExceptionClick:handleAddException}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(ExceptionsViewerUtility,{pagination:pagination,showEndpointListsOnly:showEndpointListsOnly,showDetectionsListsOnly:showDetectionsListsOnly,onRefreshClick:handleFetchList,ruleSettingsUrl:ruleSettingsUrl}),external_kbnSharedDeps_React_default.a.createElement(ExceptionsViewerItems,{showEmpty:showEmpty,showNoResults:showNoResults,isInitLoading:isInitLoading,exceptions:exceptions,loadingItemIds:loadingItemIds,commentsAccordionId:commentsAccordionId,onDeleteException:handleDeleteException,onEditExceptionItem:handleEditException}),external_kbnSharedDeps_React_default.a.createElement(ExceptionsViewerPagination,{onPaginationChange:handleFilterChange,pagination:pagination})))};ExceptionsViewerComponent.displayName="ExceptionsViewerComponent";const ExceptionsViewer=external_kbnSharedDeps_React_default.a.memo(ExceptionsViewerComponent);ExceptionsViewer.displayName="ExceptionsViewer";const details_StyledFullHeightContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"ycgey0-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]);var RuleDetailTabs;(function(RuleDetailTabs){RuleDetailTabs["alerts"]="alerts";RuleDetailTabs["failures"]="failures";RuleDetailTabs["exceptions"]="exceptions"})(RuleDetailTabs||(RuleDetailTabs={}));const getRuleDetailsTabs=rule=>[{id:RuleDetailTabs.alerts,name:detection_engine_translations["a"],disabled:false,dataTestSubj:"alertsTab"},{id:RuleDetailTabs.exceptions,name:EXCEPTIONS_TAB,disabled:false,dataTestSubj:"exceptionsTab"},{id:RuleDetailTabs.failures,name:FAILURE_HISTORY_TAB,disabled:false,dataTestSubj:"failureHistoryTab"}];const RuleDetailsPageComponent=()=>{var _ruleStatus$current_s,_rule$name,_rule$id,_rule$enabled,_rule$name2,_rule$index;const dispatch=Object(react_redux_lib["useDispatch"])();const containerElement=Object(external_kbnSharedDeps_React_["useRef"])(null);const getTimeline=Object(external_kbnSharedDeps_React_["useMemo"])(()=>store_timeline["b"].getTimelineByIdSelector(),[]);const graphEventId=Object(use_selector["b"])(state=>{var _getTimeline;return((_getTimeline=getTimeline(state,types_timeline["e"].detectionsRulesDetailsPage))!==null&&_getTimeline!==void 0?_getTimeline:defaults["a"]).graphEventId});const getGlobalFiltersQuerySelector=Object(external_kbnSharedDeps_React_["useMemo"])(()=>inputs["d"].globalFiltersQuerySelector(),[]);const getGlobalQuerySelector=Object(external_kbnSharedDeps_React_["useMemo"])(()=>inputs["d"].globalQuerySelector(),[]);const query=Object(use_selector["a"])(getGlobalQuerySelector);const filters=Object(use_selector["a"])(getGlobalFiltersQuerySelector);const{to:to,from:from,deleteQuery:deleteQuery,setQuery:setQuery}=Object(use_global_time["a"])();const[{loading:userInfoLoading,isSignalIndexExists:isSignalIndexExists,isAuthenticated:isAuthenticated,hasEncryptionKey:hasEncryptionKey,canUserCRUD:canUserCRUD,hasIndexWrite:hasIndexWrite,hasIndexMaintenance:hasIndexMaintenance,signalIndexName:signalIndexName}]=Object(user_info["b"])();const{loading:listsConfigLoading,needsConfiguration:needsListsConfiguration}=useListsConfig();const loading=userInfoLoading||listsConfigLoading;const{detailName:ruleId}=Object(external_kbnSharedDeps_ReactRouterDom_["useParams"])();const{rule:maybeRule,refresh:refreshRule,loading:ruleLoading}=Object(use_rule_async["a"])(ruleId);const[loadingStatus,ruleStatus,fetchRuleStatus]=useRuleStatus(ruleId);const[currentStatus,setCurrentStatus]=Object(external_kbnSharedDeps_React_["useState"])((_ruleStatus$current_s=ruleStatus===null||ruleStatus===void 0?void 0:ruleStatus.current_status)!==null&&_ruleStatus$current_s!==void 0?_ruleStatus$current_s:null);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!fast_deep_equal_default()(currentStatus,ruleStatus===null||ruleStatus===void 0?void 0:ruleStatus.current_status)){var _ruleStatus$current_s2;setCurrentStatus((_ruleStatus$current_s2=ruleStatus===null||ruleStatus===void 0?void 0:ruleStatus.current_status)!==null&&_ruleStatus$current_s2!==void 0?_ruleStatus$current_s2:null)}},[currentStatus,ruleStatus,setCurrentStatus]);const[rule,setRule]=Object(external_kbnSharedDeps_React_["useState"])(null);const isLoading=ruleLoading&&rule==null;const[ruleEnabled,setRuleEnabled]=Object(external_kbnSharedDeps_React_["useState"])(null);const[ruleDetailTab,setRuleDetailTab]=Object(external_kbnSharedDeps_React_["useState"])(RuleDetailTabs.alerts);const{aboutRuleData:aboutRuleData,modifiedAboutRuleDetailsData:modifiedAboutRuleDetailsData,defineRuleData:defineRuleData,scheduleRuleData:scheduleRuleData}=rule!=null?getStepsData({rule:rule,detailsView:true}):{aboutRuleData:null,modifiedAboutRuleDetailsData:null,defineRuleData:null,scheduleRuleData:null};const[lastAlerts]=useAlertInfo({ruleId:ruleId});const[showBuildingBlockAlerts,setShowBuildingBlockAlerts]=Object(external_kbnSharedDeps_React_["useState"])(false);const mlCapabilities=Object(use_ml_capabilities["a"])();const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const{formatUrl:formatUrl}=Object(link_to["o"])(app_types["a"].detections);const{globalFullScreen:globalFullScreen}=Object(use_full_screen["a"])();const hasMlPermissions=Object(has_ml_license["a"])(mlCapabilities)&&Object(has_ml_admin_permissions["a"])(mlCapabilities);const ruleDetailTabs=getRuleDetailsTabs(rule);const{services:{application:{capabilities:{actions:actions}}}}=Object(lib_kibana["h"])();const hasActionsPrivileges=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if((rule===null||rule===void 0?void 0:rule.actions)!=null&&(rule===null||rule===void 0?void 0:rule.actions.length)>0&&isBoolean(actions.show)){return actions.show}return true},[actions,rule===null||rule===void 0?void 0:rule.actions]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(maybeRule!=null){setRule(maybeRule)}},[maybeRule]);const title=(_rule$name=rule===null||rule===void 0?void 0:rule.name)!==null&&_rule$name!==void 0?_rule$name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"});const subTitle=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _rule$created_by,_rule$created_at,_rule$updated_by,_rule$updated_at;return rule==null?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"}):[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleCreationDescription",defaultMessage:"Created by: {by} on {date}",values:{by:(_rule$created_by=rule===null||rule===void 0?void 0:rule.created_by)!==null&&_rule$created_by!==void 0?_rule$created_by:UNKNOWN,date:external_kbnSharedDeps_React_default.a.createElement(formatted_date["a"],{value:(_rule$created_at=rule===null||rule===void 0?void 0:rule.created_at)!==null&&_rule$created_at!==void 0?_rule$created_at:(new Date).toISOString(),fieldName:"createdAt"})}}),(rule===null||rule===void 0?void 0:rule.updated_by)!=null?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleUpdateDescription",defaultMessage:"Updated by: {by} on {date}",values:{by:(_rule$updated_by=rule===null||rule===void 0?void 0:rule.updated_by)!==null&&_rule$updated_by!==void 0?_rule$updated_by:UNKNOWN,date:external_kbnSharedDeps_React_default.a.createElement(formatted_date["a"],{value:(_rule$updated_at=rule===null||rule===void 0?void 0:rule.updated_at)!==null&&_rule$updated_at!==void 0?_rule$updated_at:(new Date).toISOString(),fieldName:"updatedAt"})}}):""]},[rule]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setShowBuildingBlockAlerts((rule===null||rule===void 0?void 0:rule.building_block_type)!=null)},[rule]);const alertDefaultFilters=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[...ruleId!=null?Object(default_config["d"])(ruleId):[],...Object(default_config["e"])(showBuildingBlockAlerts)],[ruleId,showBuildingBlockAlerts]);const alertMergedFilters=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[...alertDefaultFilters,...filters],[alertDefaultFilters,filters]);const tabs=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabs"],null,ruleDetailTabs.map(tab=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{onClick:()=>setRuleDetailTab(tab.id),isSelected:tab.id===ruleDetailTab,disabled:tab.disabled,key:tab.id,"data-test-subj":tab.dataTestSubj},tab.name))),[ruleDetailTabs,ruleDetailTab,setRuleDetailTab]);const handleRefresh=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(fetchRuleStatus!=null&&ruleId!=null){fetchRuleStatus(ruleId)}},[fetchRuleStatus,ruleId]);const ruleStatusInfo=Object(external_kbnSharedDeps_React_["useMemo"])(()=>loadingStatus?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m","data-test-subj":"rule-status-loader"})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(RuleStatus,{status:Object(utils["a"])(currentStatus===null||currentStatus===void 0?void 0:currentStatus.status),statusDate:currentStatus===null||currentStatus===void 0?void 0:currentStatus.status_date},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"data-test-subj":"refreshButton",color:"primary",onClick:handleRefresh,iconType:"refresh","aria-label":rules_translations["ib"]}))),[currentStatus,loadingStatus,handleRefresh]);const ruleError=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(loadingStatus){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m","data-test-subj":"rule-status-loader"}))}else if((currentStatus===null||currentStatus===void 0?void 0:currentStatus.status)==="failed"&&ruleDetailTab===RuleDetailTabs.alerts&&(currentStatus===null||currentStatus===void 0?void 0:currentStatus.last_failure_at)!=null){var _currentStatus$last_f;return external_kbnSharedDeps_React_default.a.createElement(RuleStatusFailedCallOut,{message:(_currentStatus$last_f=currentStatus===null||currentStatus===void 0?void 0:currentStatus.last_failure_message)!==null&&_currentStatus$last_f!==void 0?_currentStatus$last_f:"",date:currentStatus===null||currentStatus===void 0?void 0:currentStatus.last_failure_at})}else if(((currentStatus===null||currentStatus===void 0?void 0:currentStatus.status)==="warning"||(currentStatus===null||currentStatus===void 0?void 0:currentStatus.status)==="partial failure")&&ruleDetailTab===RuleDetailTabs.alerts&&(currentStatus===null||currentStatus===void 0?void 0:currentStatus.last_success_at)!=null){var _currentStatus$last_s;return external_kbnSharedDeps_React_default.a.createElement(RuleStatusFailedCallOut,{message:(_currentStatus$last_s=currentStatus===null||currentStatus===void 0?void 0:currentStatus.last_success_message)!==null&&_currentStatus$last_s!==void 0?_currentStatus$last_s:"",date:currentStatus===null||currentStatus===void 0?void 0:currentStatus.last_success_at,color:"warning"})}return null},[ruleDetailTab,currentStatus,loadingStatus]);const updateDateRangeCallback=Object(external_kbnSharedDeps_React_["useCallback"])(({x:x})=>{if(!x){return}const[min,max]=x;dispatch(Object(inputs_actions["setAbsoluteRangeDatePicker"])({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()}))},[dispatch]);const handleOnChangeEnabledRule=Object(external_kbnSharedDeps_React_["useCallback"])(enabled=>{if(ruleEnabled==null||enabled!==ruleEnabled){setRuleEnabled(enabled)}},[ruleEnabled,setRuleEnabled]);const goToEditRule=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();history.push(Object(redirect_to_detection_engine["d"])(ruleId!==null&&ruleId!==void 0?ruleId:""))},[history,ruleId]);const editRule=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _userHasNoPermissions;if(!hasActionsPrivileges){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:rules_translations["Q"]},external_kbnSharedDeps_React_default.a.createElement(links["g"],{onClick:goToEditRule,iconType:"controlsHorizontal",isDisabled:true,href:formatUrl(Object(redirect_to_detection_engine["d"])(ruleId!==null&&ruleId!==void 0?ruleId:""))},rules_translations["P"]))}return external_kbnSharedDeps_React_default.a.createElement(links["g"],{onClick:goToEditRule,iconType:"controlsHorizontal",isDisabled:(_userHasNoPermissions=helpers_userHasNoPermissions(canUserCRUD))!==null&&_userHasNoPermissions!==void 0?_userHasNoPermissions:true,href:formatUrl(Object(redirect_to_detection_engine["d"])(ruleId!==null&&ruleId!==void 0?ruleId:""))},rules_translations["P"])},[canUserCRUD,formatUrl,goToEditRule,hasActionsPrivileges,ruleId]);const onShowBuildingBlockAlertsChangedCallback=Object(external_kbnSharedDeps_React_["useCallback"])(newShowBuildingBlockAlerts=>{setShowBuildingBlockAlerts(newShowBuildingBlockAlerts)},[setShowBuildingBlockAlerts]);const{indicesExist:indicesExist,indexPattern:indexPattern}=Object(sourcerer["b"])(model["SourcererScopeName"].detections);const exceptionLists=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(rule!=null&&rule.exceptions_list!=null){return rule.exceptions_list.reduce((acc,{id:id,list_id:listId,namespace_type:namespaceType,type:type})=>{const{allowedExceptionListTypes:allowedExceptionListTypes,lists:lists}=acc;const shouldAddEndpoint=type===shared_imports["b"].ENDPOINT&&!allowedExceptionListTypes.includes(shared_imports["b"].ENDPOINT);return{lists:[...lists,{id:id,listId:listId,namespaceType:namespaceType,type:type}],allowedExceptionListTypes:shouldAddEndpoint?[...allowedExceptionListTypes,shared_imports["b"].ENDPOINT]:allowedExceptionListTypes}},{lists:[],allowedExceptionListTypes:[shared_imports["b"].DETECTION]})}else{return{lists:[],allowedExceptionListTypes:[shared_imports["b"].DETECTION]}}},[rule]);const onSkipFocusBeforeEventsTable=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{Object(timeline_helpers["m"])(containerElement.current)},[containerElement]);const onSkipFocusAfterEventsTable=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{Object(timeline_helpers["o"])()},[]);const onKeyDown=Object(external_kbnSharedDeps_React_["useCallback"])(keyboardEvent=>{if(Object(accessibility_helpers["r"])(keyboardEvent)){Object(timeline_helpers["n"])({containerElement:containerElement.current,keyboardEvent:keyboardEvent,onSkipFocusBeforeEventsTable:onSkipFocusBeforeEventsTable,onSkipFocusAfterEventsTable:onSkipFocusAfterEventsTable})}},[containerElement,onSkipFocusBeforeEventsTable,onSkipFocusAfterEventsTable]);if(redirectToDetections(isSignalIndexExists,isAuthenticated,hasEncryptionKey,needsListsConfiguration)){history.replace(Object(redirect_to_detection_engine["c"])());return null}const defaultRuleStackByOption={text:"event.category",value:"event.category"};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(NeedAdminForUpdateRulesCallOut,null),external_kbnSharedDeps_React_default.a.createElement(ReadOnlyAlertsCallOut,null),external_kbnSharedDeps_React_default.a.createElement(ReadOnlyRulesCallOut,null),indicesExist?external_kbnSharedDeps_React_default.a.createElement(details_StyledFullHeightContainer,{onKeyDown:onKeyDown,ref:containerElement},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiWindowEvent"],{event:"resize",handler:external_kbnSharedDeps_LodashFp_["noop"]}),external_kbnSharedDeps_React_default.a.createElement(filters_global["a"],{show:Object(timeline_helpers["q"])({globalFullScreen:globalFullScreen,graphEventId:graphEventId})},external_kbnSharedDeps_React_default.a.createElement(search_bar["a"],{id:"global",indexPattern:indexPattern})),external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],{noPadding:globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(Display,{show:!globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{backOptions:{href:Object(redirect_to_detection_engine["f"])(),text:translations_BACK_TO_RULES,pageId:app_types["a"].detections,dataTestSubj:"ruleDetailsBackToAllRules"},border:true,subtitle:subTitle,subtitle2:[...lastAlerts!=null?[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,detection_engine_translations["e"],": ",lastAlerts)]:[],external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"xs",alignItems:"center",justifyContent:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},STATUS,":"),ruleStatusInfo))],title:title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:getToolTipContent(rule,hasMlPermissions,hasActionsPrivileges)},external_kbnSharedDeps_React_default.a.createElement(RuleSwitch,{id:(_rule$id=rule===null||rule===void 0?void 0:rule.id)!==null&&_rule$id!==void 0?_rule$id:"-1",isDisabled:!canEditRuleWithActions(rule,hasActionsPrivileges)||helpers_userHasNoPermissions(canUserCRUD)||!hasMlPermissions&&!(rule!==null&&rule!==void 0&&rule.enabled),enabled:(_rule$enabled=rule===null||rule===void 0?void 0:rule.enabled)!==null&&_rule$enabled!==void 0?_rule$enabled:false,optionLabel:ACTIVATE_RULE,onChange:handleOnChangeEnabledRule}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"s",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},editRule),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(RuleActionsOverflow,{rule:rule,userHasNoPermissions:helpers_userHasNoPermissions(canUserCRUD),canDuplicateRuleWithActions:canEditRuleWithActions(rule,hasActionsPrivileges)})))))),ruleError,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"aboutRule",component:"section",grow:1},external_kbnSharedDeps_React_default.a.createElement(StepAboutRuleToggleDetails,{loading:isLoading,stepData:aboutRuleData,stepDataDetails:modifiedAboutRuleDetailsData})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{component:"section",grow:1},external_kbnSharedDeps_React_default.a.createElement(StepPanel,{loading:isLoading,title:rules_translations["I"]},defineRuleData!=null&&external_kbnSharedDeps_React_default.a.createElement(StepDefineRule,{descriptionColumns:"singleSplit",isReadOnlyView:true,isLoading:false,defaultValues:defineRuleData}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"schedule",component:"section",grow:1},external_kbnSharedDeps_React_default.a.createElement(StepPanel,{loading:isLoading,title:rules_translations["qb"]},scheduleRuleData!=null&&external_kbnSharedDeps_React_default.a.createElement(StepScheduleRule,{descriptionColumns:"singleSplit",isReadOnlyView:true,isLoading:false,defaultValues:scheduleRuleData})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),tabs,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)),ruleDetailTab===RuleDetailTabs.alerts&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(Display,{show:!globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(alerts_histogram_panel["a"],{deleteQuery:deleteQuery,filters:alertMergedFilters,query:query,from:from,signalIndexName:signalIndexName,setQuery:setQuery,stackByOptions:alerts_histogram_panel_config["a"],defaultStackByOption:defaultRuleStackByOption,to:to,updateDateRange:updateDateRangeCallback}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)),ruleId!=null&&external_kbnSharedDeps_React_default.a.createElement(AlertsTable,{timelineId:types_timeline["e"].detectionsRulesDetailsPage,defaultFilters:alertDefaultFilters,hasIndexWrite:hasIndexWrite!==null&&hasIndexWrite!==void 0?hasIndexWrite:false,hasIndexMaintenance:hasIndexMaintenance!==null&&hasIndexMaintenance!==void 0?hasIndexMaintenance:false,from:from,loading:loading,showBuildingBlockAlerts:showBuildingBlockAlerts,onShowBuildingBlockAlertsChanged:onShowBuildingBlockAlertsChangedCallback,onRuleChange:refreshRule,to:to})),ruleDetailTab===RuleDetailTabs.exceptions&&external_kbnSharedDeps_React_default.a.createElement(ExceptionsViewer,{ruleId:ruleId!==null&&ruleId!==void 0?ruleId:"",ruleName:(_rule$name2=rule===null||rule===void 0?void 0:rule.name)!==null&&_rule$name2!==void 0?_rule$name2:"",ruleIndices:(_rule$index=rule===null||rule===void 0?void 0:rule.index)!==null&&_rule$index!==void 0?_rule$index:constants["v"],availableListTypes:exceptionLists.allowedExceptionListTypes,commentsAccordionId:"ruleDetailsTabExceptions",exceptionListsMeta:exceptionLists.lists,onRuleChange:refreshRule}),ruleDetailTab===RuleDetailTabs.failures&&external_kbnSharedDeps_React_default.a.createElement(FailureHistory,{id:rule===null||rule===void 0?void 0:rule.id}))):external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{border:true,title:details_translations_PAGE_TITLE}),external_kbnSharedDeps_React_default.a.createElement(overview_empty["a"],null)),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].detections,state:{ruleName:rule===null||rule===void 0?void 0:rule.name}}))};RuleDetailsPageComponent.displayName="RuleDetailsPageComponent";const RuleDetailsPage=external_kbnSharedDeps_React_default.a.memo(RuleDetailsPageComponent);RuleDetailsPage.displayName="RuleDetailsPage";const PRE_BUILT_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.emptyPromptTitle",{defaultMessage:"Load Elastic prebuilt detection rules"});const PRE_BUILT_MSG=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.emptyPromptMessage",{defaultMessage:"Elastic Security comes with prebuilt detection rules that run in the background and create alerts when their conditions are met. By default, all prebuilt rules except the Endpoint Security rule are disabled. You can select additional rules you want to activate."});const CREATE_RULE_ACTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.createOwnRuletButton",{defaultMessage:"Create your own rules"});const UPDATE_PREPACKAGED_RULES_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesTitle",{defaultMessage:"Update available for Elastic prebuilt rules or timeline templates"});const UPDATE_PREPACKAGED_RULES_MSG=updateRules=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesMsg",{values:{updateRules:updateRules},defaultMessage:"You can update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}}"});const UPDATE_PREPACKAGED_TIMELINES_MSG=updateTimelines=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedTimelinesMsg",{values:{updateTimelines:updateTimelines},defaultMessage:"You can update {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}"});const UPDATE_PREPACKAGED_RULES_AND_TIMELINES_MSG=(updateRules,updateTimelines)=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesAndTimelinesMsg",{values:{updateRules:updateRules,updateTimelines:updateTimelines},defaultMessage:"You can update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}} and {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}. Note that this will reload deleted Elastic prebuilt rules."});const UPDATE_PREPACKAGED_RULES=updateRules=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesButton",{values:{updateRules:updateRules},defaultMessage:"Update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}}"});const UPDATE_PREPACKAGED_TIMELINES=updateTimelines=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedTimelinesButton",{values:{updateTimelines:updateTimelines},defaultMessage:"Update {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}"});const UPDATE_PREPACKAGED_RULES_AND_TIMELINES=(updateRules,updateTimelines)=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesAndTimelinesButton",{values:{updateRules:updateRules,updateTimelines:updateTimelines},defaultMessage:"Update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}} and {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}"});const RELEASE_NOTES_HELP=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.releaseNotesHelp",{defaultMessage:"Release notes"});const EmptyPrompt=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"]).withConfig({displayName:"EmptyPrompt",componentId:"sc-1rs1rob-0"})(["align-self:center;"]);EmptyPrompt.displayName="EmptyPrompt";const PrePackagedRulesPromptComponent=({createPrePackagedRules:createPrePackagedRules,loading:loading=false,userHasNoPermissions:userHasNoPermissions=true})=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const handlePreBuiltCreation=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{createPrePackagedRules()},[createPrePackagedRules]);const{formatUrl:formatUrl}=Object(link_to["o"])(app_types["a"].detections);const goToCreateRule=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();history.push(Object(redirect_to_detection_engine["a"])())},[history]);const[{isSignalIndexExists:isSignalIndexExists,isAuthenticated:isAuthenticated,hasEncryptionKey:hasEncryptionKey,canUserCRUD:canUserCRUD,hasIndexWrite:hasIndexWrite}]=Object(user_info["b"])();const{getLoadPrebuiltRulesAndTemplatesButton:getLoadPrebuiltRulesAndTemplatesButton}=usePrePackagedRules({canUserCRUD:canUserCRUD,hasIndexWrite:hasIndexWrite,isSignalIndexExists:isSignalIndexExists,isAuthenticated:isAuthenticated,hasEncryptionKey:hasEncryptionKey});const loadPrebuiltRulesAndTemplatesButton=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getLoadPrebuiltRulesAndTemplatesButton({isDisabled:userHasNoPermissions,onClick:handlePreBuiltCreation,fill:true,"data-test-subj":"load-prebuilt-rules"}),[getLoadPrebuiltRulesAndTemplatesButton,handlePreBuiltCreation,userHasNoPermissions]);return external_kbnSharedDeps_React_default.a.createElement(EmptyPrompt,{title:external_kbnSharedDeps_React_default.a.createElement("h2",null,PRE_BUILT_TITLE),body:external_kbnSharedDeps_React_default.a.createElement("p",null,PRE_BUILT_MSG),actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},loadPrebuiltRulesAndTemplatesButton),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(links["g"],{isDisabled:userHasNoPermissions,onClick:goToCreateRule,href:formatUrl(Object(redirect_to_detection_engine["a"])()),iconType:"plusInCircle"},CREATE_RULE_ACTION)))})};const PrePackagedRulesPrompt=Object(external_kbnSharedDeps_React_["memo"])(PrePackagedRulesPromptComponent);const MyEuiBasicTable=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiBasicTable"]).withConfig({displayName:"MyEuiBasicTable",componentId:"x49r9h-0"})([""]);const AllRulesTablesComponent=({euiBasicTableSelectionProps:euiBasicTableSelectionProps,hasNoPermissions:hasNoPermissions,monitoringColumns:monitoringColumns,pagination:pagination,rules:rules,rulesColumns:rulesColumns,rulesStatuses:rulesStatuses,sorting:sorting,tableOnChangeCallback:tableOnChangeCallback,tableRef:tableRef,selectedTab:selectedTab})=>{var _hasNoPermissions,_hasNoPermissions2;const emptyPrompt=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,rules_translations["cb"]),titleSize:"xs",body:rules_translations["db"]}),[]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,selectedTab===AllRulesTabs.rules&&external_kbnSharedDeps_React_default.a.createElement(MyEuiBasicTable,{"data-test-subj":"rules-table",columns:rulesColumns,isSelectable:(_hasNoPermissions=!hasNoPermissions)!==null&&_hasNoPermissions!==void 0?_hasNoPermissions:false,itemId:"id",items:rules!==null&&rules!==void 0?rules:[],noItemsMessage:emptyPrompt,onChange:tableOnChangeCallback,pagination:pagination,ref:tableRef,sorting:sorting,selection:hasNoPermissions?undefined:euiBasicTableSelectionProps}),selectedTab===AllRulesTabs.monitoring&&external_kbnSharedDeps_React_default.a.createElement(MyEuiBasicTable,{"data-test-subj":"monitoring-table",columns:monitoringColumns,isSelectable:(_hasNoPermissions2=!hasNoPermissions)!==null&&_hasNoPermissions2!==void 0?_hasNoPermissions2:false,itemId:"id",items:rulesStatuses,noItemsMessage:emptyPrompt,onChange:tableOnChangeCallback,pagination:pagination,sorting:sorting}))};const AllRulesTables=Object(external_kbnSharedDeps_React_["memo"])(AllRulesTablesComponent);const getBatchItems=({closePopover:closePopover,dispatch:dispatch,dispatchToaster:dispatchToaster,hasMlPermissions:hasMlPermissions,loadingRuleIds:loadingRuleIds,reFetchRules:reFetchRules,refetchPrePackagedRulesStatus:refetchPrePackagedRulesStatus,rules:rules,selectedRuleIds:selectedRuleIds,hasActionsPrivileges:hasActionsPrivileges})=>{const selectedRules=selectedRuleIds.reduce((acc,id)=>{const found=rules.find(r=>r.id===id);if(found!=null){return{[id]:found,...acc}}return acc},{});const containsEnabled=selectedRuleIds.some(id=>{var _selectedRules$id$ena,_selectedRules$id;return(_selectedRules$id$ena=(_selectedRules$id=selectedRules[id])===null||_selectedRules$id===void 0?void 0:_selectedRules$id.enabled)!==null&&_selectedRules$id$ena!==void 0?_selectedRules$id$ena:false});const containsDisabled=selectedRuleIds.some(id=>{var _selectedRules$id$ena2,_selectedRules$id2;return(_selectedRules$id$ena2=!((_selectedRules$id2=selectedRules[id])!==null&&_selectedRules$id2!==void 0&&_selectedRules$id2.enabled))!==null&&_selectedRules$id$ena2!==void 0?_selectedRules$id$ena2:false});const containsLoading=selectedRuleIds.some(id=>loadingRuleIds.includes(id));const containsImmutable=selectedRuleIds.some(id=>{var _selectedRules$id$imm,_selectedRules$id3;return(_selectedRules$id$imm=(_selectedRules$id3=selectedRules[id])===null||_selectedRules$id3===void 0?void 0:_selectedRules$id3.immutable)!==null&&_selectedRules$id$imm!==void 0?_selectedRules$id$imm:false});const missingActionPrivileges=!hasActionsPrivileges&&selectedRuleIds.some(id=>!canEditRuleWithActions(selectedRules[id],hasActionsPrivileges));return[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:rules_translations["j"],icon:"checkInCircleFilled",disabled:missingActionPrivileges||containsLoading||!containsDisabled,onClick:async()=>{closePopover();const deactivatedIds=selectedRuleIds.filter(id=>{var _selectedRules$id$ena3,_selectedRules$id4;return(_selectedRules$id$ena3=!((_selectedRules$id4=selectedRules[id])!==null&&_selectedRules$id4!==void 0&&_selectedRules$id4.enabled))!==null&&_selectedRules$id$ena3!==void 0?_selectedRules$id$ena3:false});const deactivatedIdsNoML=deactivatedIds.filter(id=>{var _selectedRules$id5;return!Object(helpers["d"])((_selectedRules$id5=selectedRules[id])===null||_selectedRules$id5===void 0?void 0:_selectedRules$id5.type)});const mlRuleCount=deactivatedIds.length-deactivatedIdsNoML.length;if(!hasMlPermissions&&mlRuleCount>0){Object(toasters["f"])(detection_engine_translations["g"](mlRuleCount),dispatchToaster)}await enableRulesAction(hasMlPermissions?deactivatedIds:deactivatedIdsNoML,true,dispatch,dispatchToaster)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"right",content:missingActionPrivileges?rules_translations["Q"]:undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,rules_translations["j"]))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:rules_translations["l"],icon:"crossInACircleFilled",disabled:missingActionPrivileges||containsLoading||!containsEnabled,onClick:async()=>{closePopover();const activatedIds=selectedRuleIds.filter(id=>{var _selectedRules$id$ena4,_selectedRules$id6;return(_selectedRules$id$ena4=(_selectedRules$id6=selectedRules[id])===null||_selectedRules$id6===void 0?void 0:_selectedRules$id6.enabled)!==null&&_selectedRules$id$ena4!==void 0?_selectedRules$id$ena4:false});await enableRulesAction(activatedIds,false,dispatch,dispatchToaster)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"right",content:missingActionPrivileges?rules_translations["Q"]:undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,rules_translations["l"]))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:rules_translations["r"],icon:"exportAction",disabled:containsImmutable||containsLoading||selectedRuleIds.length===0,onClick:()=>{closePopover();exportRulesAction(rules.filter(r=>selectedRuleIds.includes(r.id)).map(r=>r.rule_id),dispatch)}},rules_translations["r"]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:rules_translations["q"],icon:"copy",disabled:missingActionPrivileges||containsLoading||selectedRuleIds.length===0,onClick:async()=>{closePopover();await duplicateRulesAction(rules.filter(r=>selectedRuleIds.includes(r.id)),selectedRuleIds,dispatch,dispatchToaster);await reFetchRules();await refetchPrePackagedRulesStatus()}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"right",content:missingActionPrivileges?rules_translations["Q"]:undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,rules_translations["q"]))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{"data-test-subj":"deleteRuleBulk",key:rules_translations["n"],icon:"trash",title:containsImmutable?rules_translations["p"]:undefined,disabled:containsLoading||selectedRuleIds.length===0,onClick:async()=>{closePopover();await deleteRulesAction(selectedRuleIds,dispatch,dispatchToaster);await reFetchRules();await refetchPrePackagedRulesStatus()}},rules_translations["n"])]};var localized_date_tooltip=__webpack_require__(359);const TagWrapper=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiBadgeGroup"]).withConfig({displayName:"TagWrapper",componentId:"dbczeh-0"})(["width:100%;"]);const TagPopoverWrapper=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiBadgeGroup"]).withConfig({displayName:"TagPopoverWrapper",componentId:"dbczeh-1"})(["max-height:200px;max-width:600px;overflow:auto;"]);const TagPopoverButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"]).withConfig({displayName:"TagPopoverButton",componentId:"dbczeh-2"})(["font-size:"," font-weight:500;height:20px;"],({theme:theme})=>theme.eui.euiFontSizeXS);const TagsDisplayComponent=({tags:tags})=>{const[isTagPopoverOpen,setIsTagPopoverOpen]=Object(external_kbnSharedDeps_React_["useState"])(false);const sortedTags=Object(external_kbnSharedDeps_React_["useMemo"])(()=>caseInsensitiveSort(tags),[tags]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,sortedTags.length<=3?external_kbnSharedDeps_React_default.a.createElement(TagWrapper,{"data-test-subj":"tags"},sortedTags.map((tag,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{color:"hollow",key:`${tag}-${i}`,"data-test-subj":`rules-table-column-tags-${i}`},tag))):external_kbnSharedDeps_React_default.a.createElement(TagWrapper,{"data-test-subj":"tags"},sortedTags.slice(0,3).map((tag,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{color:"hollow",key:`${tag}-${i}`,"data-test-subj":`rules-table-column-tags-${i}`},tag)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{ownFocus:true,display:"block","data-test-subj":"tags-display-popover",button:external_kbnSharedDeps_React_default.a.createElement(TagPopoverButton,{size:"xs","data-test-subj":"tags-display-popover-button",onClick:()=>setIsTagPopoverOpen(!isTagPopoverOpen)},rules_translations["B"]),isOpen:isTagPopoverOpen,closePopover:()=>setIsTagPopoverOpen(!isTagPopoverOpen),repositionOnScroll:true},external_kbnSharedDeps_React_default.a.createElement(TagPopoverWrapper,null,sortedTags.map((tag,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{color:"hollow",key:`${tag}-${i}`,"data-test-subj":`rules-table-column-popover-tags-${i}`,title:tag},tag))))))};const TagsDisplay=external_kbnSharedDeps_React_default.a.memo(TagsDisplayComponent);TagsDisplay.displayName="TagsDisplay";const getActions=(dispatch,dispatchToaster,history,reFetchRules,refetchPrePackagedRulesStatus,actionsPrivileges)=>[{"data-test-subj":"editRuleAction",description:rules_translations["P"],name:!actionsPrivileges?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"left",content:rules_translations["Q"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,rules_translations["P"])):rules_translations["P"],icon:"controlsHorizontal",onClick:rowItem=>editRuleAction(rowItem,history),enabled:rowItem=>canEditRuleWithActions(rowItem,actionsPrivileges)},{"data-test-subj":"duplicateRuleAction",description:rules_translations["M"],icon:"copy",name:!actionsPrivileges?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"left",content:rules_translations["Q"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,rules_translations["M"])):rules_translations["M"],enabled:rowItem=>canEditRuleWithActions(rowItem,actionsPrivileges),onClick:async rowItem=>{await duplicateRulesAction([rowItem],[rowItem.id],dispatch,dispatchToaster);await reFetchRules();await refetchPrePackagedRulesStatus()}},{"data-test-subj":"exportRuleAction",description:rules_translations["U"],icon:"exportAction",name:rules_translations["U"],onClick:rowItem=>exportRulesAction([rowItem.rule_id],dispatch),enabled:rowItem=>!rowItem.immutable},{"data-test-subj":"deleteRuleAction",description:rules_translations["K"],icon:"trash",name:rules_translations["K"],onClick:async rowItem=>{await deleteRulesAction([rowItem.id],dispatch,dispatchToaster);await reFetchRules();await refetchPrePackagedRulesStatus()}}];const getColumns=({dispatch:dispatch,dispatchToaster:dispatchToaster,formatUrl:formatUrl,history:history,hasMlPermissions:hasMlPermissions,hasNoPermissions:hasNoPermissions,loadingRuleIds:loadingRuleIds,reFetchRules:reFetchRules,refetchPrePackagedRulesStatus:refetchPrePackagedRulesStatus,hasReadActionsPrivileges:hasReadActionsPrivileges})=>{const cols=[{field:"name",name:rules_translations["A"],render:(value,item)=>external_kbnSharedDeps_React_default.a.createElement(links["f"],{"data-test-subj":"ruleName",onClick:ev=>{ev.preventDefault();history.push(Object(redirect_to_detection_engine["e"])(item.id))},href:formatUrl(Object(redirect_to_detection_engine["e"])(item.id))},value),truncateText:true,width:"20%",sortable:true},{field:"risk_score",name:rules_translations["z"],render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{"data-test-subj":"riskScore",size:"s"},value),truncateText:true,width:"10%"},{field:"severity",name:rules_translations["C"],render:value=>external_kbnSharedDeps_React_default.a.createElement(SeverityBadge,{value:value}),truncateText:true,width:"12%"},{field:"status_date",name:rules_translations["v"],render:value=>value==null?Object(empty_value["d"])():external_kbnSharedDeps_React_default.a.createElement(localized_date_tooltip["a"],{fieldName:rules_translations["v"],date:new Date(value)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedRelative"],{value:value})),truncateText:true,width:"14%"},{field:"status",name:rules_translations["w"],render:value=>{var _getRuleStatusText;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:getStatusColor(value!==null&&value!==void 0?value:null)},(_getRuleStatusText=Object(utils["a"])(value))!==null&&_getRuleStatusText!==void 0?_getRuleStatusText:Object(empty_value["d"])()))},width:"12%",truncateText:true},{field:"updated_at",name:rules_translations["x"],render:value=>value==null?Object(empty_value["d"])():external_kbnSharedDeps_React_default.a.createElement(localized_date_tooltip["a"],{fieldName:rules_translations["x"],date:new Date(value)},external_kbnSharedDeps_React_default.a.createElement(formatted_date["a"],{value:value,fieldName:"last rule update date"})),sortable:true,truncateText:true,width:"14%"},{field:"version",name:rules_translations["E"],render:value=>value==null?Object(empty_value["d"])():external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{"data-test-subj":"version",size:"s"},value),truncateText:true,width:"8%"},{field:"tags",name:rules_translations["D"],render:value=>{if(value.length>0){return external_kbnSharedDeps_React_default.a.createElement(TagsDisplay,{tags:value})}return Object(empty_value["d"])()},truncateText:true,width:"20%"},{align:"center",field:"enabled",name:rules_translations["s"],render:(value,item)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:getToolTipContent(item,hasMlPermissions,hasReadActionsPrivileges)},external_kbnSharedDeps_React_default.a.createElement(RuleSwitch,{"data-test-subj":"enabled",dispatch:dispatch,id:item.id,enabled:item.enabled,isDisabled:!canEditRuleWithActions(item,hasReadActionsPrivileges)||hasNoPermissions||Object(helpers["d"])(item.type)&&!hasMlPermissions&&!item.enabled,isLoading:loadingRuleIds.includes(item.id)})),sortable:true,width:"95px"}];const actions=[{actions:getActions(dispatch,dispatchToaster,history,reFetchRules,refetchPrePackagedRulesStatus,hasReadActionsPrivileges),width:"40px"}];return hasNoPermissions?cols:[...cols,...actions]};const getMonitoringColumns=(history,formatUrl)=>{const cols=[{field:"name",name:rules_translations["A"],render:(value,item)=>external_kbnSharedDeps_React_default.a.createElement(links["f"],{"data-test-subj":"ruleName",onClick:ev=>{ev.preventDefault();history.push(Object(redirect_to_detection_engine["e"])(item.id))},href:formatUrl(Object(redirect_to_detection_engine["e"])(item.id))},value==="partial failure"?"warning":value),truncateText:true,width:"24%"},{field:"current_status.bulk_create_time_durations",name:rules_translations["u"],render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{"data-test-subj":"bulk_create_time_durations",size:"s"},value!=null&&value.length>0?Math.max(...value===null||value===void 0?void 0:value.map(item=>Number.parseFloat(item))):Object(empty_value["d"])()),truncateText:true,width:"14%"},{field:"current_status.search_after_time_durations",name:rules_translations["y"],render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{"data-test-subj":"search_after_time_durations",size:"s"},value!=null&&value.length>0?Math.max(...value===null||value===void 0?void 0:value.map(item=>Number.parseFloat(item))):Object(empty_value["d"])()),truncateText:true,width:"14%"},{field:"current_status.gap",name:rules_translations["t"],render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{"data-test-subj":"gap",size:"s"},value!==null&&value!==void 0?value:Object(empty_value["d"])()),truncateText:true,width:"14%"},{field:"current_status.status_date",name:rules_translations["v"],render:value=>value==null?Object(empty_value["d"])():external_kbnSharedDeps_React_default.a.createElement(localized_date_tooltip["a"],{fieldName:rules_translations["v"],date:new Date(value)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedRelative"],{value:value})),truncateText:true,width:"20%"},{field:"current_status.status",name:rules_translations["w"],render:value=>{var _getRuleStatusText2;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHealth"],{color:getStatusColor(value!==null&&value!==void 0?value:null)},(_getRuleStatusText2=Object(utils["a"])(value))!==null&&_getRuleStatusText2!==void 0?_getRuleStatusText2:Object(empty_value["d"])()))},width:"16%",truncateText:true},{field:"activate",name:rules_translations["s"],render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{"data-test-subj":"search_after_time_durations",size:"s"},value?rules_translations["d"]:rules_translations["Z"]),width:"95px"}];return cols};const useTags=()=>{const[tags,setTags]=Object(external_kbnSharedDeps_React_["useState"])([]);const[loading,setLoading]=Object(external_kbnSharedDeps_React_["useState"])(true);const[,dispatchToaster]=Object(toasters["h"])();const reFetchTags=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;const abortCtrl=new AbortController;const fetchData=async()=>{setLoading(true);try{const fetchTagsResult=await Object(api["i"])({signal:abortCtrl.signal});if(isSubscribed){setTags(fetchTagsResult)}}catch(error){if(isSubscribed){Object(toasters["g"])({title:translations["l"],error:error,dispatchToaster:dispatchToaster})}}if(isSubscribed){setLoading(false)}};fetchData();reFetchTags.current=fetchData;return()=>{isSubscribed=false;abortCtrl.abort()}},[dispatchToaster]);return[loading,tags,reFetchTags.current]};var toggle_selected_group=__webpack_require__(721);const PopoverContentWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"PopoverContentWrapper",componentId:"sc-1c6dnvx-0"})(["width:275px;"]);const ScrollableDiv=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"ScrollableDiv",componentId:"sc-1c6dnvx-1"})(["max-height:250px;overflow-y:auto;"]);const TagOverflowContainer=external_kbnSharedDeps_StyledComponents_default.a.span.withConfig({displayName:"TagOverflowContainer",componentId:"sc-1c6dnvx-2"})(["overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"]);const TagsFilterPopoverComponent=({tags:tags,selectedTags:selectedTags,onSelectedTagsChanged:onSelectedTagsChanged,currentFilterTags:currentFilterTags})=>{const sortedTags=Object(external_kbnSharedDeps_React_["useMemo"])(()=>caseInsensitiveSort(Array.from(new Set([...tags,...currentFilterTags]))),[tags,currentFilterTags]);const[isTagPopoverOpen,setIsTagPopoverOpen]=Object(external_kbnSharedDeps_React_["useState"])(false);const[searchInput,setSearchInput]=Object(external_kbnSharedDeps_React_["useState"])("");const[filterTags,setFilterTags]=Object(external_kbnSharedDeps_React_["useState"])(sortedTags);const tagsComponent=Object(external_kbnSharedDeps_React_["useMemo"])(()=>filterTags.map((tag,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterSelectItem"],{checked:selectedTags.includes(tag)?"on":undefined,key:`${index}-${tag}`,onClick:()=>Object(toggle_selected_group["a"])(tag,selectedTags,onSelectedTagsChanged),title:tag},external_kbnSharedDeps_React_default.a.createElement(TagOverflowContainer,null,tag))),[onSelectedTagsChanged,selectedTags,filterTags]);const onSearchInputChange=Object(external_kbnSharedDeps_React_["useCallback"])(event=>{setSearchInput(event.target.value)},[]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setFilterTags(sortedTags.filter(tag=>tag.toLowerCase().includes(searchInput.toLowerCase())))},[sortedTags,searchInput]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{ownFocus:true,button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterButton"],{"data-test-subj":"tags-filter-popover-button",iconType:"arrowDown",onClick:()=>setIsTagPopoverOpen(!isTagPopoverOpen),isSelected:isTagPopoverOpen,hasActiveFilters:selectedTags.length>0,numActiveFilters:selectedTags.length},rules_translations["Bb"]),isOpen:isTagPopoverOpen,closePopover:()=>setIsTagPopoverOpen(!isTagPopoverOpen),panelPaddingSize:"none",repositionOnScroll:true},external_kbnSharedDeps_React_default.a.createElement(PopoverContentWrapper,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverTitle"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldSearch"],{placeholder:"Search tags",value:searchInput,onChange:onSearchInputChange,isClearable:true,"aria-label":"Rules tag search"})),external_kbnSharedDeps_React_default.a.createElement(ScrollableDiv,null,tagsComponent),filterTags.length===0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"m",justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,rules_translations["eb"]))))))};TagsFilterPopoverComponent.displayName="TagsFilterPopoverComponent";const TagsFilterPopover=external_kbnSharedDeps_React_default.a.memo(TagsFilterPopoverComponent);TagsFilterPopover.displayName="TagsFilterPopover";const RulesTableFiltersComponent=({onFilterChanged:onFilterChanged,rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled,currentFilterTags:currentFilterTags})=>{const[filter,setFilter]=Object(external_kbnSharedDeps_React_["useState"])("");const[selectedTags,setSelectedTags]=Object(external_kbnSharedDeps_React_["useState"])([]);const[showCustomRules,setShowCustomRules]=Object(external_kbnSharedDeps_React_["useState"])(false);const[showElasticRules,setShowElasticRules]=Object(external_kbnSharedDeps_React_["useState"])(false);const[isLoadingTags,tags,reFetchTags]=useTags();Object(external_kbnSharedDeps_React_["useEffect"])(()=>{reFetchTags()},[rulesCustomInstalled,rulesInstalled]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{onFilterChanged({filter:filter,showCustomRules:showCustomRules,showElasticRules:showElasticRules,tags:selectedTags})},[filter,selectedTags,showCustomRules,showElasticRules,onFilterChanged]);const handleOnSearch=Object(external_kbnSharedDeps_React_["useCallback"])(filterString=>setFilter(filterString.trim()),[setFilter]);const handleElasticRulesClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setShowElasticRules(!showElasticRules);setShowCustomRules(false)},[setShowElasticRules,showElasticRules,setShowCustomRules]);const handleCustomRulesClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setShowCustomRules(!showCustomRules);setShowElasticRules(false)},[setShowElasticRules,showCustomRules,setShowCustomRules]);const handleSelectedTags=Object(external_kbnSharedDeps_React_["useCallback"])(newTags=>{if(!Object(external_kbnSharedDeps_LodashFp_["isEqual"])(newTags,selectedTags)){setSelectedTags(newTags)}},[selectedTags]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"m",justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldSearch"],{"aria-label":rules_translations["tb"],fullWidth:true,incremental:false,placeholder:rules_translations["sb"],onSearch:handleOnSearch})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterGroup"],null,external_kbnSharedDeps_React_default.a.createElement(TagsFilterPopover,{isLoading:isLoadingTags,onSelectedTagsChanged:handleSelectedTags,selectedTags:selectedTags,tags:tags,currentFilterTags:currentFilterTags,"data-test-subj":"allRulesTagPopover"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterButton"],{hasActiveFilters:showElasticRules,onClick:handleElasticRulesClick,"data-test-subj":"showElasticRulesFilterButton",withNext:true},rules_translations["R"],rulesInstalled!=null?` (${rulesInstalled})`:""),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilterButton"],{hasActiveFilters:showCustomRules,onClick:handleCustomRulesClick,"data-test-subj":"showCustomRulesFilterButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,rules_translations["G"],rulesCustomInstalled!=null?` (${rulesCustomInstalled})`:"")))))};RulesTableFiltersComponent.displayName="RulesTableFiltersComponent";const RulesTableFilters=external_kbnSharedDeps_React_default.a.memo(RulesTableFiltersComponent);RulesTableFilters.displayName="RulesTableFilters";const AllRulesUtilityBar=external_kbnSharedDeps_React_default.a.memo(({userHasNoPermissions:userHasNoPermissions,onRefresh:onRefresh,paginationTotal:paginationTotal,numberSelectedItems:numberSelectedItems,onGetBatchItemsPopoverContent:onGetBatchItemsPopoverContent,isAutoRefreshOn:isAutoRefreshOn,showBulkActions:showBulkActions=true,onRefreshSwitch:onRefreshSwitch})=>{const handleGetBatchItemsPopoverContent=Object(external_kbnSharedDeps_React_["useCallback"])(closePopover=>{if(onGetBatchItemsPopoverContent!=null){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuPanel"],{items:onGetBatchItemsPopoverContent(closePopover)})}else{return null}},[onGetBatchItemsPopoverContent]);const handleAutoRefreshSwitch=Object(external_kbnSharedDeps_React_["useCallback"])(closePopover=>e=>{if(onRefreshSwitch!=null){onRefreshSwitch(e.target.checked);closePopover()}},[onRefreshSwitch]);const handleGetRefreshSettingsPopoverContent=Object(external_kbnSharedDeps_React_["useCallback"])(closePopover=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuPanel"],{items:[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{key:"allRulesAutoRefreshSwitch",label:rules_translations["mb"],checked:isAutoRefreshOn!==null&&isAutoRefreshOn!==void 0?isAutoRefreshOn:false,onChange:handleAutoRefreshSwitch(closePopover),compressed:true,"data-test-subj":"refreshSettingsSwitch"})]}),[isAutoRefreshOn,handleAutoRefreshSwitch]);return external_kbnSharedDeps_React_default.a.createElement(utility_bar["a"],null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["d"],null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["c"],null,showBulkActions?external_kbnSharedDeps_React_default.a.createElement(utility_bar["f"],{dataTestSubj:"showingRules"},rules_translations["xb"](paginationTotal)):external_kbnSharedDeps_React_default.a.createElement(utility_bar["f"],{dataTestSubj:"showingExceptionLists"},rules_translations["wb"](paginationTotal))),showBulkActions?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["c"],{"data-test-subj":"tableBulkActions"},external_kbnSharedDeps_React_default.a.createElement(utility_bar["f"],{dataTestSubj:"selectedRules"},rules_translations["ub"](numberSelectedItems)),!userHasNoPermissions&&external_kbnSharedDeps_React_default.a.createElement(utility_bar["b"],{dataTestSubj:"bulkActions",iconSide:"right",iconType:"arrowDown",popoverContent:handleGetBatchItemsPopoverContent},rules_translations["i"]),external_kbnSharedDeps_React_default.a.createElement(utility_bar["b"],{dataTestSubj:"refreshRulesAction",iconSide:"left",iconType:"refresh",onClick:onRefresh},rules_translations["ib"]),external_kbnSharedDeps_React_default.a.createElement(utility_bar["b"],{dataTestSubj:"refreshSettings",iconSide:"right",iconType:"arrowDown",popoverContent:handleGetRefreshSettingsPopoverContent},rules_translations["nb"]))):external_kbnSharedDeps_React_default.a.createElement(utility_bar["c"],null,external_kbnSharedDeps_React_default.a.createElement(utility_bar["b"],{dataTestSubj:"refreshRulesAction",iconSide:"left",iconType:"refresh",onClick:onRefresh},rules_translations["ib"]))))});AllRulesUtilityBar.displayName="AllRulesUtilityBar";var last_updated=__webpack_require__(521);const rules_tables_INITIAL_SORT_FIELD="enabled";const RulesTables=external_kbnSharedDeps_React_default.a.memo(({history:history,formatUrl:formatUrl,createPrePackagedRules:createPrePackagedRules,hasNoPermissions:hasNoPermissions,loading:loading,loadingCreatePrePackagedRules:loadingCreatePrePackagedRules,refetchPrePackagedRulesStatus:refetchPrePackagedRulesStatus,rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled,rulesNotInstalled:rulesNotInstalled,rulesNotUpdated:rulesNotUpdated,setRefreshRulesData:setRefreshRulesData,selectedTab:selectedTab})=>{var _pagination$total;const[initLoading,setInitLoading]=Object(external_kbnSharedDeps_React_["useState"])(true);const{services:{application:{capabilities:{actions:actions}}}}=Object(lib_kibana["h"])();const tableRef=Object(external_kbnSharedDeps_React_["useRef"])();const[defaultAutoRefreshSetting]=Object(lib_kibana["l"])(constants["C"]);const rulesTable=useRulesTable({tableRef:tableRef,initialStateOverride:{isRefreshOn:defaultAutoRefreshSetting.on}});const{exportRuleIds:exportRuleIds,filterOptions:filterOptions,loadingRuleIds:loadingRuleIds,loadingRulesAction:loadingRulesAction,pagination:pagination,rules:rules,selectedRuleIds:selectedRuleIds,lastUpdated:lastUpdated,showIdleModal:showIdleModal,isRefreshOn:isRefreshOn,isRefreshing:isRefreshing}=rulesTable.state;const{dispatch:dispatch,updateOptions:updateOptions,actionStopped:actionStopped,setShowIdleModal:setShowIdleModal,setLastRefreshDate:setLastRefreshDate,setAutoRefreshOn:setAutoRefreshOn,setIsRefreshing:setIsRefreshing,reFetchRules:reFetchRules}=rulesTable;const{loading:isLoadingRulesStatuses,rulesStatuses:rulesStatuses}=useRulesStatuses(rules);const[,dispatchToaster]=Object(toasters["h"])();const mlCapabilities=Object(use_ml_capabilities["a"])();const hasMlPermissions=Object(has_ml_license["a"])(mlCapabilities)&&Object(has_ml_admin_permissions["a"])(mlCapabilities);const isLoadingRules=loadingRulesAction==="load";const isLoadingAnActionOnRule=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(loadingRuleIds.length>0&&(loadingRulesAction==="disable"||loadingRulesAction==="enable")){return false}else if(loadingRuleIds.length>0){return true}return false},[loadingRuleIds,loadingRulesAction]);const sorting=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({sort:{field:filterOptions.sortField,direction:filterOptions.sortOrder}}),[filterOptions]);const prePackagedRuleStatus=getPrePackagedRuleStatus(rulesInstalled,rulesNotInstalled,rulesNotUpdated);const hasActionsPrivileges=Object(external_kbnSharedDeps_React_["useMemo"])(()=>isBoolean(actions.show)?actions.show:true,[actions]);const getBatchItemsPopoverContent=Object(external_kbnSharedDeps_React_["useCallback"])(closePopover=>getBatchItems({closePopover:closePopover,dispatch:dispatch,dispatchToaster:dispatchToaster,hasMlPermissions:hasMlPermissions,hasActionsPrivileges:hasActionsPrivileges,loadingRuleIds:loadingRuleIds,selectedRuleIds:selectedRuleIds,reFetchRules:reFetchRules,refetchPrePackagedRulesStatus:refetchPrePackagedRulesStatus,rules:rules}),[dispatch,dispatchToaster,hasMlPermissions,loadingRuleIds,reFetchRules,refetchPrePackagedRulesStatus,rules,selectedRuleIds,hasActionsPrivileges]);const paginationMemo=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({pageIndex:pagination.page-1,pageSize:pagination.perPage,totalItemCount:pagination.total,pageSizeOptions:[5,10,20,50,100,200,300,400,500,600]}),[pagination]);const onFilterChangedCallback=Object(external_kbnSharedDeps_React_["useCallback"])(newFilter=>{updateOptions(newFilter,{page:1})},[updateOptions]);const tableOnChangeCallback=Object(external_kbnSharedDeps_React_["useCallback"])(({page:page,sort:sort})=>{var _ref,_sort$direction;updateOptions({sortField:(_ref=sort===null||sort===void 0?void 0:sort.field)!==null&&_ref!==void 0?_ref:rules_tables_INITIAL_SORT_FIELD,sortOrder:(_sort$direction=sort===null||sort===void 0?void 0:sort.direction)!==null&&_sort$direction!==void 0?_sort$direction:"desc"},{page:page.index+1,perPage:page.size});setLastRefreshDate()},[updateOptions,setLastRefreshDate]);const rulesColumns=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getColumns({dispatch:dispatch,dispatchToaster:dispatchToaster,formatUrl:formatUrl,history:history,hasMlPermissions:hasMlPermissions,hasNoPermissions:hasNoPermissions,loadingRuleIds:loadingRulesAction!=null&&(loadingRulesAction==="enable"||loadingRulesAction==="disable")?loadingRuleIds:[],reFetchRules:reFetchRules,refetchPrePackagedRulesStatus:refetchPrePackagedRulesStatus,hasReadActionsPrivileges:hasActionsPrivileges}),[dispatch,dispatchToaster,formatUrl,refetchPrePackagedRulesStatus,hasActionsPrivileges,hasNoPermissions,hasMlPermissions,history,loadingRuleIds,loadingRulesAction,reFetchRules]);const monitoringColumns=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getMonitoringColumns(history,formatUrl),[history,formatUrl]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setRefreshRulesData(reFetchRules)},[reFetchRules,setRefreshRulesData]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(initLoading&&!loading&&!isLoadingRules&&!isLoadingRulesStatuses){setInitLoading(false)}},[initLoading,loading,isLoadingRules,isLoadingRulesStatuses]);const handleCreatePrePackagedRules=Object(external_kbnSharedDeps_React_["useCallback"])(async()=>{if(createPrePackagedRules!=null){await createPrePackagedRules();await reFetchRules();await refetchPrePackagedRulesStatus()}},[createPrePackagedRules,reFetchRules,refetchPrePackagedRulesStatus]);const euiBasicTableSelectionProps=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({selectable:item=>!loadingRuleIds.includes(item.id),onSelectionChange:selected=>dispatch({type:"selectedRuleIds",ids:selected.map(r=>r.id)})}),[loadingRuleIds,dispatch]);const refreshTable=Object(external_kbnSharedDeps_React_["useCallback"])(async(mode="manual")=>{if(isLoadingAnActionOnRule){return}const isAutoRefresh=mode==="auto";if(isAutoRefresh){setIsRefreshing(true)}await reFetchRules();await refetchPrePackagedRulesStatus();setLastRefreshDate();if(isAutoRefresh){setIsRefreshing(false)}},[isLoadingAnActionOnRule,setIsRefreshing,reFetchRules,refetchPrePackagedRulesStatus,setLastRefreshDate]);const handleAutoRefresh=Object(external_kbnSharedDeps_React_["useCallback"])(async()=>{await refreshTable("auto")},[refreshTable]);const handleManualRefresh=Object(external_kbnSharedDeps_React_["useCallback"])(async()=>{await refreshTable()},[refreshTable]);const handleResetIdleTimer=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(isRefreshOn){setShowIdleModal(true);setAutoRefreshOn(false)}},[setShowIdleModal,setAutoRefreshOn,isRefreshOn]);const debounceResetIdleTimer=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(external_kbnSharedDeps_LodashFp_["debounce"])(defaultAutoRefreshSetting.idleTimeout,handleResetIdleTimer),[handleResetIdleTimer,defaultAutoRefreshSetting.idleTimeout]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const interval=setInterval(()=>{if(isRefreshOn){handleAutoRefresh()}},defaultAutoRefreshSetting.value);return()=>{clearInterval(interval)}},[isRefreshOn,handleAutoRefresh,defaultAutoRefreshSetting.value]);const handleIdleModalContinue=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setShowIdleModal(false);handleAutoRefresh();setAutoRefreshOn(true)},[setShowIdleModal,setAutoRefreshOn,handleAutoRefresh]);const handleAutoRefreshSwitch=Object(external_kbnSharedDeps_React_["useCallback"])(refreshOn=>{if(refreshOn){handleAutoRefresh()}setAutoRefreshOn(refreshOn)},[setAutoRefreshOn,handleAutoRefresh]);const shouldShowRulesTable=Object(external_kbnSharedDeps_React_["useMemo"])(()=>showRulesTable({rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled})&&!initLoading,[initLoading,rulesCustomInstalled,rulesInstalled]);const shouldShowPrepackagedRulesPrompt=Object(external_kbnSharedDeps_React_["useMemo"])(()=>rulesCustomInstalled!=null&&rulesCustomInstalled===0&&prePackagedRuleStatus==="ruleNotInstalled"&&!initLoading,[initLoading,prePackagedRuleStatus,rulesCustomInstalled]);const handleGenericDownloaderSuccess=Object(external_kbnSharedDeps_React_["useCallback"])(exportCount=>{actionStopped();dispatchToaster({type:"addToaster",toast:{id:uuid_default.a.v4(),title:rules_translations["zb"](exportCount),color:"success",iconType:"check"}})},[actionStopped,dispatchToaster]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiWindowEvent"],{event:"mousemove",handler:debounceResetIdleTimer}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiWindowEvent"],{event:"mousedown",handler:debounceResetIdleTimer}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiWindowEvent"],{event:"click",handler:debounceResetIdleTimer}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiWindowEvent"],{event:"keydown",handler:debounceResetIdleTimer}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiWindowEvent"],{event:"scroll",handler:debounceResetIdleTimer}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiWindowEvent"],{event:"load",handler:debounceResetIdleTimer}),external_kbnSharedDeps_React_default.a.createElement(generic_downloader["a"],{filename:`${rules_translations["T"]}.ndjson`,ids:exportRuleIds,onExportSuccess:handleGenericDownloaderSuccess,exportSelectedData:api["f"]}),external_kbnSharedDeps_React_default.a.createElement(panel["a"],{loading:loading||isLoadingRules||isLoadingRulesStatuses,"data-test-subj":"allRulesPanel"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,!initLoading&&(loading||isLoadingRules||isLoadingAnActionOnRule)&&isRefreshing&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiProgress"],{"data-test-subj":"loadingRulesInfoProgress",size:"xs",position:"absolute",color:"accent"}),external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{split:true,growLeftSplit:false,title:rules_translations["g"],subtitle:external_kbnSharedDeps_React_default.a.createElement(last_updated["a"],{showUpdating:loading||isLoadingRules||isLoadingRulesStatuses,updatedAt:lastUpdated})},shouldShowRulesTable&&external_kbnSharedDeps_React_default.a.createElement(RulesTableFilters,{onFilterChanged:onFilterChangedCallback,rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled,currentFilterTags:filterOptions.tags})),!initLoading&&(loading||isLoadingRules||isLoadingAnActionOnRule)&&!isRefreshing&&external_kbnSharedDeps_React_default.a.createElement(loader["a"],{"data-test-subj":"loadingPanelAllRulesTable",overlay:true,size:"xl"}),shouldShowPrepackagedRulesPrompt&&external_kbnSharedDeps_React_default.a.createElement(PrePackagedRulesPrompt,{createPrePackagedRules:handleCreatePrePackagedRules,loading:loadingCreatePrePackagedRules,userHasNoPermissions:hasNoPermissions}),initLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingContent"],{"data-test-subj":"initialLoadingPanelAllRulesTable",lines:10}),showIdleModal&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiConfirmModal"],{title:rules_translations["lb"],onCancel:handleIdleModalContinue,onConfirm:handleIdleModalContinue,confirmButtonText:rules_translations["kb"],defaultFocusedButton:"confirm","data-test-subj":"allRulesIdleModal"},external_kbnSharedDeps_React_default.a.createElement("p",null,rules_translations["jb"])),shouldShowRulesTable&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(AllRulesUtilityBar,{userHasNoPermissions:hasNoPermissions,paginationTotal:(_pagination$total=pagination.total)!==null&&_pagination$total!==void 0?_pagination$total:0,numberSelectedItems:selectedRuleIds.length,onGetBatchItemsPopoverContent:getBatchItemsPopoverContent,onRefresh:handleManualRefresh,isAutoRefreshOn:isRefreshOn,onRefreshSwitch:handleAutoRefreshSwitch,showBulkActions:true}),external_kbnSharedDeps_React_default.a.createElement(AllRulesTables,{selectedTab:selectedTab,euiBasicTableSelectionProps:euiBasicTableSelectionProps,hasNoPermissions:hasNoPermissions,monitoringColumns:monitoringColumns,pagination:paginationMemo,rules:rules,rulesColumns:rulesColumns,rulesStatuses:rulesStatuses,sorting:sorting,tableOnChangeCallback:tableOnChangeCallback,tableRef:tableRef})))))});RulesTables.displayName="RulesTables";const InvisibleAnchor=external_kbnSharedDeps_StyledComponents_default.a.a.withConfig({displayName:"InvisibleAnchor",componentId:"bxvucm-0"})(["display:none;"]);const AutoDownload=({blob:blob,name:name,onDownload:onDownload})=>{const anchorRef=Object(external_kbnSharedDeps_React_["useRef"])(null);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(blob&&anchorRef!==null&&anchorRef!==void 0&&anchorRef.current){if(typeof window.navigator.msSaveOrOpenBlob==="function"){window.navigator.msSaveBlob(blob)}else{const objectURL=window.URL.createObjectURL(blob);anchorRef.current.href=objectURL;anchorRef.current.download=name!==null&&name!==void 0?name:"download.txt";anchorRef.current.click();window.URL.revokeObjectURL(objectURL)}if(onDownload){onDownload()}}},[blob,name,onDownload]);return external_kbnSharedDeps_React_default.a.createElement(InvisibleAnchor,{ref:anchorRef})};const EXCEPTION_LIST_ID_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.idTitle",{defaultMessage:"List ID"});const EXCEPTION_LIST_NAME=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.listName",{defaultMessage:"Name"});const NUMBER_RULES_ASSIGNED_TO_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.numberRulesAssignedTitle",{defaultMessage:"Number of rules assigned to"});const RULES_ASSIGNED_TO_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.rulesAssignedTitle",{defaultMessage:"Rules assigned to"});const LIST_DATE_CREATED_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.dateCreatedTitle",{defaultMessage:"Date created"});const LIST_DATE_UPDATED_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.dateUpdatedTitle",{defaultMessage:"Last edited"});const ERROR_EXCEPTION_LISTS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.errorFetching",{defaultMessage:"Error fetching exception lists"});const NO_EXCEPTION_LISTS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.allExceptionLists.filters.noExceptionsTitle",{defaultMessage:"No exception lists found"});const EXCEPTIONS_LISTS_SEARCH_PLACEHOLDER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.allExceptionLists.search.placeholder",{defaultMessage:"Search exception lists"});const ALL_EXCEPTIONS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.allExceptions.tableTitle",{defaultMessage:"Exception Lists"});const NO_LISTS_BODY=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.allExceptions.filters.noListsBody",{defaultMessage:"We weren't able to find any exception lists."});const EXCEPTION_EXPORT_SUCCESS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.exportSuccess",{defaultMessage:"Exception list export success"});const EXCEPTION_EXPORT_ERROR=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.exportError",{defaultMessage:"Exception list export error"});const EXCEPTION_DELETE_ERROR=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.deleteError",{defaultMessage:"Error occurred deleting exception list"});const exceptionDeleteSuccessMessage=listId=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.referenceModalSuccessDescription",{defaultMessage:"Exception list - {listId} - deleted successfully.",values:{listId:listId}});const REFERENCE_MODAL_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.referenceModalTitle",{defaultMessage:"Remove exception list"});const REFERENCE_MODAL_CANCEL_BUTTON=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.referenceModalCancelButton",{defaultMessage:"Cancel"});const REFERENCE_MODAL_CONFIRM_BUTTON=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.referenceModalDeleteButton",{defaultMessage:"Remove exception list"});const referenceErrorMessage=referenceCount=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.referenceModalDescription",{defaultMessage:"This exception list is associated with ({referenceCount}) {referenceCount, plural, =1 {rule} other {rules}}. Removing this exception list will also remove its reference from the associated rules.",values:{referenceCount:referenceCount}});const EXCEPTION_LIST_SEARCH_PLACEHOLDER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.exceptions.searchPlaceholder",{defaultMessage:"e.g. Example List Name"});var page=__webpack_require__(153);const getAllExceptionListsColumns=(onExport,onDelete,history,formatUrl)=>[{align:"left",field:"list_id",name:EXCEPTION_LIST_ID_TITLE,truncateText:true,dataType:"string",width:"15%",render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"left",content:value},external_kbnSharedDeps_React_default.a.createElement("p",{"data-test-subj":"exceptionsTableListId"},value))},{align:"left",field:"name",name:EXCEPTION_LIST_NAME,truncateText:true,dataType:"string",width:"10%",render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"left",content:value},external_kbnSharedDeps_React_default.a.createElement("p",{"data-test-subj":"exceptionsTableName"},value))},{align:"center",field:"rules",name:NUMBER_RULES_ASSIGNED_TO_TITLE,truncateText:true,dataType:"number",width:"10%",render:value=>external_kbnSharedDeps_React_default.a.createElement("p",null,value.length)},{align:"left",field:"rules",name:RULES_ASSIGNED_TO_TITLE,truncateText:true,dataType:"string",width:"20%",render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,value.map(({id:id,name:name},index)=>external_kbnSharedDeps_React_default.a.createElement(page["h"],{key:id},external_kbnSharedDeps_React_default.a.createElement(links["f"],{key:id,"data-test-subj":"ruleName",onClick:ev=>{ev.preventDefault();history.push(Object(redirect_to_detection_engine["e"])(id))},href:formatUrl(Object(redirect_to_detection_engine["e"])(id))},name),index!==value.length-1?", ":"")))},{align:"left",field:"created_at",name:LIST_DATE_CREATED_TITLE,truncateText:true,dataType:"date",width:"14%"},{align:"left",field:"updated_at",name:LIST_DATE_UPDATED_TITLE,truncateText:true,width:"14%"},{align:"center",isExpander:false,width:"25px",render:({id:id,list_id:listId,namespace_type:namespaceType})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{onClick:onExport({id:id,listId:listId,namespaceType:namespaceType}),"aria-label":"Export exception list",iconType:"exportAction","data-test-subj":"exceptionsTableExportButton"})},{align:"center",width:"25px",isExpander:false,render:({id:id,list_id:listId,namespace_type:namespaceType})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{color:"danger",onClick:onDelete({id:id,listId:listId,namespaceType:namespaceType}),"aria-label":"Delete exception list",iconType:"trash",isDisabled:listId==="endpoint_list","data-test-subj":"exceptionsTableDeleteButton"})}];const useAllExceptionLists=({exceptionLists:exceptionLists})=>{const[loading,setLoading]=Object(external_kbnSharedDeps_React_["useState"])(true);const[exceptions,setExceptions]=Object(external_kbnSharedDeps_React_["useState"])([]);const[exceptionsListsInfo,setExceptionsListInfo]=Object(external_kbnSharedDeps_React_["useState"])({});const handleExceptionsInfo=Object(external_kbnSharedDeps_React_["useCallback"])(rules=>{const listsSkeleton=exceptionLists.reduce((acc,{id:id,...rest})=>{acc[id]={...rest,id:id,rules:[]};return acc},{});return rules.reduce((acc,rule)=>{const ruleExceptionLists=rule.exceptions_list;if(ruleExceptionLists!=null&&ruleExceptionLists.length>0){ruleExceptionLists.forEach(ex=>{const list=acc[ex.id];if(list!=null){acc[ex.id]={...list,rules:[...list.rules,rule]}}})}return acc},listsSkeleton)},[exceptionLists]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;const abortCtrl=new AbortController;const fetchData=async()=>{if(exceptionLists.length===0&&isSubscribed){setLoading(false);setExceptions([]);setExceptionsListInfo({});return}try{setLoading(true);const{data:rules}=await Object(api["h"])({pagination:{page:1,perPage:1e4,total:0},signal:abortCtrl.signal});const updatedLists=handleExceptionsInfo(rules);const lists=Object.keys(updatedLists).map(listKey=>updatedLists[listKey]);setExceptions(lists);setExceptionsListInfo(updatedLists);if(isSubscribed){setLoading(false)}}catch(error){if(isSubscribed){setLoading(false)}}};fetchData();return()=>{isSubscribed=false;abortCtrl.abort()}},[exceptionLists.length,handleExceptionsInfo]);return[loading,exceptions,exceptionsListsInfo]};const MarkdownContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"MarkdownContainer",componentId:"sc-1c9tzb5-0"})(["max-height:200px;overflow-y:auto;&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],({theme:theme})=>theme.eui.euiScrollBar,({theme:theme})=>theme.eui.euiScrollBar,({theme:theme})=>Object(polished_lib["rgba"])(theme.eui.euiColorDarkShade,.5),({theme:theme})=>theme.eui.euiScrollBarCorner);const ReferenceErrorModalComponent=({cancelText:cancelText,confirmText:confirmText,contentText:contentText,onClose:onClose,onCancel:onCancel,onConfirm:onConfirm,references:references=[],showModal:showModal,titleText:titleText})=>{if(!showModal){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiConfirmModal"],{maxWidth:460,title:titleText,onCancel:onCancel,onConfirm:onConfirm,cancelButtonText:cancelText,confirmButtonText:confirmText,buttonColor:"danger",defaultFocusedButton:"confirm","data-test-subj":"referenceErrorModal"},external_kbnSharedDeps_React_default.a.createElement("p",null,contentText),external_kbnSharedDeps_React_default.a.createElement(MarkdownContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiListGroup"],{gutterSize:"none",showToolTips:true},references.map((r,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiListGroupItem"],{key:`${index}-${r}`,label:r})))))};ReferenceErrorModalComponent.displayName="ReferenceErrorModalComponent";const ReferenceErrorModal=external_kbnSharedDeps_React_default.a.memo(ReferenceErrorModalComponent);ReferenceErrorModal.displayName="ReferenceErrorModal";const EXCEPTIONS_SEARCH_SCHEMA={strict:true,fields:{created_by:{type:"string"},name:{type:"string"},type:{type:"string"},list_id:{type:"string"},tags:{type:"string"}}};const ExceptionsSearchBar=external_kbnSharedDeps_React_default.a.memo(({onSearch:onSearch})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSearchBar"],{"data-test-subj":"exceptionsHeaderSearch","aria-label":EXCEPTIONS_LISTS_SEARCH_PLACEHOLDER,onChange:onSearch,box:{placeholder:EXCEPTION_LIST_SEARCH_PLACEHOLDER,incremental:false,schema:EXCEPTIONS_SEARCH_SCHEMA}}));ExceptionsSearchBar.displayName="ExceptionsSearchBar";const exceptions_table_MyEuiBasicTable=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiBasicTable"]).withConfig({displayName:"MyEuiBasicTable",componentId:"sc-5x4nxx-0"})([""]);const exceptionReferenceModalInitialState={contentText:"",rulesReferences:[],isLoading:false,listId:"",listNamespaceType:"single"};const ExceptionListsTable=external_kbnSharedDeps_React_default.a.memo(({formatUrl:formatUrl,history:history,hasNoPermissions:hasNoPermissions,loading:loading})=>{var _exceptionListsWithRu,_hasNoPermissions;const{services:{http:http,notifications:notifications}}=Object(lib_kibana["h"])();const{exportExceptionList:exportExceptionList,deleteExceptionList:deleteExceptionList}=Object(shared_imports["A"])(http);const[showReferenceErrorModal,setShowReferenceErrorModal]=Object(external_kbnSharedDeps_React_["useState"])(false);const[referenceModalState,setReferenceModalState]=Object(external_kbnSharedDeps_React_["useState"])(exceptionReferenceModalInitialState);const[filters,setFilters]=Object(external_kbnSharedDeps_React_["useState"])(undefined);const[loadingExceptions,exceptions,pagination,refreshExceptions]=Object(shared_imports["G"])({errorMessage:ERROR_EXCEPTION_LISTS,filterOptions:filters,http:http,namespaceTypes:["single","agnostic"],notifications:notifications,showTrustedApps:false});const[loadingTableInfo,exceptionListsWithRuleRefs,exceptionsListsRef]=useAllExceptionLists({exceptionLists:exceptions!==null&&exceptions!==void 0?exceptions:[]});const[initLoading,setInitLoading]=Object(external_kbnSharedDeps_React_["useState"])(true);const[lastUpdated,setLastUpdated]=Object(external_kbnSharedDeps_React_["useState"])(Date.now());const[deletingListIds,setDeletingListIds]=Object(external_kbnSharedDeps_React_["useState"])([]);const[exportingListIds,setExportingListIds]=Object(external_kbnSharedDeps_React_["useState"])([]);const[exportDownload,setExportDownload]=Object(external_kbnSharedDeps_React_["useState"])({});const handleDeleteSuccess=Object(external_kbnSharedDeps_React_["useCallback"])(listId=>()=>{notifications.toasts.addSuccess({title:exceptionDeleteSuccessMessage(listId!==null&&listId!==void 0?listId:referenceModalState.listId)})},[notifications.toasts,referenceModalState.listId]);const handleDeleteError=Object(external_kbnSharedDeps_React_["useCallback"])(err=>{notifications.toasts.addError(err,{title:EXCEPTION_DELETE_ERROR,toastMessage:err.body!=null?err.body.message:err.message})},[notifications.toasts]);const handleDelete=Object(external_kbnSharedDeps_React_["useCallback"])(({id:id,listId:listId,namespaceType:namespaceType})=>async()=>{try{setDeletingListIds(ids=>[...ids,id]);if(refreshExceptions!=null){await refreshExceptions()}if(exceptionsListsRef[id]!=null&&exceptionsListsRef[id].rules.length===0){await deleteExceptionList({id:id,namespaceType:namespaceType,onError:handleDeleteError,onSuccess:handleDeleteSuccess(listId)});if(refreshExceptions!=null){refreshExceptions()}}else{setReferenceModalState({contentText:referenceErrorMessage(exceptionsListsRef[id].rules.length),rulesReferences:exceptionsListsRef[id].rules.map(({name:name})=>name),isLoading:true,listId:id,listNamespaceType:namespaceType});setShowReferenceErrorModal(true)}}catch(error){handleDeleteError(error)}finally{setDeletingListIds(ids=>[...ids.filter(_id=>_id!==id)])}},[deleteExceptionList,exceptionsListsRef,handleDeleteError,handleDeleteSuccess,refreshExceptions]);const handleExportSuccess=Object(external_kbnSharedDeps_React_["useCallback"])(listId=>blob=>{setExportDownload({name:listId,blob:blob})},[]);const handleExportError=Object(external_kbnSharedDeps_React_["useCallback"])(err=>{notifications.toasts.addError(err,{title:EXCEPTION_EXPORT_ERROR})},[notifications.toasts]);const handleExport=Object(external_kbnSharedDeps_React_["useCallback"])(({id:id,listId:listId,namespaceType:namespaceType})=>async()=>{setExportingListIds(ids=>[...ids,id]);await exportExceptionList({id:id,listId:listId,namespaceType:namespaceType,onError:handleExportError,onSuccess:handleExportSuccess(listId)})},[exportExceptionList,handleExportError,handleExportSuccess]);const exceptionsColumns=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getAllExceptionListsColumns(handleExport,handleDelete,history,formatUrl),[handleExport,handleDelete,history,formatUrl]);const handleRefresh=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(refreshExceptions!=null){setLastUpdated(Date.now());refreshExceptions()}},[refreshExceptions]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(initLoading&&!loading&&!loadingExceptions&&!loadingTableInfo){setInitLoading(false)}},[initLoading,loading,loadingExceptions,loadingTableInfo]);const emptyPrompt=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,NO_EXCEPTION_LISTS),titleSize:"xs",body:NO_LISTS_BODY}),[]);const handleSearch=Object(external_kbnSharedDeps_React_["useCallback"])(async({query:query,queryText:queryText})=>{const filterOptions={name:null,list_id:null,created_by:null,type:null,tags:null};const searchTerms=getSearchFilters({defaultSearchTerm:"name",filterOptions:filterOptions,query:query,searchValue:queryText});setFilters(searchTerms)},[]);const handleCloseReferenceErrorModal=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setDeletingListIds([]);setShowReferenceErrorModal(false);setReferenceModalState({contentText:"",rulesReferences:[],isLoading:false,listId:"",listNamespaceType:"single"})},[]);const handleReferenceDelete=Object(external_kbnSharedDeps_React_["useCallback"])(async()=>{const exceptionListId=referenceModalState.listId;const exceptionListNamespaceType=referenceModalState.listNamespaceType;const relevantRules=exceptionsListsRef[exceptionListId].rules;try{await Promise.all(relevantRules.map(rule=>{var _rule$exceptions_list;const abortCtrl=new AbortController;const exceptionLists=((_rule$exceptions_list=rule.exceptions_list)!==null&&_rule$exceptions_list!==void 0?_rule$exceptions_list:[]).filter(({id:id})=>id!==exceptionListId);return Object(api["n"])({ruleProperties:{rule_id:rule.rule_id,exceptions_list:exceptionLists},signal:abortCtrl.signal})}));await deleteExceptionList({id:exceptionListId,namespaceType:exceptionListNamespaceType,onError:handleDeleteError,onSuccess:handleDeleteSuccess()})}catch(err){handleDeleteError(err)}finally{setReferenceModalState(exceptionReferenceModalInitialState);setDeletingListIds([]);setShowReferenceErrorModal(false);if(refreshExceptions!=null){refreshExceptions()}}},[referenceModalState.listId,referenceModalState.listNamespaceType,exceptionsListsRef,deleteExceptionList,handleDeleteError,handleDeleteSuccess,refreshExceptions]);const paginationMemo=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({pageIndex:pagination.page-1,pageSize:pagination.perPage,totalItemCount:pagination.total,pageSizeOptions:[5,10,20,50,100,200,300]}),[pagination]);const handleOnDownload=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setExportDownload({})},[]);const tableItems=(exceptionListsWithRuleRefs!==null&&exceptionListsWithRuleRefs!==void 0?exceptionListsWithRuleRefs:[]).map(item=>({...item,isDeleting:deletingListIds.includes(item.id),isExporting:exportingListIds.includes(item.id)}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(panel["a"],{loading:!initLoading&&loadingTableInfo,"data-test-subj":"allExceptionListsPanel"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,loadingTableInfo&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiProgress"],{"data-test-subj":"loadingRulesInfoProgress",size:"xs",position:"absolute",color:"accent"}),external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{split:true,title:ALL_EXCEPTIONS,subtitle:external_kbnSharedDeps_React_default.a.createElement(last_updated["a"],{showUpdating:loading,updatedAt:lastUpdated})},!initLoading&&external_kbnSharedDeps_React_default.a.createElement(ExceptionsSearchBar,{onSearch:handleSearch})),loadingTableInfo&&!initLoading&&!showReferenceErrorModal&&external_kbnSharedDeps_React_default.a.createElement(loader["a"],{"data-test-subj":"loadingPanelAllRulesTable",overlay:true,size:"xl"}),initLoading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingContent"],{"data-test-subj":"initialLoadingPanelAllRulesTable",lines:10}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(AllRulesUtilityBar,{showBulkActions:false,userHasNoPermissions:hasNoPermissions,paginationTotal:(_exceptionListsWithRu=exceptionListsWithRuleRefs.length)!==null&&_exceptionListsWithRu!==void 0?_exceptionListsWithRu:0,numberSelectedItems:0,onRefresh:handleRefresh}),external_kbnSharedDeps_React_default.a.createElement(exceptions_table_MyEuiBasicTable,{"data-test-subj":"exceptions-table",columns:exceptionsColumns,isSelectable:(_hasNoPermissions=!hasNoPermissions)!==null&&_hasNoPermissions!==void 0?_hasNoPermissions:false,itemId:"id",items:tableItems,noItemsMessage:emptyPrompt,onChange:()=>{},pagination:paginationMemo})))),external_kbnSharedDeps_React_default.a.createElement(AutoDownload,{blob:exportDownload.blob,name:`${exportDownload.name}.ndjson`,onDownload:handleOnDownload}),external_kbnSharedDeps_React_default.a.createElement(ReferenceErrorModal,{cancelText:REFERENCE_MODAL_CANCEL_BUTTON,confirmText:REFERENCE_MODAL_CONFIRM_BUTTON,contentText:referenceModalState.contentText,onCancel:handleCloseReferenceErrorModal,onClose:handleCloseReferenceErrorModal,onConfirm:handleReferenceDelete,references:referenceModalState.rulesReferences,showModal:showReferenceErrorModal,titleText:REFERENCE_MODAL_TITLE}))});let AllRulesTabs;(function(AllRulesTabs){AllRulesTabs["rules"]="rules";AllRulesTabs["monitoring"]="monitoring";AllRulesTabs["exceptions"]="exceptions"})(AllRulesTabs||(AllRulesTabs={}));const allRulesTabs=[{id:AllRulesTabs.rules,name:rules_translations["ob"],disabled:false},{id:AllRulesTabs.monitoring,name:rules_translations["bb"],disabled:false},{id:AllRulesTabs.exceptions,name:rules_translations["S"],disabled:false}];const AllRules=external_kbnSharedDeps_React_default.a.memo(({createPrePackagedRules:createPrePackagedRules,hasNoPermissions:hasNoPermissions,loading:loading,loadingCreatePrePackagedRules:loadingCreatePrePackagedRules,refetchPrePackagedRulesStatus:refetchPrePackagedRulesStatus,rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled,rulesNotInstalled:rulesNotInstalled,rulesNotUpdated:rulesNotUpdated,setRefreshRulesData:setRefreshRulesData})=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const{formatUrl:formatUrl}=Object(link_to["o"])(app_types["a"].detections);const[allRulesTab,setAllRulesTab]=Object(external_kbnSharedDeps_React_["useState"])(AllRulesTabs.rules);const tabs=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTabs"],null,allRulesTabs.map(tab=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTab"],{"data-test-subj":`allRulesTableTab-${tab.id}`,onClick:()=>setAllRulesTab(tab.id),isSelected:tab.id===allRulesTab,disabled:tab.disabled,key:tab.id},tab.name))),[allRulesTabs,allRulesTab,setAllRulesTab]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),tabs,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),(allRulesTab===AllRulesTabs.rules||allRulesTab===AllRulesTabs.monitoring)&&external_kbnSharedDeps_React_default.a.createElement(RulesTables,{history:history,formatUrl:formatUrl,selectedTab:allRulesTab,createPrePackagedRules:createPrePackagedRules,hasNoPermissions:hasNoPermissions,loading:loading,loadingCreatePrePackagedRules:loadingCreatePrePackagedRules,refetchPrePackagedRulesStatus:refetchPrePackagedRulesStatus,rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled,rulesNotInstalled:rulesNotInstalled,rulesNotUpdated:rulesNotUpdated,setRefreshRulesData:setRefreshRulesData}),allRulesTab===AllRulesTabs.exceptions&&external_kbnSharedDeps_React_default.a.createElement(ExceptionListsTable,{formatUrl:formatUrl,history:history,hasNoPermissions:hasNoPermissions,loading:loading}))});AllRules.displayName="AllRules";var import_data_modal=__webpack_require__(781);const MODAL_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.uploadValueListTitle",{defaultMessage:"Upload value lists"});const FILE_PICKER_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.uploadValueListDescription",{defaultMessage:"Upload single value lists to use while writing rule exceptions."});const FILE_PICKER_PROMPT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.uploadValueListPrompt",{defaultMessage:"Select or drag and drop a file"});const FILE_PICKER_INVALID_FILE_TYPE=fileTypes=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.uploadValueListExtensionValidationMessage",{values:{fileTypes:fileTypes},defaultMessage:"File must be one of the following types: [{fileTypes}]"});const CLOSE_BUTTON=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.closeValueListsModalTitle",{defaultMessage:"Close"});const CANCEL_BUTTON=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.cancelValueListsUploadTitle",{defaultMessage:"Cancel upload"});const UPLOAD_BUTTON=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsUploadButton",{defaultMessage:"Upload list"});const UPLOAD_SUCCESS_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsUploadSuccessTitle",{defaultMessage:"Value list uploaded"});const UPLOAD_ERROR=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsUploadError",{defaultMessage:"There was an error uploading the value list."});const uploadSuccessMessage=fileName=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsUploadSuccess",{defaultMessage:"Value list '{fileName}' was uploaded",values:{fileName:fileName}});const EXPORT_ERROR=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsExportError",{defaultMessage:"There was an error exporting the value list."});const COLUMN_FILE_NAME=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsTable.fileNameColumn",{defaultMessage:"Filename"});const COLUMN_TYPE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsTable.typeColumn",{defaultMessage:"Type"});const COLUMN_UPLOAD_DATE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsTable.uploadDateColumn",{defaultMessage:"Upload Date"});const COLUMN_CREATED_BY=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsTable.createdByColumn",{defaultMessage:"Created by"});const COLUMN_ACTIONS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsTable.actionsColumn",{defaultMessage:"Actions"});const ACTION_EXPORT_NAME=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsTable.exportActionName",{defaultMessage:"Export"});const ACTION_EXPORT_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsTable.exportActionDescription",{defaultMessage:"Export value list"});const ACTION_DELETE_NAME=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsTable.deleteActionName",{defaultMessage:"Remove"});const ACTION_DELETE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsTable.deleteActionDescription",{defaultMessage:"Remove value list"});const TABLE_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsTable.title",{defaultMessage:"Value lists"});const LIST_TYPES_RADIO_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsForm.listTypesRadioLabel",{defaultMessage:"Type of value list"});const IP_RADIO=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsForm.ipRadioLabel",{defaultMessage:"IP addresses"});const KEYWORDS_RADIO=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsForm.keywordsRadioLabel",{defaultMessage:"Keywords"});const IP_RANGE_RADIO=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsForm.ipRangesRadioLabel",{defaultMessage:"IP ranges"});const TEXT_RADIO=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.valueListsForm.textRadioLabel",{defaultMessage:"Text"});const translations_REFERENCE_MODAL_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.referenceModalTitle",{defaultMessage:"Remove value list"});const translations_REFERENCE_MODAL_CANCEL_BUTTON=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.referenceModalCancelButton",{defaultMessage:"Cancel"});const translations_REFERENCE_MODAL_CONFIRM_BUTTON=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.referenceModalDeleteButton",{defaultMessage:"Remove value list"});const translations_referenceErrorMessage=referenceCount=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.lists.referenceModalDescription",{defaultMessage:"This value list is associated with ({referenceCount}) exception {referenceCount, plural, =1 {list} other {lists}}. Removing this list will remove all exception items that reference this value list.",values:{referenceCount:referenceCount}});const listFormOptions=[{value:"keyword",text:KEYWORDS_RADIO},{value:"ip",text:IP_RADIO},{value:"ip_range",text:IP_RANGE_RADIO},{value:"text",text:TEXT_RADIO}];const defaultListType="keyword";const validFileTypes=["text/csv","text/plain"];const ValueListsFormComponent=({onError:onError,onSuccess:onSuccess})=>{const ctrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const[file,setFile]=Object(external_kbnSharedDeps_React_["useState"])(null);const[type,setType]=Object(external_kbnSharedDeps_React_["useState"])(defaultListType);const filePickerRef=Object(external_kbnSharedDeps_React_["useRef"])(null);const{http:http}=Object(lib_kibana["h"])().services;const{start:importList,...importState}=Object(shared_imports["L"])();const fileIsValid=!file||validFileTypes.some(fileType=>file.type===fileType);const handleRadioChange=Object(external_kbnSharedDeps_React_["useCallback"])(event=>setType(event.target.value),[setType]);const handleFileChange=Object(external_kbnSharedDeps_React_["useCallback"])(files=>{var _files$item;setFile((_files$item=files===null||files===void 0?void 0:files.item(0))!==null&&_files$item!==void 0?_files$item:null)},[]);const resetForm=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{var _filePickerRef$curren;if((_filePickerRef$curren=filePickerRef.current)!==null&&_filePickerRef$curren!==void 0&&_filePickerRef$curren.fileInput){filePickerRef.current.fileInput.value="";filePickerRef.current.handleChange()}setFile(null);setType(defaultListType)},[]);const handleCancel=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{ctrl.current.abort()},[]);const handleSuccess=Object(external_kbnSharedDeps_React_["useCallback"])(response=>{resetForm();onSuccess(response)},[resetForm,onSuccess]);const handleError=Object(external_kbnSharedDeps_React_["useCallback"])(error=>{onError(error)},[onError]);const handleImport=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(!importState.loading&&file){ctrl.current=new AbortController;importList({file:file,listId:undefined,http:http,signal:ctrl.current.signal,type:type})}},[importState.loading,file,importList,http,type]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!importState.loading&&importState.result){handleSuccess(importState.result)}else if(!importState.loading&&importState.error){handleError(importState.error)}},[handleError,handleSuccess,importState.error,importState.loading,importState.result]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>handleCancel,[handleCancel]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiForm"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{"data-test-subj":"value-list-file-picker-row",label:FILE_PICKER_LABEL,fullWidth:true,isInvalid:!fileIsValid,error:[FILE_PICKER_INVALID_FILE_TYPE(validFileTypes.join(", "))]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFilePicker"],{accept:validFileTypes.join(),"data-test-subj":"value-list-file-picker",id:"value-list-file-picker",initialPromptText:FILE_PICKER_PROMPT,ref:filePickerRef,onChange:handleFileChange,fullWidth:true,isLoading:importState.loading,isInvalid:!fileIsValid})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:LIST_TYPES_RADIO_LABEL},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{"data-test-subj":"value-lists-form-select-type-action",options:listFormOptions,value:type,onChange:handleRadioChange,name:"valueListType"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{hasEmptyLabelSpace:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,importState.loading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:handleCancel},CANCEL_BUTTON)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"value-lists-form-import-action",onClick:handleImport,disabled:file==null||!fileIsValid||importState.loading},UPLOAD_BUTTON))))))))};ValueListsFormComponent.displayName="ValueListsFormComponent";const ValueListsForm=external_kbnSharedDeps_React_default.a.memo(ValueListsFormComponent);ValueListsForm.displayName="ValueListsForm";const AlignedSpinner=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"]).withConfig({displayName:"AlignedSpinner",componentId:"j76bhq-0"})(["margin:",";vertical-align:middle;"],({theme:theme})=>theme.eui.euiSizeXS);const buildColumns=(onExport,onDelete)=>[{field:"name",name:COLUMN_FILE_NAME,truncateText:false},{field:"type",name:COLUMN_TYPE,width:"15%",truncateText:true,render:type=>{const option=listFormOptions.find(({value:value})=>value===type);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,option?option.text:type)}},{field:"created_at",name:COLUMN_UPLOAD_DATE,render:value=>external_kbnSharedDeps_React_default.a.createElement(formatted_date["a"],{value:value,fieldName:"created_at"}),width:"30%"},{field:"created_by",name:COLUMN_CREATED_BY,truncateText:true,width:"20%"},{name:COLUMN_ACTIONS,actions:[{render:item=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:ACTION_EXPORT_DESCRIPTION},item.isExporting?external_kbnSharedDeps_React_default.a.createElement(AlignedSpinner,{size:"m"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"aria-label":ACTION_EXPORT_DESCRIPTION,"data-test-subj":"action-export-value-list",iconType:"exportAction",onClick:()=>onExport(item)}))},{render:item=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:ACTION_DELETE_DESCRIPTION},item.isDeleting?external_kbnSharedDeps_React_default.a.createElement(AlignedSpinner,{size:"m"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"aria-label":ACTION_DELETE_DESCRIPTION,"data-test-subj":`action-delete-value-list-${item.name}`,iconType:"trash",onClick:()=>onDelete(item)}))}],width:"15%"}];const referenceModalInitialState={contentText:"",exceptionListReferences:[],isLoading:false,valueListId:""};const ValueListsModalComponent=({onClose:onClose,showModal:showModal})=>{var _lists$result$data,_lists$result2,_lists$result$total,_lists$result3;const[pageIndex,setPageIndex]=Object(external_kbnSharedDeps_React_["useState"])(0);const[pageSize,setPageSize]=Object(external_kbnSharedDeps_React_["useState"])(5);const[cursor,setCursor]=Object(shared_imports["D"])({pageIndex:pageIndex,pageSize:pageSize});const{http:http}=Object(lib_kibana["h"])().services;const{start:findLists,...lists}=Object(shared_imports["H"])();const{start:deleteList,result:deleteResult,error:deleteError}=Object(shared_imports["E"])();const[deletingListIds,setDeletingListIds]=Object(external_kbnSharedDeps_React_["useState"])([]);const[exportingListIds,setExportingListIds]=Object(external_kbnSharedDeps_React_["useState"])([]);const[exportDownload,setExportDownload]=Object(external_kbnSharedDeps_React_["useState"])({});const{addError:addError,addSuccess:addSuccess}=Object(use_app_toasts["a"])();const[showReferenceErrorModal,setShowReferenceErrorModal]=Object(external_kbnSharedDeps_React_["useState"])(false);const[referenceModalState,setReferenceModalState]=Object(external_kbnSharedDeps_React_["useState"])(referenceModalInitialState);const fetchLists=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{findLists({cursor:cursor,http:http,pageIndex:pageIndex+1,pageSize:pageSize})},[cursor,http,findLists,pageIndex,pageSize]);const handleDelete=Object(external_kbnSharedDeps_React_["useCallback"])(({deleteReferences:deleteReferences,id:id})=>{setDeletingListIds([...deletingListIds,id]);deleteList({deleteReferences:deleteReferences,http:http,id:id})},[deleteList,deletingListIds,http]);const handleReferenceDelete=Object(external_kbnSharedDeps_React_["useCallback"])(async()=>{setShowReferenceErrorModal(false);deleteList({deleteReferences:true,http:http,id:referenceModalState.valueListId});setReferenceModalState(referenceModalInitialState);setDeletingListIds([])},[deleteList,http,referenceModalState.valueListId]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(deleteResult!=null){setDeletingListIds(ids=>[...ids.filter(id=>id!==deleteResult.id)]);fetchLists()}},[deleteResult,fetchLists]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(deleteError)){var _deleteError$body$mes,_deleteError$body,_deleteError$body$mes2,_deleteError$body$mes3,_deleteError$body$mes4,_deleteError$body2,_deleteError$body2$me,_deleteError$body2$me2;const references=(_deleteError$body$mes=deleteError===null||deleteError===void 0?void 0:(_deleteError$body=deleteError.body)===null||_deleteError$body===void 0?void 0:(_deleteError$body$mes2=_deleteError$body.message)===null||_deleteError$body$mes2===void 0?void 0:(_deleteError$body$mes3=_deleteError$body$mes2.error)===null||_deleteError$body$mes3===void 0?void 0:(_deleteError$body$mes4=_deleteError$body$mes3.references)===null||_deleteError$body$mes4===void 0?void 0:_deleteError$body$mes4.map(ref=>ref===null||ref===void 0?void 0:ref.exception_list.name))!==null&&_deleteError$body$mes!==void 0?_deleteError$body$mes:[];const uniqueExceptionListReferences=Array.from(new Set(references));setShowReferenceErrorModal(true);setReferenceModalState({contentText:translations_referenceErrorMessage(uniqueExceptionListReferences.length),exceptionListReferences:uniqueExceptionListReferences,isLoading:false,valueListId:deleteError===null||deleteError===void 0?void 0:(_deleteError$body2=deleteError.body)===null||_deleteError$body2===void 0?void 0:(_deleteError$body2$me=_deleteError$body2.message)===null||_deleteError$body2$me===void 0?void 0:(_deleteError$body2$me2=_deleteError$body2$me.error)===null||_deleteError$body2$me2===void 0?void 0:_deleteError$body2$me2.value_list_id})}},[deleteError]);const handleExport=Object(external_kbnSharedDeps_React_["useCallback"])(async({id:id})=>{try{setExportingListIds(ids=>[...ids,id]);const blob=await Object(shared_imports["t"])({http:http,listId:id,signal:(new AbortController).signal});setExportDownload({name:id,blob:blob})}catch(error){addError(error,{title:EXPORT_ERROR})}finally{setExportingListIds(ids=>[...ids.filter(_id=>_id!==id)])}},[addError,http]);const handleTableChange=Object(external_kbnSharedDeps_React_["useCallback"])(({page:{index:index,size:size}})=>{setPageIndex(index);setPageSize(size)},[setPageIndex,setPageSize]);const handleUploadError=Object(external_kbnSharedDeps_React_["useCallback"])(error=>{if(error.name!=="AbortError"){addError(error,{title:UPLOAD_ERROR})}},[addError]);const handleUploadSuccess=Object(external_kbnSharedDeps_React_["useCallback"])(response=>{addSuccess({text:uploadSuccessMessage(response.name),title:UPLOAD_SUCCESS_TITLE});fetchLists()},[addSuccess]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(showModal){fetchLists()}},[showModal,fetchLists]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{var _lists$result;if(!lists.loading&&(_lists$result=lists.result)!==null&&_lists$result!==void 0&&_lists$result.cursor){setCursor(lists.result.cursor)}},[lists.loading,lists.result,setCursor]);const handleCloseReferenceErrorModal=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setDeletingListIds([]);setShowReferenceErrorModal(false);setReferenceModalState({contentText:"",exceptionListReferences:[],isLoading:false,valueListId:""})},[]);if(!showModal){return null}const tableItems=((_lists$result$data=(_lists$result2=lists.result)===null||_lists$result2===void 0?void 0:_lists$result2.data)!==null&&_lists$result$data!==void 0?_lists$result$data:[]).map(item=>({...item,isDeleting:deletingListIds.includes(item.id),isExporting:exportingListIds.includes(item.id)}));const pagination={pageIndex:pageIndex,pageSize:pageSize,totalItemCount:(_lists$result$total=(_lists$result3=lists.result)===null||_lists$result3===void 0?void 0:_lists$result3.total)!==null&&_lists$result$total!==void 0?_lists$result$total:0,hidePerPageOptions:true};const columns=buildColumns(handleExport,handleDelete);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModal"],{onClose:onClose,maxWidth:800},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModalHeader"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModalHeaderTitle"],null,MODAL_TITLE)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModalBody"],null,external_kbnSharedDeps_React_default.a.createElement(ValueListsForm,{onSuccess:handleUploadSuccess,onError:handleUploadError}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h2",null,TABLE_TITLE)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBasicTable"],{"data-test-subj":"value-lists-table",columns:columns,items:tableItems,loading:lists.loading,onChange:handleTableChange,pagination:pagination}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModalFooter"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"value-lists-modal-close-action",onClick:onClose},CLOSE_BUTTON))),external_kbnSharedDeps_React_default.a.createElement(ReferenceErrorModal,{cancelText:translations_REFERENCE_MODAL_CANCEL_BUTTON,confirmText:translations_REFERENCE_MODAL_CONFIRM_BUTTON,contentText:referenceModalState.contentText,onCancel:handleCloseReferenceErrorModal,onClose:handleCloseReferenceErrorModal,onConfirm:handleReferenceDelete,references:referenceModalState.exceptionListReferences,showModal:showReferenceErrorModal,titleText:translations_REFERENCE_MODAL_TITLE}),external_kbnSharedDeps_React_default.a.createElement(AutoDownload,{blob:exportDownload.blob,name:exportDownload.name,onDownload:()=>setExportDownload({})}))};ValueListsModalComponent.displayName="ValueListsModalComponent";const ValueListsModal=external_kbnSharedDeps_React_default.a.memo(ValueListsModalComponent);ValueListsModal.displayName="ValueListsModal";const UpdatePrePackagedRulesCallOutComponent=({loading:loading,numberOfUpdatedRules:numberOfUpdatedRules,numberOfUpdatedTimelines:numberOfUpdatedTimelines,updateRules:updateRules})=>{const{services:services}=Object(lib_kibana["h"])();const prepackagedRulesOrTimelines=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(numberOfUpdatedRules>0&&numberOfUpdatedTimelines===0){return{callOutMessage:UPDATE_PREPACKAGED_RULES_MSG(numberOfUpdatedRules),buttonTitle:UPDATE_PREPACKAGED_RULES(numberOfUpdatedRules)}}else if(numberOfUpdatedRules===0&&numberOfUpdatedTimelines>0){return{callOutMessage:UPDATE_PREPACKAGED_TIMELINES_MSG(numberOfUpdatedTimelines),buttonTitle:UPDATE_PREPACKAGED_TIMELINES(numberOfUpdatedTimelines)}}else if(numberOfUpdatedRules>0&&numberOfUpdatedTimelines>0)return{callOutMessage:UPDATE_PREPACKAGED_RULES_AND_TIMELINES_MSG(numberOfUpdatedRules,numberOfUpdatedTimelines),buttonTitle:UPDATE_PREPACKAGED_RULES_AND_TIMELINES(numberOfUpdatedRules,numberOfUpdatedTimelines)}},[numberOfUpdatedRules,numberOfUpdatedTimelines]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:UPDATE_PREPACKAGED_RULES_TITLE,"data-test-subj":"update-callout"},external_kbnSharedDeps_React_default.a.createElement("p",null,prepackagedRulesOrTimelines===null||prepackagedRulesOrTimelines===void 0?void 0:prepackagedRulesOrTimelines.callOutMessage,external_kbnSharedDeps_React_default.a.createElement("br",null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:`${services.docLinks.ELASTIC_WEBSITE_URL}guide/en/security/${services.docLinks.DOC_LINK_VERSION}/prebuilt-rules-changelog.html`,target:"_blank"},RELEASE_NOTES_HELP)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{onClick:updateRules,size:"s",isLoading:loading,"data-test-subj":"update-callout-button"},prepackagedRulesOrTimelines===null||prepackagedRulesOrTimelines===void 0?void 0:prepackagedRulesOrTimelines.buttonTitle))};const UpdatePrePackagedRulesCallOut=Object(external_kbnSharedDeps_React_["memo"])(UpdatePrePackagedRulesCallOutComponent);var use_installed_security_jobs=__webpack_require__(513);const affectedJobIds=["v2_rare_process_by_host_linux_ecs","v2_linux_rare_metadata_user","v2_linux_rare_metadata_process","v2_linux_anomalous_user_name_ecs","v2_linux_anomalous_process_all_hosts_ecs","v2_linux_anomalous_network_port_activity_ecs","v2_rare_process_by_host_windows_ecs","v2_windows_anomalous_network_activity_ecs","v2_windows_anomalous_path_activity_ecs","v2_windows_anomalous_process_all_hosts_ecs","v2_windows_anomalous_process_creation","v2_windows_anomalous_user_name_ecs","v2_windows_rare_metadata_process","v2_windows_rare_metadata_user","rare_process_by_host_linux_ecs","linux_anomalous_network_activity_ecs","linux_anomalous_network_port_activity_ecs","linux_anomalous_network_service","linux_anomalous_network_url_activity_ecs","linux_anomalous_process_all_hosts_ecs","linux_anomalous_user_name_ecs","linux_rare_metadata_process","linux_rare_metadata_user","linux_rare_user_compiler","linux_rare_kernel_module_arguments","linux_rare_sudo_user","linux_system_user_discovery","linux_system_information_discovery","linux_system_process_discovery","linux_network_connection_discovery","linux_network_configuration_discovery","rare_process_by_host_windows_ecs","windows_anomalous_network_activity_ecs","windows_anomalous_path_activity_ecs","windows_anomalous_process_all_hosts_ecs","windows_anomalous_process_creation","windows_anomalous_script","windows_anomalous_service","windows_anomalous_user_name_ecs","windows_rare_user_runas_event","windows_rare_metadata_process","windows_rare_metadata_user"];const ML_JOB_COMPATIBILITY_CALLOUT_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.detectionEngine.mlJobCompatibilityCallout.messageTitle",{defaultMessage:"Your ML jobs may be incompatible with your data sources and/or ML rules"});const MlJobCompatibilityCalloutBody=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.detectionEngine.mlJobCompatibilityCallout.messageBody",defaultMessage:"{summary} Related documentation: {docs}",values:{summary:external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.detectionEngine.mlJobCompatibilityCallout.messageBody.summary",defaultMessage:"Machine learning rules specify ML jobs that in turn have dependencies on data fields populated by the Elastic beats and agent integrations that were current when the ML job was created. New ML jobs, prefixed with V2, have been updated to operate on now-current ECS fields. If you are using multiple versions of beats and agents, you need to create new machine learning rules that specify the new ML (V2) jobs, and enable them to run alongside your existing machine learning rules, in order to ensure continued rule coverage."})),docs:external_kbnSharedDeps_React_default.a.createElement("ul",null,external_kbnSharedDeps_React_default.a.createElement("li",null,external_kbnSharedDeps_React_default.a.createElement(MlJobCompatibilityLink,null)))}});const mlJobCompatibilityCalloutMessage={type:"primary",id:"ml-job-compatibility",title:ML_JOB_COMPATIBILITY_CALLOUT_TITLE,description:external_kbnSharedDeps_React_default.a.createElement(MlJobCompatibilityCalloutBody,null)};const MlJobCompatibilityCalloutComponent=()=>{const{loading:loading,jobs:jobs}=Object(use_installed_security_jobs["a"])();const newJobsInstalled=jobs.some(job=>affectedJobIds.includes(job.id));return external_kbnSharedDeps_React_default.a.createElement(callouts["CallOutSwitcher"],{namespace:"detections",condition:!loading&&newJobsInstalled,message:mlJobCompatibilityCalloutMessage})};const MlJobCompatibilityCallout=Object(external_kbnSharedDeps_React_["memo"])(MlJobCompatibilityCalloutComponent);const RulesPageComponent=()=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const[showImportModal,setShowImportModal]=Object(external_kbnSharedDeps_React_["useState"])(false);const[showValueListsModal,setShowValueListsModal]=Object(external_kbnSharedDeps_React_["useState"])(false);const refreshRulesData=Object(external_kbnSharedDeps_React_["useRef"])(null);const[{loading:userInfoLoading,isSignalIndexExists:isSignalIndexExists,isAuthenticated:isAuthenticated,hasEncryptionKey:hasEncryptionKey,canUserCRUD:canUserCRUD,hasIndexWrite:hasIndexWrite}]=Object(user_info["b"])();const{loading:listsConfigLoading,canWriteIndex:canWriteListsIndex,needsConfiguration:needsListsConfiguration}=useListsConfig();const loading=userInfoLoading||listsConfigLoading;const{createPrePackagedRules:createPrePackagedRules,loading:prePackagedRuleLoading,loadingCreatePrePackagedRules:loadingCreatePrePackagedRules,refetchPrePackagedRulesStatus:refetchPrePackagedRulesStatus,rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled,rulesNotInstalled:rulesNotInstalled,rulesNotUpdated:rulesNotUpdated,timelinesInstalled:timelinesInstalled,timelinesNotInstalled:timelinesNotInstalled,timelinesNotUpdated:timelinesNotUpdated,getLoadPrebuiltRulesAndTemplatesButton:getLoadPrebuiltRulesAndTemplatesButton,getReloadPrebuiltRulesAndTemplatesButton:getReloadPrebuiltRulesAndTemplatesButton}=usePrePackagedRules({canUserCRUD:canUserCRUD,hasIndexWrite:hasIndexWrite,isSignalIndexExists:isSignalIndexExists,isAuthenticated:isAuthenticated,hasEncryptionKey:hasEncryptionKey});const prePackagedRuleStatus=getPrePackagedRuleStatus(rulesInstalled,rulesNotInstalled,rulesNotUpdated);const prePackagedTimelineStatus=getPrePackagedTimelineStatus(timelinesInstalled,timelinesNotInstalled,timelinesNotUpdated);const{formatUrl:formatUrl}=Object(link_to["o"])(app_types["a"].detections);const handleRefreshRules=Object(external_kbnSharedDeps_React_["useCallback"])(async()=>{if(refreshRulesData.current!=null){await refreshRulesData.current()}},[refreshRulesData]);const handleCreatePrePackagedRules=Object(external_kbnSharedDeps_React_["useCallback"])(async()=>{if(createPrePackagedRules!=null){await createPrePackagedRules();return handleRefreshRules()}},[createPrePackagedRules,handleRefreshRules]);const handleRefetchPrePackagedRulesStatus=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(refetchPrePackagedRulesStatus!=null){return refetchPrePackagedRulesStatus()}else{return Promise.resolve()}},[refetchPrePackagedRulesStatus]);const handleSetRefreshRulesData=Object(external_kbnSharedDeps_React_["useCallback"])(refreshRule=>{refreshRulesData.current=refreshRule},[]);const goToNewRule=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();history.push(Object(redirect_to_detection_engine["a"])())},[history]);const loadPrebuiltRulesAndTemplatesButton=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getLoadPrebuiltRulesAndTemplatesButton({isDisabled:helpers_userHasNoPermissions(canUserCRUD)||loading,onClick:handleCreatePrePackagedRules}),[canUserCRUD,getLoadPrebuiltRulesAndTemplatesButton,handleCreatePrePackagedRules,loading]);const reloadPrebuiltRulesAndTemplatesButton=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getReloadPrebuiltRulesAndTemplatesButton({isDisabled:helpers_userHasNoPermissions(canUserCRUD)||loading,onClick:handleCreatePrePackagedRules}),[canUserCRUD,getReloadPrebuiltRulesAndTemplatesButton,handleCreatePrePackagedRules,loading]);if(redirectToDetections(isSignalIndexExists,isAuthenticated,hasEncryptionKey,needsListsConfiguration)){history.replace(Object(redirect_to_detection_engine["c"])());return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(NeedAdminForUpdateRulesCallOut,null),external_kbnSharedDeps_React_default.a.createElement(ReadOnlyRulesCallOut,null),external_kbnSharedDeps_React_default.a.createElement(MlJobCompatibilityCallout,null),external_kbnSharedDeps_React_default.a.createElement(ValueListsModal,{showModal:showValueListsModal,onClose:()=>setShowValueListsModal(false)}),external_kbnSharedDeps_React_default.a.createElement(import_data_modal["a"],{checkBoxLabel:rules_translations["gb"],closeModal:()=>setShowImportModal(false),description:rules_translations["vb"],errorMessage:rules_translations["V"],failedDetailed:rules_translations["W"],importComplete:handleRefreshRules,importData:api["m"],successMessage:rules_translations["Ab"],showCheckBox:true,showModal:showImportModal,submitBtnText:rules_translations["Y"],subtitle:rules_translations["ab"],title:rules_translations["X"]}),external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{backOptions:{href:Object(redirect_to_detection_engine["c"])(),text:rules_translations["h"],pageId:app_types["a"].detections},title:rules_translations["hb"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"s",responsive:false,wrap:true},loadPrebuiltRulesAndTemplatesButton&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},loadPrebuiltRulesAndTemplatesButton),reloadPrebuiltRulesAndTemplatesButton&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},reloadPrebuiltRulesAndTemplatesButton),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:rules_translations["Db"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"open-value-lists-modal-button",iconType:"importAction",isDisabled:!canWriteListsIndex||loading,onClick:()=>setShowValueListsModal(true)},rules_translations["Cb"]))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{iconType:"importAction",isDisabled:helpers_userHasNoPermissions(canUserCRUD)||loading,onClick:()=>{setShowImportModal(true)}},rules_translations["X"])),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(links["g"],{"data-test-subj":"create-new-rule",fill:true,onClick:goToNewRule,href:formatUrl(Object(redirect_to_detection_engine["a"])()),iconType:"plusInCircle",isDisabled:helpers_userHasNoPermissions(canUserCRUD)||loading},rules_translations["e"])))),(prePackagedRuleStatus==="ruleNeedUpdate"||prePackagedTimelineStatus==="timelineNeedUpdate")&&external_kbnSharedDeps_React_default.a.createElement(UpdatePrePackagedRulesCallOut,{"data-test-subj":"update-callout-button",loading:loadingCreatePrePackagedRules,numberOfUpdatedRules:rulesNotUpdated!==null&&rulesNotUpdated!==void 0?rulesNotUpdated:0,numberOfUpdatedTimelines:timelinesNotUpdated!==null&&timelinesNotUpdated!==void 0?timelinesNotUpdated:0,updateRules:handleCreatePrePackagedRules}),external_kbnSharedDeps_React_default.a.createElement(AllRules,{createPrePackagedRules:createPrePackagedRules,"data-test-subj":"all-rules",loading:loading||prePackagedRuleLoading,loadingCreatePrePackagedRules:loadingCreatePrePackagedRules,hasNoPermissions:helpers_userHasNoPermissions(canUserCRUD),refetchPrePackagedRulesStatus:handleRefetchPrePackagedRulesStatus,rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled,rulesNotInstalled:rulesNotInstalled,rulesNotUpdated:rulesNotUpdated,setRefreshRulesData:handleSetRefreshRulesData})),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].detections}))};const RulesPage=external_kbnSharedDeps_React_default.a.memo(RulesPageComponent);const DetectionEngineContainerComponent=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/rules/id/:detailName/edit"},external_kbnSharedDeps_React_default.a.createElement(EditRulePage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/rules/id/:detailName"},external_kbnSharedDeps_React_default.a.createElement(RuleDetailsPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/rules/create"},external_kbnSharedDeps_React_default.a.createElement(CreateRulePage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/rules"},external_kbnSharedDeps_React_default.a.createElement(RulesPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{exact:true,path:"",strict:true},external_kbnSharedDeps_React_default.a.createElement(DetectionEnginePage,null)));const DetectionEngineContainer=external_kbnSharedDeps_React_default.a.memo(DetectionEngineContainerComponent);var _404=__webpack_require__(167);const AlertsRoutes=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/"},external_kbnSharedDeps_React_default.a.createElement(DetectionEngineContainer,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],null,external_kbnSharedDeps_React_default.a.createElement(_404["a"],null)));const DETECTIONS_TIMELINE_IDS=[types_timeline["e"].detectionsRulesDetailsPage,types_timeline["e"].detectionsPage];class detections_Detections{setup(){}start(storage){return{SubPluginRoutes:AlertsRoutes,storageTimelines:{timelineById:Object(local_storage["b"])(storage,DETECTIONS_TIMELINE_IDS)}}}}var use_get_url_search=__webpack_require__(295);var home_navigations=__webpack_require__(271);var common_api=__webpack_require__(36);var lib_helpers=__webpack_require__(225);const SAVE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.header.editableTitle.save",{defaultMessage:"Save"});const header_page_translations_CANCEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.header.editableTitle.cancel",{defaultMessage:"Cancel"});const EDIT_TITLE_ARIA=title=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.header.editableTitle.editButtonAria",{values:{title:title},defaultMessage:"You can edit {title} by clicking"});var header_page_title=__webpack_require__(716);const editable_title_MyEuiButtonIcon=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"]).withConfig({displayName:"MyEuiButtonIcon",componentId:"sc-1mw23e4-0"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["margin-left:",";"],theme.eui.euiSize));const MySpinner=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"]).withConfig({displayName:"MySpinner",componentId:"sc-1mw23e4-1"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["margin-left:",";"],theme.eui.euiSize));const EditableTitleComponent=({disabled:disabled=false,onSubmit:onSubmit,isLoading:isLoading,title:title})=>{const[editMode,setEditMode]=Object(external_kbnSharedDeps_React_["useState"])(false);const[changedTitle,onTitleChange]=Object(external_kbnSharedDeps_React_["useState"])(typeof title==="string"?title:"");const onCancel=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setEditMode(false),[]);const onClickEditIcon=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setEditMode(true),[]);const onClickSubmit=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(changedTitle!==title){onSubmit(changedTitle)}setEditMode(false)},[changedTitle,title]);const handleOnChange=Object(external_kbnSharedDeps_React_["useCallback"])(e=>onTitleChange(e.target.value),[]);return editMode?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"m",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{onChange:handleOnChange,value:`${changedTitle}`,"data-test-subj":"editable-title-input-field"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",responsive:false,wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{color:"secondary","data-test-subj":"editable-title-submit-btn",fill:true,iconType:"save",onClick:onClickSubmit,size:"s"},SAVE)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"editable-title-cancel-btn",iconType:"cross",onClick:onCancel,size:"s"},header_page_translations_CANCEL))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(header_page_title["a"],{title:title})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},isLoading&&external_kbnSharedDeps_React_default.a.createElement(MySpinner,{"data-test-subj":"editable-title-loading"}),!isLoading&&external_kbnSharedDeps_React_default.a.createElement(editable_title_MyEuiButtonIcon,{isDisabled:disabled,"aria-label":EDIT_TITLE_ARIA(title),iconType:"pencil",onClick:onClickEditIcon,"data-test-subj":"editable-title-edit-icon"})))};const EditableTitle=external_kbnSharedDeps_React_default.a.memo(EditableTitleComponent);var cases_translations=__webpack_require__(37);const EDIT_TAGS_ARIA=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.editTagsLinkAria",{defaultMessage:"click to edit tags"});var create_schema=__webpack_require__(794);const tag_list_schema_schema={tags:create_schema["b"]};var use_get_tags=__webpack_require__(480);const TagsComponent=({tags:tags,color:color="default",gutterSize:gutterSize})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,tags.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadgeGroup"],{gutterSize:gutterSize},tags.map(tag=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{"data-test-subj":`tag-${tag}`,color:color,key:tag},tag))));const Tags=Object(external_kbnSharedDeps_React_["memo"])(TagsComponent);const tag_list_CommonUseField=Object(shared_imports["x"])({component:shared_imports["d"]});const MyFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"MyFlexGroup",componentId:"sc-1hmj58j-0"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["margin-top:",";p{font-size:",";}"],theme.eui.euiSizeM,theme.eui.euiSizeM));const TagList=external_kbnSharedDeps_React_default.a.memo(({disabled:disabled=false,isLoading:isLoading,onSubmit:onSubmit,tags:tags})=>{const initialState={tags:tags};const{form:form}=Object(shared_imports["I"])({defaultValue:initialState,options:{stripEmptyFields:false},schema:tag_list_schema_schema});const{submit:submit}=form;const[isEditTags,setIsEditTags]=Object(external_kbnSharedDeps_React_["useState"])(false);const onSubmitTags=Object(external_kbnSharedDeps_React_["useCallback"])(async()=>{const{isValid:isValid,data:newData}=await submit();if(isValid&&newData.tags){onSubmit(newData.tags);setIsEditTags(false)}},[onSubmit,submit]);const{tags:tagOptions}=Object(use_get_tags["a"])();const[options,setOptions]=Object(external_kbnSharedDeps_React_["useState"])(tagOptions.map(label=>({label:label})));Object(external_kbnSharedDeps_React_["useEffect"])(()=>setOptions(tagOptions.map(label=>({label:label}))),[tagOptions]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"xs",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement("h4",null,cases_translations["O"])),isLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{"data-test-subj":"tag-list-loading"}),!isLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"tag-list-edit",grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"data-test-subj":"tag-list-edit-button",isDisabled:disabled,"aria-label":EDIT_TAGS_ARIA,iconType:"pencil",onClick:setIsEditTags.bind(null,true)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"xs"}),external_kbnSharedDeps_React_default.a.createElement(MyFlexGroup,{gutterSize:"none","data-test-subj":"case-tags"},tags.length===0&&!isEditTags&&external_kbnSharedDeps_React_default.a.createElement("p",{"data-test-subj":"no-tags"},cases_translations["z"]),!isEditTags&&external_kbnSharedDeps_React_default.a.createElement(Tags,{tags:tags,color:"hollow"}),isEditTags&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{"data-test-subj":"edit-tags",direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(shared_imports["e"],{form:form},external_kbnSharedDeps_React_default.a.createElement(tag_list_CommonUseField,{path:"tags",componentProps:{idAria:"caseTags","data-test-subj":"caseTags",euiFieldProps:{fullWidth:true,placeholder:"",options:options,noSuggestions:false}}}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["f"],{pathsToWatch:"tags"},({tags:anotherTags})=>{const current=options.map(opt=>opt.label);const newOptions=anotherTags.reduce((acc,item)=>{if(!acc.includes(item)){return[...acc,item]}return acc},current);if(!Object(external_kbnSharedDeps_LodashFp_["isEqual"])(current,newOptions)){setOptions(newOptions.map(label=>({label:label})))}return null}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{color:"secondary","data-test-subj":"edit-tags-submit",fill:true,iconType:"save",onClick:onSubmitTags,size:"s"},cases_translations["J"])),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"edit-tags-cancel",iconType:"cross",onClick:setIsEditTags.bind(null,false),size:"s"},cases_translations["e"])))))))});TagList.displayName="TagList";var containers_translations=__webpack_require__(132);var containers_api=__webpack_require__(163);const dataFetchReducer=(state,action)=>{switch(action.type){case"FETCH_INIT":return{...state,isLoading:true,isError:false};case"FETCH_SUCCESS":return{...state,isLoading:false,isError:false,data:action.payload};case"FETCH_FAILURE":return{...state,isLoading:false,isError:true};case"UPDATE_CASE":return{...state,data:action.payload};default:return state}};const useGetCase=caseId=>{const[state,dispatch]=Object(external_kbnSharedDeps_React_["useReducer"])(dataFetchReducer,{isLoading:false,isError:false,data:null});const[,dispatchToaster]=Object(toasters["h"])();const isCancelledRef=Object(external_kbnSharedDeps_React_["useRef"])(false);const abortCtrlRef=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const updateCase=Object(external_kbnSharedDeps_React_["useCallback"])(newCase=>{dispatch({type:"UPDATE_CASE",payload:newCase})},[]);const callFetch=Object(external_kbnSharedDeps_React_["useCallback"])(async()=>{try{isCancelledRef.current=false;abortCtrlRef.current.abort();abortCtrlRef.current=new AbortController;dispatch({type:"FETCH_INIT"});const response=await Object(containers_api["c"])(caseId,true,abortCtrlRef.current.signal);if(!isCancelledRef.current){dispatch({type:"FETCH_SUCCESS",payload:response})}}catch(error){if(!isCancelledRef.current){if(error.name!=="AbortError"){Object(toasters["g"])({title:containers_translations["d"],error:error.body&&error.body.message?new Error(error.body.message):error,dispatchToaster:dispatchToaster})}dispatch({type:"FETCH_FAILURE"})}}},[caseId]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{callFetch();return()=>{isCancelledRef.current=true;abortCtrlRef.current.abort()}},[caseId]);return{...state,fetchCase:callFetch,updateCase:updateCase}};var classnames=__webpack_require__(286);var classnames_default=__webpack_require__.n(classnames);var Either=__webpack_require__(4);const SHOWING_CASES=(actionDate,actionName,userName)=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionHeadline",{values:{actionDate:actionDate,actionName:actionName,userName:userName},defaultMessage:"{userName} {actionName} on {actionDate}"});const ADDED_FIELD=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.addedField",{defaultMessage:"added"});const CHANGED_FIELD=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.changededField",{defaultMessage:"changed"});const SELECTED_THIRD_PARTY=thirdParty=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.selectedThirdParty",{values:{thirdParty:thirdParty},defaultMessage:"selected { thirdParty } as incident management system"});const REMOVED_THIRD_PARTY=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.removedThirdParty",{defaultMessage:"removed external incident management system"});const EDITED_FIELD=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.editedField",{defaultMessage:"edited"});const REMOVED_FIELD=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.removedField",{defaultMessage:"removed"});const VIEW_INCIDENT=incidentNumber=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.viewIncident",{defaultMessage:"View {incidentNumber}",values:{incidentNumber:incidentNumber}});const PUSHED_NEW_INCIDENT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.pushedNewIncident",{defaultMessage:"pushed as new incident"});const UPDATE_INCIDENT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.updateIncident",{defaultMessage:"updated incident"});const ADDED_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.addDescription",{defaultMessage:"added description"});const EDIT_DESCRIPTION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.edit.description",{defaultMessage:"Edit description"});const QUOTE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.edit.quote",{defaultMessage:"Quote"});const EDIT_COMMENT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.edit.comment",{defaultMessage:"Edit comment"});const ON=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.on",{defaultMessage:"on"});const ADDED_COMMENT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.actionLabel.addComment",{defaultMessage:"added comment"});const translations_STATUS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.statusLabel",{defaultMessage:"Status"});const CASE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.case",{defaultMessage:"case"});const COMMENT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.comment",{defaultMessage:"comment"});const CASE_REFRESH=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.caseRefresh",{defaultMessage:"Refresh case"});const EMAIL_SUBJECT=caseTitle=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.emailSubject",{values:{caseTitle:caseTitle},defaultMessage:"Security Case - {caseTitle}"});const EMAIL_BODY=caseUrl=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.emailBody",{values:{caseUrl:caseUrl},defaultMessage:"Case reference: {caseUrl}"});const CHANGED_CONNECTOR_FIELD=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.fieldChanged",{defaultMessage:`changed connector field`});const SYNC_ALERTS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.syncAlertsLabel",{defaultMessage:`Sync alerts`});const ALREADY_PUSHED_TO_SERVICE=externalService=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.alreadyPushedToExternalService",{values:{externalService:externalService},defaultMessage:"Already pushed to { externalService } incident"});const REQUIRED_UPDATE_TO_SERVICE=externalService=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.requiredUpdateToExternalService",{values:{externalService:externalService},defaultMessage:"Requires update to { externalService } incident"});const COPY_REFERENCE_LINK=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.copyCommentLinkAria",{defaultMessage:"Copy reference link"});const MOVE_TO_ORIGINAL_COMMENT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.moveToCommentAria",{defaultMessage:"Highlight the referenced comment"});const ALERT_COMMENT_LABEL_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.alertCommentLabelTitle",{defaultMessage:"added an alert from"});const GENERATED_ALERT_COMMENT_LABEL_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.generatedAlertCommentLabelTitle",{defaultMessage:"were added from"});const GENERATED_ALERT_COUNT_COMMENT_LABEL_TITLE=totalCount=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.generatedAlertCountCommentLabelTitle",{values:{totalCount:totalCount},defaultMessage:`{totalCount} {totalCount, plural, =1 {alert} other {alerts}}`});const ALERT_RULE_DELETED_COMMENT_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.alertRuleDeletedLabelTitle",{defaultMessage:"added an alert"});const SHOW_ALERT_TOOLTIP=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.showAlertTooltip",{defaultMessage:"Show alert details"});const SEND_ALERT_TO_TIMELINE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.sendAlertToTimelineTooltip",{defaultMessage:"Investigate in timeline"});const UNKNOWN_RULE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.unknownRule.label",{defaultMessage:"Unknown rule"});const use_update_comment_dataFetchReducer=(state,action)=>{switch(action.type){case"FETCH_INIT":return{...state,isLoadingIds:[...state.isLoadingIds,action.payload],isError:false};case"FETCH_SUCCESS":return{...state,isLoadingIds:state.isLoadingIds.filter(id=>action.payload.commentId!==id),isError:false};case"FETCH_FAILURE":return{...state,isLoadingIds:state.isLoadingIds.filter(id=>action.payload!==id),isError:true};default:return state}};const useUpdateComment=()=>{const[state,dispatch]=Object(external_kbnSharedDeps_React_["useReducer"])(use_update_comment_dataFetchReducer,{isLoadingIds:[],isError:false});const[,dispatchToaster]=Object(toasters["h"])();const isCancelledRef=Object(external_kbnSharedDeps_React_["useRef"])(false);const abortCtrlRef=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const dispatchUpdateComment=Object(external_kbnSharedDeps_React_["useCallback"])(async({caseId:caseId,commentId:commentId,commentUpdate:commentUpdate,fetchUserActions:fetchUserActions,updateCase:updateCase,version:version})=>{try{isCancelledRef.current=false;abortCtrlRef.current.abort();abortCtrlRef.current=new AbortController;dispatch({type:"FETCH_INIT",payload:commentId});const response=await Object(containers_api["k"])(caseId,commentId,commentUpdate,version,abortCtrlRef.current.signal);if(!isCancelledRef.current){updateCase(response);fetchUserActions();dispatch({type:"FETCH_SUCCESS",payload:{commentId:commentId}})}}catch(error){if(!isCancelledRef.current){if(error.name!=="AbortError"){Object(toasters["g"])({title:containers_translations["d"],error:error.body&&error.body.message?new Error(error.body.message):error,dispatchToaster:dispatchToaster})}dispatch({type:"FETCH_FAILURE",payload:commentId})}}},[]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>()=>{isCancelledRef.current=true;abortCtrlRef.current.abort()},[]);return{...state,patchComment:dispatchUpdateComment}};var use_post_comment=__webpack_require__(697);const{emptyField:schema_emptyField}=shared_imports["v"];const add_comment_schema_schema={comment:{type:shared_imports["c"].TEXTAREA,validations:[{validator:schema_emptyField(cases_translations["k"])}]}};var timeline_actions=__webpack_require__(21);const useInsertTimeline=(value,onChange)=>{const dispatch=Object(react_redux_lib["useDispatch"])();const{formatUrl:formatUrl}=Object(link_to["o"])(app_types["a"].timelines);const insertTimeline=Object(use_selector["b"])(store_timeline["b"].selectInsertTimeline);const handleOnTimelineChange=Object(external_kbnSharedDeps_React_["useCallback"])((title,id,graphEventId)=>{const url=formatUrl(Object(link_to["n"])(id!==null&&id!==void 0?id:"",graphEventId),{absolute:true,skipSearch:true});let newValue=`[${title}](${url})`;if(!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(value)){newValue=`${value} ${newValue}`}onChange(newValue)},[value,onChange,formatUrl]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(insertTimeline!=null&&value!=null){dispatch(store_timeline["a"].showTimeline({id:insertTimeline.timelineId,show:false}));handleOnTimelineChange(insertTimeline.timelineTitle,insertTimeline.timelineSavedObjectId,insertTimeline.graphEventId);dispatch(Object(timeline_actions["setInsertTimeline"])(null))}},[insertTimeline,dispatch,handleOnTimelineChange,value]);return{handleOnTimelineChange:handleOnTimelineChange}};const add_comment_MySpinner=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"]).withConfig({displayName:"MySpinner",componentId:"sc-12tgh7e-0"})(["position:absolute;top:50%;left:50%;"]);const initialCommentValue={comment:""};const AddComment=external_kbnSharedDeps_React_default.a.memo(Object(external_kbnSharedDeps_React_["forwardRef"])(({caseId:caseId,disabled:disabled,onCommentPosted:onCommentPosted,onCommentSaving:onCommentSaving,showLoading:showLoading=true},ref)=>{const{isLoading:isLoading,postComment:postComment}=Object(use_post_comment["a"])();const{form:form}=Object(shared_imports["I"])({defaultValue:initialCommentValue,options:{stripEmptyFields:false},schema:add_comment_schema_schema});const fieldName="comment";const{setFieldValue:setFieldValue,reset:reset,submit:submit}=form;const[{comment:comment}]=Object(shared_imports["K"])({form:form,watch:[fieldName]});const addQuote=Object(external_kbnSharedDeps_React_["useCallback"])(quote=>{setFieldValue(fieldName,`${comment}${comment.length>0?"\n\n":""}${quote}`)},[comment,setFieldValue]);Object(external_kbnSharedDeps_React_["useImperativeHandle"])(ref,()=>({addQuote:addQuote}));const onTimelineAttached=Object(external_kbnSharedDeps_React_["useCallback"])(newValue=>setFieldValue(fieldName,newValue),[setFieldValue]);useInsertTimeline(comment!==null&&comment!==void 0?comment:"",onTimelineAttached);const onSubmit=Object(external_kbnSharedDeps_React_["useCallback"])(async()=>{const{isValid:isValid,data:data}=await submit();if(isValid){if(onCommentSaving!=null){onCommentSaving()}postComment({caseId:caseId,data:{...data,type:common_api["k"].user},updateCase:onCommentPosted});reset()}},[caseId,onCommentPosted,onCommentSaving,postComment,reset,submit]);return external_kbnSharedDeps_React_default.a.createElement("span",{id:"add-comment-permLink"},isLoading&&showLoading&&external_kbnSharedDeps_React_default.a.createElement(add_comment_MySpinner,{"data-test-subj":"loading-spinner",size:"xl"}),external_kbnSharedDeps_React_default.a.createElement(shared_imports["e"],{form:form},external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:fieldName,component:eui_form["a"],componentProps:{idAria:"caseComment",isDisabled:isLoading,dataTestSubj:"add-comment",placeholder:cases_translations["c"],bottomRightContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"submit-comment",iconType:"plusInCircle",isDisabled:isLoading||disabled,isLoading:isLoading,onClick:onSubmit,size:"s"},cases_translations["b"])}})))}));AddComment.displayName="AddComment";var containers_utils=__webpack_require__(203);const UserActionUsernameComponent=({username:username,fullName:fullName})=>{var _ref;const tooltipContent=(_ref=Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(fullName)?username:fullName)!==null&&_ref!==void 0?_ref:cases_translations["S"];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:external_kbnSharedDeps_React_default.a.createElement("p",null,tooltipContent),"data-test-subj":"user-action-username-tooltip"},external_kbnSharedDeps_React_default.a.createElement("strong",null,username!==null&&username!==void 0?username:cases_translations["S"].toLowerCase()))};const UserActionUsername=Object(external_kbnSharedDeps_React_["memo"])(UserActionUsernameComponent);const UserActionUsernameWithAvatarComponent=({username:username,fullName:fullName})=>{var _ref;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,alignItems:"center",gutterSize:"s","data-test-subj":"user-action-username-with-avatar"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAvatar"],{size:"s",name:(_ref=Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(fullName)?username:fullName)!==null&&_ref!==void 0?_ref:cases_translations["S"],"data-test-subj":"user-action-username-avatar"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(UserActionUsername,{username:username,fullName:fullName})))};const UserActionUsernameWithAvatar=Object(external_kbnSharedDeps_React_["memo"])(UserActionUsernameWithAvatarComponent);const UserActionTimestampComponent=({createdAt:createdAt,updatedAt:updatedAt})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(localized_date_tooltip["a"],{date:new Date(createdAt)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedRelative"],{"data-test-subj":"user-action-title-creation-relative-time",value:createdAt})),updatedAt&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTextColor"],{color:"subdued"}," (",EDITED_FIELD," ",external_kbnSharedDeps_React_default.a.createElement(localized_date_tooltip["a"],{date:new Date(updatedAt)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedRelative"],{"data-test-subj":"user-action-title-edited-relative-time",value:updatedAt})),")"));const UserActionTimestamp=Object(external_kbnSharedDeps_React_["memo"])(UserActionTimestampComponent);var copy_to_clipboard=__webpack_require__(609);var copy_to_clipboard_default=__webpack_require__.n(copy_to_clipboard);const UserActionCopyLinkComponent=({id:commentId})=>{const{detailName:caseId}=Object(external_kbnSharedDeps_ReactRouterDom_["useParams"])();const{formatUrl:formatUrl}=Object(link_to["o"])(app_types["a"].case);const handleAnchorLink=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{copy_to_clipboard_default()(formatUrl(Object(link_to["c"])({id:caseId,commentId:commentId}),{absolute:true}))},[caseId,commentId,formatUrl]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:external_kbnSharedDeps_React_default.a.createElement("p",null,COPY_REFERENCE_LINK)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"aria-label":COPY_REFERENCE_LINK,"data-test-subj":`copy-link-${commentId}`,onClick:handleAnchorLink,iconType:"link",id:`${commentId}-permLink`}))};const UserActionCopyLink=Object(external_kbnSharedDeps_React_["memo"])(UserActionCopyLinkComponent);const UserActionMoveToReferenceComponent=({id:id,outlineComment:outlineComment})=>{const handleMoveToLink=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{outlineComment(id)},[id,outlineComment]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:external_kbnSharedDeps_React_default.a.createElement("p",null,MOVE_TO_ORIGINAL_COMMENT)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"aria-label":MOVE_TO_ORIGINAL_COMMENT,"data-test-subj":`move-to-link-${id}`,onClick:handleMoveToLink,iconType:"arrowUp"}))};const UserActionMoveToReference=Object(external_kbnSharedDeps_React_["memo"])(UserActionMoveToReferenceComponent);var components_status=__webpack_require__(199);const UserActionShowAlertComponent=({id:id,alertId:alertId,index:index,onShowAlertDetails:onShowAlertDetails})=>{const onClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>onShowAlertDetails(alertId,index),[alertId,index,onShowAlertDetails]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:external_kbnSharedDeps_React_default.a.createElement("p",null,SHOW_ALERT_TOOLTIP)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"aria-label":SHOW_ALERT_TOOLTIP,"data-test-subj":`comment-action-show-alert-${id}`,onClick:onClick,iconType:"arrowRight",id:`${id}-show-alert`}))};const UserActionShowAlert=Object(external_kbnSharedDeps_React_["memo"])(UserActionShowAlertComponent);const AlertCommentEventComponent=({alertId:alertId,loadingAlertData:loadingAlertData=false,ruleId:ruleId,ruleName:ruleName,alertsCount:alertsCount,commentType:commentType})=>{const{navigateToApp:navigateToApp}=Object(lib_kibana["h"])().services.application;const{formatUrl:formatUrl,search:urlSearch}=Object(link_to["o"])(app_types["a"].detections);const onLinkClick=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();navigateToApp(`${constants["f"]}:${app_types["a"].detections}`,{path:Object(link_to["l"])(ruleId!==null&&ruleId!==void 0?ruleId:"")})},[ruleId,navigateToApp]);return commentType!==common_api["k"].generatedAlert?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,`${ALERT_COMMENT_LABEL_TITLE} `,loadingAlertData&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"}),!loadingAlertData&&!Object(external_kbnSharedDeps_Lodash_["isEmpty"])(ruleId)&&external_kbnSharedDeps_React_default.a.createElement(links["f"],{onClick:onLinkClick,href:formatUrl(Object(link_to["l"])(ruleId!==null&&ruleId!==void 0?ruleId:"",urlSearch)),"data-test-subj":`alert-rule-link-${alertId!==null&&alertId!==void 0?alertId:"deleted"}`},ruleName!==null&&ruleName!==void 0?ruleName:UNKNOWN_RULE),!loadingAlertData&&Object(external_kbnSharedDeps_Lodash_["isEmpty"])(ruleId)&&UNKNOWN_RULE):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("b",null,GENERATED_ALERT_COUNT_COMMENT_LABEL_TITLE(alertsCount!==null&&alertsCount!==void 0?alertsCount:0))," ",GENERATED_ALERT_COMMENT_LABEL_TITLE," ",loadingAlertData&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"}),!loadingAlertData&&ruleId!==""&&external_kbnSharedDeps_React_default.a.createElement(links["f"],{onClick:onLinkClick,href:formatUrl(Object(link_to["l"])(ruleId!==null&&ruleId!==void 0?ruleId:"",urlSearch)),"data-test-subj":`alert-rule-link-${alertId!==null&&alertId!==void 0?alertId:"deleted"}`},ruleName),!loadingAlertData&&ruleId===""&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,ruleName))};const AlertCommentEvent=Object(external_kbnSharedDeps_React_["memo"])(AlertCommentEventComponent);var investigate_in_timeline_action=__webpack_require__(696);const getManualAlertIdsWithNoRuleId=comments=>{const dedupeAlerts=comments.reduce((alertIds,comment)=>{if(comment.type===common_api["k"].alert&&Object(external_kbnSharedDeps_Lodash_["isEmpty"])(comment.rule.id)){const ids=Array.isArray(comment.alertId)?comment.alertId:[comment.alertId];ids.forEach(id=>alertIds.add(id));return alertIds}return alertIds},new Set);return[...dedupeAlerts]};const buildAlertsQuery=alertIds=>{if(alertIds.length===0){return{}}return{query:{bool:{filter:{ids:{values:alertIds}}}},size:1e4}};const getStatusTitle=(id,status)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center","data-test-subj":`${id}-user-action-status-title`},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},cases_translations["u"]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(components_status["b"],{type:status})));const isStatusValid=status=>Object.prototype.hasOwnProperty.call(components_status["d"],status);const getLabelTitle=({action:action,field:field})=>{if(field==="tags"){return getTagsLabelTitle(action)}else if(field==="title"&&action.action==="update"){return`${CHANGED_FIELD.toLowerCase()} ${cases_translations["f"].toLowerCase()}  ${cases_translations["R"]} "${action.newValue}"`}else if(field==="description"&&action.action==="update"){return`${EDITED_FIELD} ${cases_translations["r"].toLowerCase()}`}else if(field==="status"&&action.action==="update"){var _action$newValue;const status=(_action$newValue=action.newValue)!==null&&_action$newValue!==void 0?_action$newValue:"";if(isStatusValid(status)){return getStatusTitle(action.actionId,status)}return""}else if(field==="comment"&&action.action==="update"){return`${EDITED_FIELD} ${COMMENT.toLowerCase()}`}return""};const getConnectorLabelTitle=({action:action,connectors:connectors})=>{const oldValue=Object(containers_utils["m"])(`${action.oldValue}`);const newValue=Object(containers_utils["m"])(`${action.newValue}`);if(oldValue===null||newValue===null){return""}if(oldValue.id!==newValue.id){const newConnector=connectors.find(c=>c.id===newValue.id);return newValue.id!=null&&newValue.id!=="none"&&newConnector!=null?SELECTED_THIRD_PARTY(newConnector.name):REMOVED_THIRD_PARTY}else{return CHANGED_CONNECTOR_FIELD}};const getTagsLabelTitle=action=>{const tags=action.newValue!=null?action.newValue.split(","):[];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"baseline",gutterSize:"xs",component:"span"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"ua-tags-label",grow:false},action.action==="add"&&ADDED_FIELD,action.action==="delete"&&REMOVED_FIELD," ",cases_translations["O"].toLowerCase()),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(Tags,{tags:tags,gutterSize:"xs"})))};const getPushedServiceLabelTitle=(action,firstPush)=>{var _action$newValue2;const pushedVal=JSON.parse((_action$newValue2=action.newValue)!==null&&_action$newValue2!==void 0?_action$newValue2:"");return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"baseline",gutterSize:"xs","data-test-subj":"pushed-service-label-title"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"pushed-label"},`${firstPush?PUSHED_NEW_INCIDENT:UPDATE_INCIDENT} ${pushedVal===null||pushedVal===void 0?void 0:pushedVal.connector_name}`),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{"data-test-subj":"pushed-value",href:pushedVal===null||pushedVal===void 0?void 0:pushedVal.external_url,target:"_blank"},pushedVal===null||pushedVal===void 0?void 0:pushedVal.external_title)))};const getPushInfo=(caseServices,parsedValue,index)=>{var _caseServices$parsedV;return parsedValue!=null?{firstPush:((_caseServices$parsedV=caseServices[parsedValue.connector_id])===null||_caseServices$parsedV===void 0?void 0:_caseServices$parsedV.firstPushIndex)===index,parsedConnectorId:parsedValue.connector_id,parsedConnectorName:parsedValue.connector_name}:{firstPush:false,parsedConnectorId:"none",parsedConnectorName:"none"}};const getUpdateActionIcon=actionField=>{if(actionField==="tags"){return"tag"}else if(actionField==="status"){return"folderClosed"}return"dot"};const getUpdateAction=({action:action,label:label,handleOutlineComment:handleOutlineComment})=>({username:external_kbnSharedDeps_React_default.a.createElement(UserActionUsernameWithAvatar,{username:action.actionBy.username,fullName:action.actionBy.fullName}),type:"update",event:label,"data-test-subj":`${action.actionField[0]}-${action.action}-action-${action.actionId}`,timestamp:external_kbnSharedDeps_React_default.a.createElement(UserActionTimestamp,{createdAt:action.actionAt}),timelineIcon:getUpdateActionIcon(action.actionField[0]),actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(UserActionCopyLink,{id:action.actionId})),action.action==="update"&&action.commentId!=null&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(UserActionMoveToReference,{id:action.commentId,outlineComment:handleOutlineComment})))});const getAlertAttachment=({action:action,alertId:alertId,index:index,loadingAlertData:loadingAlertData,ruleId:ruleId,ruleName:ruleName,onShowAlertDetails:onShowAlertDetails})=>({username:external_kbnSharedDeps_React_default.a.createElement(UserActionUsernameWithAvatar,{username:action.actionBy.username,fullName:action.actionBy.fullName}),className:"comment-alert",type:"update",event:external_kbnSharedDeps_React_default.a.createElement(AlertCommentEvent,{alertId:alertId,loadingAlertData:loadingAlertData,ruleId:ruleId,ruleName:ruleName,commentType:common_api["k"].alert}),"data-test-subj":`${action.actionField[0]}-${action.action}-action-${action.actionId}`,timestamp:external_kbnSharedDeps_React_default.a.createElement(UserActionTimestamp,{createdAt:action.actionAt}),timelineIcon:"bell",actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(UserActionCopyLink,{id:action.actionId})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(UserActionShowAlert,{id:action.actionId,alertId:alertId,index:index,onShowAlertDetails:onShowAlertDetails})))});const toStringArray=value=>{if(Array.isArray(value)){return value.reduce((acc,v)=>{if(v!=null){switch(typeof v){case"number":case"boolean":return[...acc,v.toString()];case"object":try{return[...acc,JSON.stringify(v)]}catch{return[...acc,"Invalid Object"]}case"string":return[...acc,v];default:return[...acc,`${v}`]}}return acc},[])}else if(value==null){return[]}else if(!Array.isArray(value)&&typeof value==="object"){try{return[JSON.stringify(value)]}catch{return["Invalid Object"]}}else{return[`${value}`]}};const formatAlertToEcsSignal=alert=>Object.keys(alert).reduce((accumulator,key)=>{const item=Object(external_kbnSharedDeps_Lodash_["get"])(alert,key);if(item!=null&&Object(external_kbnSharedDeps_Lodash_["isObject"])(item)){return{...accumulator,[key]:formatAlertToEcsSignal(item)}}else if(Array.isArray(item)||Object(external_kbnSharedDeps_Lodash_["isString"])(item)||Object(external_kbnSharedDeps_Lodash_["isNumber"])(item)){return{...accumulator,[key]:toStringArray(item)}}return accumulator},{});const EMPTY_ARRAY=[];const getGeneratedAlertsAttachment=({action:action,alertIds:alertIds,ruleId:ruleId,ruleName:ruleName})=>{const fetchEcsAlertsData=async fetchAlertIds=>{var _alertResponse$hits$h;if(Object(external_kbnSharedDeps_Lodash_["isEmpty"])(fetchAlertIds)){return[]}const alertResponse=await lib_kibana["b"].get().http.fetch(constants["K"],{method:"POST",body:JSON.stringify(buildAlertsQuery(fetchAlertIds!==null&&fetchAlertIds!==void 0?fetchAlertIds:[]))});return(_alertResponse$hits$h=alertResponse===null||alertResponse===void 0?void 0:alertResponse.hits.hits.reduce((acc,{_id:_id,_index:_index,_source:_source})=>[...acc,{...formatAlertToEcsSignal(_source),_id:_id,_index:_index,timestamp:_source["@timestamp"]}],[]))!==null&&_alertResponse$hits$h!==void 0?_alertResponse$hits$h:[]};return{username:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"logoSecurity",size:"m"}),className:"comment-alert",type:"update",event:external_kbnSharedDeps_React_default.a.createElement(AlertCommentEvent,{alertId:alertIds[0],ruleId:ruleId,ruleName:ruleName,alertsCount:alertIds.length,commentType:common_api["k"].generatedAlert}),"data-test-subj":`${action.actionField[0]}-${action.action}-action-${action.actionId}`,timestamp:external_kbnSharedDeps_React_default.a.createElement(UserActionTimestamp,{createdAt:action.actionAt}),timelineIcon:"bell",actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(UserActionCopyLink,{id:action.actionId})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(investigate_in_timeline_action["a"],{ariaLabel:SEND_ALERT_TO_TIMELINE,alertIds:alertIds,key:"investigate-in-timeline",ecsRowData:null,fetchEcsAlertsData:fetchEcsAlertsData,nonEcsRowData:EMPTY_ARRAY})))}};const useFetchAlertData=alertIds=>{const{selectedPatterns:selectedPatterns}=Object(sourcerer["b"])(model["SourcererScopeName"].detections);const alertsQuery=Object(external_kbnSharedDeps_React_["useMemo"])(()=>buildAlertsQuery(alertIds),[alertIds]);const{loading:isLoadingAlerts,data:alertsData}=Object(use_query["a"])(alertsQuery,selectedPatterns[0]);const alerts=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _alertsData$hits$hits;return(_alertsData$hits$hits=alertsData===null||alertsData===void 0?void 0:alertsData.hits.hits.reduce((acc,{_id:_id,_index:_index,_source:_source})=>({...acc,[_id]:{...formatAlertToEcsSignal(_source),_id:_id,_index:_index,timestamp:_source["@timestamp"]}}),{}))!==null&&_alertsData$hits$hits!==void 0?_alertsData$hits$hits:{}},[alertsData===null||alertsData===void 0?void 0:alertsData.hits.hits]);return[isLoadingAlerts,alerts]};const UserActionAvatarComponent=({username:username,fullName:fullName})=>{const avatarName=fullName&&fullName.length>0?fullName:username!==null&&username!==void 0?username:cases_translations["S"];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAvatar"],{name:avatarName,"data-test-subj":`user-action-avatar`})};const UserActionAvatar=Object(external_kbnSharedDeps_React_["memo"])(UserActionAvatarComponent);const{emptyField:user_action_tree_schema_emptyField}=shared_imports["v"];const user_action_tree_schema_schema={content:{type:shared_imports["c"].TEXTAREA,validations:[{validator:user_action_tree_schema_emptyField(cases_translations["I"])}]}};const ContentWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"ContentWrapper",componentId:"t03oqe-0"})(["padding:",";"],({theme:theme})=>`${theme.eui.euiSizeM} ${theme.eui.euiSizeL}`);const UserActionMarkdown=({id:id,content:content,isEditable:isEditable,onChangeEditable:onChangeEditable,onSaveContent:onSaveContent})=>{const initialState={content:content};const{form:form}=Object(shared_imports["I"])({defaultValue:initialState,options:{stripEmptyFields:false},schema:user_action_tree_schema_schema});const fieldName="content";const{submit:submit}=form;const handleCancelAction=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{onChangeEditable(id)},[id,onChangeEditable]);const handleSaveAction=Object(external_kbnSharedDeps_React_["useCallback"])(async()=>{const{isValid:isValid,data:data}=await submit();if(isValid){onSaveContent(data.content)}onChangeEditable(id)},[id,onChangeEditable,onSaveContent,submit]);const renderButtons=Object(external_kbnSharedDeps_React_["useCallback"])(({cancelAction:cancelAction,saveAction:saveAction})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"user-action-cancel-markdown",size:"s",onClick:cancelAction,iconType:"cross"},cases_translations["e"])),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"user-action-save-markdown",color:"secondary",fill:true,iconType:"save",onClick:saveAction,size:"s"},cases_translations["J"]))),[]);return isEditable?external_kbnSharedDeps_React_default.a.createElement(shared_imports["e"],{form:form,"data-test-subj":"user-action-markdown-form"},external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:fieldName,component:markdown_editor["MarkdownEditorForm"],componentProps:{"aria-label":"Cases markdown editor",value:content,id:id,bottomRightContent:renderButtons({cancelAction:handleCancelAction,saveAction:handleSaveAction})}})):external_kbnSharedDeps_React_default.a.createElement(ContentWrapper,{"data-test-subj":"user-action-markdown"},external_kbnSharedDeps_React_default.a.createElement(markdown_editor["MarkdownRenderer"],null,content))};const ACTIONS_ARIA=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.editActionsLinkAria",{defaultMessage:"click to see all actions"});const ComponentId="property-actions";const PropertyActionButton=external_kbnSharedDeps_React_default.a.memo(({disabled:disabled=false,onClick:onClick,iconType:iconType,label:label})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":`${ComponentId}-${iconType}`,"aria-label":label,color:"text",iconSide:"left",iconType:iconType,isDisabled:disabled,onClick:onClick},label));PropertyActionButton.displayName="PropertyActionButton";const PropertyActions=external_kbnSharedDeps_React_default.a.memo(({propertyActions:propertyActions})=>{const[showActions,setShowActions]=Object(external_kbnSharedDeps_React_["useState"])(false);const onButtonClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setShowActions(!showActions)},[showActions]);const onClosePopover=Object(external_kbnSharedDeps_React_["useCallback"])(cb=>{setShowActions(false);if(cb!=null){cb()}},[]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"flexStart","data-test-subj":ComponentId,gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{anchorPosition:"downRight",ownFocus:true,button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"data-test-subj":`${ComponentId}-ellipses`,"aria-label":ACTIONS_ARIA,iconType:"boxesHorizontal",onClick:onButtonClick}),id:"settingsPopover",isOpen:showActions,closePopover:onClosePopover,repositionOnScroll:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"flexStart","data-test-subj":`${ComponentId}-group`,direction:"column",gutterSize:"none"},propertyActions.map((action,key)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,key:`${action.label}${key}`},external_kbnSharedDeps_React_default.a.createElement(PropertyActionButton,{disabled:action.disabled,iconType:action.iconType,label:action.label,onClick:()=>onClosePopover(action.onClick)})))))))});PropertyActions.displayName="PropertyActions";const UserActionPropertyActionsComponent=({id:id,editLabel:editLabel,quoteLabel:quoteLabel,disabled:disabled,isLoading:isLoading,onEdit:onEdit,onQuote:onQuote})=>{const onEditClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>onEdit(id),[id,onEdit]);const onQuoteClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>onQuote(id),[id,onQuote]);const propertyActions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[{disabled:disabled,iconType:"pencil",label:editLabel,onClick:onEditClick},{disabled:disabled,iconType:"quote",label:quoteLabel,onClick:onQuoteClick}],[disabled,editLabel,quoteLabel,onEditClick,onQuoteClick]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{"data-test-subj":"user-action-title-loading"}),!isLoading&&external_kbnSharedDeps_React_default.a.createElement(PropertyActions,{propertyActions:propertyActions}))};const UserActionPropertyActions=Object(external_kbnSharedDeps_React_["memo"])(UserActionPropertyActionsComponent);const UserActionContentToolbarComponent=({id:id,editLabel:editLabel,quoteLabel:quoteLabel,disabled:disabled,isLoading:isLoading,onEdit:onEdit,onQuote:onQuote})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(UserActionCopyLink,{id:id})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(UserActionPropertyActions,{id:id,editLabel:editLabel,quoteLabel:quoteLabel,disabled:disabled,isLoading:isLoading,onEdit:onEdit,onQuote:onQuote})));const UserActionContentToolbar=Object(external_kbnSharedDeps_React_["memo"])(UserActionContentToolbarComponent);const MyEuiFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"MyEuiFlexGroup",componentId:"sc-1dz3qn9-0"})(["margin-bottom:8px;"]);const MyEuiCommentList=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiCommentList"]).withConfig({displayName:"MyEuiCommentList",componentId:"sc-1dz3qn9-1"})(["",""],({theme:theme})=>`\n    & .userAction__comment.outlined .euiCommentEvent {\n      outline: solid 5px ${theme.eui.euiColorVis1_behindText};\n      margin: 0.5em;\n      transition: 0.8s;\n    }\n\n    & .euiComment.isEdit {\n      & .euiCommentEvent {\n        border: none;\n        box-shadow: none;\n      }\n\n      & .euiCommentEvent__body {\n        padding: 0;\n      }\n\n      & .euiCommentEvent__header {\n        display: none;\n      }\n    }\n\n    & .comment-alert .euiCommentEvent {\n      background-color: ${theme.eui.euiColorLightestShade};\n      border: ${theme.eui.euiFlyoutBorder};\n      padding: 10px;\n      border-radius: ${theme.eui.paddingSizes.xs};\n    }\n\n    & .comment-alert .euiCommentEvent__headerData {\n      flex-grow: 1;\n    }\n  `);const DESCRIPTION_ID="description";const NEW_ID="newComment";const UserActionTree=external_kbnSharedDeps_React_default.a.memo(({data:caseData,caseServices:caseServices,caseUserActions:caseUserActions,connectors:connectors,fetchUserActions:fetchUserActions,isLoadingDescription:isLoadingDescription,isLoadingUserActions:isLoadingUserActions,onUpdateField:onUpdateField,updateCase:updateCase,userCanCrud:userCanCrud,onShowAlertDetails:onShowAlertDetails})=>{const{detailName:caseId,commentId:commentId}=Object(external_kbnSharedDeps_ReactRouterDom_["useParams"])();const handlerTimeoutId=Object(external_kbnSharedDeps_React_["useRef"])(0);const addCommentRef=Object(external_kbnSharedDeps_React_["useRef"])(null);const[initLoading,setInitLoading]=Object(external_kbnSharedDeps_React_["useState"])(true);const[selectedOutlineCommentId,setSelectedOutlineCommentId]=Object(external_kbnSharedDeps_React_["useState"])("");const{isLoadingIds:isLoadingIds,patchComment:patchComment}=useUpdateComment();const currentUser=Object(lib_kibana["d"])();const[manageMarkdownEditIds,setManangeMardownEditIds]=Object(external_kbnSharedDeps_React_["useState"])([]);const[loadingAlertData,manualAlertsData]=useFetchAlertData(getManualAlertIdsWithNoRuleId(caseData.comments));const handleManageMarkdownEditId=Object(external_kbnSharedDeps_React_["useCallback"])(id=>{if(!manageMarkdownEditIds.includes(id)){setManangeMardownEditIds([...manageMarkdownEditIds,id])}else{setManangeMardownEditIds(manageMarkdownEditIds.filter(myId=>id!==myId))}},[manageMarkdownEditIds]);const handleSaveComment=Object(external_kbnSharedDeps_React_["useCallback"])(({id:id,version:version},content)=>{patchComment({caseId:caseId,commentId:id,commentUpdate:content,fetchUserActions:fetchUserActions,version:version,updateCase:updateCase})},[caseId,fetchUserActions,patchComment,updateCase]);const handleOutlineComment=Object(external_kbnSharedDeps_React_["useCallback"])(id=>{const moveToTarget=document.getElementById(`${id}-permLink`);if(moveToTarget!=null){const yOffset=-60;const y=moveToTarget.getBoundingClientRect().top+window.pageYOffset+yOffset;window.scrollTo({top:y,behavior:"smooth"});if(id==="add-comment"){moveToTarget.getElementsByTagName("textarea")[0].focus()}}window.clearTimeout(handlerTimeoutId.current);setSelectedOutlineCommentId(id);handlerTimeoutId.current=window.setTimeout(()=>{setSelectedOutlineCommentId("");window.clearTimeout(handlerTimeoutId.current)},2400)},[handlerTimeoutId]);const handleManageQuote=Object(external_kbnSharedDeps_React_["useCallback"])(quote=>{const addCarrots=quote.replace(new RegExp("\r?\n","g"),"  \n> ");if(addCommentRef&&addCommentRef.current){addCommentRef.current.addQuote(`> ${addCarrots} \n`)}handleOutlineComment("add-comment")},[handleOutlineComment]);const handleUpdate=Object(external_kbnSharedDeps_React_["useCallback"])(newCase=>{updateCase(newCase);fetchUserActions()},[fetchUserActions,updateCase]);const MarkdownDescription=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(UserActionMarkdown,{id:DESCRIPTION_ID,content:caseData.description,isEditable:manageMarkdownEditIds.includes(DESCRIPTION_ID),onSaveContent:content=>{onUpdateField({key:DESCRIPTION_ID,value:content})},onChangeEditable:handleManageMarkdownEditId}),[caseData.description,handleManageMarkdownEditId,manageMarkdownEditIds,onUpdateField]);const MarkdownNewComment=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(AddComment,{caseId:caseId,disabled:!userCanCrud,ref:addCommentRef,onCommentPosted:handleUpdate,onCommentSaving:handleManageMarkdownEditId.bind(null,NEW_ID),showLoading:false}),[caseId,userCanCrud,handleUpdate,handleManageMarkdownEditId]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(initLoading&&!isLoadingUserActions&&isLoadingIds.length===0){setInitLoading(false);if(commentId!=null){handleOutlineComment(commentId)}}},[commentId,initLoading,isLoadingUserActions,isLoadingIds,handleOutlineComment]);const descriptionCommentListObj=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({username:external_kbnSharedDeps_React_default.a.createElement(UserActionUsername,{username:caseData.createdBy.username,fullName:caseData.createdBy.fullName}),event:ADDED_DESCRIPTION,"data-test-subj":"description-action",timestamp:external_kbnSharedDeps_React_default.a.createElement(UserActionTimestamp,{createdAt:caseData.createdAt}),children:MarkdownDescription,timelineIcon:external_kbnSharedDeps_React_default.a.createElement(UserActionAvatar,{username:caseData.createdBy.username,fullName:caseData.createdBy.fullName}),className:classnames_default()({isEdit:manageMarkdownEditIds.includes(DESCRIPTION_ID)}),actions:external_kbnSharedDeps_React_default.a.createElement(UserActionContentToolbar,{id:DESCRIPTION_ID,editLabel:EDIT_DESCRIPTION,quoteLabel:QUOTE,disabled:!userCanCrud,isLoading:isLoadingDescription,onEdit:handleManageMarkdownEditId.bind(null,DESCRIPTION_ID),onQuote:handleManageQuote.bind(null,caseData.description)})}),[MarkdownDescription,caseData,handleManageMarkdownEditId,handleManageQuote,isLoadingDescription,userCanCrud,manageMarkdownEditIds]);const userActions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>caseUserActions.reduce((comments,action,index)=>{if(action.commentId!=null&&action.action==="create"){const comment=caseData.comments.find(c=>c.id===action.commentId);if(comment!=null&&Object(Either["isRight"])(common_api["m"].decode(comment))&&comment.type===common_api["k"].user){return[...comments,{username:external_kbnSharedDeps_React_default.a.createElement(UserActionUsername,{username:comment.createdBy.username,fullName:comment.createdBy.fullName}),"data-test-subj":`comment-create-action-${comment.id}`,timestamp:external_kbnSharedDeps_React_default.a.createElement(UserActionTimestamp,{createdAt:comment.createdAt,updatedAt:comment.updatedAt}),className:classnames_default()("userAction__comment",{outlined:comment.id===selectedOutlineCommentId,isEdit:manageMarkdownEditIds.includes(comment.id)}),children:external_kbnSharedDeps_React_default.a.createElement(UserActionMarkdown,{id:comment.id,content:comment.comment,isEditable:manageMarkdownEditIds.includes(comment.id),onChangeEditable:handleManageMarkdownEditId,onSaveContent:handleSaveComment.bind(null,{id:comment.id,version:comment.version})}),timelineIcon:external_kbnSharedDeps_React_default.a.createElement(UserActionAvatar,{username:comment.createdBy.username,fullName:comment.createdBy.fullName}),actions:external_kbnSharedDeps_React_default.a.createElement(UserActionContentToolbar,{id:comment.id,editLabel:EDIT_COMMENT,quoteLabel:QUOTE,disabled:!userCanCrud,isLoading:isLoadingIds.includes(comment.id),onEdit:handleManageMarkdownEditId.bind(null,comment.id),onQuote:handleManageQuote.bind(null,comment.comment)})}]}else if(comment!=null&&Object(Either["isRight"])(common_api["a"].decode(comment))&&comment.type===common_api["k"].alert){var _ref,_comment$rule$id,_comment$rule,_manualAlertsData$ale,_manualAlertsData$ale2,_manualAlertsData$ale3,_manualAlertsData$ale4,_ref2,_comment$rule$name,_comment$rule2,_manualAlertsData$ale5,_manualAlertsData$ale6,_manualAlertsData$ale7,_manualAlertsData$ale8;const alertId=Array.isArray(comment.alertId)?comment.alertId.length>0?comment.alertId[0]:"":comment.alertId;const alertIndex=Array.isArray(comment.index)?comment.index.length>0?comment.index[0]:"":comment.index;if(Object(external_kbnSharedDeps_Lodash_["isEmpty"])(alertId)){return comments}const ruleId=(_ref=(_comment$rule$id=comment===null||comment===void 0?void 0:(_comment$rule=comment.rule)===null||_comment$rule===void 0?void 0:_comment$rule.id)!==null&&_comment$rule$id!==void 0?_comment$rule$id:(_manualAlertsData$ale=manualAlertsData[alertId])===null||_manualAlertsData$ale===void 0?void 0:(_manualAlertsData$ale2=_manualAlertsData$ale.signal)===null||_manualAlertsData$ale2===void 0?void 0:(_manualAlertsData$ale3=_manualAlertsData$ale2.rule)===null||_manualAlertsData$ale3===void 0?void 0:(_manualAlertsData$ale4=_manualAlertsData$ale3.id)===null||_manualAlertsData$ale4===void 0?void 0:_manualAlertsData$ale4[0])!==null&&_ref!==void 0?_ref:null;const ruleName=(_ref2=(_comment$rule$name=comment===null||comment===void 0?void 0:(_comment$rule2=comment.rule)===null||_comment$rule2===void 0?void 0:_comment$rule2.name)!==null&&_comment$rule$name!==void 0?_comment$rule$name:(_manualAlertsData$ale5=manualAlertsData[alertId])===null||_manualAlertsData$ale5===void 0?void 0:(_manualAlertsData$ale6=_manualAlertsData$ale5.signal)===null||_manualAlertsData$ale6===void 0?void 0:(_manualAlertsData$ale7=_manualAlertsData$ale6.rule)===null||_manualAlertsData$ale7===void 0?void 0:(_manualAlertsData$ale8=_manualAlertsData$ale7.name)===null||_manualAlertsData$ale8===void 0?void 0:_manualAlertsData$ale8[0])!==null&&_ref2!==void 0?_ref2:null;return[...comments,getAlertAttachment({action:action,alertId:alertId,index:alertIndex,loadingAlertData:loadingAlertData,ruleId:ruleId,ruleName:ruleName,onShowAlertDetails:onShowAlertDetails})]}else if(comment!=null&&comment.type===common_api["k"].generatedAlert){var _comment$rule$id2,_comment$rule3,_comment$rule$name2,_comment$rule4;const alertIds=Array.isArray(comment.alertId)?comment.alertId:[comment.alertId];if(Object(external_kbnSharedDeps_Lodash_["isEmpty"])(alertIds)){return comments}return[...comments,getGeneratedAlertsAttachment({action:action,alertIds:alertIds,ruleId:(_comment$rule$id2=(_comment$rule3=comment.rule)===null||_comment$rule3===void 0?void 0:_comment$rule3.id)!==null&&_comment$rule$id2!==void 0?_comment$rule$id2:"",ruleName:(_comment$rule$name2=(_comment$rule4=comment.rule)===null||_comment$rule4===void 0?void 0:_comment$rule4.name)!==null&&_comment$rule$name2!==void 0?_comment$rule$name2:UNKNOWN_RULE})]}}if(action.actionField.length===1&&action.actionField[0]==="connector"){const label=getConnectorLabelTitle({action:action,connectors:connectors});return[...comments,getUpdateAction({action:action,label:label,handleOutlineComment:handleOutlineComment})]}if(action.actionField.length===1&&action.actionField[0]==="pushed"){var _caseServices$parsedC,_caseServices$parsedC2;const parsedValue=Object(containers_utils["m"])(`${action.newValue}`);const{firstPush:firstPush,parsedConnectorId:parsedConnectorId,parsedConnectorName:parsedConnectorName}=getPushInfo(caseServices,parsedValue,index);const label=getPushedServiceLabelTitle(action,firstPush);const showTopFooter=action.action==="push-to-service"&&index===((_caseServices$parsedC=caseServices[parsedConnectorId])===null||_caseServices$parsedC===void 0?void 0:_caseServices$parsedC.lastPushIndex);const showBottomFooter=action.action==="push-to-service"&&index===((_caseServices$parsedC2=caseServices[parsedConnectorId])===null||_caseServices$parsedC2===void 0?void 0:_caseServices$parsedC2.lastPushIndex)&&caseServices[parsedConnectorId].hasDataToPush;let footers=[];if(showTopFooter){footers=[...footers,{username:"",type:"update",event:ALREADY_PUSHED_TO_SERVICE(`${parsedConnectorName}`),timelineIcon:"sortUp","data-test-subj":"top-footer"}]}if(showBottomFooter){footers=[...footers,{username:"",type:"update",event:REQUIRED_UPDATE_TO_SERVICE(`${parsedConnectorName}`),timelineIcon:"sortDown","data-test-subj":"bottom-footer"}]}return[...comments,getUpdateAction({action:action,label:label,handleOutlineComment:handleOutlineComment}),...footers]}if(action.actionField.length===1&&["title","description","comment","tags","status"].includes(action.actionField[0])){const myField=action.actionField[0];const label=getLabelTitle({action:action,field:myField});return[...comments,getUpdateAction({action:action,label:label,handleOutlineComment:handleOutlineComment})]}return comments},[descriptionCommentListObj]),[caseData,caseServices,caseUserActions,connectors,handleOutlineComment,descriptionCommentListObj,handleManageMarkdownEditId,handleManageQuote,handleSaveComment,isLoadingIds,loadingAlertData,manualAlertsData,manageMarkdownEditIds,selectedOutlineCommentId,userCanCrud,onShowAlertDetails]);const bottomActions=[{username:external_kbnSharedDeps_React_default.a.createElement(UserActionUsername,{username:currentUser===null||currentUser===void 0?void 0:currentUser.username,fullName:currentUser===null||currentUser===void 0?void 0:currentUser.fullName}),"data-test-subj":"add-comment",timelineIcon:external_kbnSharedDeps_React_default.a.createElement(UserActionAvatar,{username:currentUser===null||currentUser===void 0?void 0:currentUser.username,fullName:currentUser===null||currentUser===void 0?void 0:currentUser.fullName}),className:"isEdit",children:MarkdownNewComment}];const comments=[...userActions,...bottomActions];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(MyEuiCommentList,{comments:comments,"data-test-subj":"user-actions"}),(isLoadingUserActions||isLoadingIds.includes(NEW_ID))&&external_kbnSharedDeps_React_default.a.createElement(MyEuiFlexGroup,{justifyContent:"center",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{"data-test-subj":"user-actions-loading",size:"l"}))))});UserActionTree.displayName="UserActionTree";const SEND_EMAIL_ARIA=user=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.caseView.sendEmalLinkAria",{values:{user:user},defaultMessage:"click to send an email to {user}"});const MyAvatar=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiAvatar"]).withConfig({displayName:"MyAvatar",componentId:"i4ieve-0"})(["top:-4px;"]);const user_list_MyFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"MyFlexGroup",componentId:"i4ieve-1"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["margin-top:",";"],theme.eui.euiSizeM));const renderUsers=(users,handleSendEmail)=>users.map(({fullName:fullName,username:username,email:email},key)=>external_kbnSharedDeps_React_default.a.createElement(user_list_MyFlexGroup,{key:key,justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(MyAvatar,{name:fullName?fullName:username!==null&&username!==void 0?username:""})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:external_kbnSharedDeps_React_default.a.createElement("p",null,fullName?fullName:username!==null&&username!==void 0?username:"")},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_React_default.a.createElement("small",{"data-test-subj":"case-view-username"},username))))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"data-test-subj":"user-list-email-button",onClick:handleSendEmail.bind(null,email),iconType:"email","aria-label":SEND_EMAIL_ARIA(fullName?fullName:username!==null&&username!==void 0?username:""),isDisabled:Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(email)}))));const UserList=external_kbnSharedDeps_React_default.a.memo(({email:email,headline:headline,loading:loading,users:users})=>{const handleSendEmail=Object(external_kbnSharedDeps_React_["useCallback"])(emailAddress=>{if(emailAddress&&emailAddress!=null){window.open(`mailto:${emailAddress}?subject=${email.subject}&body=${email.body}`,"_blank")}},[email.subject]);return users.filter(({username:username})=>username!=null&&username!=="").length>0?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement("h4",null,headline),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"xs"}),loading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],null))),renderUsers(users.filter(({username:username})=>username!=null&&username!==""),handleSendEmail)):null});UserList.displayName="UserList";const use_update_case_dataFetchReducer=(state,action)=>{switch(action.type){case"FETCH_INIT":return{...state,isLoading:true,isError:false,updateKey:action.payload};case"FETCH_SUCCESS":return{...state,isLoading:false,isError:false,updateKey:null};case"FETCH_FAILURE":return{...state,isLoading:false,isError:true,updateKey:null};default:return state}};const useUpdateCase=({caseId:caseId})=>{const[state,dispatch]=Object(external_kbnSharedDeps_React_["useReducer"])(use_update_case_dataFetchReducer,{isLoading:false,isError:false,updateKey:null});const[,dispatchToaster]=Object(toasters["h"])();const isCancelledRef=Object(external_kbnSharedDeps_React_["useRef"])(false);const abortCtrlRef=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const dispatchUpdateCaseProperty=Object(external_kbnSharedDeps_React_["useCallback"])(async({fetchCaseUserActions:fetchCaseUserActions,updateKey:updateKey,updateValue:updateValue,updateCase:updateCase,caseData:caseData,onSuccess:onSuccess,onError:onError})=>{try{isCancelledRef.current=false;abortCtrlRef.current.abort();abortCtrlRef.current=new AbortController;dispatch({type:"FETCH_INIT",payload:updateKey});const response=await Object(containers_api["i"])(caseId,{[updateKey]:updateValue},caseData.version,abortCtrlRef.current.signal);if(!isCancelledRef.current){if(fetchCaseUserActions!=null){fetchCaseUserActions(caseId,response[0].connector.id)}if(updateCase!=null){updateCase(response[0])}dispatch({type:"FETCH_SUCCESS"});dispatchToaster({type:"addToaster",toast:Object(containers_utils["e"])(caseData,response[0],updateKey,updateValue)});if(onSuccess){onSuccess()}}}catch(error){if(!isCancelledRef.current){if(error.name!=="AbortError"){Object(toasters["g"])({title:containers_translations["d"],error:error.body&&error.body.message?new Error(error.body.message):error,dispatchToaster:dispatchToaster})}dispatch({type:"FETCH_FAILURE"});if(onError){onError()}}}},[caseId]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>()=>{isCancelledRef.current=true;abortCtrlRef.current.abort()},[]);return{...state,updateCaseProperty:dispatchUpdateCaseProperty}};const WhitePageWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"WhitePageWrapper",componentId:"d11hu8-0"})(["background-color:",";border-top:",";flex:1 1 auto;"],({theme:theme})=>theme.eui.euiColorEmptyShade,({theme:theme})=>theme.eui.euiBorderThin);const SectionWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"SectionWrapper",componentId:"d11hu8-1"})(["box-sizing:content-box;margin:0 auto;max-width:1175px;width:100%;"]);const wrappers_HeaderWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"HeaderWrapper",componentId:"d11hu8-2"})(["padding:",";"],({theme:theme})=>`${theme.eui.paddingSizes.l} ${theme.eui.paddingSizes.l} 0 ${theme.eui.paddingSizes.l}`);var use_delete_cases=__webpack_require__(715);var confirm_delete_case=__webpack_require__(784);const ActionsComponent=({caseData:caseData,currentExternalIncident:currentExternalIncident,disabled:disabled=false})=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const{handleToggleModal:handleToggleModal,handleOnDeleteConfirm:handleOnDeleteConfirm,isDeleted:isDeleted,isDisplayConfirmDeleteModal:isDisplayConfirmDeleteModal}=Object(use_delete_cases["a"])();const confirmDeleteModal=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(confirm_delete_case["a"],{caseTitle:caseData.title,isModalVisible:isDisplayConfirmDeleteModal,isPlural:false,onCancel:handleToggleModal,onConfirm:handleOnDeleteConfirm.bind(null,[{id:caseData.id,title:caseData.title,type:caseData.type}])}),[isDisplayConfirmDeleteModal,caseData]);const propertyActions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _currentExternalIncid;return[{disabled:disabled,iconType:"trash",label:cases_translations["p"],onClick:handleToggleModal},...currentExternalIncident!=null&&!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(currentExternalIncident===null||currentExternalIncident===void 0?void 0:currentExternalIncident.externalUrl)?[{iconType:"popout",label:VIEW_INCIDENT((_currentExternalIncid=currentExternalIncident===null||currentExternalIncident===void 0?void 0:currentExternalIncident.externalTitle)!==null&&_currentExternalIncid!==void 0?_currentExternalIncid:""),onClick:()=>window.open(currentExternalIncident===null||currentExternalIncident===void 0?void 0:currentExternalIncident.externalUrl,"_blank")}]:[]]},[disabled,handleToggleModal,currentExternalIncident]);if(isDeleted){history.push("/");return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(PropertyActions,{propertyActions:propertyActions}),confirmDeleteModal)};const Actions=external_kbnSharedDeps_React_default.a.memo(ActionsComponent);const StatusContextMenuComponent=({currentStatus:currentStatus,onStatusChanged:onStatusChanged})=>{const[isPopoverOpen,setIsPopoverOpen]=Object(external_kbnSharedDeps_React_["useState"])(false);const closePopover=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setIsPopoverOpen(false),[]);const openPopover=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setIsPopoverOpen(true),[]);const popOverButton=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(components_status["b"],{type:currentStatus,withArrow:true,onClick:openPopover}),[currentStatus,openPopover]);const onContextMenuItemClick=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(external_kbnSharedDeps_LodashFp_["memoize"])(status=>()=>{closePopover();onStatusChanged(status)}),[closePopover,onStatusChanged]);const panelItems=common_api["n"].map(status=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:status,icon:status===currentStatus?"check":"empty",onClick:onContextMenuItemClick(status),"data-test-subj":`case-view-status-dropdown-${status}`},external_kbnSharedDeps_React_default.a.createElement(components_status["b"],{type:status})));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"caseStatusPopover",button:popOverButton,isOpen:isPopoverOpen,closePopover:closePopover,anchorPosition:"downLeft","data-test-subj":"case-view-status-dropdown"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuPanel"],{items:panelItems})))};const StatusContextMenu=Object(external_kbnSharedDeps_React_["memo"])(StatusContextMenuComponent);const getStatusDate=theCase=>{if(theCase.status===common_api["e"].open){return theCase.createdAt}else if(theCase.status===common_api["e"]["in-progress"]){return theCase.updatedAt}else if(theCase.status===common_api["e"].closed){return theCase.closedAt}return null};const helpers_getStatusTitle=status=>components_status["d"][status].actionBar.title;const SyncAlertsSwitchComponent=({disabled:disabled,isSynced:isSynced=true,showLabel:showLabel=false,onSwitchChange:onSwitchChange})=>{const[isOn,setIsOn]=Object(external_kbnSharedDeps_React_["useState"])(isSynced);const onChange=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(onSwitchChange){onSwitchChange(!isOn)}setIsOn(!isOn)},[isOn,onSwitchChange]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{label:isOn?cases_translations["N"]:cases_translations["M"],showLabel:showLabel,checked:isOn,onChange:onChange,disabled:disabled,"data-test-subj":"sync-alerts-switch"})};SyncAlertsSwitchComponent.displayName="SyncAlertsSwitchComponent";const SyncAlertsSwitch=Object(external_kbnSharedDeps_React_["memo"])(SyncAlertsSwitchComponent);const MyDescriptionList=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiDescriptionList"]).withConfig({displayName:"MyDescriptionList",componentId:"sc-1pjs4ua-0"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["&{padding-right:",";border-right:",";}"],theme.eui.euiSizeL,theme.eui.euiBorderThin));const CaseActionBarComponent=({caseData:caseData,currentExternalIncident:currentExternalIncident,disabled:disabled=false,isLoading:isLoading,onRefresh:onRefresh,onUpdateField:onUpdateField})=>{const date=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getStatusDate(caseData),[caseData]);const title=Object(external_kbnSharedDeps_React_["useMemo"])(()=>helpers_getStatusTitle(caseData.status),[caseData.status]);const onStatusChanged=Object(external_kbnSharedDeps_React_["useCallback"])(status=>onUpdateField({key:"status",value:status}),[onUpdateField]);const onSyncAlertsChanged=Object(external_kbnSharedDeps_React_["useCallback"])(syncAlerts=>onUpdateField({key:"settings",value:{...caseData.settings,syncAlerts:syncAlerts}}),[caseData.settings,onUpdateField]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"l",justifyContent:"flexEnd","data-test-subj":"case-action-bar-wrapper"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(MyDescriptionList,{compressed:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,caseData.type!==common_api["f"].collection&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,"data-test-subj":"case-view-status"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"],null,translations_STATUS),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"],null,external_kbnSharedDeps_React_default.a.createElement(StatusContextMenu,{currentStatus:caseData.status,onStatusChanged:onStatusChanged}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"],null,title),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"],null,external_kbnSharedDeps_React_default.a.createElement(formatted_date["b"],{"data-test-subj":"case-action-bar-status-date",value:date})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionList"],{compressed:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"l",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListTitle"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{component:"span",alignItems:"center",gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement("span",null,SYNC_ALERTS)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{content:cases_translations["L"]})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescriptionListDescription"],null,external_kbnSharedDeps_React_default.a.createElement(SyncAlertsSwitch,{disabled:disabled||isLoading,isSynced:caseData.settings.syncAlerts,onSwitchChange:onSyncAlertsChanged}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"case-refresh",iconType:"refresh",onClick:onRefresh},CASE_REFRESH)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,"data-test-subj":"case-view-actions"},external_kbnSharedDeps_React_default.a.createElement(Actions,{caseData:caseData,currentExternalIncident:currentExternalIncident,disabled:disabled}))))))};const CaseActionBar=external_kbnSharedDeps_React_default.a.memo(CaseActionBarComponent);const initialData={caseServices:{},caseUserActions:[],hasDataToPush:false,isError:false,isLoading:true,participants:[]};const getExternalService=value=>Object(containers_utils["c"])(Object(containers_utils["m"])(`${value}`));const groupConnectorFields=userActions=>userActions.reduce((acc,mua)=>{if(mua.actionField[0]!=="connector"){return acc}const oldValue=Object(containers_utils["m"])(`${mua.oldValue}`);const newValue=Object(containers_utils["m"])(`${mua.newValue}`);if(oldValue==null||newValue==null){return acc}return{...acc,[oldValue.id]:[...acc[oldValue.id]||[],...oldValue.id===newValue.id?[oldValue.fields,newValue.fields]:[oldValue.fields]],[newValue.id]:[...acc[newValue.id]||[],...oldValue.id===newValue.id?[oldValue.fields,newValue.fields]:[newValue.fields]]}},{});const connectorHasChangedFields=({connectorFieldsBeforePush:connectorFieldsBeforePush,connectorFieldsAfterPush:connectorFieldsAfterPush,connectorId:connectorId})=>{if(connectorFieldsAfterPush==null||connectorFieldsAfterPush[connectorId]==null){return false}const fieldsAfterPush=connectorFieldsAfterPush[connectorId];if(connectorFieldsBeforePush!=null&&connectorFieldsBeforePush[connectorId]!=null){const fieldsBeforePush=connectorFieldsBeforePush[connectorId];return!fast_deep_equal_default()(fieldsBeforePush[fieldsBeforePush.length-1],fieldsAfterPush[fieldsAfterPush.length-1])}if(fieldsAfterPush.length>=2){return!fast_deep_equal_default()(fieldsAfterPush[fieldsAfterPush.length-2],fieldsAfterPush[fieldsAfterPush.length-1])}return false};const getPushedInfo=(caseUserActions,caseConnectorId)=>{const hasDataToPushForConnector=connectorId=>{const caseUserActionsReversed=[...caseUserActions].reverse();const lastPushOfConnectorReversedIndex=caseUserActionsReversed.findIndex(mua=>{var _getExternalService;return mua.action==="push-to-service"&&((_getExternalService=getExternalService(`${mua.newValue}`))===null||_getExternalService===void 0?void 0:_getExternalService.connectorId)===connectorId});if(lastPushOfConnectorReversedIndex===-1){return true}const lastPushOfConnectorIndex=caseUserActionsReversed.length-lastPushOfConnectorReversedIndex-1;const actionsBeforePush=caseUserActions.slice(0,lastPushOfConnectorIndex);const actionsAfterPush=caseUserActions.slice(lastPushOfConnectorIndex+1,caseUserActionsReversed.length);const connectorFieldsBeforePush=groupConnectorFields(actionsBeforePush);const connectorFieldsAfterPush=groupConnectorFields(actionsAfterPush);const connectorHasChanged=connectorHasChangedFields({connectorFieldsBeforePush:connectorFieldsBeforePush,connectorFieldsAfterPush:connectorFieldsAfterPush,connectorId:connectorId});return actionsAfterPush.some(mua=>mua.actionField[0]!=="connector"&&mua.action!=="push-to-service")||connectorHasChanged};const commentsAndIndex=caseUserActions.reduce((bacc,mua,index)=>mua.actionField[0]==="comment"&&mua.commentId!=null?[...bacc,{commentId:mua.commentId,commentIndex:index}]:bacc,[]);let caseServices=caseUserActions.reduce((acc,cua,i)=>{if(cua.action!=="push-to-service"){return acc}const externalService=getExternalService(`${cua.newValue}`);if(externalService===null){return acc}return{...acc,...acc[externalService.connectorId]!=null?{[externalService.connectorId]:{...acc[externalService.connectorId],...externalService,lastPushIndex:i,commentsToUpdate:[]}}:{[externalService.connectorId]:{...externalService,firstPushIndex:i,lastPushIndex:i,hasDataToPush:hasDataToPushForConnector(externalService.connectorId),commentsToUpdate:[]}}}},{});caseServices=Object.keys(caseServices).reduce((acc,key)=>({...acc,[key]:{...caseServices[key],commentsToUpdate:commentsAndIndex.reduce((bacc,currentComment)=>currentComment.commentIndex>caseServices[key].lastPushIndex?bacc.indexOf(currentComment.commentId)>-1?[...bacc.filter(e=>e!==currentComment.commentId),currentComment.commentId]:[...bacc,currentComment.commentId]:bacc,[])}}),{});const hasDataToPush=caseServices[caseConnectorId]!=null?caseServices[caseConnectorId].hasDataToPush:true;return{hasDataToPush:hasDataToPush,caseServices:caseServices}};const useGetCaseUserActions=(caseId,caseConnectorId)=>{const[caseUserActionsState,setCaseUserActionsState]=Object(external_kbnSharedDeps_React_["useState"])(initialData);const abortCtrlRef=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const isCancelledRef=Object(external_kbnSharedDeps_React_["useRef"])(false);const[,dispatchToaster]=Object(toasters["h"])();const fetchCaseUserActions=Object(external_kbnSharedDeps_React_["useCallback"])(async(thisCaseId,thisCaseConnectorId)=>{try{isCancelledRef.current=false;abortCtrlRef.current.abort();abortCtrlRef.current=new AbortController;setCaseUserActionsState({...caseUserActionsState,isLoading:true});const response=await Object(containers_api["d"])(thisCaseId,abortCtrlRef.current.signal);if(!isCancelledRef.current){const participants=!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(response)?Object(external_kbnSharedDeps_LodashFp_["uniqBy"])("actionBy.username",response).map(cau=>cau.actionBy):[];const caseUserActions=!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(response)?response.slice(1):[];setCaseUserActionsState({caseUserActions:caseUserActions,...getPushedInfo(caseUserActions,thisCaseConnectorId),isLoading:false,isError:false,participants:participants})}}catch(error){if(!isCancelledRef.current){if(error.name!=="AbortError"){Object(toasters["g"])({title:containers_translations["d"],error:error.body&&error.body.message?new Error(error.body.message):error,dispatchToaster:dispatchToaster})}setCaseUserActionsState({caseServices:{},caseUserActions:[],hasDataToPush:false,isError:true,isLoading:false,participants:[]})}}},[caseUserActionsState]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(caseId)){fetchCaseUserActions(caseId,caseConnectorId)}return()=>{isCancelledRef.current=true;abortCtrlRef.current.abort()}},[caseId]);return{...caseUserActionsState,fetchCaseUserActions:fetchCaseUserActions}};var use_get_action_license=__webpack_require__(717);var use_post_push_to_service=__webpack_require__(699);var callout=__webpack_require__(403);var use_push_to_service_helpers=__webpack_require__(718);var use_push_to_service_translations=__webpack_require__(488);const usePushToService=({connector:connector,caseId:caseId,caseServices:caseServices,caseStatus:caseStatus,connectors:connectors,updateCase:updateCase,userCanCrud:userCanCrud,isValidConnector:isValidConnector})=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const{formatUrl:formatUrl,search:urlSearch}=Object(link_to["o"])(app_types["a"].case);const{isLoading:isLoading,pushCaseToExternalService:pushCaseToExternalService}=Object(use_post_push_to_service["a"])();const{isLoading:loadingLicense,actionLicense:actionLicense}=Object(use_get_action_license["a"])();const handlePushToService=Object(external_kbnSharedDeps_React_["useCallback"])(async()=>{if(connector.id!=null&&connector.id!=="none"){const theCase=await pushCaseToExternalService({caseId:caseId,connector:connector});if(theCase!=null){updateCase(theCase)}}},[caseId,connector,pushCaseToExternalService,updateCase]);const goToConfigureCases=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();history.push(Object(link_to["e"])(urlSearch))},[history,urlSearch]);const errorsMsg=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{let errors=[];if(actionLicense!=null&&!actionLicense.enabledInLicense){errors=[...errors,Object(use_push_to_service_helpers["c"])()]}if(connectors.length===0&&connector.id==="none"&&!loadingLicense){errors=[...errors,{id:"connector-missing-error",title:use_push_to_service_translations["i"],description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"To open and update cases in external systems, you must configure a {link}.",id:"xpack.securitySolution.case.caseView.pushToServiceDisableByNoConnectors",values:{link:external_kbnSharedDeps_React_default.a.createElement(links["f"],{onClick:goToConfigureCases,href:formatUrl(Object(link_to["e"])()),target:"_blank"},use_push_to_service_translations["d"])}})}]}else if(connector.id==="none"&&!loadingLicense){errors=[...errors,{id:"connector-not-selected-error",title:use_push_to_service_translations["h"],description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"To open and update cases in external systems, you must select an external incident management system for this case.",id:"xpack.securitySolution.case.caseView.pushToServiceDisableByNoCaseConfigDescription"})}]}else if(!isValidConnector&&!loadingLicense){errors=[...errors,{id:"connector-deleted-error",title:use_push_to_service_translations["h"],description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"The connector used to send updates to external service has been deleted. To update cases in external systems, select a different connector or create a new one.",id:"xpack.securitySolution.case.caseView.pushToServiceDisableByInvalidConnector"}),errorType:"danger"}]}if(caseStatus===common_api["e"].closed){errors=[...errors,{id:"closed-case-push-error",title:use_push_to_service_translations["e"],description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"Closed cases cannot be sent to external systems. Reopen the case if you want to open or update it in an external system.",id:"xpack.securitySolution.case.caseView.pushToServiceDisableBecauseCaseClosedDescription"})}]}if(actionLicense!=null&&!actionLicense.enabledInConfig){errors=[...errors,Object(use_push_to_service_helpers["b"])()]}return errors},[actionLicense,caseStatus,connectors.length,connector,loadingLicense,urlSearch]);const pushToServiceButton=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"push-to-external-service",fill:true,iconType:"importAction",onClick:handlePushToService,disabled:isLoading||loadingLicense||errorsMsg.length>0||!userCanCrud||!isValidConnector,isLoading:isLoading},caseServices[connector.id]?use_push_to_service_translations["k"](connector.name):use_push_to_service_translations["j"](connector.name)),[connector,connectors,errorsMsg,handlePushToService,isLoading,loadingLicense,userCanCrud,isValidConnector]);const objToReturn=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({pushButton:errorsMsg.length>0?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",title:errorsMsg[0].title,content:external_kbnSharedDeps_React_default.a.createElement("p",null,errorsMsg[0].description)},pushToServiceButton):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,pushToServiceButton),pushCallouts:errorsMsg.length>0?external_kbnSharedDeps_React_default.a.createElement(callout["a"],{title:use_push_to_service_translations["a"],messages:errorsMsg}):null}),[errorsMsg,pushToServiceButton]);return objToReturn};var connector_selector_form=__webpack_require__(701);var fields_form=__webpack_require__(703);var configure_cases_utils=__webpack_require__(309);const edit_connector_schema_schema={connectorId:{type:shared_imports["c"].SUPER_SELECT}};const getConnectorFieldsFromUserActions=(id,userActions)=>{try{for(const action of[...userActions].reverse()){if(action.actionField.length===1&&action.actionField[0]==="connector"){if(action.oldValue&&action.newValue){const oldValue=JSON.parse(action.oldValue);const newValue=JSON.parse(action.newValue);if(newValue.id===id){return newValue.fields}if(oldValue.id===id){return oldValue.fields}}}}return null}catch{return null}};const EDIT_CONNECTOR_ARIA=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.case.editConnector.editConnectorLinkAria",{defaultMessage:"click to edit connector"});const edit_connector_MyFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"MyFlexGroup",componentId:"sc-1e8a7nn-0"})(["",""],({theme:theme})=>`\n    margin-top: ${theme.eui.euiSizeM};\n    p {\n      font-size: ${theme.eui.euiSizeM};\n    }\n  `);const DisappearingFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"DisappearingFlexItem",componentId:"sc-1e8a7nn-1"})(["",""],({$isHidden:$isHidden})=>$isHidden&&`\n      margin: 0 !important;\n    `);const editConnectorReducer=(state,action)=>{switch(action.type){case"SET_CURRENT_CONNECTOR":return{...state,currentConnector:action.payload};case"SET_FIELDS":return{...state,fields:action.payload};case"SET_EDIT_CONNECTOR":return{...state,editConnector:action.payload};default:return state}};const edit_connector_initialState={currentConnector:null,fields:null,editConnector:false};const EditConnector=external_kbnSharedDeps_React_default.a.memo(({caseFields:caseFields,connectors:connectors,disabled:disabled=false,hideConnectorServiceNowSir:hideConnectorServiceNowSir=false,isLoading:isLoading,onSubmit:onSubmit,selectedConnector:selectedConnector,userActions:userActions})=>{const{form:form}=Object(shared_imports["I"])({defaultValue:{connectorId:selectedConnector},options:{stripEmptyFields:false},schema:edit_connector_schema_schema});const{setFieldValue:setFieldValue,submit:submit}=form;const[{currentConnector:currentConnector,fields:fields,editConnector:editConnector},dispatch]=Object(external_kbnSharedDeps_React_["useReducer"])(editConnectorReducer,{...edit_connector_initialState,fields:caseFields});const onChangeConnector=Object(external_kbnSharedDeps_React_["useCallback"])(newConnectorId=>{if(currentConnector==null){dispatch({type:"SET_CURRENT_CONNECTOR",payload:Object(configure_cases_utils["a"])(newConnectorId,connectors)})}else if(currentConnector.id!==newConnectorId){dispatch({type:"SET_CURRENT_CONNECTOR",payload:Object(configure_cases_utils["a"])(newConnectorId,connectors)});dispatch({type:"SET_FIELDS",payload:getConnectorFieldsFromUserActions(newConnectorId,userActions!==null&&userActions!==void 0?userActions:[])})}else if(fields===null){dispatch({type:"SET_FIELDS",payload:getConnectorFieldsFromUserActions(newConnectorId,userActions!==null&&userActions!==void 0?userActions:[])})}},[currentConnector,fields,userActions,connectors]);const onFieldsChange=Object(external_kbnSharedDeps_React_["useCallback"])(newFields=>{if(!fast_deep_equal_default()(newFields,fields)){dispatch({type:"SET_FIELDS",payload:newFields})}},[fields,dispatch]);const onError=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setFieldValue("connectorId",selectedConnector);dispatch({type:"SET_EDIT_CONNECTOR",payload:false})},[dispatch,setFieldValue,selectedConnector]);const onCancelConnector=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setFieldValue("connectorId",selectedConnector);dispatch({type:"SET_FIELDS",payload:caseFields});dispatch({type:"SET_EDIT_CONNECTOR",payload:false})},[dispatch,selectedConnector,setFieldValue,caseFields]);const onSubmitConnector=Object(external_kbnSharedDeps_React_["useCallback"])(async()=>{const{isValid:isValid,data:newData}=await submit();if(isValid&&newData.connectorId){onSubmit(newData.connectorId,fields,onError,external_kbnSharedDeps_LodashFp_["noop"]);dispatch({type:"SET_EDIT_CONNECTOR",payload:false})}},[dispatch,submit,fields,onSubmit,onError]);const onEditClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{dispatch({type:"SET_EDIT_CONNECTOR",payload:true})},[dispatch]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,external_kbnSharedDeps_React_default.a.createElement(edit_connector_MyFlexGroup,{alignItems:"center",gutterSize:"xs",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement("h4",null,cases_translations["m"])),isLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{"data-test-subj":"connector-loading"}),!isLoading&&!editConnector&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"connector-edit",grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"data-test-subj":"connector-edit-button",isDisabled:disabled,"aria-label":EDIT_CONNECTOR_ARIA,iconType:"pencil",onClick:onEditClick}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"xs"}),external_kbnSharedDeps_React_default.a.createElement(edit_connector_MyFlexGroup,{"data-test-subj":"edit-connectors",direction:"column"},external_kbnSharedDeps_React_default.a.createElement(DisappearingFlexItem,{$isHidden:!editConnector},external_kbnSharedDeps_React_default.a.createElement(shared_imports["e"],{form:form},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",direction:"row"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(shared_imports["j"],{path:"connectorId",component:connector_selector_form["a"],componentProps:{connectors:connectors,dataTestSubj:"caseConnectors",defaultValue:selectedConnector,disabled:disabled,hideConnectorServiceNowSir:hideConnectorServiceNowSir,idAria:"caseConnectors",isEdit:editConnector,isLoading:isLoading},onChange:onChangeConnector}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"edit-connector-fields-form-flex-item"},(currentConnector==null||(currentConnector===null||currentConnector===void 0?void 0:currentConnector.id)==="none")&&!(currentConnector===null&&selectedConnector!=="none")&&!editConnector&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("span",null,cases_translations["x"])),external_kbnSharedDeps_React_default.a.createElement(fields_form["a"],{connector:currentConnector,fields:fields,isEdit:editConnector,onChange:onFieldsChange})),editConnector&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{color:"secondary","data-test-subj":"edit-connectors-submit",fill:true,iconType:"save",onClick:onSubmitConnector,size:"s"},cases_translations["J"])),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"edit-connectors-cancel",iconType:"cross",onClick:onCancelConnector,size:"s"},cases_translations["e"]))))))});EditConnector.displayName="EditConnector";var use_connectors=__webpack_require__(381);var side_panel=__webpack_require__(280);var status_config=__webpack_require__(307);const getNextItem=item=>(item+1)%common_api["n"].length;const StatusActionButtonComponent=({status:status,onStatusChanged:onStatusChanged,disabled:disabled,isLoading:isLoading})=>{const indexOfCurrentStatus=Object(external_kbnSharedDeps_React_["useMemo"])(()=>common_api["n"].findIndex(caseStatus=>caseStatus===status),[status]);const nextStatusIndex=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getNextItem(indexOfCurrentStatus),[indexOfCurrentStatus]);const onClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{onStatusChanged(common_api["n"][nextStatusIndex])},[nextStatusIndex,onStatusChanged]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{"data-test-subj":"case-view-status-action-button",iconType:status_config["b"][common_api["n"][nextStatusIndex]].button.icon,isDisabled:disabled,isLoading:isLoading,onClick:onClick},status_config["b"][common_api["n"][nextStatusIndex]].button.label)};const StatusActionButton=Object(external_kbnSharedDeps_React_["memo"])(StatusActionButtonComponent);const MyWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"MyWrapper",componentId:"sc-1xjixbg-0"})(["padding:",";"],({theme:theme})=>`${theme.eui.paddingSizes.l} ${theme.eui.paddingSizes.l} ${lib_helpers["d"]} ${theme.eui.paddingSizes.l}`);const case_view_MyEuiFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"MyEuiFlexGroup",componentId:"sc-1xjixbg-1"})(["height:100%;"]);const MyEuiHorizontalRule=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"]).withConfig({displayName:"MyEuiHorizontalRule",componentId:"sc-1xjixbg-2"})(["margin-left:48px;&.euiHorizontalRule--full{width:calc(100% - 48px);}"]);const CaseComponent=external_kbnSharedDeps_React_default.a.memo(({caseId:caseId,caseData:caseData,fetchCase:fetchCase,updateCase:updateCase,userCanCrud:userCanCrud})=>{const dispatch=Object(react_redux_lib["useDispatch"])();const{formatUrl:formatUrl,search:search}=Object(link_to["o"])(app_types["a"].case);const allCasesLink=Object(link_to["d"])(search);const caseDetailsLink=formatUrl(Object(link_to["b"])({id:caseId}),{absolute:true});const[initLoadingData,setInitLoadingData]=Object(external_kbnSharedDeps_React_["useState"])(true);const init=Object(external_kbnSharedDeps_React_["useRef"])(true);const{caseUserActions:caseUserActions,fetchCaseUserActions:fetchCaseUserActions,caseServices:caseServices,hasDataToPush:hasDataToPush,isLoading:isLoadingUserActions,participants:participants}=useGetCaseUserActions(caseId,caseData.connector.id);const{isLoading:isLoading,updateKey:updateKey,updateCaseProperty:updateCaseProperty}=useUpdateCase({caseId:caseId});const{browserFields:browserFields,docValueFields:docValueFields}=Object(sourcerer["b"])(model["SourcererScopeName"].detections);const onUpdateField=Object(external_kbnSharedDeps_React_["useCallback"])(({key:key,value:value,onSuccess:onSuccess,onError:onError})=>{const handleUpdateNewCase=newCase=>updateCase({...newCase,comments:caseData.comments});switch(key){case"title":const titleUpdate=Object(containers_utils["l"])(value);if(titleUpdate.length>0){updateCaseProperty({fetchCaseUserActions:fetchCaseUserActions,updateKey:"title",updateValue:titleUpdate,updateCase:handleUpdateNewCase,caseData:caseData,onSuccess:onSuccess,onError:onError})}break;case"connector":const connector=Object(containers_utils["l"])(value);if(connector!=null){updateCaseProperty({fetchCaseUserActions:fetchCaseUserActions,updateKey:"connector",updateValue:connector,updateCase:handleUpdateNewCase,caseData:caseData,onSuccess:onSuccess,onError:onError})}break;case"description":const descriptionUpdate=Object(containers_utils["l"])(value);if(descriptionUpdate.length>0){updateCaseProperty({fetchCaseUserActions:fetchCaseUserActions,updateKey:"description",updateValue:descriptionUpdate,updateCase:handleUpdateNewCase,caseData:caseData,onSuccess:onSuccess,onError:onError})}break;case"tags":const tagsUpdate=Object(containers_utils["l"])(value);updateCaseProperty({fetchCaseUserActions:fetchCaseUserActions,updateKey:"tags",updateValue:tagsUpdate,updateCase:handleUpdateNewCase,caseData:caseData,onSuccess:onSuccess,onError:onError});break;case"status":const statusUpdate=Object(containers_utils["l"])(value);if(caseData.status!==value){updateCaseProperty({fetchCaseUserActions:fetchCaseUserActions,updateKey:"status",updateValue:statusUpdate,updateCase:handleUpdateNewCase,caseData:caseData,onSuccess:onSuccess,onError:onError})}break;case"settings":const settingsUpdate=Object(containers_utils["l"])(value);if(caseData.settings!==value){updateCaseProperty({fetchCaseUserActions:fetchCaseUserActions,updateKey:"settings",updateValue:settingsUpdate,updateCase:handleUpdateNewCase,caseData:caseData,onSuccess:onSuccess,onError:onError})}break;default:return null}},[fetchCaseUserActions,updateCaseProperty,updateCase,caseData]);const handleUpdateCase=Object(external_kbnSharedDeps_React_["useCallback"])(newCase=>{updateCase(newCase);fetchCaseUserActions(caseId,newCase.connector.id)},[updateCase,fetchCaseUserActions,caseId]);const{loading:isLoadingConnectors,connectors:connectors}=Object(use_connectors["a"])();const[connectorName,isValidConnector]=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _connector$name;const connector=connectors.find(c=>c.id===caseData.connector.id);return[(_connector$name=connector===null||connector===void 0?void 0:connector.name)!==null&&_connector$name!==void 0?_connector$name:"",!!connector]},[connectors,caseData.connector]);const currentExternalIncident=Object(external_kbnSharedDeps_React_["useMemo"])(()=>caseServices!=null&&caseServices[caseData.connector.id]!=null?caseServices[caseData.connector.id]:null,[caseServices,caseData.connector]);const{pushButton:pushButton,pushCallouts:pushCallouts}=usePushToService({connector:{...caseData.connector,name:Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(connectorName)?caseData.connector.name:connectorName},caseServices:caseServices,caseId:caseData.id,caseStatus:caseData.status,connectors:connectors,updateCase:handleUpdateCase,userCanCrud:userCanCrud,isValidConnector:isLoadingConnectors?true:isValidConnector});const onSubmitConnector=Object(external_kbnSharedDeps_React_["useCallback"])((connectorId,connectorFields,onError,onSuccess)=>{const connector=Object(configure_cases_utils["a"])(connectorId,connectors);const connectorToUpdate=connector?Object(configure_cases_utils["c"])(connector):Object(configure_cases_utils["b"])();onUpdateField({key:"connector",value:{...connectorToUpdate,fields:connectorFields},onSuccess:onSuccess,onError:onError})},[onUpdateField,connectors]);const onSubmitTags=Object(external_kbnSharedDeps_React_["useCallback"])(newTags=>onUpdateField({key:"tags",value:newTags}),[onUpdateField]);const onSubmitTitle=Object(external_kbnSharedDeps_React_["useCallback"])(newTitle=>onUpdateField({key:"title",value:newTitle}),[onUpdateField]);const changeStatus=Object(external_kbnSharedDeps_React_["useCallback"])(status=>onUpdateField({key:"status",value:status}),[onUpdateField]);const handleRefresh=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{fetchCaseUserActions(caseId,caseData.connector.id);fetchCase()},[caseData.connector.id,caseId,fetchCase,fetchCaseUserActions]);const spyState=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({caseTitle:caseData.title}),[caseData.title]);const emailContent=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({subject:EMAIL_SUBJECT(caseData.title),body:EMAIL_BODY(caseDetailsLink)}),[caseDetailsLink,caseData.title]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(initLoadingData&&!isLoadingUserActions){setInitLoadingData(false)}},[initLoadingData,isLoadingUserActions]);const backOptions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({href:allCasesLink,text:cases_translations["d"],dataTestSubj:"backToCases",pageId:app_types["a"].case}),[allCasesLink]);const showAlert=Object(external_kbnSharedDeps_React_["useCallback"])((alertId,index)=>{dispatch(store_timeline["a"].toggleDetailPanel({panelView:"eventDetail",timelineId:types_timeline["e"].casePage,params:{eventId:alertId,indexName:index}}))},[dispatch]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(init.current){init.current=false;dispatch(store_timeline["a"].createTimeline({id:types_timeline["e"].casePage,columns:[],indexNames:[],expandedDetail:{},show:false}))}},[dispatch]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(wrappers_HeaderWrapper,null,external_kbnSharedDeps_React_default.a.createElement(header_page["a"],{backOptions:backOptions,"data-test-subj":"case-view-title",hideSourcerer:true,titleNode:external_kbnSharedDeps_React_default.a.createElement(EditableTitle,{disabled:!userCanCrud,isLoading:isLoading&&updateKey==="title",title:caseData.title,onSubmit:onSubmitTitle}),title:caseData.title},external_kbnSharedDeps_React_default.a.createElement(CaseActionBar,{currentExternalIncident:currentExternalIncident,caseData:caseData,disabled:!userCanCrud,isLoading:isLoading&&(updateKey==="status"||updateKey==="settings"),onRefresh:handleRefresh,onUpdateField:onUpdateField}))),external_kbnSharedDeps_React_default.a.createElement(WhitePageWrapper,null,external_kbnSharedDeps_React_default.a.createElement(MyWrapper,null,!initLoadingData&&pushCallouts!=null&&pushCallouts,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:6},initLoadingData&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingContent"],{lines:8,"data-test-subj":"case-view-loading-content"}),!initLoadingData&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(UserActionTree,{caseServices:caseServices,caseUserActions:caseUserActions,connectors:connectors,data:caseData,fetchUserActions:fetchCaseUserActions.bind(null,caseId,caseData.connector.id),isLoadingDescription:isLoading&&updateKey==="description",isLoadingUserActions:isLoadingUserActions,onShowAlertDetails:showAlert,onUpdateField:onUpdateField,updateCase:updateCase,userCanCrud:userCanCrud}),(caseData.type!==common_api["f"].collection||hasDataToPush)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(MyEuiHorizontalRule,{margin:"s","data-test-subj":"case-view-bottom-actions-horizontal-rule"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"s",justifyContent:"flexEnd"},caseData.type!==common_api["f"].collection&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(StatusActionButton,{status:caseData.status,onStatusChanged:changeStatus,disabled:!userCanCrud,isLoading:isLoading&&updateKey==="status"})),hasDataToPush&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"has-data-to-push-button",grow:false},pushButton))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:2},external_kbnSharedDeps_React_default.a.createElement(UserList,{"data-test-subj":"case-view-user-list-reporter",email:emailContent,headline:cases_translations["H"],users:[caseData.createdBy]}),external_kbnSharedDeps_React_default.a.createElement(UserList,{"data-test-subj":"case-view-user-list-participants",email:emailContent,headline:cases_translations["F"],loading:isLoadingUserActions,users:participants}),external_kbnSharedDeps_React_default.a.createElement(TagList,{"data-test-subj":"case-view-tag-list",disabled:!userCanCrud,tags:caseData.tags,onSubmit:onSubmitTags,isLoading:isLoading&&updateKey==="tags"}),external_kbnSharedDeps_React_default.a.createElement(EditConnector,{caseFields:caseData.connector.fields,connectors:connectors,disabled:!userCanCrud,hideConnectorServiceNowSir:false,isLoading:isLoadingConnectors||isLoading&&updateKey==="connector",onSubmit:onSubmitConnector,selectedConnector:caseData.connector.id,userActions:caseUserActions}))))),external_kbnSharedDeps_React_default.a.createElement(side_panel["a"],{browserFields:browserFields,docValueFields:docValueFields,isFlyoutView:true,timelineId:types_timeline["e"].casePage}),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{state:spyState,pageName:app_types["a"].case}))});const CaseView=external_kbnSharedDeps_React_default.a.memo(({caseId:caseId,userCanCrud:userCanCrud})=>{const{data:data,isLoading:isLoading,isError:isError,fetchCase:fetchCase,updateCase:updateCase}=useGetCase(caseId);if(isError){return null}if(isLoading){return external_kbnSharedDeps_React_default.a.createElement(case_view_MyEuiFlexGroup,{gutterSize:"none",justifyContent:"center",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{"data-test-subj":"case-view-loading",size:"xl"})))}return data&&external_kbnSharedDeps_React_default.a.createElement(CaseComponent,{caseId:caseId,fetchCase:fetchCase,caseData:data,updateCase:updateCase,userCanCrud:userCanCrud})});CaseComponent.displayName="CaseComponent";CaseView.displayName="CaseView";const CaseDetailsPage=external_kbnSharedDeps_React_default.a.memo(()=>{var _userPermissions$crud;const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const userPermissions=Object(lib_kibana["f"])();const{detailName:caseId}=Object(external_kbnSharedDeps_ReactRouterDom_["useParams"])();const search=Object(use_get_url_search["a"])(home_navigations["a"].case);if(userPermissions!=null&&!userPermissions.read){history.replace(Object(link_to["d"])(search));return null}return caseId!=null?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],{noPadding:true},userPermissions!=null&&!(userPermissions!==null&&userPermissions!==void 0&&userPermissions.crud)&&(userPermissions===null||userPermissions===void 0?void 0:userPermissions.read)&&external_kbnSharedDeps_React_default.a.createElement(callout["a"],{title:callout["b"].title,messages:[{...callout["b"]}]}),external_kbnSharedDeps_React_default.a.createElement(CaseView,{caseId:caseId,userCanCrud:(_userPermissions$crud=userPermissions===null||userPermissions===void 0?void 0:userPermissions.crud)!==null&&_userPermissions$crud!==void 0?_userPermissions$crud:false})),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].case})):null});CaseDetailsPage.displayName="CaseDetailsPage";var all_cases=__webpack_require__(750);var pages_translations=__webpack_require__(392);const CaseSavedObjectNoPermissions=external_kbnSharedDeps_React_default.a.memo(()=>{const docLinks=Object(lib_kibana["h"])().services.docLinks;const actions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({savedObject:{icon:"documents",label:pages_translations["e"],url:`${docLinks.ELASTIC_WEBSITE_URL}guide/en/security/${docLinks.DOC_LINK_VERSION}s`,target:"_blank"}}),[docLinks]);return external_kbnSharedDeps_React_default.a.createElement(empty_page["a"],{actions:actions,message:pages_translations["g"],"data-test-subj":"no_saved_objects_permissions",title:pages_translations["h"]})});CaseSavedObjectNoPermissions.displayName="CaseSavedObjectNoPermissions";const CasesPage=external_kbnSharedDeps_React_default.a.memo(()=>{var _userPermissions$crud;const userPermissions=Object(lib_kibana["f"])();return userPermissions==null||userPermissions!==null&&userPermissions!==void 0&&userPermissions.read?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,userPermissions!=null&&!(userPermissions!==null&&userPermissions!==void 0&&userPermissions.crud)&&(userPermissions===null||userPermissions===void 0?void 0:userPermissions.read)&&external_kbnSharedDeps_React_default.a.createElement(callout["a"],{title:callout["b"].title,messages:[{...callout["b"]}]}),external_kbnSharedDeps_React_default.a.createElement(all_cases["a"],{userCanCrud:(_userPermissions$crud=userPermissions===null||userPermissions===void 0?void 0:userPermissions.crud)!==null&&_userPermissions$crud!==void 0?_userPermissions$crud:false})),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].case})):external_kbnSharedDeps_React_default.a.createElement(CaseSavedObjectNoPermissions,null)});CasesPage.displayName="CasesPage";var case_header_page=__webpack_require__(487);var create_translations=__webpack_require__(308);var create_form=__webpack_require__(506);var form_context=__webpack_require__(519);var create_description=__webpack_require__(700);var submit_button=__webpack_require__(481);const create_CommonUseField=Object(shared_imports["x"])({component:shared_imports["d"]});const Container=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Container",componentId:"sc-3p3fo4-0"})(["",""],({theme:theme})=>`\n    margin-top: ${theme.eui.euiSize};\n  `);const InsertTimeline=()=>{var _formData$description;const{setFieldValue:setFieldValue,getFormData:getFormData}=Object(shared_imports["J"])();const formData=getFormData();const onTimelineAttached=Object(external_kbnSharedDeps_React_["useCallback"])(newValue=>setFieldValue(create_description["b"],newValue),[setFieldValue]);useInsertTimeline((_formData$description=formData[create_description["b"]])!==null&&_formData$description!==void 0?_formData$description:"",onTimelineAttached);return null};const Create=external_kbnSharedDeps_React_default.a.memo(()=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const onSuccess=Object(external_kbnSharedDeps_React_["useCallback"])(async({id:id})=>{history.push(Object(link_to["b"])({id:id}))},[history]);const handleSetIsCancel=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{history.push("/")},[history]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(form_context["a"],{onSuccess:onSuccess},external_kbnSharedDeps_React_default.a.createElement(create_form["a"],null),external_kbnSharedDeps_React_default.a.createElement(Container,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",justifyContent:"flexEnd",gutterSize:"xs",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"create-case-cancel",size:"s",onClick:handleSetIsCancel,iconType:"cross"},create_translations["a"])),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(submit_button["a"],null)))),external_kbnSharedDeps_React_default.a.createElement(InsertTimeline,null)))});Create.displayName="Create";const CreateCasePage=external_kbnSharedDeps_React_default.a.memo(()=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const userPermissions=Object(lib_kibana["f"])();const search=Object(use_get_url_search["a"])(home_navigations["a"].case);const backOptions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({href:Object(link_to["d"])(search),text:pages_translations["a"],pageId:app_types["a"].case}),[search]);if(userPermissions!=null&&!userPermissions.crud){history.replace(Object(link_to["d"])(search));return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,external_kbnSharedDeps_React_default.a.createElement(case_header_page["a"],{backOptions:backOptions,title:pages_translations["d"]}),external_kbnSharedDeps_React_default.a.createElement(Create,null)),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].case}))});CreateCasePage.displayName="CreateCasePage";var configure_api=__webpack_require__(479);const useActionTypes=()=>{const[,dispatchToaster]=Object(toasters["h"])();const[loading,setLoading]=Object(external_kbnSharedDeps_React_["useState"])(true);const[actionTypes,setActionTypes]=Object(external_kbnSharedDeps_React_["useState"])([]);const isCancelledRef=Object(external_kbnSharedDeps_React_["useRef"])(false);const abortCtrlRef=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const queryFirstTime=Object(external_kbnSharedDeps_React_["useRef"])(true);const refetchActionTypes=Object(external_kbnSharedDeps_React_["useCallback"])(async()=>{try{setLoading(true);isCancelledRef.current=false;abortCtrlRef.current.abort();abortCtrlRef.current=new AbortController;const res=await Object(configure_api["a"])({signal:abortCtrlRef.current.signal});if(!isCancelledRef.current){setLoading(false);setActionTypes(res)}}catch(error){if(!isCancelledRef.current){setLoading(false);setActionTypes([]);Object(toasters["g"])({title:containers_translations["d"],error:error.body&&error.body.message?new Error(error.body.message):error,dispatchToaster:dispatchToaster})}}},[dispatchToaster]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(queryFirstTime.current){refetchActionTypes();queryFirstTime.current=false}return()=>{isCancelledRef.current=true;abortCtrlRef.current.abort();queryFirstTime.current=true}},[refetchActionTypes]);return{loading:loading,actionTypes:actionTypes,refetchActionTypes:refetchActionTypes}};var use_configure=__webpack_require__(783);var connectors_dropdown=__webpack_require__(702);var configure_cases_translations=__webpack_require__(246);const FieldMappingRowComponent=({isLoading:isLoading,securitySolutionField:securitySolutionField,selectedActionType:selectedActionType,selectedThirdParty:selectedThirdParty})=>{const selectedActionTypeCapitalized=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(external_kbnSharedDeps_LodashFp_["capitalize"])(selectedActionType),[selectedActionType]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{"data-test-subj":"static-mappings",alignItems:"center",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{component:"span",justifyContent:"spaceBetween",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{component:"span",grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],{"data-test-subj":"field-mapping-source"},securitySolutionField)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{component:"span",grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"sortRight"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{component:"span",justifyContent:"spaceBetween",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{component:"span",grow:false},isLoading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],{"data-test-subj":"field-mapping-target"},selectedThirdParty)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,isLoading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"}):selectedActionTypeCapitalized))};const FieldMappingRowStatic=external_kbnSharedDeps_React_default.a.memo(FieldMappingRowComponent);var components_connectors=__webpack_require__(40);const FieldRowWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"FieldRowWrapper",componentId:"sc-1007xg6-0"})(["margin:10px 0;font-size:14px;"]);const FieldMappingComponent=({connectorActionTypeId:connectorActionTypeId,isLoading:isLoading,mappings:mappings})=>{const selectedConnector=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _connectorsConfigurat;return(_connectorsConfigurat=components_connectors["a"][connectorActionTypeId])!==null&&_connectorsConfigurat!==void 0?_connectorsConfigurat:{fields:{}}},[connectorActionTypeId]);return mappings.length?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement("span",{className:"euiFormLabel"},configure_cases_translations["i"])),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement("span",{className:"euiFormLabel"},configure_cases_translations["j"](selectedConnector.name))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement("span",{className:"euiFormLabel"},configure_cases_translations["k"])))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(FieldRowWrapper,{"data-test-subj":"case-configure-field-mappings-row-wrapper"},mappings.map(item=>{var _item$target;return external_kbnSharedDeps_React_default.a.createElement(FieldMappingRowStatic,{key:`${item.source}`,securitySolutionField:item.source,isLoading:isLoading,selectedActionType:item.actionType,selectedThirdParty:(_item$target=item.target)!==null&&_item$target!==void 0?_item$target:"not_mapped"})})))):null};const FieldMapping=external_kbnSharedDeps_React_default.a.memo(FieldMappingComponent);const MappingComponent=({connectorActionTypeId:connectorActionTypeId,isLoading:isLoading,mappings:mappings})=>{const selectedConnector=Object(external_kbnSharedDeps_React_["useMemo"])(()=>components_connectors["a"][connectorActionTypeId],[connectorActionTypeId]);const fieldMappingDesc=Object(external_kbnSharedDeps_React_["useMemo"])(()=>mappings.length>0||isLoading?{desc:configure_cases_translations["g"](selectedConnector.name),color:"subdued"}:{desc:configure_cases_translations["h"](selectedConnector.name),color:"danger"},[isLoading,mappings.length,selectedConnector.name]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h4",null,configure_cases_translations["l"](selectedConnector.name)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTextColor"],{"data-test-subj":"field-mapping-desc",color:fieldMappingDesc.color},fieldMappingDesc.desc))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(FieldMapping,{connectorActionTypeId:connectorActionTypeId,"data-test-subj":"case-mappings-field",isLoading:isLoading,mappings:mappings})))};const Mapping=external_kbnSharedDeps_React_default.a.memo(MappingComponent);var api_connectors=__webpack_require__(10);const EuiFormRowExtended=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFormRow"]).withConfig({displayName:"EuiFormRowExtended",componentId:"iiz1mi-0"})([".euiFormRow__labelWrapper{.euiFormRow__label{width:100%;}}"]);const ConnectorsComponent=({connectors:connectors,disabled:disabled,handleShowEditFlyout:handleShowEditFlyout,isLoading:isLoading,mappings:mappings,onChangeConnector:onChangeConnector,selectedConnector:selectedConnector,updateConnectorDisabled:updateConnectorDisabled})=>{const connectorsName=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _connectors$find$name,_connectors$find;return(_connectors$find$name=(_connectors$find=connectors.find(c=>c.id===selectedConnector.id))===null||_connectors$find===void 0?void 0:_connectors$find.name)!==null&&_connectors$find$name!==void 0?_connectors$find$name:"none"},[connectors,selectedConnector.id]);const dropDownLabel=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},configure_cases_translations["n"]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},connectorsName!=="none"&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{disabled:updateConnectorDisabled,onClick:handleShowEditFlyout,"data-test-subj":"case-configure-update-selected-connector-button"},configure_cases_translations["q"](connectorsName)))),[connectorsName,handleShowEditFlyout,updateConnectorDisabled]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescribedFormGroup"],{fullWidth:true,title:external_kbnSharedDeps_React_default.a.createElement("h3",null,configure_cases_translations["o"]),description:configure_cases_translations["m"],"data-test-subj":"case-connectors-form-group"},external_kbnSharedDeps_React_default.a.createElement(EuiFormRowExtended,{fullWidth:true,label:dropDownLabel,"data-test-subj":"case-connectors-form-row"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(connectors_dropdown["a"],{connectors:connectors,disabled:disabled,selectedConnector:selectedConnector.id,isLoading:isLoading,onChange:onChangeConnector,"data-test-subj":"case-connectors-dropdown",appendAddConnectorButton:true})),selectedConnector.type!==api_connectors["c"].none?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(Mapping,{connectorActionTypeId:selectedConnector.type,isLoading:isLoading,mappings:mappings})):null))))};const Connectors=external_kbnSharedDeps_React_default.a.memo(ConnectorsComponent);const radios=[{id:"close-by-user",label:configure_cases_translations["d"]},{id:"close-by-pushing",label:configure_cases_translations["e"]}];const ClosureOptionsRadioComponent=({closureTypeSelected:closureTypeSelected,disabled:disabled,onChangeClosureType:onChangeClosureType})=>{const onChangeLocal=Object(external_kbnSharedDeps_React_["useCallback"])(id=>{onChangeClosureType(id)},[onChangeClosureType]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiRadioGroup"],{disabled:disabled,options:radios,idSelected:closureTypeSelected,onChange:onChangeLocal,name:"closure_options","data-test-subj":"closure-options-radio-group"})};const ClosureOptionsRadio=external_kbnSharedDeps_React_default.a.memo(ClosureOptionsRadioComponent);const ClosureOptionsComponent=({closureTypeSelected:closureTypeSelected,disabled:disabled,onChangeClosureType:onChangeClosureType})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescribedFormGroup"],{fullWidth:true,title:external_kbnSharedDeps_React_default.a.createElement("h3",null,configure_cases_translations["f"]),description:external_kbnSharedDeps_React_default.a.createElement("p",null,configure_cases_translations["b"]),"data-test-subj":"case-closure-options-form-group"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true,label:configure_cases_translations["c"],"data-test-subj":"case-closure-options-form-row"},external_kbnSharedDeps_React_default.a.createElement(ClosureOptionsRadio,{closureTypeSelected:closureTypeSelected,disabled:disabled,onChangeClosureType:onChangeClosureType,"data-test-subj":"case-closure-options-radio"})));const ClosureOptions=external_kbnSharedDeps_React_default.a.memo(ClosureOptionsComponent);const FormWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"FormWrapper",componentId:"ox2hsq-0"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_["css"])(["& > *{margin-top 40px;}& >:first-child{margin-top:0;}padding-top:",";padding-bottom:",";.euiFlyout{z-index:",";}"],theme.eui.paddingSizes.xl,theme.eui.paddingSizes.xl,theme.eui.euiZNavigation+1));const ConfigureCasesComponent=({userCanCrud:userCanCrud})=>{const{triggersActionsUi:triggersActionsUi}=Object(lib_kibana["h"])().services;const[connectorIsValid,setConnectorIsValid]=Object(external_kbnSharedDeps_React_["useState"])(true);const[addFlyoutVisible,setAddFlyoutVisibility]=Object(external_kbnSharedDeps_React_["useState"])(false);const[editFlyoutVisible,setEditFlyoutVisibility]=Object(external_kbnSharedDeps_React_["useState"])(false);const[editedConnectorItem,setEditedConnectorItem]=Object(external_kbnSharedDeps_React_["useState"])(null);const{connector:connector,closureType:closureType,loading:loadingCaseConfigure,mappings:mappings,persistLoading:persistLoading,persistCaseConfigure:persistCaseConfigure,refetchCaseConfigure:refetchCaseConfigure,setConnector:setConnector,setClosureType:setClosureType}=Object(use_configure["a"])();const{loading:isLoadingConnectors,connectors:connectors,refetchConnectors:refetchConnectors}=Object(use_connectors["a"])();const{loading:isLoadingActionTypes,actionTypes:actionTypes,refetchActionTypes:refetchActionTypes}=useActionTypes();const supportedActionTypes=Object(external_kbnSharedDeps_React_["useMemo"])(()=>actionTypes.filter(actionType=>common_constants["q"].includes(actionType.id)),[actionTypes]);const onConnectorUpdate=Object(external_kbnSharedDeps_React_["useCallback"])(async()=>{refetchConnectors();refetchActionTypes();refetchCaseConfigure()},[refetchActionTypes,refetchCaseConfigure,refetchConnectors]);const isLoadingAny=isLoadingConnectors||persistLoading||loadingCaseConfigure||isLoadingActionTypes;const updateConnectorDisabled=isLoadingAny||!connectorIsValid||connector.id==="none";const onClickUpdateConnector=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setEditFlyoutVisibility(true)},[]);const onCloseAddFlyout=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setAddFlyoutVisibility(false),[setAddFlyoutVisibility]);const onCloseEditFlyout=Object(external_kbnSharedDeps_React_["useCallback"])(()=>setEditFlyoutVisibility(false),[]);const onChangeConnector=Object(external_kbnSharedDeps_React_["useCallback"])(id=>{if(id==="add-connector"){setAddFlyoutVisibility(true);return}const actionConnector=Object(configure_cases_utils["a"])(id,connectors);const caseConnector=actionConnector!=null?Object(configure_cases_utils["c"])(actionConnector):Object(configure_cases_utils["b"])();setConnector(caseConnector);persistCaseConfigure({connector:caseConnector,closureType:closureType})},[connectors,closureType,persistCaseConfigure,setConnector]);const onChangeClosureType=Object(external_kbnSharedDeps_React_["useCallback"])(type=>{setClosureType(type);persistCaseConfigure({connector:connector,closureType:type})},[connector,persistCaseConfigure,setClosureType]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!isLoadingConnectors&&connector.id!=="none"&&!connectors.some(c=>c.id===connector.id)){setConnectorIsValid(false)}else if(!isLoadingConnectors&&(connector.id==="none"||connectors.some(c=>c.id===connector.id))){setConnectorIsValid(true)}},[connectors,connector,isLoadingConnectors]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(!isLoadingConnectors&&connector.id!=="none"){setEditedConnectorItem(Object(configure_cases_utils["d"])(connectors,connector))}},[connectors,connector,isLoadingConnectors]);const ConnectorAddFlyout=Object(external_kbnSharedDeps_React_["useMemo"])(()=>triggersActionsUi.getAddConnectorFlyout({consumer:"case",onClose:onCloseAddFlyout,actionTypes:supportedActionTypes,reloadConnectors:onConnectorUpdate}),[supportedActionTypes]);const ConnectorEditFlyout=Object(external_kbnSharedDeps_React_["useMemo"])(()=>editedConnectorItem&&editFlyoutVisible?triggersActionsUi.getEditConnectorFlyout({initialConnector:editedConnectorItem,consumer:"case",onClose:onCloseEditFlyout,reloadConnectors:onConnectorUpdate}):null,[connector.id,editFlyoutVisible]);return external_kbnSharedDeps_React_default.a.createElement(FormWrapper,null,!connectorIsValid&&external_kbnSharedDeps_React_default.a.createElement(SectionWrapper,{style:{marginTop:0}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:configure_cases_translations["s"],color:"warning",iconType:"help","data-test-subj":"configure-cases-warning-callout"},configure_cases_translations["r"])),external_kbnSharedDeps_React_default.a.createElement(SectionWrapper,null,external_kbnSharedDeps_React_default.a.createElement(ClosureOptions,{closureTypeSelected:closureType,disabled:persistLoading||isLoadingConnectors||!userCanCrud,onChangeClosureType:onChangeClosureType})),external_kbnSharedDeps_React_default.a.createElement(SectionWrapper,null,external_kbnSharedDeps_React_default.a.createElement(Connectors,{connectors:connectors!==null&&connectors!==void 0?connectors:[],disabled:persistLoading||isLoadingConnectors||!userCanCrud,handleShowEditFlyout:onClickUpdateConnector,isLoading:isLoadingAny,mappings:mappings,onChangeConnector:onChangeConnector,selectedConnector:connector,updateConnectorDisabled:updateConnectorDisabled||!userCanCrud})),addFlyoutVisible&&ConnectorAddFlyout,ConnectorEditFlyout)};const ConfigureCases=external_kbnSharedDeps_React_default.a.memo(ConfigureCasesComponent);const ConfigureCasesPageComponent=()=>{var _userPermissions$crud;const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const userPermissions=Object(lib_kibana["f"])();const search=Object(use_get_url_search["a"])(home_navigations["a"].case);const backOptions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({href:Object(link_to["d"])(search),text:pages_translations["a"],pageId:app_types["a"].case}),[search]);if(userPermissions!=null&&!userPermissions.read){history.push(Object(link_to["d"])(search));return null}const HeaderWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"HeaderWrapper",componentId:"ty9qqa-0"})(["padding-top:",";"],({theme:theme})=>theme.eui.paddingSizes.l);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],{noPadding:true},external_kbnSharedDeps_React_default.a.createElement(SectionWrapper,null,external_kbnSharedDeps_React_default.a.createElement(HeaderWrapper,null,external_kbnSharedDeps_React_default.a.createElement(case_header_page["a"],{title:pages_translations["b"],backOptions:backOptions}))),external_kbnSharedDeps_React_default.a.createElement(WhitePageWrapper,null,external_kbnSharedDeps_React_default.a.createElement(ConfigureCases,{userCanCrud:(_userPermissions$crud=userPermissions===null||userPermissions===void 0?void 0:userPermissions.crud)!==null&&_userPermissions$crud!==void 0?_userPermissions$crud:false}))),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].case}))};const ConfigureCasesPage=external_kbnSharedDeps_React_default.a.memo(ConfigureCasesPageComponent);const casesPagePath="";const caseDetailsPagePath=`${casesPagePath}/:detailName`;const caseDetailsPagePathWithCommentId=`${caseDetailsPagePath}/:commentId`;const createCasePagePath=`${casesPagePath}/create`;const configureCasesPagePath=`${casesPagePath}/configure`;const CaseContainerComponent=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:createCasePagePath},external_kbnSharedDeps_React_default.a.createElement(CreateCasePage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:configureCasesPagePath},external_kbnSharedDeps_React_default.a.createElement(ConfigureCasesPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{exact:true,path:caseDetailsPagePathWithCommentId},external_kbnSharedDeps_React_default.a.createElement(CaseDetailsPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:caseDetailsPagePath},external_kbnSharedDeps_React_default.a.createElement(CaseDetailsPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{strict:true,exact:true,path:casesPagePath},external_kbnSharedDeps_React_default.a.createElement(CasesPage,null)));const Case=external_kbnSharedDeps_React_default.a.memo(CaseContainerComponent);const CasesRoutes=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/"},external_kbnSharedDeps_React_default.a.createElement(Case,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{render:()=>external_kbnSharedDeps_React_default.a.createElement(_404["a"],null)}));class cases_Cases{setup(){}start(){return{SubPluginRoutes:CasesRoutes}}}var search_strategy=__webpack_require__(120);var last_event_time=__webpack_require__(405);var anomaly_table_provider=__webpack_require__(708);var host_to_criteria=__webpack_require__(710);var has_ml_user_permissions=__webpack_require__(210);var score_interval_to_datetime=__webpack_require__(247);var navigation=__webpack_require__(323);var containers_helpers=__webpack_require__(129);const ERROR_HOSTS_KPI_AUTHENTICATIONS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.hostsKpiAuthentications.errorSearchDescription",{defaultMessage:`An error has occurred on hosts kpi authentications search`});const FAIL_HOSTS_KPI_AUTHENTICATIONS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.hostsKpiAuthentications.failSearchDescription",{defaultMessage:`Failed to run search on hosts kpi authentications`});var public_helpers=__webpack_require__(38);const authentications_ID="hostsKpiAuthenticationsQuery";const useHostsKpiAuthentications=({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=false,startDate:startDate})=>{const{data:data,notifications:notifications}=Object(lib_kibana["h"])().services;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const searchSubscription$=Object(external_kbnSharedDeps_React_["useRef"])(new external_kbnSharedDeps_Rxjs_["Subscription"]);const[loading,setLoading]=Object(external_kbnSharedDeps_React_["useState"])(false);const[hostsKpiAuthenticationsRequest,setHostsKpiAuthenticationsRequest]=Object(external_kbnSharedDeps_React_["useState"])(null);const[hostsKpiAuthenticationsResponse,setHostsKpiAuthenticationsResponse]=Object(external_kbnSharedDeps_React_["useState"])({authenticationsSuccess:0,authenticationsSuccessHistogram:[],authenticationsFailure:0,authenticationsFailureHistogram:[],id:authentications_ID,inspect:{dsl:[],response:[]},isInspected:false,refetch:refetch.current});const hostsKpiAuthenticationsSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{if(request==null||skip){return}const asyncSearch=async()=>{abortCtrl.current=new AbortController;setLoading(true);searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(!response.isPartial&&!response.isRunning){setLoading(false);setHostsKpiAuthenticationsResponse(prevResponse=>({...prevResponse,authenticationsSuccess:response.authenticationsSuccess,authenticationsSuccessHistogram:response.authenticationsSuccessHistogram,authenticationsFailure:response.authenticationsFailure,authenticationsFailureHistogram:response.authenticationsFailureHistogram,inspect:Object(public_helpers["a"])(response,prevResponse.inspect),refetch:refetch.current}));searchSubscription$.current.unsubscribe()}else if(response.isPartial&&!response.isRunning){setLoading(false);notifications.toasts.addWarning(ERROR_HOSTS_KPI_AUTHENTICATIONS);searchSubscription$.current.unsubscribe()}},error:msg=>{setLoading(false);notifications.toasts.addDanger({title:FAIL_HOSTS_KPI_AUTHENTICATIONS,text:msg.message});searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch},[data.search,notifications.toasts,skip]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setHostsKpiAuthenticationsRequest(prevRequest=>{const myRequest={...prevRequest!==null&&prevRequest!==void 0?prevRequest:{},defaultIndex:indexNames,factoryQueryType:search_strategy["HostsKpiQueries"].kpiAuthentications,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}};if(!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[indexNames,endDate,filterQuery,startDate]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{hostsKpiAuthenticationsSearch(hostsKpiAuthenticationsRequest);return()=>{searchSubscription$.current.unsubscribe();abortCtrl.current.abort()}},[hostsKpiAuthenticationsRequest,hostsKpiAuthenticationsSearch]);return[loading,hostsKpiAuthenticationsResponse]};var manage_query=__webpack_require__(135);var chart_place_holder=__webpack_require__(612);var common=__webpack_require__(360);const getSeriesLineStyle=()=>({area:{opacity:.04,visible:true},line:{strokeWidth:1,visible:true},point:{visible:false,radius:.2,strokeWidth:1,opacity:1}});const checkIfAllTheDataInTheSeriesAreValid=series=>!!Object(external_kbnSharedDeps_LodashFp_["get"])("value.length",series)&&Object(external_kbnSharedDeps_LodashFp_["get"])("value",series).every(({x:x,y:y})=>!Object(external_kbnSharedDeps_LodashFp_["isNull"])(x)&&Object(external_kbnSharedDeps_LodashFp_["isNumber"])(y)&&y>0);const checkIfAnyValidSeriesExist=data=>Array.isArray(data)&&data.some(checkIfAllTheDataInTheSeriesAreValid);const axisStyle={tickLine:{visible:false},tickLabel:{padding:3}};const AreaChartBaseComponent=({data:data,...chartConfigs})=>{const theme=Object(common["f"])();const timeZone=Object(lib_kibana["i"])();const xTickFormatter=Object(external_kbnSharedDeps_LodashFp_["get"])("configs.axis.xTickFormatter",chartConfigs);const yTickFormatter=Object(external_kbnSharedDeps_LodashFp_["get"])("configs.axis.yTickFormatter",chartConfigs);const xAxisId=`group-${data[0].key}-x`;const yAxisId=`group-${data[0].key}-y`;const settings={...common["b"],theme:theme,...Object(external_kbnSharedDeps_LodashFp_["get"])("configs.settings",chartConfigs)};return chartConfigs.width&&chartConfigs.height?external_kbnSharedDeps_React_default.a.createElement("div",{style:{height:chartConfigs.height,width:chartConfigs.width,position:"relative"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Chart"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Settings"],settings),data.map(series=>{const seriesKey=series.key;return checkIfAllTheDataInTheSeriesAreValid(series)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["AreaSeries"],{id:seriesKey,key:seriesKey,name:series.key.replace("Histogram",""),data:series.value||[],xScaleType:Object(external_kbnSharedDeps_LodashFp_["getOr"])(external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear,"configs.series.xScaleType",chartConfigs),yScaleType:Object(external_kbnSharedDeps_LodashFp_["getOr"])(external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear,"configs.series.yScaleType",chartConfigs),timeZone:timeZone,xAccessor:"x",yAccessors:["y"],areaSeriesStyle:getSeriesLineStyle(),color:series.color?series.color:undefined}):null}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Axis"],{id:xAxisId,position:external_kbnSharedDeps_ElasticCharts_["Position"].Bottom,showOverlappingTicks:false,tickFormat:xTickFormatter,style:axisStyle}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_["Axis"],{id:yAxisId,position:external_kbnSharedDeps_ElasticCharts_["Position"].Left,style:axisStyle,tickFormat:yTickFormatter}))):null};AreaChartBaseComponent.displayName="AreaChartBaseComponent";const AreaChartBase=external_kbnSharedDeps_React_default.a.memo(AreaChartBaseComponent);AreaChartBase.displayName="AreaChartBase";const AreaChartComponent=({areaChart:areaChart,configs:configs})=>{const{ref:measureRef,width:width,height:height}=Object(components_utils["b"])();const customHeight=Object(external_kbnSharedDeps_LodashFp_["get"])("customHeight",configs);const customWidth=Object(external_kbnSharedDeps_LodashFp_["get"])("customWidth",configs);const chartHeight=Object(common["d"])(customHeight,height);const chartWidth=Object(common["e"])(customWidth,width);return checkIfAnyValidSeriesExist(areaChart)?external_kbnSharedDeps_React_default.a.createElement(common["a"],{ref:measureRef,height:chartHeight},external_kbnSharedDeps_React_default.a.createElement(AreaChartBase,{data:areaChart,height:chartHeight,width:chartWidth,configs:configs})):external_kbnSharedDeps_React_default.a.createElement(chart_place_holder["a"],{height:chartHeight,width:chartWidth,data:areaChart})};const AreaChart=external_kbnSharedDeps_React_default.a.memo(AreaChartComponent);var components_inspect=__webpack_require__(189);const FlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"FlexItem",componentId:"sc-1rm4ik7-0"})(["min-width:0;"]);FlexItem.displayName="FlexItem";const StatValue=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiTitle"]).withConfig({displayName:"StatValue",componentId:"sc-1rm4ik7-1"})(["overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"]);StatValue.displayName="StatValue";const numberFormatter=value=>value.toLocaleString();const statItemBarchartRotation=90;const statItemChartCustomHeight=74;const areachartConfigs=config=>({series:{xScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Time,yScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear},axis:{xTickFormatter:Object(external_kbnSharedDeps_LodashFp_["get"])("xTickFormatter",config),yTickFormatter:numberFormatter},settings:{onBrushEnd:Object(external_kbnSharedDeps_LodashFp_["getOr"])(()=>{},"onBrushEnd",config)},customHeight:statItemChartCustomHeight});const barchartConfigs=config=>({series:{xScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Ordinal,yScaleType:external_kbnSharedDeps_ElasticCharts_["ScaleType"].Linear,stackAccessors:["y0"]},axis:{xTickFormatter:numberFormatter},settings:{onElementClick:Object(external_kbnSharedDeps_LodashFp_["getOr"])(()=>{},"onElementClick",config),rotation:statItemBarchartRotation},customHeight:statItemChartCustomHeight});const addValueToFields=(fields,data)=>fields.map(field=>({...field,value:Object(external_kbnSharedDeps_LodashFp_["get"])(field.key,data)}));const addValueToAreaChart=(fields,data)=>fields.filter(field=>Object(external_kbnSharedDeps_LodashFp_["get"])(`${field.key}Histogram`,data)!=null).map(field=>({...field,value:Object(external_kbnSharedDeps_LodashFp_["get"])(`${field.key}Histogram`,data),key:`${field.key}Histogram`}));const addValueToBarChart=(fields,data)=>{if(fields.length===0)return[];return fields.reduce((acc,field,idx)=>{const{key:key,color:color}=field;const y=Object(external_kbnSharedDeps_LodashFp_["getOr"])(null,key,data);const x=Object(external_kbnSharedDeps_LodashFp_["get"])(`${idx}.name`,fields)||Object(external_kbnSharedDeps_LodashFp_["getOr"])("",`${idx}.description`,fields);const value=[{x:x,y:y,g:key,y0:0}];return[...acc,{key:key,color:color,value:value}]},[])};const useKpiMatrixStatus=(mappings,data,id,from,to,narrowDateRange)=>{const[statItemsProps,setStatItemsProps]=Object(external_kbnSharedDeps_React_["useState"])(mappings);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setStatItemsProps(mappings.map(stat=>({...stat,areaChart:stat.enableAreaChart?addValueToAreaChart(stat.fields,data):undefined,barChart:stat.enableBarChart?addValueToBarChart(stat.fields,data):undefined,fields:addValueToFields(stat.fields,data),id:id,key:`kpi-summary-${stat.key}`,statKey:`${stat.key}`,from:from,to:to,narrowDateRange:narrowDateRange})))},[data]);return statItemsProps};const StatItemsComponent=external_kbnSharedDeps_React_default.a.memo(({areaChart:areaChart,barChart:barChart,description:description,enableAreaChart:enableAreaChart,enableBarChart:enableBarChart,fields:fields,from:from,grow:grow,id:id,index:index,narrowDateRange:narrowDateRange,statKey:statKey="item",to:to})=>{const isBarChartDataAvailable=barChart&&barChart.length&&barChart.every(item=>item.value!=null&&item.value.length>0);const isAreaChartDataAvailable=areaChart&&areaChart.length&&areaChart.every(item=>item.value!=null&&item.value.length>0);return external_kbnSharedDeps_React_default.a.createElement(FlexItem,{grow:grow,"data-test-subj":`stat-${statKey}`},external_kbnSharedDeps_React_default.a.createElement(components_inspect["b"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xxxs"},external_kbnSharedDeps_React_default.a.createElement("h6",null,description))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(components_inspect["a"],{queryId:id,title:`KPI ${description}`,inspectIndex:index}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,fields.map(field=>external_kbnSharedDeps_React_default.a.createElement(FlexItem,{key:`stat-items-field-${field.key}`},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"m",responsive:false},(isAreaChartDataAvailable||isBarChartDataAvailable)&&field.icon&&external_kbnSharedDeps_React_default.a.createElement(FlexItem,{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:field.icon,color:field.color,size:"l","data-test-subj":"stat-icon"})),external_kbnSharedDeps_React_default.a.createElement(FlexItem,null,external_kbnSharedDeps_React_default.a.createElement(StatValue,null,external_kbnSharedDeps_React_default.a.createElement("p",{"data-test-subj":"stat-title"},field.value!=null?field.value.toLocaleString():Object(empty_value["d"])()," ",field.description))))))),(enableAreaChart||enableBarChart)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,enableBarChart&&external_kbnSharedDeps_React_default.a.createElement(FlexItem,null,external_kbnSharedDeps_React_default.a.createElement(barchart["a"],{barChart:barChart,configs:barchartConfigs()})),enableAreaChart&&from!=null&&to!=null&&external_kbnSharedDeps_React_default.a.createElement(FlexItem,null,external_kbnSharedDeps_React_default.a.createElement(AreaChart,{areaChart:areaChart,configs:areachartConfigs({xTickFormatter:Object(components_utils["a"])([from,to]),onBrushEnd:narrowDateRange})}))))))},(prevProps,nextProps)=>prevProps.description===nextProps.description&&prevProps.enableAreaChart===nextProps.enableAreaChart&&prevProps.enableBarChart===nextProps.enableBarChart&&prevProps.from===nextProps.from&&prevProps.grow===nextProps.grow&&prevProps.id===nextProps.id&&prevProps.index===nextProps.index&&prevProps.narrowDateRange===nextProps.narrowDateRange&&prevProps.statKey===nextProps.statKey&&prevProps.to===nextProps.to&&fast_deep_equal_default()(prevProps.areaChart,nextProps.areaChart)&&fast_deep_equal_default()(prevProps.barChart,nextProps.barChart)&&fast_deep_equal_default()(prevProps.fields,nextProps.fields));StatItemsComponent.displayName="StatItemsComponent";const kpiWidgetHeight=247;const FlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"FlexGroup",componentId:"sc-17i7jd7-0"})(["min-height:","px;"],kpiWidgetHeight);FlexGroup.displayName="FlexGroup";const HostsKpiBaseComponent=external_kbnSharedDeps_React_default.a.memo(({fieldsMapping:fieldsMapping,data:data,id:id,loading:loading=false,from:from,to:to,narrowDateRange:narrowDateRange})=>{const statItemsProps=useKpiMatrixStatus(fieldsMapping,data,id,from,to,narrowDateRange);if(loading){return external_kbnSharedDeps_React_default.a.createElement(FlexGroup,{justifyContent:"center",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"xl"})))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true},statItemsProps.map(mappedStatItemProps=>external_kbnSharedDeps_React_default.a.createElement(StatItemsComponent,mappedStatItemProps)))},(prevProps,nextProps)=>prevProps.fieldsMapping===nextProps.fieldsMapping&&prevProps.id===nextProps.id&&prevProps.loading===nextProps.loading&&prevProps.from===nextProps.from&&prevProps.to===nextProps.to&&prevProps.narrowDateRange===nextProps.narrowDateRange&&fast_deep_equal_default()(prevProps.data,nextProps.data));HostsKpiBaseComponent.displayName="HostsKpiBaseComponent";const HostsKpiBaseComponentManage=Object(manage_query["a"])(HostsKpiBaseComponent);var kpi_hosts_types=__webpack_require__(363);const USER_AUTHENTICATIONS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiHosts.userAuthentications.title",{defaultMessage:"User authentications"});const SUCCESS_UNIT_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiHosts.userAuthentications.successUnitLabel",{defaultMessage:"success"});const FAIL_UNIT_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiHosts.userAuthentications.failUnitLabel",{defaultMessage:"fail"});const SUCCESS_CHART_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiHosts.userAuthentications.successChartLabel",{defaultMessage:"Succ."});const FAIL_CHART_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiHosts.userAuthentications.failChartLabel",{defaultMessage:"Fail"});const authentications_fieldsMapping=[{key:"authentication",fields:[{key:"authenticationsSuccess",name:SUCCESS_CHART_LABEL,description:SUCCESS_UNIT_LABEL,value:null,color:kpi_hosts_types["a"].authenticationsSuccess,icon:"check"},{key:"authenticationsFailure",name:FAIL_CHART_LABEL,description:FAIL_UNIT_LABEL,value:null,color:kpi_hosts_types["a"].authenticationsFailure,icon:"cross"}],enableAreaChart:true,enableBarChart:true,description:USER_AUTHENTICATIONS}];const HostsKpiAuthenticationsComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const[loading,{refetch:refetch,id:id,inspect:inspect,...data}]=useHostsKpiAuthentications({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip});return external_kbnSharedDeps_React_default.a.createElement(HostsKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:authentications_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})};HostsKpiAuthenticationsComponent.displayName="HostsKpiAuthenticationsComponent";const HostsKpiAuthentications=external_kbnSharedDeps_React_default.a.memo(HostsKpiAuthenticationsComponent);const ERROR_HOSTS_KPI_HOSTS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.hostsKpiHosts.errorSearchDescription",{defaultMessage:`An error has occurred on hosts kpi hosts search`});const FAIL_HOSTS_KPI_HOSTS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.hostsKpiHosts.failSearchDescription",{defaultMessage:`Failed to run search on hosts kpi hosts`});const hosts_ID="hostsKpiHostsQuery";const useHostsKpiHosts=({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=false,startDate:startDate})=>{const{data:data,notifications:notifications}=Object(lib_kibana["h"])().services;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const searchSubscription$=Object(external_kbnSharedDeps_React_["useRef"])(new external_kbnSharedDeps_Rxjs_["Subscription"]);const[loading,setLoading]=Object(external_kbnSharedDeps_React_["useState"])(false);const[hostsKpiHostsRequest,setHostsKpiHostsRequest]=Object(external_kbnSharedDeps_React_["useState"])(null);const[hostsKpiHostsResponse,setHostsKpiHostsResponse]=Object(external_kbnSharedDeps_React_["useState"])({hosts:0,hostsHistogram:[],id:hosts_ID,inspect:{dsl:[],response:[]},isInspected:false,refetch:refetch.current});const hostsKpiHostsSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{if(request==null||skip){return}const asyncSearch=async()=>{abortCtrl.current=new AbortController;setLoading(true);searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(!response.isPartial&&!response.isRunning){setLoading(false);setHostsKpiHostsResponse(prevResponse=>({...prevResponse,hosts:response.hosts,hostsHistogram:response.hostsHistogram,inspect:Object(public_helpers["a"])(response,prevResponse.inspect),refetch:refetch.current}));searchSubscription$.current.unsubscribe()}else if(response.isPartial&&!response.isRunning){setLoading(false);notifications.toasts.addWarning(ERROR_HOSTS_KPI_HOSTS);searchSubscription$.current.unsubscribe()}},error:msg=>{setLoading(false);notifications.toasts.addDanger({title:FAIL_HOSTS_KPI_HOSTS,text:msg.message});searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch},[data.search,notifications.toasts,skip]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setHostsKpiHostsRequest(prevRequest=>{const myRequest={...prevRequest!==null&&prevRequest!==void 0?prevRequest:{},defaultIndex:indexNames,factoryQueryType:search_strategy["HostsKpiQueries"].kpiHosts,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}};if(!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[indexNames,endDate,filterQuery,startDate]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{hostsKpiHostsSearch(hostsKpiHostsRequest);return()=>{searchSubscription$.current.unsubscribe();abortCtrl.current.abort()}},[hostsKpiHostsRequest,hostsKpiHostsSearch]);return[loading,hostsKpiHostsResponse]};const HOSTS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiHosts.hosts.title",{defaultMessage:"Hosts"});const hosts_fieldsMapping=[{key:"hosts",fields:[{key:"hosts",value:null,color:kpi_hosts_types["a"].hosts,icon:"storage"}],enableAreaChart:true,description:HOSTS}];const HostsKpiHostsComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const[loading,{refetch:refetch,id:id,inspect:inspect,...data}]=useHostsKpiHosts({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip});return external_kbnSharedDeps_React_default.a.createElement(HostsKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:hosts_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})};const HostsKpiHosts=external_kbnSharedDeps_React_default.a.memo(HostsKpiHostsComponent);const ERROR_HOSTS_KPI_UNIQUE_IPS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.hostsKpiUniqueIps.errorSearchDescription",{defaultMessage:`An error has occurred on hosts kpi unique ips search`});const FAIL_HOSTS_KPI_UNIQUE_IPS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.hostsKpiUniqueIps.failSearchDescription",{defaultMessage:`Failed to run search on hosts kpi unique ips`});const unique_ips_ID="hostsKpiUniqueIpsQuery";const useHostsKpiUniqueIps=({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=false,startDate:startDate})=>{const{data:data,notifications:notifications}=Object(lib_kibana["h"])().services;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const searchSubscription$=Object(external_kbnSharedDeps_React_["useRef"])(new external_kbnSharedDeps_Rxjs_["Subscription"]);const[loading,setLoading]=Object(external_kbnSharedDeps_React_["useState"])(false);const[hostsKpiUniqueIpsRequest,setHostsKpiUniqueIpsRequest]=Object(external_kbnSharedDeps_React_["useState"])(null);const[hostsKpiUniqueIpsResponse,setHostsKpiUniqueIpsResponse]=Object(external_kbnSharedDeps_React_["useState"])({uniqueSourceIps:0,uniqueSourceIpsHistogram:[],uniqueDestinationIps:0,uniqueDestinationIpsHistogram:[],id:unique_ips_ID,inspect:{dsl:[],response:[]},isInspected:false,refetch:refetch.current});const hostsKpiUniqueIpsSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{if(request==null||skip){return}const asyncSearch=async()=>{abortCtrl.current=new AbortController;setLoading(true);searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(!response.isPartial&&!response.isRunning){setLoading(false);setHostsKpiUniqueIpsResponse(prevResponse=>({...prevResponse,uniqueSourceIps:response.uniqueSourceIps,uniqueSourceIpsHistogram:response.uniqueSourceIpsHistogram,uniqueDestinationIps:response.uniqueDestinationIps,uniqueDestinationIpsHistogram:response.uniqueDestinationIpsHistogram,inspect:Object(public_helpers["a"])(response,prevResponse.inspect),refetch:refetch.current}));searchSubscription$.current.unsubscribe()}else if(response.isPartial&&!response.isRunning){setLoading(false);notifications.toasts.addWarning(ERROR_HOSTS_KPI_UNIQUE_IPS);searchSubscription$.current.unsubscribe()}},error:msg=>{setLoading(false);notifications.toasts.addDanger({title:FAIL_HOSTS_KPI_UNIQUE_IPS,text:msg.message});searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch},[data.search,notifications.toasts,skip]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setHostsKpiUniqueIpsRequest(prevRequest=>{const myRequest={...prevRequest!==null&&prevRequest!==void 0?prevRequest:{},defaultIndex:indexNames,factoryQueryType:search_strategy["HostsKpiQueries"].kpiUniqueIps,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}};if(!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[indexNames,endDate,filterQuery,skip,startDate]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{hostsKpiUniqueIpsSearch(hostsKpiUniqueIpsRequest);return()=>{searchSubscription$.current.unsubscribe();abortCtrl.current.abort()}},[hostsKpiUniqueIpsRequest,hostsKpiUniqueIpsSearch]);return[loading,hostsKpiUniqueIpsResponse]};const UNIQUE_IPS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiHosts.uniqueIps.title",{defaultMessage:"Unique IPs"});const SOURCE_UNIT_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiHosts.uniqueIps.sourceUnitLabel",{defaultMessage:"source"});const DESTINATION_UNIT_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiHosts.uniqueIps.destinationUnitLabel",{defaultMessage:"destination"});const SOURCE_CHART_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiHosts.uniqueIps.sourceChartLabel",{defaultMessage:"Src."});const DESTINATION_CHART_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiHosts.uniqueIps.destinationChartLabel",{defaultMessage:"Dest."});const unique_ips_fieldsMapping=[{key:"uniqueIps",fields:[{key:"uniqueSourceIps",name:SOURCE_CHART_LABEL,description:SOURCE_UNIT_LABEL,value:null,color:kpi_hosts_types["a"].uniqueSourceIps,icon:"visMapCoordinate"},{key:"uniqueDestinationIps",name:DESTINATION_CHART_LABEL,description:DESTINATION_UNIT_LABEL,value:null,color:kpi_hosts_types["a"].uniqueDestinationIps,icon:"visMapCoordinate"}],enableAreaChart:true,enableBarChart:true,description:UNIQUE_IPS}];const HostsKpiUniqueIpsComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const[loading,{refetch:refetch,id:id,inspect:inspect,...data}]=useHostsKpiUniqueIps({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip});return external_kbnSharedDeps_React_default.a.createElement(HostsKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:unique_ips_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})};const HostsKpiUniqueIps=external_kbnSharedDeps_React_default.a.memo(HostsKpiUniqueIpsComponent);const HostsKpiComponent=external_kbnSharedDeps_React_default.a.memo(({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,setQuery:setQuery,skip:skip,narrowDateRange:narrowDateRange})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(HostsKpiHosts,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:2},external_kbnSharedDeps_React_default.a.createElement(HostsKpiAuthentications,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:2},external_kbnSharedDeps_React_default.a.createElement(HostsKpiUniqueIps,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip}))));HostsKpiComponent.displayName="HostsKpiComponent";const HostsDetailsKpiComponent=external_kbnSharedDeps_React_default.a.memo(({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,setQuery:setQuery,skip:skip,narrowDateRange:narrowDateRange})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(HostsKpiAuthentications,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(HostsKpiUniqueIps,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip}))));HostsDetailsKpiComponent.displayName="HostsDetailsKpiComponent";var host_overview=__webpack_require__(755);var hosts_details=__webpack_require__(767);var store_actions=__webpack_require__(361);var store_model=__webpack_require__(141);var anomalies_query_tab_body=__webpack_require__(404);var use_anomalies_table_data=__webpack_require__(324);var tables_translations=__webpack_require__(390);var tables_helpers=__webpack_require__(183);var entity_draggable=__webpack_require__(723);var create_compound_key=__webpack_require__(724);var get_entries=__webpack_require__(311);var draggable_score=__webpack_require__(484);var create_explorer_link=__webpack_require__(485);var drag_and_drop_helpers=__webpack_require__(116);const getAnomaliesHostTableColumns=(startDate,endDate,interval,narrowDateRange)=>[{name:tables_translations["d"],field:"hostName",sortable:true,render:(hostName,anomaliesByHost)=>Object(tables_helpers["b"])({rowItem:hostName,attrName:"host.name",idPrefix:`anomalies-host-table-hostName-${Object(create_compound_key["a"])(anomaliesByHost)}-hostName`,render:item=>external_kbnSharedDeps_React_default.a.createElement(links["d"],{hostName:item})})},{name:tables_translations["b"],field:"anomaly.jobId",sortable:true,render:(jobId,anomaliesByHost)=>external_kbnSharedDeps_React_default.a.createElement(create_explorer_link["a"],{score:anomaliesByHost.anomaly,startDate:startDate,endDate:endDate,linkName:jobId})},{name:tables_translations["g"],field:"anomaly.severity",sortable:true,render:(_,anomaliesByHost)=>external_kbnSharedDeps_React_default.a.createElement(draggable_score["a"],{id:Object(drag_and_drop_helpers["l"])(`anomalies-host-table-severity-${Object(create_compound_key["a"])(anomaliesByHost)}`),score:anomaliesByHost.anomaly})},{name:tables_translations["c"],field:"anomaly.entityValue",sortable:true,render:(entityValue,anomaliesByHost)=>external_kbnSharedDeps_React_default.a.createElement(entity_draggable["a"],{idPrefix:`anomalies-host-table-entityValue${Object(create_compound_key["a"])(anomaliesByHost)}-entity`,entityName:anomaliesByHost.anomaly.entityName,entityValue:entityValue})},{name:tables_translations["e"],field:"anomaly.influencers",render:(influencers,anomaliesByHost)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"none",responsive:false},influencers&&influencers.map(influencer=>{const[key,value]=Object(get_entries["a"])(influencer);const entityName=key!=null?key:"";const entityValue=value!=null?value:"";return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:`${entityName}-${entityValue}-${Object(create_compound_key["a"])(anomaliesByHost)}`,grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(entity_draggable["a"],{idPrefix:`anomalies-host-table-influencers-${entityName}-${entityValue}-${Object(create_compound_key["a"])(anomaliesByHost)}`,entityName:entityName,entityValue:entityValue}))))}))},{name:tables_translations["i"],field:"anomaly.time",sortable:true,render:time=>external_kbnSharedDeps_React_default.a.createElement(formatted_date["b"],{value:time})}];const getAnomaliesHostTableColumnsCurated=(pageType,startDate,endDate,interval,narrowDateRange)=>{const columns=getAnomaliesHostTableColumns(startDate,endDate,interval,narrowDateRange);if(pageType===store_model["HostsType"].details){return columns.filter(column=>column.name!==tables_translations["d"])}else{return columns}};const getHostNameFromInfluencers=(influencers=[],hostName)=>{const recordFound=influencers.find(influencer=>{const[influencerName,influencerValue]=Object(get_entries["a"])(influencer);if(influencerName==="host.name"){if(hostName==null){return true}else{return influencerValue===hostName}}else{return false}});if(recordFound!=null){return Object.values(recordFound)[0]}else{return null}};const convertAnomaliesToHosts=(anomalies,hostName)=>{if(anomalies==null){return[]}else{return anomalies.anomalies.reduce((accum,item)=>{if(getHostNameFromEntity(item,hostName)){return[...accum,{hostName:item.entityValue,anomaly:item}]}else{const hostNameFromInfluencers=getHostNameFromInfluencers(item.influencers,hostName);if(hostNameFromInfluencers!=null){return[...accum,{hostName:hostNameFromInfluencers,anomaly:item}]}else{return accum}}},[])}};const getHostNameFromEntity=(anomaly,hostName)=>{if(anomaly.entityName!=="host.name"){return false}else if(hostName==null){return true}else{return anomaly.entityValue===hostName}};const getIntervalFromAnomalies=anomalies=>{if(anomalies==null){return"day"}else{return anomalies.interval}};var basic_table=__webpack_require__(725);const hostEquality=(prevProps,nextProps)=>prevProps.startDate===nextProps.startDate&&prevProps.endDate===nextProps.endDate&&prevProps.skip===nextProps.skip;const getCriteriaFromHostType=(type,hostName)=>{if(type===store_model["HostsType"].details&&hostName!=null){return[{fieldName:"host.name",fieldValue:hostName}]}else{return[]}};const anomalies_host_table_sorting={sort:{field:"anomaly.severity",direction:"desc"}};const AnomaliesHostTableComponent=({startDate:startDate,endDate:endDate,narrowDateRange:narrowDateRange,hostName:hostName,skip:skip,type:type})=>{const capabilities=Object(use_ml_capabilities["a"])();const[loading,tableData]=Object(use_anomalies_table_data["a"])({startDate:startDate,endDate:endDate,skip:skip,criteriaFields:getCriteriaFromHostType(type,hostName)});const hosts=convertAnomaliesToHosts(tableData,hostName);const interval=getIntervalFromAnomalies(tableData);const columns=getAnomaliesHostTableColumnsCurated(type,startDate,endDate,interval,narrowDateRange);const pagination={initialPageIndex:0,initialPageSize:10,totalItemCount:hosts.length,pageSizeOptions:[5,10,20,50],hidePerPageOptions:false};if(!Object(has_ml_user_permissions["a"])(capabilities)){return null}else{return external_kbnSharedDeps_React_default.a.createElement(panel["a"],{loading:loading},external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{subtitle:`${tables_translations["h"]}: ${pagination.totalItemCount.toLocaleString()} ${tables_translations["k"](pagination.totalItemCount)}`,title:tables_translations["a"],tooltip:tables_translations["j"]}),external_kbnSharedDeps_React_default.a.createElement(basic_table["a"],{columns:columns,items:hosts,pagination:pagination,sorting:anomalies_host_table_sorting}),loading&&external_kbnSharedDeps_React_default.a.createElement(loader["a"],{"data-test-subj":"anomalies-host-table-loading-panel",overlay:true,size:"xl"}))}};const AnomaliesHostTable=external_kbnSharedDeps_React_default.a.memo(AnomaliesHostTableComponent,hostEquality);var details_utils=__webpack_require__(491);var pages_navigation=__webpack_require__(401);function details_tabs_extends(){details_tabs_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return details_tabs_extends.apply(this,arguments)}const HostDetailsTabs=external_kbnSharedDeps_React_default.a.memo(({detailName:detailName,docValueFields:docValueFields,filterQuery:filterQuery,indexNames:indexNames,indexPattern:indexPattern,pageFilters:pageFilters,setAbsoluteRangeDatePicker:setAbsoluteRangeDatePicker,hostDetailsPagePath:hostDetailsPagePath})=>{const{from:from,to:to,isInitializing:isInitializing,deleteQuery:deleteQuery,setQuery:setQuery}=Object(use_global_time["a"])();const narrowDateRange=Object(external_kbnSharedDeps_React_["useCallback"])((score,interval)=>{const fromTo=Object(score_interval_to_datetime["a"])(score,interval);setAbsoluteRangeDatePicker({id:"global",from:fromTo.from,to:fromTo.to})},[setAbsoluteRangeDatePicker]);const updateDateRange=Object(external_kbnSharedDeps_React_["useCallback"])(({x:x})=>{if(!x){return}const[min,max]=x;setAbsoluteRangeDatePicker({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()})},[setAbsoluteRangeDatePicker]);const tabProps={deleteQuery:deleteQuery,endDate:to,filterQuery:filterQuery,skip:isInitializing,setQuery:setQuery,startDate:from,type:details_utils["b"],indexPattern:indexPattern,indexNames:indexNames,hostName:detailName,narrowDateRange:narrowDateRange,updateDateRange:updateDateRange};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:`${hostDetailsPagePath}/:tabName(${store_model["HostsTableType"].authentications})`},external_kbnSharedDeps_React_default.a.createElement(pages_navigation["a"],details_tabs_extends({docValueFields:docValueFields},tabProps))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:`${hostDetailsPagePath}/:tabName(${store_model["HostsTableType"].hosts})`},external_kbnSharedDeps_React_default.a.createElement(pages_navigation["d"],tabProps)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:`${hostDetailsPagePath}/:tabName(${store_model["HostsTableType"].uncommonProcesses})`},external_kbnSharedDeps_React_default.a.createElement(pages_navigation["e"],tabProps)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:`${hostDetailsPagePath}/:tabName(${store_model["HostsTableType"].anomalies})`},external_kbnSharedDeps_React_default.a.createElement(anomalies_query_tab_body["a"],details_tabs_extends({},tabProps,{AnomaliesTableComponent:AnomaliesHostTable}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:`${hostDetailsPagePath}/:tabName(${store_model["HostsTableType"].events})`},external_kbnSharedDeps_React_default.a.createElement(pages_navigation["b"],details_tabs_extends({},tabProps,{pageFilters:pageFilters}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:`${hostDetailsPagePath}/:tabName(${store_model["HostsTableType"].alerts})`},external_kbnSharedDeps_React_default.a.createElement(pages_navigation["c"],details_tabs_extends({},tabProps,{pageFilters:pageFilters}))))});HostDetailsTabs.displayName="HostDetailsTabs";var hosts_pages_translations=__webpack_require__(269);const getTabsOnHostDetailsUrl=(hostName,tabName)=>`/${hostName}/${tabName}`;const navTabsHostDetails=(hostName,hasMlUserPermissions)=>{const hostDetailsNavTabs={[store_model["HostsTableType"].authentications]:{id:store_model["HostsTableType"].authentications,name:hosts_pages_translations["f"],href:getTabsOnHostDetailsUrl(hostName,store_model["HostsTableType"].authentications),disabled:false,urlKey:"host",isDetailPage:true,pageId:app_types["a"].hosts},[store_model["HostsTableType"].uncommonProcesses]:{id:store_model["HostsTableType"].uncommonProcesses,name:hosts_pages_translations["h"],href:getTabsOnHostDetailsUrl(hostName,store_model["HostsTableType"].uncommonProcesses),disabled:false,urlKey:"host",isDetailPage:true,pageId:app_types["a"].hosts},[store_model["HostsTableType"].anomalies]:{id:store_model["HostsTableType"].anomalies,name:hosts_pages_translations["e"],href:getTabsOnHostDetailsUrl(hostName,store_model["HostsTableType"].anomalies),disabled:false,urlKey:"host",isDetailPage:true,pageId:app_types["a"].hosts},[store_model["HostsTableType"].events]:{id:store_model["HostsTableType"].events,name:hosts_pages_translations["g"],href:getTabsOnHostDetailsUrl(hostName,store_model["HostsTableType"].events),disabled:false,urlKey:"host",isDetailPage:true,pageId:app_types["a"].hosts},[store_model["HostsTableType"].alerts]:{id:store_model["HostsTableType"].alerts,name:hosts_pages_translations["c"],href:getTabsOnHostDetailsUrl(hostName,store_model["HostsTableType"].alerts),disabled:false,urlKey:"host",pageId:app_types["a"].hosts}};return hasMlUserPermissions?hostDetailsNavTabs:Object(external_kbnSharedDeps_LodashFp_["omit"])(store_model["HostsTableType"].anomalies,hostDetailsNavTabs)};const getHostDetailsEventsKqlQueryExpression=({filterQueryExpression:filterQueryExpression,hostName:hostName})=>{if(filterQueryExpression.length){return`${filterQueryExpression}${hostName.length?` and host.name: ${Object(keury["c"])(hostName)}`:""}`}else{return hostName.length?`host.name: ${Object(keury["c"])(hostName)}`:""}};const getHostDetailsPageFilters=hostName=>[{meta:{alias:null,negate:false,disabled:false,type:"phrase",key:"host.name",value:hostName,params:{query:hostName}},query:{match:{"host.name":{query:hostName,type:"phrase"}}}}];const HostOverviewManage=Object(manage_query["a"])(host_overview["a"]);const HostDetailsComponent=({detailName:detailName,hostDetailsPagePath:hostDetailsPagePath})=>{const dispatch=Object(react_redux_lib["useDispatch"])();const getTimeline=Object(external_kbnSharedDeps_React_["useMemo"])(()=>store_timeline["b"].getTimelineByIdSelector(),[]);const graphEventId=Object(use_selector["b"])(state=>{var _getTimeline;return((_getTimeline=getTimeline(state,types_timeline["e"].hostsPageEvents))!==null&&_getTimeline!==void 0?_getTimeline:defaults["a"]).graphEventId});const getGlobalFiltersQuerySelector=Object(external_kbnSharedDeps_React_["useMemo"])(()=>store["inputsSelectors"].globalFiltersQuerySelector(),[]);const getGlobalQuerySelector=Object(external_kbnSharedDeps_React_["useMemo"])(()=>store["inputsSelectors"].globalQuerySelector(),[]);const query=Object(use_selector["a"])(getGlobalQuerySelector);const filters=Object(use_selector["a"])(getGlobalFiltersQuerySelector);const{to:to,from:from,deleteQuery:deleteQuery,setQuery:setQuery,isInitializing:isInitializing}=Object(use_global_time["a"])();const{globalFullScreen:globalFullScreen}=Object(use_full_screen["a"])();const capabilities=Object(use_ml_capabilities["a"])();const kibana=Object(lib_kibana["h"])();const hostDetailsPageFilters=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getHostDetailsPageFilters(detailName),[detailName]);const getFilters=()=>[...hostDetailsPageFilters,...filters];const narrowDateRange=Object(external_kbnSharedDeps_React_["useCallback"])(({x:x})=>{if(!x){return}const[min,max]=x;dispatch(Object(inputs_actions["setAbsoluteRangeDatePicker"])({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()}))},[dispatch]);const{docValueFields:docValueFields,indicesExist:indicesExist,indexPattern:indexPattern,selectedPatterns:selectedPatterns}=Object(sourcerer["b"])();const filterQuery=Object(keury["b"])({config:public_["esQuery"].getEsQueryConfig(kibana.services.uiSettings),indexPattern:indexPattern,queries:[query],filters:getFilters()});Object(external_kbnSharedDeps_React_["useEffect"])(()=>{dispatch(Object(store_actions["setHostDetailsTablesActivePageToZero"])())},[dispatch,detailName]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,indicesExist?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiWindowEvent"],{event:"resize",handler:external_kbnSharedDeps_LodashFp_["noop"]}),external_kbnSharedDeps_React_default.a.createElement(filters_global["a"],{show:Object(timeline_helpers["q"])({globalFullScreen:globalFullScreen,graphEventId:graphEventId})},external_kbnSharedDeps_React_default.a.createElement(search_bar["a"],{indexPattern:indexPattern,id:"global"})),external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],{noPadding:globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(Display,{show:!globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(header_page["a"],{border:true,subtitle:external_kbnSharedDeps_React_default.a.createElement(last_event_time["a"],{docValueFields:docValueFields,indexKey:search_strategy["LastEventIndexKey"].hostDetails,hostName:detailName,indexNames:selectedPatterns}),title:detailName}),external_kbnSharedDeps_React_default.a.createElement(hosts_details["a"],{indexNames:selectedPatterns,sourceId:"default",hostName:detailName,skip:isInitializing,startDate:from,endDate:to},({hostOverview:hostOverview,loading:loading,id:id,inspect:inspect,refetch:refetch})=>external_kbnSharedDeps_React_default.a.createElement(anomaly_table_provider["a"],{criteriaFields:Object(host_to_criteria["a"])(hostOverview),startDate:from,endDate:to,skip:isInitializing},({isLoadingAnomaliesData:isLoadingAnomaliesData,anomaliesData:anomaliesData})=>external_kbnSharedDeps_React_default.a.createElement(HostOverviewManage,{docValueFields:docValueFields,id:id,inspect:inspect,isInDetailsSidePanel:false,refetch:refetch,setQuery:setQuery,data:hostOverview,anomaliesData:anomaliesData,isLoadingAnomaliesData:isLoadingAnomaliesData,indexNames:selectedPatterns,loading:loading,startDate:from,endDate:to,narrowDateRange:(score,interval)=>{const fromTo=Object(score_interval_to_datetime["a"])(score,interval);Object(inputs_actions["setAbsoluteRangeDatePicker"])({id:"global",from:fromTo.from,to:fromTo.to})}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null),external_kbnSharedDeps_React_default.a.createElement(HostsDetailsKpiComponent,{filterQuery:filterQuery,from:from,indexNames:selectedPatterns,setQuery:setQuery,to:to,narrowDateRange:narrowDateRange,skip:isInitializing}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(navigation["a"],{navTabs:navTabsHostDetails(detailName,Object(has_ml_user_permissions["a"])(capabilities))}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)),external_kbnSharedDeps_React_default.a.createElement(HostDetailsTabs,{docValueFields:docValueFields,indexNames:selectedPatterns,isInitializing:isInitializing,deleteQuery:deleteQuery,pageFilters:hostDetailsPageFilters,to:to,from:from,detailName:detailName,type:details_utils["b"],setQuery:setQuery,filterQuery:filterQuery,hostDetailsPagePath:hostDetailsPagePath,indexPattern:indexPattern,setAbsoluteRangeDatePicker:inputs_actions["setAbsoluteRangeDatePicker"]}))):external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,external_kbnSharedDeps_React_default.a.createElement(header_page["a"],{border:true,title:detailName}),external_kbnSharedDeps_React_default.a.createElement(overview_empty["a"],null)),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].hosts}))};HostDetailsComponent.displayName="HostDetailsComponent";const HostDetails=external_kbnSharedDeps_React_default.a.memo(HostDetailsComponent);var query_string=__webpack_require__(366);var rison=__webpack_require__(178);const decodeRison=value=>{try{return Object(rison["decode"])(value)}catch(error){return null}};const isRisonObject=value=>Object(external_kbnSharedDeps_LodashFp_["isObject"])(value);const isRegularString=value=>Object(external_kbnSharedDeps_LodashFp_["isString"])(value);const entityToKql=(entityNames,entity)=>{if(entityNames.length===1){return`${entityNames[0]}: "${entity}"`}else{return entityNames.reduce((accum,entityName,index,array)=>{if(index===0){return`(${entityName}: "${entity}"`}else if(index===array.length-1){return`${accum} or ${entityName}: "${entity}")`}else{return`${accum} or ${entityName}: "${entity}"`}},"")}};const entitiesToKql=(entityNames,entities)=>entities.reduce((accum,entity,index)=>{const entityKql=entityToKql(entityNames,entity);if(index===0){return entityKql}else{return`${accum} or ${entityKql}`}},"");const addEntitiesToKql=(entityNames,entities,kqlQuery)=>{const value=decodeRison(kqlQuery);if(isRisonObject(value)){const appQuery=value;if(isRisonObject(appQuery)){if(isRegularString(appQuery.query)){const entitiesKql=entitiesToKql(entityNames,entities);if(appQuery.query!==""&&entitiesKql!==""){appQuery.query=`(${entitiesKql}) and (${appQuery.query})`}else if(appQuery.query===""&&entitiesKql!==""){appQuery.query=`(${entitiesKql})`}return Object(rison["encode"])(value)}}}else if(value==null){const entitiesKql=entitiesToKql(entityNames,entities);return Object(rison["encode"])({query:`(${entitiesKql})`,language:"kuery"})}return kqlQuery};const replacement=(match,p1,p2)=>{const split=p2.split(",");const newQuery=split.reduce((accum,item,index)=>{if(index===0){return`${p1}: "${item}"`}else{return`${accum} or ${p1}: "${item}"`}},"");return`(${newQuery})`};const replaceKqlCommasWithOrUsingRegex=expression=>{const myRegexp=/([\w\.\-\[\]]+)\s*:\s*"(([\w\.\-\(\)\[\]]+,[\w\.\-\(\)\[\]]+){1,})"/g;return expression.replace(myRegexp,replacement)};const replaceKqlCommasWithOr=kqlQuery=>{const value=decodeRison(kqlQuery);if(isRisonObject(value)){const appQuery=value;if(isRisonObject(appQuery)){if(isRegularString(appQuery.query)){appQuery.query=replaceKqlCommasWithOrUsingRegex(appQuery.query);return Object(rison["encode"])(value)}}}return kqlQuery};const operators=["and","or","not"];const removeKqlVariablesUsingRegex=expression=>{const myRegexp=/(\s+)*(and|or|not){0,1}(\s+)*([\w\.\-\[\]]+)\s*:\s*"(\$[\w\.\-\(\)\[\]]+\$)"(\s+)*(and|or|not){0,1}(\s+)*/g;return expression.replace(myRegexp,replacer)};const replacer=(match,...parts)=>{if(parts==null){return""}const operatorsMatched=parts.reduce((accum,part)=>part!=null&&operators.includes(part)?[...accum,part]:accum,[]);if(operatorsMatched.length>1){return` ${operatorsMatched[operatorsMatched.length-1].trim()} `}else{return""}};const removeKqlVariables=kqlQuery=>{const value=decodeRison(kqlQuery);if(isRisonObject(value)){const appQuery=value;if(isRisonObject(appQuery)){if(isRegularString(appQuery.query)){appQuery.query=removeKqlVariablesUsingRegex(appQuery.query);return Object(rison["encode"])(value)}}}return kqlQuery};const replaceKQLParts=kqlQuery=>Object(external_kbnSharedDeps_LodashFp_["flow"])(replaceKqlCommasWithOr,removeKqlVariables)(kqlQuery);const emptyEntity=entity=>entity.trim()===""||entity.startsWith("$")&&entity.endsWith("$");const multipleEntities=entity=>entity.split(",").length>1;const getMultipleEntities=entity=>entity.split(",");var kibanaUtils_public_=__webpack_require__(41);const MlHostConditionalContainer=external_kbnSharedDeps_React_default.a.memo(({url:url})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{strict:true,exact:true,path:url,render:({location:location})=>{const queryStringDecoded=Object(query_string["parse"])(location.search.substring(1),{sort:false});if(queryStringDecoded.query!=null){queryStringDecoded.query=replaceKQLParts(queryStringDecoded.query)}const reEncoded=Object(query_string["stringify"])(kibanaUtils_public_["url"].encodeQuery(queryStringDecoded),{sort:false,encode:false});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{to:`?${reEncoded}`})}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:`${url}/:hostName`,render:({location:location,match:{params:{hostName:hostName}}})=>{const queryStringDecoded=Object(query_string["parse"])(location.search.substring(1),{sort:false});if(queryStringDecoded.query!=null){queryStringDecoded.query=replaceKQLParts(queryStringDecoded.query)}if(emptyEntity(hostName)){const reEncoded=Object(query_string["stringify"])(kibanaUtils_public_["url"].encodeQuery(queryStringDecoded),{sort:false,encode:false});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{to:`/${store_model["HostsTableType"].anomalies}?${reEncoded}`})}else if(multipleEntities(hostName)){const hosts=getMultipleEntities(hostName);queryStringDecoded.query=addEntitiesToKql(["host.name"],hosts,queryStringDecoded.query||"");const reEncoded=Object(query_string["stringify"])(kibanaUtils_public_["url"].encodeQuery(queryStringDecoded),{sort:false,encode:false});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{to:`/${store_model["HostsTableType"].anomalies}?${reEncoded}`})}else{const reEncoded=Object(query_string["stringify"])(kibanaUtils_public_["url"].encodeQuery(queryStringDecoded),{sort:false,encode:false});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{to:`/${hostName}/${store_model["HostsTableType"].anomalies}?${reEncoded}`})}}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/ml-hosts/",render:({location:{search:search=""}})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{from:"/ml-hosts/",to:`/ml-hosts${search}`})})));MlHostConditionalContainer.displayName="MlHostConditionalContainer";var alerts_query_tab_body=__webpack_require__(385);function hosts_tabs_extends(){hosts_tabs_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return hosts_tabs_extends.apply(this,arguments)}const HostsTabs=Object(external_kbnSharedDeps_React_["memo"])(({deleteQuery:deleteQuery,docValueFields:docValueFields,filterQuery:filterQuery,from:from,indexNames:indexNames,isInitializing:isInitializing,setAbsoluteRangeDatePicker:setAbsoluteRangeDatePicker,setQuery:setQuery,to:to,type:type})=>{const narrowDateRange=Object(external_kbnSharedDeps_React_["useCallback"])((score,interval)=>{const fromTo=Object(score_interval_to_datetime["a"])(score,interval);setAbsoluteRangeDatePicker({id:"global",from:fromTo.from,to:fromTo.to})},[setAbsoluteRangeDatePicker]);const updateDateRange=Object(external_kbnSharedDeps_React_["useCallback"])(({x:x})=>{if(!x){return}const[min,max]=x;setAbsoluteRangeDatePicker({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()})},[setAbsoluteRangeDatePicker]);const tabProps={deleteQuery:deleteQuery,endDate:to,filterQuery:filterQuery,indexNames:indexNames,skip:isInitializing,setQuery:setQuery,startDate:from,type:type,narrowDateRange:narrowDateRange,updateDateRange:updateDateRange};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:`/:tabName(${store_model["HostsTableType"].hosts})`},external_kbnSharedDeps_React_default.a.createElement(pages_navigation["d"],hosts_tabs_extends({docValueFields:docValueFields},tabProps))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:`/:tabName(${store_model["HostsTableType"].authentications})`},external_kbnSharedDeps_React_default.a.createElement(pages_navigation["a"],hosts_tabs_extends({docValueFields:docValueFields},tabProps))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:`/:tabName(${store_model["HostsTableType"].uncommonProcesses})`},external_kbnSharedDeps_React_default.a.createElement(pages_navigation["e"],tabProps)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:`/:tabName(${store_model["HostsTableType"].anomalies})`},external_kbnSharedDeps_React_default.a.createElement(anomalies_query_tab_body["a"],hosts_tabs_extends({},tabProps,{AnomaliesTableComponent:AnomaliesHostTable}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:`/:tabName(${store_model["HostsTableType"].events})`},external_kbnSharedDeps_React_default.a.createElement(pages_navigation["b"],tabProps)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:`/:tabName(${store_model["HostsTableType"].alerts})`},external_kbnSharedDeps_React_default.a.createElement(alerts_query_tab_body["a"],tabProps)))});HostsTabs.displayName="HostsTabs";const getTabsOnHostsUrl=tabName=>`/${tabName}`;const navTabsHosts=hasMlUserPermissions=>{const hostsNavTabs={[store_model["HostsTableType"].hosts]:{id:store_model["HostsTableType"].hosts,name:hosts_pages_translations["d"],href:getTabsOnHostsUrl(store_model["HostsTableType"].hosts),disabled:false,urlKey:"host",pageId:app_types["a"].hosts},[store_model["HostsTableType"].authentications]:{id:store_model["HostsTableType"].authentications,name:hosts_pages_translations["f"],href:getTabsOnHostsUrl(store_model["HostsTableType"].authentications),disabled:false,urlKey:"host",pageId:app_types["a"].hosts},[store_model["HostsTableType"].uncommonProcesses]:{id:store_model["HostsTableType"].uncommonProcesses,name:hosts_pages_translations["h"],href:getTabsOnHostsUrl(store_model["HostsTableType"].uncommonProcesses),disabled:false,urlKey:"host",pageId:app_types["a"].hosts},[store_model["HostsTableType"].anomalies]:{id:store_model["HostsTableType"].anomalies,name:hosts_pages_translations["e"],href:getTabsOnHostsUrl(store_model["HostsTableType"].anomalies),disabled:false,urlKey:"host",pageId:app_types["a"].hosts},[store_model["HostsTableType"].events]:{id:store_model["HostsTableType"].events,name:hosts_pages_translations["g"],href:getTabsOnHostsUrl(store_model["HostsTableType"].events),disabled:false,urlKey:"host",pageId:app_types["a"].hosts},[store_model["HostsTableType"].alerts]:{id:store_model["HostsTableType"].alerts,name:hosts_pages_translations["c"],href:getTabsOnHostsUrl(store_model["HostsTableType"].alerts),disabled:false,urlKey:"host",pageId:app_types["a"].hosts}};return hasMlUserPermissions?hostsNavTabs:Object(external_kbnSharedDeps_LodashFp_["omit"])([store_model["HostsTableType"].anomalies],hostsNavTabs)};var hosts_store=__webpack_require__(198);const hosts_StyledFullHeightContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-13ka402-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]);const HostsComponent=()=>{const dispatch=Object(react_redux_lib["useDispatch"])();const containerElement=Object(external_kbnSharedDeps_React_["useRef"])(null);const getTimeline=Object(external_kbnSharedDeps_React_["useMemo"])(()=>store_timeline["b"].getTimelineByIdSelector(),[]);const graphEventId=Object(use_selector["b"])(state=>{var _ref,_getTimeline;return((_ref=(_getTimeline=getTimeline(state,types_timeline["e"].hostsPageEvents))!==null&&_getTimeline!==void 0?_getTimeline:getTimeline(state,types_timeline["e"].hostsPageExternalAlerts))!==null&&_ref!==void 0?_ref:defaults["a"]).graphEventId});const getGlobalFiltersQuerySelector=Object(external_kbnSharedDeps_React_["useMemo"])(()=>store["inputsSelectors"].globalFiltersQuerySelector(),[]);const getGlobalQuerySelector=Object(external_kbnSharedDeps_React_["useMemo"])(()=>store["inputsSelectors"].globalQuerySelector(),[]);const query=Object(use_selector["a"])(getGlobalQuerySelector);const filters=Object(use_selector["a"])(getGlobalFiltersQuerySelector);const{to:to,from:from,deleteQuery:deleteQuery,setQuery:setQuery,isInitializing:isInitializing}=Object(use_global_time["a"])();const{globalFullScreen:globalFullScreen}=Object(use_full_screen["a"])();const capabilities=Object(use_ml_capabilities["a"])();const{uiSettings:uiSettings}=Object(lib_kibana["h"])().services;const{tabName:tabName}=Object(external_kbnSharedDeps_ReactRouterDom_["useParams"])();const tabsFilters=external_kbnSharedDeps_React_default.a.useMemo(()=>{if(tabName===store_model["HostsTableType"].alerts){return filters.length>0?[...filters,...pages_navigation["g"]]:pages_navigation["g"]}return filters},[tabName,filters]);const narrowDateRange=Object(external_kbnSharedDeps_React_["useCallback"])(({x:x})=>{if(!x){return}const[min,max]=x;dispatch(Object(inputs_actions["setAbsoluteRangeDatePicker"])({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()}))},[dispatch]);const{docValueFields:docValueFields,indicesExist:indicesExist,indexPattern:indexPattern,selectedPatterns:selectedPatterns}=Object(sourcerer["b"])();const filterQuery=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(keury["b"])({config:public_["esQuery"].getEsQueryConfig(uiSettings),indexPattern:indexPattern,queries:[query],filters:filters}),[filters,indexPattern,uiSettings,query]);const tabsFilterQuery=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(keury["b"])({config:public_["esQuery"].getEsQueryConfig(uiSettings),indexPattern:indexPattern,queries:[query],filters:tabsFilters}),[indexPattern,query,tabsFilters,uiSettings]);const onSkipFocusBeforeEventsTable=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{var _containerElement$cur,_containerElement$cur2;(_containerElement$cur=containerElement.current)===null||_containerElement$cur===void 0?void 0:(_containerElement$cur2=_containerElement$cur.querySelector(".inspectButtonComponent:last-of-type"))===null||_containerElement$cur2===void 0?void 0:_containerElement$cur2.focus()},[containerElement]);const onSkipFocusAfterEventsTable=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{Object(timeline_helpers["o"])()},[]);const onKeyDown=Object(external_kbnSharedDeps_React_["useCallback"])(keyboardEvent=>{if(Object(accessibility_helpers["r"])(keyboardEvent)){Object(timeline_helpers["n"])({containerElement:containerElement.current,keyboardEvent:keyboardEvent,onSkipFocusBeforeEventsTable:onSkipFocusBeforeEventsTable,onSkipFocusAfterEventsTable:onSkipFocusAfterEventsTable})}},[containerElement,onSkipFocusBeforeEventsTable,onSkipFocusAfterEventsTable]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,indicesExist?external_kbnSharedDeps_React_default.a.createElement(hosts_StyledFullHeightContainer,{onKeyDown:onKeyDown,ref:containerElement},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiWindowEvent"],{event:"resize",handler:external_kbnSharedDeps_LodashFp_["noop"]}),external_kbnSharedDeps_React_default.a.createElement(filters_global["a"],{show:Object(timeline_helpers["q"])({globalFullScreen:globalFullScreen,graphEventId:graphEventId})},external_kbnSharedDeps_React_default.a.createElement(search_bar["a"],{indexPattern:indexPattern,id:"global"})),external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],{noPadding:globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(Display,{show:!globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(header_page["a"],{border:true,subtitle:external_kbnSharedDeps_React_default.a.createElement(last_event_time["a"],{docValueFields:docValueFields,indexKey:search_strategy["LastEventIndexKey"].hosts,indexNames:selectedPatterns}),title:hosts_pages_translations["i"]}),external_kbnSharedDeps_React_default.a.createElement(HostsKpiComponent,{filterQuery:filterQuery,indexNames:selectedPatterns,from:from,setQuery:setQuery,to:to,skip:isInitializing,narrowDateRange:narrowDateRange}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(navigation["a"],{navTabs:navTabsHosts(Object(has_ml_user_permissions["a"])(capabilities))}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)),external_kbnSharedDeps_React_default.a.createElement(HostsTabs,{deleteQuery:deleteQuery,docValueFields:docValueFields,to:to,filterQuery:tabsFilterQuery,isInitializing:isInitializing,indexNames:selectedPatterns,setAbsoluteRangeDatePicker:inputs_actions["setAbsoluteRangeDatePicker"],setQuery:setQuery,from:from,type:hosts_store["b"].HostsType.page}))):external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,external_kbnSharedDeps_React_default.a.createElement(header_page["a"],{border:true,title:hosts_pages_translations["i"]}),external_kbnSharedDeps_React_default.a.createElement(overview_empty["a"],null)),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].hosts}))};HostsComponent.displayName="HostsComponent";const hosts_Hosts=external_kbnSharedDeps_React_default.a.memo(HostsComponent);const hostsPagePath="/";const types_hostDetailsPagePath=`/:detailName`;const getHostsTabPath=()=>`/:tabName(`+`${store_model["HostsTableType"].hosts}|`+`${store_model["HostsTableType"].authentications}|`+`${store_model["HostsTableType"].uncommonProcesses}|`+`${store_model["HostsTableType"].anomalies}|`+`${store_model["HostsTableType"].events}|`+`${store_model["HostsTableType"].alerts})`;const getHostDetailsTabPath=pagePath=>`${types_hostDetailsPagePath}/:tabName(`+`${store_model["HostsTableType"].authentications}|`+`${store_model["HostsTableType"].uncommonProcesses}|`+`${store_model["HostsTableType"].anomalies}|`+`${store_model["HostsTableType"].events}|`+`${store_model["HostsTableType"].alerts})`;const HostsContainer=external_kbnSharedDeps_React_default.a.memo(({url:url})=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/ml-hosts",render:({location:location,match:match})=>external_kbnSharedDeps_React_default.a.createElement(MlHostConditionalContainer,{location:location,url:match.url})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:getHostsTabPath()},external_kbnSharedDeps_React_default.a.createElement(hosts_Hosts,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:getHostDetailsTabPath(hostsPagePath),render:({match:{params:{detailName:detailName}}})=>external_kbnSharedDeps_React_default.a.createElement(HostDetails,{hostDetailsPagePath:types_hostDetailsPagePath,detailName:detailName})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:types_hostDetailsPagePath,render:({match:{params:{detailName:detailName}},location:{search:search=""}})=>{history.replace(`${detailName}/${store_model["HostsTableType"].authentications}${search}`);return null}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{exact:true,strict:true,path:"",render:({location:{search:search=""}})=>{history.replace(`${store_model["HostsTableType"].hosts}${search}`);return null}}))});HostsContainer.displayName="HostsContainer";const HostsRoutes=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/",render:({match:match})=>external_kbnSharedDeps_React_default.a.createElement(HostsContainer,{url:match.url})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{render:()=>external_kbnSharedDeps_React_default.a.createElement(_404["a"],null)}));const HOST_TIMELINE_IDS=[types_timeline["e"].hostsPageEvents,types_timeline["e"].hostsPageExternalAlerts];class public_hosts_Hosts{setup(){}start(storage){return{SubPluginRoutes:HostsRoutes,storageTimelines:{timelineById:Object(local_storage["b"])(storage,HOST_TIMELINE_IDS)},store:{initialState:{hosts:hosts_store["e"]},reducer:{hosts:hosts_store["c"]}}}}}var graphql_types=__webpack_require__(133);var pages_details=__webpack_require__(749);var web=__webpack_require__(231);var embeddable_public_=__webpack_require__(95);const Panel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiPanel"]).withConfig({displayName:"Panel",componentId:"sc-4inzan-0"})(["overflow:hidden;"]);Panel.displayName="Panel";const Embeddable=external_kbnSharedDeps_React_default.a.memo(({children:children})=>external_kbnSharedDeps_React_default.a.createElement("section",{className:"siemEmbeddable"},external_kbnSharedDeps_React_default.a.createElement(Panel,{paddingSize:"none"},children)));Embeddable.displayName="Embeddable";const Header=external_kbnSharedDeps_StyledComponents_default.a.header.attrs(({className:className})=>({className:`siemEmbeddable__header ${className}`})).withConfig({displayName:"Header",componentId:"yclxqi-0"})(["border-bottom:",";padding:",";"],({theme:theme})=>theme.eui.euiBorderThin,({theme:theme})=>theme.eui.paddingSizes.m);Header.displayName="Header";const EmbeddableHeader=external_kbnSharedDeps_React_default.a.memo(({children:children,title:title})=>external_kbnSharedDeps_React_default.a.createElement(Header,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xxxs"},external_kbnSharedDeps_React_default.a.createElement("h6",{"data-test-subj":"header-embeddable-title"},title))),children&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":"header-embeddable-supplements",grow:false},children))));EmbeddableHeader.displayName="EmbeddableHeader";var minimatch=__webpack_require__(1168);var minimatch_default=__webpack_require__.n(minimatch);const EMBEDDABLE_HEADER_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddableHeaderTitle",{defaultMessage:"Network map"});const EMBEDDABLE_HEADER_HELP=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddableHeaderHelp",{defaultMessage:"Map configuration help"});const MAP_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddablePanelTitle",{defaultMessage:"Source -> Destination Point-to-Point Map"});const SOURCE_LAYER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.embeddedMap.sourceLayerLabel",{defaultMessage:"Source Point"});const DESTINATION_LAYER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.embeddedMap.destinationLayerLabel",{defaultMessage:"Destination Point"});const CLIENT_LAYER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.embeddedMap.clientLayerLabel",{defaultMessage:"Client Point"});const SERVER_LAYER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.embeddedMap.serverLayerLabel",{defaultMessage:"Server Point"});const LINE_LAYER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.embeddedMap.lineLayerLabel",{defaultMessage:"Line"});const ERROR_CONFIGURING_EMBEDDABLES_API=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.embeddedMap.errorConfiguringEmbeddableApiTitle",{defaultMessage:"Error configuring Embeddables API"});const ERROR_CREATING_EMBEDDABLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.embeddedMap.errorCreatingMapEmbeddableTitle",{defaultMessage:"Error creating Map Embeddable"});const ERROR_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorTitle",{defaultMessage:"Required index patterns not configured"});const ERROR_BUTTON=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorButtonLabel",{defaultMessage:"Configure index patterns"});const FILTER_FOR_VALUE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.filterForValueHoverAction",{defaultMessage:"Filter for value"});const MAP_TOOL_TIP_ERROR=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.errorTitle",{defaultMessage:"Error loading map features"});const MAP_TOOL_TIP_FEATURES_FOOTER=(currentFeature,totalFeatures)=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.footerLabel",{values:{currentFeature:currentFeature,totalFeatures:totalFeatures},defaultMessage:"{currentFeature} of {totalFeatures} {totalFeatures, plural, =1 {feature} other {features}}"});const HOST=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.hostTitle",{defaultMessage:"Host"});const SOURCE_IP=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.sourceIPTitle",{defaultMessage:"Source IP"});const DESTINATION_IP=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.destinationIPTitle",{defaultMessage:"Destination IP"});const CLIENT_IP=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.clientIPTitle",{defaultMessage:"Client IP"});const SERVER_IP=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.serverIPTitle",{defaultMessage:"Server IP"});const SOURCE_DOMAIN=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.sourceDomainTitle",{defaultMessage:"Source domain"});const DESTINATION_DOMAIN=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.destinationDomainTitle",{defaultMessage:"Destination domain"});const CLIENT_DOMAIN=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.clientDomainTitle",{defaultMessage:"Client domain"});const SERVER_DOMAIN=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.serverDomainTitle",{defaultMessage:"Server domain"});const LOCATION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.locationTitle",{defaultMessage:"Location"});const ASN=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.asnTitle",{defaultMessage:"ASN"});const SOURCE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.sourceLabel",{defaultMessage:"Source"});const DESTINATION=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.destinationLabel",{defaultMessage:"Destination"});const CLIENT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.clientLabel",{defaultMessage:"Client"});const SERVER=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.serverLabel",{defaultMessage:"Server"});var constants_=__webpack_require__(100);const euiVisColorPalette=Object(external_kbnSharedDeps_ElasticEui_["euiPaletteColorBlind"])();const sourceFieldMappings={"host.name":HOST,"source.ip":SOURCE_IP,"source.domain":SOURCE_DOMAIN,"source.geo.country_iso_code":LOCATION,"source.as.organization.name":ASN};const destinationFieldMappings={"host.name":HOST,"destination.ip":DESTINATION_IP,"destination.domain":DESTINATION_DOMAIN,"destination.geo.country_iso_code":LOCATION,"destination.as.organization.name":ASN};const clientFieldMappings={"host.name":HOST,"client.ip":CLIENT_IP,"client.domain":CLIENT_DOMAIN,"client.geo.country_iso_code":LOCATION,"client.as.organization.name":ASN};const serverFieldMappings={"host.name":HOST,"server.ip":SERVER_IP,"server.domain":SERVER_DOMAIN,"server.geo.country_iso_code":LOCATION,"server.as.organization.name":ASN};const sourceDestinationFieldMappings={...sourceFieldMappings,...destinationFieldMappings,...clientFieldMappings,...serverFieldMappings};const SUM_OF_SOURCE_BYTES="sum_of_source.bytes";const SUM_OF_DESTINATION_BYTES="sum_of_destination.bytes";const SUM_OF_CLIENT_BYTES="sum_of_client.bytes";const SUM_OF_SERVER_BYTES="sum_of_server.bytes";const lmc={default:{source:{metricField:"source.bytes",geoField:"source.geo.location",tooltipProperties:Object.keys(sourceFieldMappings),label:SOURCE_LAYER},destination:{metricField:"destination.bytes",geoField:"destination.geo.location",tooltipProperties:Object.keys(destinationFieldMappings),label:DESTINATION_LAYER}},"apm-*":{source:{metricField:"client.bytes",geoField:"client.geo.location",tooltipProperties:Object.keys(clientFieldMappings),label:CLIENT_LAYER},destination:{metricField:"server.bytes",geoField:"server.geo.location",tooltipProperties:Object.keys(serverFieldMappings),label:SERVER_LAYER}}};const getLayerList=indexPatternIds=>[{sourceDescriptor:{type:constants_["SOURCE_TYPES"].EMS_TMS,isAutoSelect:true},id:uuid_default.a.v4(),label:null,minZoom:0,maxZoom:24,alpha:1,visible:true,style:null,type:"VECTOR_TILE"},...indexPatternIds.reduce((acc,{title:title,id:id})=>{var _lmc$title,_lmc$title$destinatio,_lmc$title2,_lmc$title$source,_lmc$title3;return[...acc,getLineLayer(title,id,(_lmc$title=lmc[title])!==null&&_lmc$title!==void 0?_lmc$title:lmc.default),getDestinationLayer(title,id,(_lmc$title$destinatio=(_lmc$title2=lmc[title])===null||_lmc$title2===void 0?void 0:_lmc$title2.destination)!==null&&_lmc$title$destinatio!==void 0?_lmc$title$destinatio:lmc.default.destination),getSourceLayer(title,id,(_lmc$title$source=(_lmc$title3=lmc[title])===null||_lmc$title3===void 0?void 0:_lmc$title3.source)!==null&&_lmc$title$source!==void 0?_lmc$title$source:lmc.default.source)]},[])];const getSourceLayer=(indexPatternTitle,indexPatternId,layerDetails)=>({sourceDescriptor:{id:uuid_default.a.v4(),type:"ES_SEARCH",applyGlobalQuery:true,geoField:layerDetails.geoField,filterByMapBounds:false,tooltipProperties:layerDetails.tooltipProperties,useTopHits:false,topHitsTimeField:"@timestamp",topHitsSize:1,indexPatternId:indexPatternId},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:euiVisColorPalette[1]}},lineColor:{type:"STATIC",options:{color:"#FFFFFF"}},lineWidth:{type:"STATIC",options:{size:2}},iconSize:{type:"STATIC",options:{size:8}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"home"}}}},id:uuid_default.a.v4(),label:`${indexPatternTitle} | ${layerDetails.label}`,minZoom:0,maxZoom:24,alpha:1,visible:true,type:"VECTOR",query:{query:"",language:"kuery"},joins:[]});const getDestinationLayer=(indexPatternTitle,indexPatternId,layerDetails)=>({sourceDescriptor:{id:uuid_default.a.v4(),type:"ES_SEARCH",applyGlobalQuery:true,geoField:layerDetails.geoField,filterByMapBounds:true,tooltipProperties:layerDetails.tooltipProperties,useTopHits:false,topHitsTimeField:"@timestamp",topHitsSize:1,indexPatternId:indexPatternId},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:euiVisColorPalette[2]}},lineColor:{type:"STATIC",options:{color:"#FFFFFF"}},lineWidth:{type:"STATIC",options:{size:2}},iconSize:{type:"STATIC",options:{size:8}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"marker"}}}},id:uuid_default.a.v4(),label:`${indexPatternTitle} | ${layerDetails.label}`,minZoom:0,maxZoom:24,alpha:1,visible:true,type:"VECTOR",query:{query:"",language:"kuery"}});const getLineLayer=(indexPatternTitle,indexPatternId,layerDetails)=>({sourceDescriptor:{type:constants_["SOURCE_TYPES"].ES_PEW_PEW,applyGlobalQuery:true,id:uuid_default.a.v4(),indexPatternId:indexPatternId,sourceGeoField:layerDetails.source.geoField,destGeoField:layerDetails.destination.geoField,metrics:[{type:"sum",field:layerDetails.source.metricField,label:layerDetails.source.metricField},{type:"sum",field:layerDetails.destination.metricField,label:layerDetails.destination.metricField}]},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:"#1EA593"}},lineColor:{type:"STATIC",options:{color:euiVisColorPalette[1]}},lineWidth:{type:"DYNAMIC",options:{field:{label:"count",name:"doc_count",origin:"source"},minSize:1,maxSize:8,fieldMetaOptions:{isEnabled:true,sigma:3}}},iconSize:{type:"STATIC",options:{size:10}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"airfield"}}}},id:uuid_default.a.v4(),label:`${indexPatternTitle} | ${LINE_LAYER}`,minZoom:0,maxZoom:24,alpha:.5,visible:true,type:"VECTOR",query:{query:"",language:"kuery"}});var maps_public_=__webpack_require__(101);function embedded_map_helpers_extends(){embedded_map_helpers_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return embedded_map_helpers_extends.apply(this,arguments)}const createEmbeddable=async(filters,indexPatterns,query,startDate,endDate,setQuery,portalNode,embeddableApi)=>{const factory=embeddableApi.getEmbeddableFactory(maps_public_["MAP_SAVED_OBJECT_TYPE"]);if(!factory){throw new Error("Map embeddable factory undefined")}const input={title:MAP_TITLE,attributes:{title:""},id:uuid_default.a.v4(),filters:filters,hidePanelTitles:true,query:query,refreshConfig:{value:0,pause:true},timeRange:{from:new Date(startDate).toISOString(),to:new Date(endDate).toISOString()},viewMode:embeddable_public_["ViewMode"].VIEW,isLayerTOCOpen:false,openTOCDetails:[],hideFilterActions:false,mapCenter:{lon:-1.05469,lat:15.96133,zoom:1},disabledActions:["CUSTOM_TIME_RANGE","CUSTOM_TIME_RANGE_BADGE"]};const renderTooltipContent=({addFilters:addFilters,closeTooltip:closeTooltip,features:features,isLocked:isLocked,getLayerName:getLayerName,loadFeatureProperties:loadFeatureProperties,loadFeatureGeometry:loadFeatureGeometry})=>{const props={addFilters:addFilters,closeTooltip:closeTooltip,features:features,isLocked:isLocked,getLayerName:getLayerName,loadFeatureProperties:loadFeatureProperties,loadFeatureGeometry:loadFeatureGeometry};return external_kbnSharedDeps_React_default.a.createElement(web["b"],embedded_map_helpers_extends({node:portalNode},props))};const embeddableObject=await factory.create(input);if(!embeddableObject){throw new Error("Map embeddable is undefined")}if(!Object(embeddable_public_["isErrorEmbeddable"])(embeddableObject)){embeddableObject.setRenderTooltipContent(renderTooltipContent);embeddableObject.setLayerList(getLayerList(indexPatterns))}setQuery({id:"embeddedMap",inspect:null,loading:false,refetch:()=>embeddableObject.reload()});return embeddableObject};const ignoredIndexPatterns=["*","*:*"];const findMatchingIndexPatterns=({kibanaIndexPatterns:kibanaIndexPatterns,siemDefaultIndices:siemDefaultIndices})=>{try{return kibanaIndexPatterns.filter(kip=>{const pattern=kip.attributes.title;return!ignoredIndexPatterns.includes(pattern)&&siemDefaultIndices.some(sdi=>{var _pattern$split;const splitPattern=(_pattern$split=pattern.split(","))!==null&&_pattern$split!==void 0?_pattern$split:[];return splitPattern.length>1?splitPattern.some(p=>{const isMatch=minimatch_default()(sdi,p);return isMatch&&p.charAt(0)==="-"?false:isMatch}):minimatch_default()(sdi,pattern)})})}catch{return[]}};const IndexPatternsMissingPromptComponent=()=>{const{docLinks:docLinks}=Object(lib_kibana["h"])().services;const kibanaBasePath=`${Object(lib_kibana["c"])()}/app`;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{iconType:"gisApp",title:external_kbnSharedDeps_React_default.a.createElement("h2",null,ERROR_TITLE),titleSize:"xs",body:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"To display map data, you must define SIEM indices ({defaultIndex}) and Kibana index patterns with matching glob patterns. When using {beats}, you can run the {setup} command on your hosts to automatically create the index patterns. For example: {example}.",id:"xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorDescription1",values:{defaultIndex:external_kbnSharedDeps_React_default.a.createElement("a",{href:`${kibanaBasePath}/management/kibana/settings`,rel:"noopener noreferrer",target:"_blank"},"securitySolution:defaultIndex"),beats:external_kbnSharedDeps_React_default.a.createElement("a",{href:`${docLinks.ELASTIC_WEBSITE_URL}guide/en/beats/libbeat/${docLinks.DOC_LINK_VERSION}/getting-started.html`,rel:"noopener noreferrer",target:"_blank"},"beats"),setup:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"setup"),example:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCode"],null,"./packetbeat setup")}})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"You can also configure index patterns manually in Kibana.",id:"xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorDescription2"}))),actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{href:`${kibanaBasePath}/management/kibana/indexPatterns`,color:"primary",target:"_blank",fill:true},ERROR_BUTTON)})};IndexPatternsMissingPromptComponent.displayName="IndexPatternsMissingPromptComponent";const IndexPatternsMissingPrompt=external_kbnSharedDeps_React_default.a.memo(IndexPatternsMissingPromptComponent);IndexPatternsMissingPrompt.displayName="IndexPatternsMissingPrompt";const Icon=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiIcon"]).withConfig({displayName:"Icon",componentId:"s0r863-0"})(["margin-right:",";"],external_kbnSharedDeps_Theme_euiLightVars_default.a.euiSizeS);Icon.displayName="Icon";const ToolTipFooterComponent=({featureIndex:featureIndex,totalFeatures:totalFeatures,previousFeature:previousFeature,nextFeature:nextFeature})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween",alignItems:"center",gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},MAP_TOOL_TIP_FEATURES_FOOTER(featureIndex+1,totalFeatures))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"data-test-subj":"previous-feature-button",color:"text",onClick:previousFeature,iconType:"arrowLeft","aria-label":"Next",disabled:featureIndex<=0}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"data-test-subj":"next-feature-button",color:"text",onClick:nextFeature,iconType:"arrowRight","aria-label":"Next",disabled:featureIndex>=totalFeatures-1})))));ToolTipFooterComponent.displayName="ToolTipFooterComponent";const ToolTipFooter=external_kbnSharedDeps_React_default.a.memo(ToolTipFooterComponent);ToolTipFooter.displayName="ToolTipFooter";var source_destination_arrows=__webpack_require__(408);const FlowBadge=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiBadge"]).withConfig({displayName:"FlowBadge",componentId:"sc-120vo88-0"})(["height:45px;min-width:85px;"]);const EuiFlexGroupStyled=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"EuiFlexGroupStyled",componentId:"sc-120vo88-1"})(["margin:0 auto;"]);const LineToolTipContentComponent=({contextId:contextId,featureProps:featureProps})=>{const lineProps=featureProps.reduce((acc,f)=>{var _f$getRawValue;const rawValue=(_f$getRawValue=f.getRawValue())!==null&&_f$getRawValue!==void 0?_f$getRawValue:[];return{...acc,...{[f.getPropertyKey()]:Array.isArray(rawValue)?rawValue:[rawValue]}}},{});const isSrcDest=Object.keys(lineProps).includes(SUM_OF_SOURCE_BYTES);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"center",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(FlowBadge,{color:"hollow"},external_kbnSharedDeps_React_default.a.createElement(EuiFlexGroupStyled,{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},isSrcDest?SOURCE:CLIENT)))),external_kbnSharedDeps_React_default.a.createElement(source_destination_arrows["e"],{contextId:contextId,destinationBytes:isSrcDest?lineProps[SUM_OF_DESTINATION_BYTES]:lineProps[SUM_OF_SERVER_BYTES],eventId:`map-line-tooltip-${contextId}`,sourceBytes:isSrcDest?lineProps[SUM_OF_SOURCE_BYTES]:lineProps[SUM_OF_CLIENT_BYTES]}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(FlowBadge,{color:"hollow"},external_kbnSharedDeps_React_default.a.createElement(EuiFlexGroupStyled,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},isSrcDest?DESTINATION:SERVER)))))};LineToolTipContentComponent.displayName="LineToolTipContentComponent";const LineToolTipContent=external_kbnSharedDeps_React_default.a.memo(LineToolTipContentComponent);LineToolTipContent.displayName="LineToolTipContent";var field_renderers=__webpack_require__(265);const PointToolTipContentComponent=({contextId:contextId,featureProps:featureProps})=>{const featureDescriptionListItems=Object(external_kbnSharedDeps_React_["useMemo"])(()=>featureProps.map(featureProp=>{var _featureProp$getRawVa;const key=featureProp.getPropertyKey();const value=(_featureProp$getRawVa=featureProp.getRawValue())!==null&&_featureProp$getRawVa!==void 0?_featureProp$getRawVa:[];return{title:sourceDestinationFieldMappings[key],description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,value!=null?external_kbnSharedDeps_React_default.a.createElement(field_renderers["b"],{rowItems:Array.isArray(value)?value:[value],attrName:key,idPrefix:`map-point-tooltip-${contextId}-${key}-${value}`,render:item=>getRenderedFieldValue(key,item)}):Object(empty_value["d"])())}}),[contextId,featureProps]);return external_kbnSharedDeps_React_default.a.createElement(page["d"],{listItems:featureDescriptionListItems})};PointToolTipContentComponent.displayName="PointToolTipContentComponent";const PointToolTipContent=external_kbnSharedDeps_React_default.a.memo(PointToolTipContentComponent);PointToolTipContent.displayName="PointToolTipContent";const getRenderedFieldValue=(field,value)=>{if(value===""){return Object(empty_value["f"])(value)}else if(["host.name"].includes(field)){return external_kbnSharedDeps_React_default.a.createElement(links["d"],{hostName:value})}else if(["source.ip","destination.ip"].includes(field)){const flowTarget=field.split(".")[0];return external_kbnSharedDeps_React_default.a.createElement(links["h"],{ip:value,flowTarget:flowTarget})}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,value)};const MapToolTipComponent=({closeTooltip:closeTooltip,features:features=[],getLayerName:getLayerName,loadFeatureProperties:loadFeatureProperties,loadFeatureGeometry:loadFeatureGeometry})=>{const[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_["useState"])(true);const[isLoadingNextFeature,setIsLoadingNextFeature]=Object(external_kbnSharedDeps_React_["useState"])(false);const[isError,setIsError]=Object(external_kbnSharedDeps_React_["useState"])(false);const[featureIndex,setFeatureIndex]=Object(external_kbnSharedDeps_React_["useState"])(0);const[featureProps,setFeatureProps]=Object(external_kbnSharedDeps_React_["useState"])([]);const[featureGeometry,setFeatureGeometry]=Object(external_kbnSharedDeps_React_["useState"])(null);const[,setLayerName]=Object(external_kbnSharedDeps_React_["useState"])("");const handleCloseTooltip=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{if(closeTooltip!=null){closeTooltip();setFeatureIndex(0)}},[closeTooltip]);const handlePreviousFeature=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setFeatureIndex(prevFeatureIndex=>prevFeatureIndex-1);setIsLoadingNextFeature(true)},[]);const handleNextFeature=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setFeatureIndex(prevFeatureIndex=>prevFeatureIndex+1);setIsLoadingNextFeature(true)},[]);const content=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(isError){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},MAP_TOOL_TIP_ERROR))}if(isLoading&&!isLoadingNextFeature){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"m"})))}return external_kbnSharedDeps_React_default.a.createElement("div",null,featureGeometry!=null&&featureGeometry.type==="LineString"?external_kbnSharedDeps_React_default.a.createElement(LineToolTipContent,{contextId:`${features[featureIndex].layerId}-${features[featureIndex].id}-${featureIndex}`,featureProps:featureProps}):external_kbnSharedDeps_React_default.a.createElement(PointToolTipContent,{contextId:`${features[featureIndex].layerId}-${features[featureIndex].id}-${featureIndex}`,featureProps:featureProps}),features.length>1&&external_kbnSharedDeps_React_default.a.createElement(ToolTipFooter,{featureIndex:featureIndex,totalFeatures:features.length,previousFeature:handlePreviousFeature,nextFeature:handleNextFeature}),isLoadingNextFeature&&external_kbnSharedDeps_React_default.a.createElement(loader["a"],{"data-test-subj":"loading-panel",overlay:true,size:"m"}))},[featureGeometry,featureIndex,featureProps,features,handleNextFeature,handlePreviousFeature,isError,isLoading,isLoadingNextFeature]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(features.length===0||getLayerName==null||loadFeatureProperties==null||loadFeatureGeometry==null){return}if(!isLoadingNextFeature){setIsLoading(true)}setIsError(false);const fetchFeatureProps=async()=>{if(features[featureIndex]!=null){const layerId=features[featureIndex].layerId;const featureId=features[featureIndex].id;try{const featureGeo=loadFeatureGeometry({layerId:layerId,featureId:featureId});const[featureProperties,layerNameString]=await Promise.all([loadFeatureProperties({layerId:layerId,featureId:featureId}),getLayerName(layerId)]);setFeatureProps(featureProperties);setFeatureGeometry(featureGeo);setLayerName(layerNameString)}catch(e){setIsError(true)}finally{setIsLoading(false);setIsLoadingNextFeature(false)}}};fetchFeatureProps()},[featureIndex,features,getLayerName,isLoadingNextFeature,loadFeatureGeometry,loadFeatureProperties]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiOutsideClickDetector"],{onOutsideClick:handleCloseTooltip},content)};MapToolTipComponent.displayName="MapToolTipComponent";const MapToolTip=external_kbnSharedDeps_React_default.a.memo(MapToolTipComponent);MapToolTip.displayName="MapToolTip";var store_sourcerer=__webpack_require__(137);const getDefaultSourcererSelector=()=>{const getKibanaIndexPatternsSelector=store_sourcerer["d"].kibanaIndexPatternsSelector();const getScopesSelector=store_sourcerer["d"].scopesSelector();const mapStateToProps=state=>{const kibanaIndexPatterns=getKibanaIndexPatternsSelector(state);const scope=getScopesSelector(state)[model["SourcererScopeName"].default];return{kibanaIndexPatterns:kibanaIndexPatterns,sourcererScope:scope}};return mapStateToProps};const EmbeddableMap=external_kbnSharedDeps_StyledComponents_default.a.div.attrs(()=>({className:"siemEmbeddable__map"})).withConfig({displayName:"EmbeddableMap",componentId:"sc-1t0ky4k-0"})([".embPanel{border:none;box-shadow:none;}.mapToolbarOverlay__button{display:none;}",""],({maintainRatio:maintainRatio})=>maintainRatio&&Object(external_kbnSharedDeps_StyledComponents_["css"])(["padding-top:calc(3 / 4 * 100%);position:relative;@media only screen and (min-width:","){padding-top:calc(9 / 32 * 100%);}@media only screen and (min-width:1441px) and (min-height:901px){padding-top:calc(9 / 21 * 100%);}.embPanel{bottom:0;left:0;position:absolute;right:0;top:0;}"],({theme:theme})=>theme.eui.euiBreakpoints.m));EmbeddableMap.displayName="EmbeddableMap";const EmbeddedMapComponent=({endDate:endDate,filters:filters,query:query,setQuery:setQuery,startDate:startDate})=>{const[embeddable,setEmbeddable]=external_kbnSharedDeps_React_default.a.useState(undefined);const[isError,setIsError]=Object(external_kbnSharedDeps_React_["useState"])(false);const[isIndexError,setIsIndexError]=Object(external_kbnSharedDeps_React_["useState"])(false);const[,dispatchToaster]=Object(toasters["h"])();const defaultSourcererScopeSelector=Object(external_kbnSharedDeps_React_["useMemo"])(getDefaultSourcererSelector,[]);const{kibanaIndexPatterns:kibanaIndexPatterns,sourcererScope:sourcererScope}=Object(use_selector["a"])(defaultSourcererScopeSelector);const[mapIndexPatterns,setMapIndexPatterns]=Object(external_kbnSharedDeps_React_["useState"])(kibanaIndexPatterns.filter(kip=>sourcererScope.selectedPatterns.includes(kip.title)));const portalNode=external_kbnSharedDeps_React_default.a.useMemo(()=>Object(web["c"])(),[]);const{services:services}=Object(lib_kibana["h"])();Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setMapIndexPatterns(prevMapIndexPatterns=>{const newIndexPatterns=kibanaIndexPatterns.filter(kip=>sourcererScope.selectedPatterns.includes(kip.title));if(!fast_deep_equal_default()(newIndexPatterns,prevMapIndexPatterns)){if(newIndexPatterns.length===0){setIsError(true)}return newIndexPatterns}return prevMapIndexPatterns})},[kibanaIndexPatterns,sourcererScope.selectedPatterns]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let isSubscribed=true;async function setupEmbeddable(){try{const embeddableObject=await createEmbeddable(filters,mapIndexPatterns,query,startDate,endDate,setQuery,portalNode,services.embeddable);if(isSubscribed){if(mapIndexPatterns.length===0){setIsIndexError(true)}else{setEmbeddable(embeddableObject);setIsIndexError(false)}}}catch(e){if(isSubscribed){Object(toasters["d"])(ERROR_CREATING_EMBEDDABLE,[e.message],dispatchToaster);setIsError(true)}}}if(embeddable==null&&sourcererScope.selectedPatterns.length>0){setupEmbeddable()}return()=>{isSubscribed=false}},[dispatchToaster,endDate,embeddable,filters,mapIndexPatterns,query,portalNode,services.embeddable,sourcererScope.selectedPatterns,setQuery,startDate]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{const setLayerList=async()=>{if(embeddable!=null){await embeddable.setLayerList(getLayerList(mapIndexPatterns));embeddable.reload()}};if(embeddable!=null&&!Object(embeddable_public_["isErrorEmbeddable"])(embeddable)){setLayerList()}},[embeddable,mapIndexPatterns]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(embeddable!=null){embeddable.updateInput({query:query})}},[embeddable,query]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(embeddable!=null){embeddable.updateInput({filters:filters})}},[embeddable,filters]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(embeddable!=null&&startDate!=null&&endDate!=null){const timeRange={from:new Date(startDate).toISOString(),to:new Date(endDate).toISOString()};embeddable.updateInput({timeRange:timeRange})}},[embeddable,startDate,endDate]);return isError?null:external_kbnSharedDeps_React_default.a.createElement(Embeddable,null,external_kbnSharedDeps_React_default.a.createElement(EmbeddableHeader,{title:EMBEDDABLE_HEADER_TITLE},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:`${services.docLinks.ELASTIC_WEBSITE_URL}guide/en/security/${services.docLinks.DOC_LINK_VERSION}/conf-map-ui.html`,target:"_blank"},EMBEDDABLE_HEADER_HELP))),external_kbnSharedDeps_React_default.a.createElement(web["a"],{node:portalNode},external_kbnSharedDeps_React_default.a.createElement(MapToolTip,null)),external_kbnSharedDeps_React_default.a.createElement(EmbeddableMap,{maintainRatio:!isIndexError},isIndexError?external_kbnSharedDeps_React_default.a.createElement(IndexPatternsMissingPrompt,{"data-test-subj":"missing-prompt"}):embeddable!=null?external_kbnSharedDeps_React_default.a.createElement(services.embeddable.EmbeddablePanel,{embeddable:embeddable}):external_kbnSharedDeps_React_default.a.createElement(loader["a"],{"data-test-subj":"loading-panel",overlay:true,size:"xl"})))};EmbeddedMapComponent.displayName="EmbeddedMapComponent";const EmbeddedMap=external_kbnSharedDeps_React_default.a.memo(EmbeddedMapComponent);EmbeddedMap.displayName="EmbeddedMap";const ERROR_NETWORK_KPI_DNS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkKpiDns.errorSearchDescription",{defaultMessage:`An error has occurred on network kpi dns search`});const FAIL_NETWORK_KPI_DNS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkKpiDns.failSearchDescription",{defaultMessage:`Failed to run search on network kpi dns`});const dns_ID="networkKpiDnsQuery";const useNetworkKpiDns=({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=false,startDate:startDate})=>{const{data:data,notifications:notifications}=Object(lib_kibana["h"])().services;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const searchSubscription$=Object(external_kbnSharedDeps_React_["useRef"])(new external_kbnSharedDeps_Rxjs_["Subscription"]);const[loading,setLoading]=Object(external_kbnSharedDeps_React_["useState"])(false);const[networkKpiDnsRequest,setNetworkKpiDnsRequest]=Object(external_kbnSharedDeps_React_["useState"])(null);const[networkKpiDnsResponse,setNetworkKpiDnsResponse]=Object(external_kbnSharedDeps_React_["useState"])({dnsQueries:0,id:dns_ID,inspect:{dsl:[],response:[]},isInspected:false,refetch:refetch.current});const networkKpiDnsSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{if(request==null||skip){return}const asyncSearch=async()=>{abortCtrl.current=new AbortController;setLoading(true);searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(Object(common_["isCompleteResponse"])(response)){setLoading(false);setNetworkKpiDnsResponse(prevResponse=>({...prevResponse,dnsQueries:response.dnsQueries,inspect:Object(public_helpers["a"])(response,prevResponse.inspect),refetch:refetch.current}));searchSubscription$.current.unsubscribe()}else if(Object(common_["isErrorResponse"])(response)){setLoading(false);notifications.toasts.addWarning(ERROR_NETWORK_KPI_DNS);searchSubscription$.current.unsubscribe()}},error:msg=>{setLoading(false);notifications.toasts.addDanger({title:FAIL_NETWORK_KPI_DNS,text:msg.message});searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch},[data.search,notifications.toasts,skip]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setNetworkKpiDnsRequest(prevRequest=>{const myRequest={...prevRequest!==null&&prevRequest!==void 0?prevRequest:{},defaultIndex:indexNames,factoryQueryType:search_strategy["NetworkKpiQueries"].dns,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}};if(!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[indexNames,endDate,filterQuery,startDate]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{networkKpiDnsSearch(networkKpiDnsRequest);return()=>{searchSubscription$.current.unsubscribe();abortCtrl.current.abort()}},[networkKpiDnsRequest,networkKpiDnsSearch]);return[loading,networkKpiDnsResponse]};const common_kpiWidgetHeight=228;const common_FlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"FlexGroup",componentId:"sc-1sakt4o-0"})(["min-height:","px;"],common_kpiWidgetHeight);common_FlexGroup.displayName="FlexGroup";const NetworkKpiBaseComponent=external_kbnSharedDeps_React_default.a.memo(({fieldsMapping:fieldsMapping,data:data,id:id,loading:loading=false,from:from,to:to,narrowDateRange:narrowDateRange})=>{const statItemsProps=useKpiMatrixStatus(fieldsMapping,data,id,from,to,narrowDateRange);if(loading){return external_kbnSharedDeps_React_default.a.createElement(common_FlexGroup,{justifyContent:"center",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"xl"})))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true},statItemsProps.map(mappedStatItemProps=>external_kbnSharedDeps_React_default.a.createElement(StatItemsComponent,mappedStatItemProps)))},(prevProps,nextProps)=>prevProps.fieldsMapping===nextProps.fieldsMapping&&prevProps.loading===nextProps.loading&&prevProps.id===nextProps.id&&prevProps.from===nextProps.from&&prevProps.to===nextProps.to&&prevProps.narrowDateRange===nextProps.narrowDateRange&&fast_deep_equal_default()(prevProps.data,nextProps.data));NetworkKpiBaseComponent.displayName="NetworkKpiBaseComponent";const NetworkKpiBaseComponentManage=Object(manage_query["a"])(NetworkKpiBaseComponent);const DNS_QUERIES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiNetwork.dnsQueries.title",{defaultMessage:"DNS queries"});const dns_fieldsMapping=[{key:"dnsQueries",fields:[{key:"dnsQueries",value:null}],description:DNS_QUERIES}];const NetworkKpiDnsComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const[loading,{refetch:refetch,id:id,inspect:inspect,...data}]=useNetworkKpiDns({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip});return external_kbnSharedDeps_React_default.a.createElement(NetworkKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:dns_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})};const NetworkKpiDns=external_kbnSharedDeps_React_default.a.memo(NetworkKpiDnsComponent);const ERROR_NETWORK_KPI_NETWORK_EVENTS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkKpiNetworkEvents.errorSearchDescription",{defaultMessage:`An error has occurred on network kpi network events search`});const FAIL_NETWORK_KPI_NETWORK_EVENTS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkKpiNetworkEvents.failSearchDescription",{defaultMessage:`Failed to run search on network kpi network events`});const network_events_ID="networkKpiNetworkEventsQuery";const useNetworkKpiNetworkEvents=({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=false,startDate:startDate})=>{const{data:data,notifications:notifications}=Object(lib_kibana["h"])().services;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const searchSubscription$=Object(external_kbnSharedDeps_React_["useRef"])(new external_kbnSharedDeps_Rxjs_["Subscription"]);const[loading,setLoading]=Object(external_kbnSharedDeps_React_["useState"])(false);const[networkKpiNetworkEventsRequest,setNetworkKpiNetworkEventsRequest]=Object(external_kbnSharedDeps_React_["useState"])(null);const[networkKpiNetworkEventsResponse,setNetworkKpiNetworkEventsResponse]=Object(external_kbnSharedDeps_React_["useState"])({networkEvents:0,id:network_events_ID,inspect:{dsl:[],response:[]},isInspected:false,refetch:refetch.current});const networkKpiNetworkEventsSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{if(request==null||skip){return}const asyncSearch=async()=>{abortCtrl.current=new AbortController;setLoading(true);searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(Object(common_["isCompleteResponse"])(response)){setLoading(false);setNetworkKpiNetworkEventsResponse(prevResponse=>({...prevResponse,networkEvents:response.networkEvents,inspect:Object(public_helpers["a"])(response,prevResponse.inspect),refetch:refetch.current}));searchSubscription$.current.unsubscribe()}else if(Object(common_["isErrorResponse"])(response)){setLoading(false);notifications.toasts.addWarning(ERROR_NETWORK_KPI_NETWORK_EVENTS);searchSubscription$.current.unsubscribe()}},error:msg=>{setLoading(false);notifications.toasts.addDanger({title:FAIL_NETWORK_KPI_NETWORK_EVENTS,text:msg.message});searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch},[data.search,notifications.toasts,skip]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setNetworkKpiNetworkEventsRequest(prevRequest=>{const myRequest={...prevRequest!==null&&prevRequest!==void 0?prevRequest:{},defaultIndex:indexNames,factoryQueryType:search_strategy["NetworkKpiQueries"].networkEvents,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}};if(!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[indexNames,endDate,filterQuery,startDate]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{networkKpiNetworkEventsSearch(networkKpiNetworkEventsRequest);return()=>{searchSubscription$.current.unsubscribe();abortCtrl.current.abort()}},[networkKpiNetworkEventsRequest,networkKpiNetworkEventsSearch]);return[loading,networkKpiNetworkEventsResponse]};const NETWORK_EVENTS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiNetwork.networkEvents.title",{defaultMessage:"Network events"});const network_events_euiVisColorPalette=Object(external_kbnSharedDeps_ElasticEui_["euiPaletteColorBlind"])();const euiColorVis1=network_events_euiVisColorPalette[1];const network_events_fieldsMapping=[{key:"networkEvents",fields:[{key:"networkEvents",value:null,color:euiColorVis1}],description:NETWORK_EVENTS}];const NetworkKpiNetworkEventsComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const[loading,{refetch:refetch,id:id,inspect:inspect,...data}]=useNetworkKpiNetworkEvents({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip});return external_kbnSharedDeps_React_default.a.createElement(NetworkKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:network_events_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})};const NetworkKpiNetworkEvents=external_kbnSharedDeps_React_default.a.memo(NetworkKpiNetworkEventsComponent);const ERROR_NETWORK_KPI_TLS_HANDSHAKES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkKpiTlsHandshakes.errorSearchDescription",{defaultMessage:`An error has occurred on network kpi tls handshakes search`});const FAIL_NETWORK_KPI_TLS_HANDSHAKES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkKpiTlsHandshakes.failSearchDescription",{defaultMessage:`Failed to run search on network kpi tls handshakes`});const tls_handshakes_ID="networkKpiTlsHandshakesQuery";const useNetworkKpiTlsHandshakes=({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=false,startDate:startDate})=>{const{data:data,notifications:notifications}=Object(lib_kibana["h"])().services;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const searchSubscription$=Object(external_kbnSharedDeps_React_["useRef"])(new external_kbnSharedDeps_Rxjs_["Subscription"]);const[loading,setLoading]=Object(external_kbnSharedDeps_React_["useState"])(false);const[networkKpiTlsHandshakesRequest,setNetworkKpiTlsHandshakesRequest]=Object(external_kbnSharedDeps_React_["useState"])(null);const[networkKpiTlsHandshakesResponse,setNetworkKpiTlsHandshakesResponse]=Object(external_kbnSharedDeps_React_["useState"])({tlsHandshakes:0,id:tls_handshakes_ID,inspect:{dsl:[],response:[]},isInspected:false,refetch:refetch.current});const networkKpiTlsHandshakesSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{if(request==null||skip){return}const asyncSearch=async()=>{abortCtrl.current=new AbortController;setLoading(true);searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(Object(common_["isCompleteResponse"])(response)){setLoading(false);setNetworkKpiTlsHandshakesResponse(prevResponse=>({...prevResponse,tlsHandshakes:response.tlsHandshakes,inspect:Object(public_helpers["a"])(response,prevResponse.inspect),refetch:refetch.current}));searchSubscription$.current.unsubscribe()}else if(Object(common_["isErrorResponse"])(response)){setLoading(false);notifications.toasts.addWarning(ERROR_NETWORK_KPI_TLS_HANDSHAKES);searchSubscription$.current.unsubscribe()}},error:msg=>{setLoading(false);notifications.toasts.addDanger({title:FAIL_NETWORK_KPI_TLS_HANDSHAKES,text:msg.message});searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch},[data.search,notifications.toasts,skip]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setNetworkKpiTlsHandshakesRequest(prevRequest=>{const myRequest={...prevRequest!==null&&prevRequest!==void 0?prevRequest:{},defaultIndex:indexNames,factoryQueryType:search_strategy["NetworkKpiQueries"].tlsHandshakes,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}};if(!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[indexNames,endDate,filterQuery,startDate]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{networkKpiTlsHandshakesSearch(networkKpiTlsHandshakesRequest);return()=>{searchSubscription$.current.unsubscribe();abortCtrl.current.abort()}},[networkKpiTlsHandshakesRequest,networkKpiTlsHandshakesSearch]);return[loading,networkKpiTlsHandshakesResponse]};const TLS_HANDSHAKES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiNetwork.tlsHandshakes.title",{defaultMessage:"TLS handshakes"});const tls_handshakes_fieldsMapping=[{key:"tlsHandshakes",fields:[{key:"tlsHandshakes",value:null}],description:TLS_HANDSHAKES}];const NetworkKpiTlsHandshakesComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const[loading,{refetch:refetch,id:id,inspect:inspect,...data}]=useNetworkKpiTlsHandshakes({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip});return external_kbnSharedDeps_React_default.a.createElement(NetworkKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:tls_handshakes_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})};const NetworkKpiTlsHandshakes=external_kbnSharedDeps_React_default.a.memo(NetworkKpiTlsHandshakesComponent);const ERROR_NETWORK_KPI_UNIQUE_FLOWS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkKpiUniqueFlows.errorSearchDescription",{defaultMessage:`An error has occurred on network kpi unique flows search`});const FAIL_NETWORK_KPI_UNIQUE_FLOWS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkKpiUniqueFlows.failSearchDescription",{defaultMessage:`Failed to run search on network kpi unique flows`});const unique_flows_ID="networkKpiUniqueFlowsQuery";const useNetworkKpiUniqueFlows=({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=false,startDate:startDate})=>{const{data:data,notifications:notifications}=Object(lib_kibana["h"])().services;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const searchSubscription$=Object(external_kbnSharedDeps_React_["useRef"])(new external_kbnSharedDeps_Rxjs_["Subscription"]);const[loading,setLoading]=Object(external_kbnSharedDeps_React_["useState"])(false);const[networkKpiUniqueFlowsRequest,setNetworkKpiUniqueFlowsRequest]=Object(external_kbnSharedDeps_React_["useState"])(null);const[networkKpiUniqueFlowsResponse,setNetworkKpiUniqueFlowsResponse]=Object(external_kbnSharedDeps_React_["useState"])({uniqueFlowId:0,id:unique_flows_ID,inspect:{dsl:[],response:[]},isInspected:false,refetch:refetch.current});const networkKpiUniqueFlowsSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{if(request==null||skip){return}const asyncSearch=async()=>{abortCtrl.current=new AbortController;setLoading(true);searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(Object(common_["isCompleteResponse"])(response)){setLoading(false);setNetworkKpiUniqueFlowsResponse(prevResponse=>({...prevResponse,uniqueFlowId:response.uniqueFlowId,inspect:Object(public_helpers["a"])(response,prevResponse.inspect),refetch:refetch.current}));searchSubscription$.current.unsubscribe()}else if(Object(common_["isErrorResponse"])(response)){setLoading(false);notifications.toasts.addWarning(ERROR_NETWORK_KPI_UNIQUE_FLOWS);searchSubscription$.current.unsubscribe()}},error:msg=>{setLoading(false);notifications.toasts.addDanger({title:FAIL_NETWORK_KPI_UNIQUE_FLOWS,text:msg.message});searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch},[data.search,notifications.toasts,skip]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setNetworkKpiUniqueFlowsRequest(prevRequest=>{const myRequest={...prevRequest!==null&&prevRequest!==void 0?prevRequest:{},defaultIndex:indexNames,factoryQueryType:search_strategy["NetworkKpiQueries"].uniqueFlows,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}};if(!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[indexNames,endDate,filterQuery,startDate]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{networkKpiUniqueFlowsSearch(networkKpiUniqueFlowsRequest);return()=>{searchSubscription$.current.unsubscribe();abortCtrl.current.abort()}},[networkKpiUniqueFlowsRequest,networkKpiUniqueFlowsSearch]);return[loading,networkKpiUniqueFlowsResponse]};const UNIQUE_FLOW_IDS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiNetwork.uniqueFlowIds.title",{defaultMessage:"Unique flow IDs"});const unique_flows_fieldsMapping=[{key:"uniqueFlowId",fields:[{key:"uniqueFlowId",value:null}],description:UNIQUE_FLOW_IDS}];const NetworkKpiUniqueFlowsComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const[loading,{refetch:refetch,id:id,inspect:inspect,...data}]=useNetworkKpiUniqueFlows({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip});return external_kbnSharedDeps_React_default.a.createElement(NetworkKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:unique_flows_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})};const NetworkKpiUniqueFlows=external_kbnSharedDeps_React_default.a.memo(NetworkKpiUniqueFlowsComponent);const ERROR_NETWORK_KPI_UNIQUE_PRIVATE_IPS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkKpiUniquePrivateIps.errorSearchDescription",{defaultMessage:`An error has occurred on network kpi unique private ips search`});const FAIL_NETWORK_KPI_UNIQUE_PRIVATE_IPS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkKpiUniquePrivateIps.failSearchDescription",{defaultMessage:`Failed to run search on network kpi unique private ips`});const unique_private_ips_ID="networkKpiUniquePrivateIpsQuery";const useNetworkKpiUniquePrivateIps=({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=false,startDate:startDate})=>{const{data:data,notifications:notifications}=Object(lib_kibana["h"])().services;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const searchSubscription$=Object(external_kbnSharedDeps_React_["useRef"])(new external_kbnSharedDeps_Rxjs_["Subscription"]);const[loading,setLoading]=Object(external_kbnSharedDeps_React_["useState"])(false);const[networkKpiUniquePrivateIpsRequest,setNetworkKpiUniquePrivateIpsRequest]=Object(external_kbnSharedDeps_React_["useState"])(null);const[networkKpiUniquePrivateIpsResponse,setNetworkKpiUniquePrivateIpsResponse]=Object(external_kbnSharedDeps_React_["useState"])({uniqueDestinationPrivateIps:0,uniqueDestinationPrivateIpsHistogram:null,uniqueSourcePrivateIps:0,uniqueSourcePrivateIpsHistogram:null,id:unique_private_ips_ID,inspect:{dsl:[],response:[]},isInspected:false,refetch:refetch.current});const networkKpiUniquePrivateIpsSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{if(request==null||skip){return}const asyncSearch=async()=>{abortCtrl.current=new AbortController;setLoading(true);searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(Object(common_["isCompleteResponse"])(response)){setLoading(false);setNetworkKpiUniquePrivateIpsResponse(prevResponse=>({...prevResponse,uniqueDestinationPrivateIps:response.uniqueDestinationPrivateIps,uniqueDestinationPrivateIpsHistogram:response.uniqueDestinationPrivateIpsHistogram,uniqueSourcePrivateIps:response.uniqueSourcePrivateIps,uniqueSourcePrivateIpsHistogram:response.uniqueSourcePrivateIpsHistogram,inspect:Object(public_helpers["a"])(response,prevResponse.inspect),refetch:refetch.current}));searchSubscription$.current.unsubscribe()}else if(Object(common_["isErrorResponse"])(response)){setLoading(false);notifications.toasts.addWarning(ERROR_NETWORK_KPI_UNIQUE_PRIVATE_IPS);searchSubscription$.current.unsubscribe()}},error:msg=>{setLoading(false);notifications.toasts.addDanger({title:FAIL_NETWORK_KPI_UNIQUE_PRIVATE_IPS,text:msg.message});searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch},[data.search,notifications.toasts,skip]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setNetworkKpiUniquePrivateIpsRequest(prevRequest=>{const myRequest={...prevRequest!==null&&prevRequest!==void 0?prevRequest:{},defaultIndex:indexNames,factoryQueryType:search_strategy["NetworkKpiQueries"].uniquePrivateIps,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}};if(!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[indexNames,endDate,filterQuery,startDate]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{networkKpiUniquePrivateIpsSearch(networkKpiUniquePrivateIpsRequest);return()=>{searchSubscription$.current.unsubscribe();abortCtrl.current.abort()}},[networkKpiUniquePrivateIpsRequest,networkKpiUniquePrivateIpsSearch]);return[loading,networkKpiUniquePrivateIpsResponse]};const UNIQUE_PRIVATE_IPS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.title",{defaultMessage:"Unique private IPs"});const translations_SOURCE_UNIT_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.sourceUnitLabel",{defaultMessage:"source"});const translations_DESTINATION_UNIT_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.destinationUnitLabel",{defaultMessage:"destination"});const translations_SOURCE_CHART_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.sourceChartLabel",{defaultMessage:"Src."});const translations_DESTINATION_CHART_LABEL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.destinationChartLabel",{defaultMessage:"Dest."});const unique_private_ips_euiVisColorPalette=Object(external_kbnSharedDeps_ElasticEui_["euiPaletteColorBlind"])();const euiColorVis2=unique_private_ips_euiVisColorPalette[2];const euiColorVis3=unique_private_ips_euiVisColorPalette[3];const unique_private_ips_fieldsMapping=[{key:"UniqueIps",fields:[{key:"uniqueSourcePrivateIps",value:null,name:translations_SOURCE_CHART_LABEL,description:translations_SOURCE_UNIT_LABEL,color:euiColorVis2,icon:"visMapCoordinate"},{key:"uniqueDestinationPrivateIps",value:null,name:translations_DESTINATION_CHART_LABEL,description:translations_DESTINATION_UNIT_LABEL,color:euiColorVis3,icon:"visMapCoordinate"}],description:UNIQUE_PRIVATE_IPS,enableAreaChart:true,enableBarChart:true}];const NetworkKpiUniquePrivateIpsComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const[loading,{refetch:refetch,id:id,inspect:inspect,...data}]=useNetworkKpiUniquePrivateIps({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip});return external_kbnSharedDeps_React_default.a.createElement(NetworkKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:unique_private_ips_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})};const NetworkKpiUniquePrivateIps=external_kbnSharedDeps_React_default.a.memo(NetworkKpiUniquePrivateIpsComponent);const NetworkKpiComponent=external_kbnSharedDeps_React_default.a.memo(({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,setQuery:setQuery,skip:skip,narrowDateRange:narrowDateRange})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(NetworkKpiNetworkEvents,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(NetworkKpiDns,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(NetworkKpiUniqueFlows,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(NetworkKpiTlsHandshakes,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(NetworkKpiUniquePrivateIps,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip}))));NetworkKpiComponent.displayName="NetworkKpiComponent";var network_store=__webpack_require__(130);var network=__webpack_require__(182);var network_top_n_flow_table=__webpack_require__(773);var network_top_n_flow=__webpack_require__(787);const NetworkTopNFlowTableManage=Object(manage_query["a"])(network_top_n_flow_table["a"]);const IPsQueryTabBody=({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,setQuery:setQuery,flowTarget:flowTarget})=>{const[loading,{id:id,inspect:inspect,isInspected:isInspected,loadPage:loadPage,networkTopNFlow:networkTopNFlow,pageInfo:pageInfo,refetch:refetch,totalCount:totalCount}]=Object(network_top_n_flow["a"])({endDate:endDate,flowTarget:flowTarget,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,type:network_store["c"].NetworkType.page});return external_kbnSharedDeps_React_default.a.createElement(NetworkTopNFlowTableManage,{data:networkTopNFlow,fakeTotalCount:Object(external_kbnSharedDeps_LodashFp_["getOr"])(50,"fakeTotalCount",pageInfo),flowTargeted:flowTarget,id:id,inspect:inspect,isInspect:isInspected,loading:loading,loadPage:loadPage,refetch:refetch,setQuery:setQuery,showMorePagesIndicator:Object(external_kbnSharedDeps_LodashFp_["getOr"])(false,"showMorePagesIndicator",pageInfo),totalCount:totalCount,type:network_store["c"].NetworkType.page})};IPsQueryTabBody.displayName="IPsQueryTabBody";var network_top_countries_table=__webpack_require__(772);var network_top_countries=__webpack_require__(786);const NetworkTopCountriesTableManage=Object(manage_query["a"])(network_top_countries_table["a"]);const CountriesQueryTabBody=({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,setQuery:setQuery,indexPattern:indexPattern,flowTarget:flowTarget})=>{const[loading,{id:id,inspect:inspect,isInspected:isInspected,loadPage:loadPage,networkTopCountries:networkTopCountries,pageInfo:pageInfo,refetch:refetch,totalCount:totalCount}]=Object(network_top_countries["a"])({endDate:endDate,flowTarget:flowTarget,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,type:network_store["c"].NetworkType.page});return external_kbnSharedDeps_React_default.a.createElement(NetworkTopCountriesTableManage,{data:networkTopCountries,fakeTotalCount:Object(external_kbnSharedDeps_LodashFp_["getOr"])(50,"fakeTotalCount",pageInfo),flowTargeted:flowTarget,id:id,indexPattern:indexPattern,inspect:inspect,isInspect:isInspected,loading:loading,loadPage:loadPage,refetch:refetch,setQuery:setQuery,showMorePagesIndicator:Object(external_kbnSharedDeps_LodashFp_["getOr"])(false,"showMorePagesIndicator",pageInfo),totalCount:totalCount,type:network_store["c"].NetworkType.page})};CountriesQueryTabBody.displayName="CountriesQueryTabBody";var network_http_table=__webpack_require__(771);var network_http=__webpack_require__(785);const NetworkHttpTableManage=Object(manage_query["a"])(network_http_table["a"]);const HttpQueryTabBody=({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,setQuery:setQuery})=>{const[loading,{id:id,inspect:inspect,isInspected:isInspected,loadPage:loadPage,networkHttp:networkHttp,pageInfo:pageInfo,refetch:refetch,totalCount:totalCount}]=Object(network_http["a"])({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,type:network_store["c"].NetworkType.page});return external_kbnSharedDeps_React_default.a.createElement(NetworkHttpTableManage,{data:networkHttp,fakeTotalCount:Object(external_kbnSharedDeps_LodashFp_["getOr"])(50,"fakeTotalCount",pageInfo),id:id,inspect:inspect,isInspect:isInspected,loading:loading,loadPage:loadPage,refetch:refetch,setQuery:setQuery,showMorePagesIndicator:Object(external_kbnSharedDeps_LodashFp_["getOr"])(false,"showMorePagesIndicator",pageInfo),totalCount:totalCount,type:network_store["c"].NetworkType.page})};HttpQueryTabBody.displayName="HttpQueryTabBody";var anomalies_network_table=__webpack_require__(756);var paginated_table=__webpack_require__(218);var draggable_wrapper=__webpack_require__(144);var data_provider=__webpack_require__(126);var formatted_bytes=__webpack_require__(270);var data_providers_provider=__webpack_require__(164);const TOP_DNS_DOMAINS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDnsTable.title",{defaultMessage:"Top DNS domains"});const UNIT=totalCount=>external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDnsTable.unit",{values:{totalCount:totalCount},defaultMessage:`{totalCount, plural, =1 {domain} other {domains}}`});const TOOLTIP=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDnsTable.helperTooltip",{defaultMessage:"This shows DNS protocol traffic only and can be useful for hunting domains used in DNS data exfiltration."});const REGISTERED_DOMAIN=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDnsTable.column.registeredDomain",{defaultMessage:"Registered domain"});const TOTAL_QUERIES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDnsTable.column.TotalQueriesTitle",{defaultMessage:"Total queries"});const UNIQUE_DOMAINS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDnsTable.column.uniqueDomainsTitle",{defaultMessage:"Unique domains"});const DNS_BYTES_IN=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDnsTable.column.bytesInTitle",{defaultMessage:"DNS bytes in"});const DNS_BYTES_OUT=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDnsTable.column.bytesOutTitle",{defaultMessage:"DNS bytes out"});const INCLUDE_PTR_RECORDS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDnsTable.select.includePtrRecords",{defaultMessage:"Include PTR records"});const ROWS_5=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDnsTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"});const ROWS_10=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDnsTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"});const getNetworkDnsColumns=()=>[{field:`node.${search_strategy["NetworkDnsFields"].dnsName}`,name:REGISTERED_DOMAIN,truncateText:false,hideForMobile:false,sortable:true,render:dnsName=>{if(dnsName!=null){const id=Object(drag_and_drop_helpers["l"])(`networkDns-table--name-${dnsName}`);return external_kbnSharedDeps_React_default.a.createElement(draggable_wrapper["b"],{key:id,dataProvider:{and:[],enabled:true,id:id,name:dnsName,excluded:false,kqlQuery:"",queryMatch:{field:"dns.question.registered_domain",value:dnsName,operator:data_provider["c"]}},render:(dataProvider,_,snapshot)=>snapshot.isDragging?external_kbnSharedDeps_React_default.a.createElement(draggable_wrapper["a"],null,external_kbnSharedDeps_React_default.a.createElement(data_providers_provider["a"],{dataProvider:dataProvider})):Object(empty_value["a"])(dnsName)})}else{return Object(empty_value["d"])()}}},{align:"right",field:`node.${search_strategy["NetworkDnsFields"].queryCount}`,name:TOTAL_QUERIES,sortable:true,truncateText:false,hideForMobile:false,render:queryCount=>{if(queryCount!=null){return external_kbnSharedDeps_ElasticNumeral_default()(queryCount).format("0")}else{return Object(empty_value["d"])()}}},{align:"right",field:`node.${search_strategy["NetworkDnsFields"].uniqueDomains}`,name:UNIQUE_DOMAINS,sortable:true,truncateText:false,hideForMobile:false,render:uniqueDomains=>{if(uniqueDomains!=null){return external_kbnSharedDeps_ElasticNumeral_default()(uniqueDomains).format("0")}else{return Object(empty_value["d"])()}}},{align:"right",field:`node.${search_strategy["NetworkDnsFields"].dnsBytesIn}`,name:DNS_BYTES_IN,sortable:true,truncateText:false,hideForMobile:false,render:dnsBytesIn=>{if(dnsBytesIn!=null){return external_kbnSharedDeps_React_default.a.createElement(formatted_bytes["a"],{value:dnsBytesIn})}else{return Object(empty_value["d"])()}}},{align:"right",field:`node.${search_strategy["NetworkDnsFields"].dnsBytesOut}`,name:DNS_BYTES_OUT,sortable:true,truncateText:false,hideForMobile:false,render:dnsBytesOut=>{if(dnsBytesOut!=null){return external_kbnSharedDeps_React_default.a.createElement(formatted_bytes["a"],{value:dnsBytesOut})}else{return Object(empty_value["d"])()}}}];const IsPtrIncluded=external_kbnSharedDeps_React_default.a.memo(({isPtrIncluded:isPtrIncluded,onChange:onChange})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{name:"switch-ptr-included",label:INCLUDE_PTR_RECORDS,checked:isPtrIncluded,onChange:onChange}));IsPtrIncluded.displayName="IsPtrIncluded";const tableType=network_store["c"].NetworkTableType.dns;const rowItems=[{text:ROWS_5,numberOfRow:5},{text:ROWS_10,numberOfRow:10}];const NetworkDnsTableComponent=({data:data,fakeTotalCount:fakeTotalCount,id:id,isInspect:isInspect,loading:loading,loadPage:loadPage,showMorePagesIndicator:showMorePagesIndicator,totalCount:totalCount,type:type})=>{const dispatch=Object(react_redux_lib["useDispatch"])();const getNetworkDnsSelector=Object(external_kbnSharedDeps_React_["useMemo"])(()=>network_store["e"].dnsSelector(),[]);const{activePage:activePage,isPtrIncluded:isPtrIncluded,limit:limit,sort:sort}=Object(use_selector["a"])(getNetworkDnsSelector);const updateLimitPagination=Object(external_kbnSharedDeps_React_["useCallback"])(newLimit=>dispatch(network_store["b"].updateNetworkTable({networkType:type,tableType:tableType,updates:{limit:newLimit}})),[type,dispatch]);const updateActivePage=Object(external_kbnSharedDeps_React_["useCallback"])(newPage=>dispatch(network_store["b"].updateNetworkTable({networkType:type,tableType:tableType,updates:{activePage:newPage}})),[dispatch,type]);const onChange=Object(external_kbnSharedDeps_React_["useCallback"])(criteria=>{if(criteria.sort!=null){const newDnsSortField={field:criteria.sort.field.split(".")[1],direction:criteria.sort.direction};if(!fast_deep_equal_default()(newDnsSortField,sort)){dispatch(network_store["b"].updateNetworkTable({networkType:type,tableType:tableType,updates:{sort:newDnsSortField}}))}}},[sort,type,dispatch]);const onChangePtrIncluded=Object(external_kbnSharedDeps_React_["useCallback"])(()=>dispatch(network_store["b"].updateNetworkTable({networkType:type,tableType:tableType,updates:{isPtrIncluded:!isPtrIncluded}})),[dispatch,type,isPtrIncluded]);const columns=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getNetworkDnsColumns(),[]);const sorting=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({field:`node.${sort.field}`,direction:sort.direction}),[sort.direction,sort.field]);const HeaderSupplement=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(IsPtrIncluded,{isPtrIncluded:isPtrIncluded,onChange:onChangePtrIncluded}),[isPtrIncluded,onChangePtrIncluded]);return external_kbnSharedDeps_React_default.a.createElement(paginated_table["a"],{activePage:activePage,columns:columns,dataTestSubj:`table-${tableType}`,headerCount:totalCount,headerSupplement:HeaderSupplement,headerTitle:TOP_DNS_DOMAINS,headerTooltip:TOOLTIP,headerUnit:UNIT(totalCount),id:id,itemsPerRow:rowItems,isInspect:isInspect,limit:limit,loading:loading,loadPage:loadPage,onChange:onChange,pageOfItems:data,showMorePagesIndicator:showMorePagesIndicator,sorting:sorting,totalCount:fakeTotalCount,updateActivePage:updateActivePage,updateLimitPagination:updateLimitPagination})};NetworkDnsTableComponent.displayName="NetworkDnsTableComponent";const NetworkDnsTable=external_kbnSharedDeps_React_default.a.memo(NetworkDnsTableComponent);var paginated_table_helpers=__webpack_require__(206);const ERROR_NETWORK_DNS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDns.errorSearchDescription",{defaultMessage:`An error has occurred on network dns search`});const FAIL_NETWORK_DNS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.networkDns.failSearchDescription",{defaultMessage:`Failed to run search on network dns`});const network_dns_ID="networkDnsQuery";const useNetworkDns=({docValueFields:docValueFields,endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,type:type})=>{const getNetworkDnsSelector=Object(external_kbnSharedDeps_React_["useMemo"])(()=>network_store["e"].dnsSelector(),[]);const{activePage:activePage,sort:sort,isPtrIncluded:isPtrIncluded,limit:limit}=Object(use_selector["a"])(getNetworkDnsSelector);const{data:data,notifications:notifications}=Object(lib_kibana["h"])().services;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const searchSubscription$=Object(external_kbnSharedDeps_React_["useRef"])(new external_kbnSharedDeps_Rxjs_["Subscription"]);const[loading,setLoading]=Object(external_kbnSharedDeps_React_["useState"])(false);const[networkDnsRequest,setNetworkDnsRequest]=Object(external_kbnSharedDeps_React_["useState"])(null);const wrappedLoadMore=Object(external_kbnSharedDeps_React_["useCallback"])(newActivePage=>{setNetworkDnsRequest(prevRequest=>{if(!prevRequest){return prevRequest}return{...prevRequest,pagination:Object(paginated_table_helpers["a"])(newActivePage,limit)}})},[limit]);const[networkDnsResponse,setNetworkDnsResponse]=Object(external_kbnSharedDeps_React_["useState"])({networkDns:[],histogram:[],id:network_dns_ID,inspect:{dsl:[],response:[]},isInspected:false,loadPage:wrappedLoadMore,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:false},refetch:refetch.current,totalCount:-1});const networkDnsSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{if(request==null||skip){return}const asyncSearch=async()=>{abortCtrl.current=new AbortController;setLoading(true);searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(Object(common_["isCompleteResponse"])(response)){setLoading(false);setNetworkDnsResponse(prevResponse=>{var _response$histogram;return{...prevResponse,networkDns:response.edges,inspect:Object(public_helpers["a"])(response,prevResponse.inspect),pageInfo:response.pageInfo,refetch:refetch.current,totalCount:response.totalCount,histogram:(_response$histogram=response.histogram)!==null&&_response$histogram!==void 0?_response$histogram:prevResponse.histogram}});searchSubscription$.current.unsubscribe()}else if(Object(common_["isErrorResponse"])(response)){setLoading(false);notifications.toasts.addWarning(ERROR_NETWORK_DNS);searchSubscription$.current.unsubscribe()}},error:msg=>{setLoading(false);notifications.toasts.addDanger({title:FAIL_NETWORK_DNS,text:msg.message});searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch},[data.search,notifications.toasts,skip]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setNetworkDnsRequest(prevRequest=>{const myRequest={...prevRequest!==null&&prevRequest!==void 0?prevRequest:{},defaultIndex:indexNames,docValueFields:docValueFields!==null&&docValueFields!==void 0?docValueFields:[],isPtrIncluded:isPtrIncluded,factoryQueryType:search_strategy["NetworkQueries"].dns,filterQuery:Object(containers_helpers["a"])(filterQuery),pagination:Object(paginated_table_helpers["a"])(activePage,limit,true),sort:sort,timerange:{interval:"12h",from:startDate,to:endDate}};if(!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[activePage,indexNames,endDate,filterQuery,limit,startDate,sort,isPtrIncluded,docValueFields]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{networkDnsSearch(networkDnsRequest);return()=>{searchSubscription$.current.unsubscribe();abortCtrl.current.abort()}},[networkDnsRequest,networkDnsSearch]);return[loading,networkDnsResponse]};var network_pages_translations=__webpack_require__(391);var components_matrix_histogram=__webpack_require__(254);var security_solution=__webpack_require__(193);var _dnsStackByOptions$fi;function dns_query_tab_body_extends(){dns_query_tab_body_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return dns_query_tab_body_extends.apply(this,arguments)}const HISTOGRAM_ID="networkDnsHistogramQuery";const NetworkDnsTableManage=Object(manage_query["a"])(NetworkDnsTable);const dnsStackByOptions=[{text:"dns.question.registered_domain",value:"dns.question.registered_domain"}];const DEFAULT_STACK_BY="dns.question.registered_domain";const histogramConfigs={defaultStackByOption:(_dnsStackByOptions$fi=dnsStackByOptions.find(o=>o.text===DEFAULT_STACK_BY))!==null&&_dnsStackByOptions$fi!==void 0?_dnsStackByOptions$fi:dnsStackByOptions[0],errorMessage:network_pages_translations["b"],histogramType:security_solution["MatrixHistogramType"].dns,stackByOptions:dnsStackByOptions,subtitle:undefined};const DnsQueryTabBodyComponent=({deleteQuery:deleteQuery,docValueFields:docValueFields,endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,setQuery:setQuery,type:type})=>{const getNetworkDnsSelector=network_store["e"].dnsSelector();const isPtrIncluded=Object(use_selector["b"])(state=>getNetworkDnsSelector(state).isPtrIncluded);Object(external_kbnSharedDeps_React_["useEffect"])(()=>()=>{if(deleteQuery){deleteQuery({id:HISTOGRAM_ID})}},[deleteQuery]);const[loading,{totalCount:totalCount,networkDns:networkDns,pageInfo:pageInfo,loadPage:loadPage,id:id,inspect:inspect,isInspected:isInspected,refetch:refetch}]=useNetworkDns({docValueFields:docValueFields!==null&&docValueFields!==void 0?docValueFields:[],endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,type:type});const getTitle=Object(external_kbnSharedDeps_React_["useCallback"])(option=>network_pages_translations["a"](option.text),[]);const dnsHistogramConfigs=Object(external_kbnSharedDeps_React_["useMemo"])(()=>({...histogramConfigs,title:getTitle}),[getTitle]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(components_matrix_histogram["a"],dns_query_tab_body_extends({id:HISTOGRAM_ID,isPtrIncluded:isPtrIncluded,docValueFields:docValueFields,endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,setQuery:setQuery,showLegend:true,startDate:startDate},dnsHistogramConfigs)),external_kbnSharedDeps_React_default.a.createElement(NetworkDnsTableManage,{data:networkDns,fakeTotalCount:Object(external_kbnSharedDeps_LodashFp_["getOr"])(50,"fakeTotalCount",pageInfo),id:id,inspect:inspect,isInspect:isInspected,loading:loading,loadPage:loadPage,refetch:refetch,setQuery:setQuery,showMorePagesIndicator:Object(external_kbnSharedDeps_LodashFp_["getOr"])(false,"showMorePagesIndicator",pageInfo),totalCount:totalCount,type:type}))};DnsQueryTabBodyComponent.displayName="DnsQueryTabBodyComponent";const DnsQueryTabBody=external_kbnSharedDeps_React_default.a.memo(DnsQueryTabBodyComponent);var conditional_flex_group=__webpack_require__(726);var navigation_types=__webpack_require__(275);var containers_tls=__webpack_require__(788);var tls_table=__webpack_require__(774);const TlsTableManage=Object(manage_query["a"])(tls_table["a"]);const TlsQueryTabBodyComponent=({endDate:endDate,filterQuery:filterQuery,flowTarget:flowTarget,indexNames:indexNames,ip:ip="",setQuery:setQuery,skip:skip,startDate:startDate,type:type})=>{const[loading,{id:id,inspect:inspect,isInspected:isInspected,tls:tls,totalCount:totalCount,pageInfo:pageInfo,loadPage:loadPage,refetch:refetch}]=Object(containers_tls["a"])({endDate:endDate,filterQuery:filterQuery,flowTarget:flowTarget,indexNames:indexNames,ip:ip,skip:skip,startDate:startDate,type:type});return external_kbnSharedDeps_React_default.a.createElement(TlsTableManage,{data:tls,id:id,inspect:inspect,isInspect:isInspected,fakeTotalCount:Object(external_kbnSharedDeps_LodashFp_["getOr"])(50,"fakeTotalCount",pageInfo),loading:loading,loadPage:loadPage,showMorePagesIndicator:Object(external_kbnSharedDeps_LodashFp_["getOr"])(false,"showMorePagesIndicator",pageInfo),refetch:refetch,setQuery:setQuery,totalCount:totalCount,type:type})};TlsQueryTabBodyComponent.displayName="TlsQueryTabBodyComponent";const TlsQueryTabBody=external_kbnSharedDeps_React_default.a.memo(TlsQueryTabBodyComponent);var alerts_viewer=__webpack_require__(770);function alerts_query_tab_body_extends(){alerts_query_tab_body_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return alerts_query_tab_body_extends.apply(this,arguments)}const filterNetworkData=[{query:{bool:{filter:[{bool:{should:[{bool:{should:[{exists:{field:"source.ip"}}],minimum_should_match:1}},{bool:{should:[{exists:{field:"destination.ip"}}],minimum_should_match:1}}],minimum_should_match:1}}]}},meta:{alias:"",disabled:false,key:"bool",negate:false,type:"custom",value:'{"bool":{"filter":[{"bool":{"should":[{"bool":{"should":[{"exists":{"field": "source.ip"}}],"minimum_should_match":1}},{"bool":{"should":[{"exists":{"field": "destination.ip"}}],"minimum_should_match":1}}],"minimum_should_match":1}}]}}'}}];const NetworkAlertsQueryTabBody=external_kbnSharedDeps_React_default.a.memo(alertsProps=>external_kbnSharedDeps_React_default.a.createElement(alerts_viewer["a"],alerts_query_tab_body_extends({timelineId:types_timeline["e"].networkPageExternalAlerts},alertsProps,{pageFilters:filterNetworkData})));NetworkAlertsQueryTabBody.displayName="NetworkAlertsQueryTabBody";function network_routes_extends(){network_routes_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return network_routes_extends.apply(this,arguments)}const NetworkRoutes=external_kbnSharedDeps_React_default.a.memo(({networkPagePath:networkPagePath,docValueFields:docValueFields,type:type,to:to,filterQuery:filterQuery,isInitializing:isInitializing,from:from,indexPattern:indexPattern,indexNames:indexNames,setQuery:setQuery,setAbsoluteRangeDatePicker:setAbsoluteRangeDatePicker})=>{const narrowDateRange=Object(external_kbnSharedDeps_React_["useCallback"])((score,interval)=>{const fromTo=Object(score_interval_to_datetime["a"])(score,interval);setAbsoluteRangeDatePicker({id:"global",from:fromTo.from,to:fromTo.to})},[setAbsoluteRangeDatePicker]);const updateDateRange=Object(external_kbnSharedDeps_React_["useCallback"])(({x:x})=>{if(!x){return}const[min,max]=x;setAbsoluteRangeDatePicker({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()})},[setAbsoluteRangeDatePicker]);const networkAnomaliesFilterQuery={bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}};const commonProps={startDate:from,endDate:to,indexNames:indexNames,skip:isInitializing,type:type,narrowDateRange:narrowDateRange,setQuery:setQuery,filterQuery:filterQuery};const tabProps={...commonProps,indexPattern:indexPattern,updateDateRange:updateDateRange};const anomaliesProps={...commonProps,anomaliesFilterQuery:networkAnomaliesFilterQuery,AnomaliesTableComponent:anomalies_network_table["a"]};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:`/:tabName(${navigation_types["a"].dns})`},external_kbnSharedDeps_React_default.a.createElement(DnsQueryTabBody,network_routes_extends({},tabProps,{docValueFields:docValueFields}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:`/:tabName(${navigation_types["a"].flows})`},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(conditional_flex_group["a"],{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(IPsQueryTabBody,network_routes_extends({},tabProps,{flowTarget:network["FlowTargetSourceDest"].source}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(IPsQueryTabBody,network_routes_extends({},tabProps,{flowTarget:network["FlowTargetSourceDest"].destination})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(conditional_flex_group["a"],{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(CountriesQueryTabBody,network_routes_extends({},tabProps,{flowTarget:network["FlowTargetSourceDest"].source}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(CountriesQueryTabBody,network_routes_extends({},tabProps,{flowTarget:network["FlowTargetSourceDest"].destination})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:`/:tabName(${navigation_types["a"].http})`},external_kbnSharedDeps_React_default.a.createElement(HttpQueryTabBody,tabProps)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:`/:tabName(${navigation_types["a"].tls})`},external_kbnSharedDeps_React_default.a.createElement(TlsQueryTabBody,network_routes_extends({},tabProps,{flowTarget:network["FlowTargetSourceDest"].source}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:`/:tabName(${navigation_types["a"].anomalies})`},external_kbnSharedDeps_React_default.a.createElement(anomalies_query_tab_body["a"],network_routes_extends({},anomaliesProps,{AnomaliesTableComponent:anomalies_network_table["a"]}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:`/:tabName(${navigation_types["a"].alerts})`},external_kbnSharedDeps_React_default.a.createElement(NetworkAlertsQueryTabBody,tabProps)))});NetworkRoutes.displayName="NetworkRoutes";const network_routes_loading_FlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"FlexGroup",componentId:"sc-1sbaj97-0"})(["min-height:200px;"]);network_routes_loading_FlexGroup.displayName="FlexGroup";const NetworkRoutesLoading=()=>external_kbnSharedDeps_React_default.a.createElement(network_routes_loading_FlexGroup,{justifyContent:"center",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"xl"})));NetworkRoutesLoading.displayName="NetworkRoutesLoading";const getTabsOnNetworkUrl=tabName=>`/${tabName}`;const navTabsNetwork=hasMlUserPermissions=>{const networkNavTabs={[navigation_types["a"].flows]:{id:navigation_types["a"].flows,name:network_pages_translations["f"],href:getTabsOnNetworkUrl(navigation_types["a"].flows),disabled:false,urlKey:"network",pageId:app_types["a"].network},[navigation_types["a"].dns]:{id:navigation_types["a"].dns,name:network_pages_translations["e"],href:getTabsOnNetworkUrl(navigation_types["a"].dns),disabled:false,urlKey:"network",pageId:app_types["a"].network},[navigation_types["a"].http]:{id:navigation_types["a"].http,name:network_pages_translations["g"],href:getTabsOnNetworkUrl(navigation_types["a"].http),disabled:false,urlKey:"network",pageId:app_types["a"].network},[navigation_types["a"].tls]:{id:navigation_types["a"].tls,name:network_pages_translations["h"],href:getTabsOnNetworkUrl(navigation_types["a"].tls),disabled:false,urlKey:"network",pageId:app_types["a"].network},[navigation_types["a"].anomalies]:{id:navigation_types["a"].anomalies,name:network_pages_translations["d"],href:getTabsOnNetworkUrl(navigation_types["a"].anomalies),disabled:false,urlKey:"network",pageId:app_types["a"].network},[navigation_types["a"].alerts]:{id:navigation_types["a"].alerts,name:network_pages_translations["c"],href:getTabsOnNetworkUrl(navigation_types["a"].alerts),disabled:false,urlKey:"network",pageId:app_types["a"].network}};return hasMlUserPermissions?networkNavTabs:Object(external_kbnSharedDeps_LodashFp_["omit"])([navigation_types["a"].anomalies],networkNavTabs)};const getNetworkRoutePath=(capabilitiesFetched,hasMlUserPermission)=>{if(capabilitiesFetched&&!hasMlUserPermission){return`/:tabName(${navigation_types["a"].flows}|${navigation_types["a"].dns}|${navigation_types["a"].http}|${navigation_types["a"].tls}|${navigation_types["a"].alerts})`}return`/:tabName(`+`${navigation_types["a"].flows}|`+`${navigation_types["a"].dns}|`+`${navigation_types["a"].anomalies}|`+`${navigation_types["a"].http}|`+`${navigation_types["a"].tls}|`+`${navigation_types["a"].alerts})`};const network_StyledFullHeightContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-5donvf-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]);const NetworkComponent=external_kbnSharedDeps_React_default.a.memo(({networkPagePath:networkPagePath,hasMlUserPermissions:hasMlUserPermissions,capabilitiesFetched:capabilitiesFetched})=>{const dispatch=Object(react_redux_lib["useDispatch"])();const containerElement=Object(external_kbnSharedDeps_React_["useRef"])(null);const getTimeline=Object(external_kbnSharedDeps_React_["useMemo"])(()=>store_timeline["b"].getTimelineByIdSelector(),[]);const graphEventId=Object(use_selector["b"])(state=>{var _getTimeline;return((_getTimeline=getTimeline(state,types_timeline["e"].networkPageExternalAlerts))!==null&&_getTimeline!==void 0?_getTimeline:defaults["a"]).graphEventId});const getGlobalFiltersQuerySelector=Object(external_kbnSharedDeps_React_["useMemo"])(()=>store["inputsSelectors"].globalFiltersQuerySelector(),[]);const getGlobalQuerySelector=Object(external_kbnSharedDeps_React_["useMemo"])(()=>store["inputsSelectors"].globalQuerySelector(),[]);const query=Object(use_selector["a"])(getGlobalQuerySelector);const filters=Object(use_selector["a"])(getGlobalFiltersQuerySelector);const{to:to,from:from,setQuery:setQuery,isInitializing:isInitializing}=Object(use_global_time["a"])();const{globalFullScreen:globalFullScreen}=Object(use_full_screen["a"])();const kibana=Object(lib_kibana["h"])();const{tabName:tabName}=Object(external_kbnSharedDeps_ReactRouterDom_["useParams"])();const tabsFilters=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{if(tabName===navigation_types["a"].alerts){return filters.length>0?[...filters,...filterNetworkData]:filterNetworkData}return filters},[tabName,filters]);const narrowDateRange=Object(external_kbnSharedDeps_React_["useCallback"])(({x:x})=>{if(!x){return}const[min,max]=x;dispatch(Object(inputs_actions["setAbsoluteRangeDatePicker"])({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()}))},[dispatch]);const{docValueFields:docValueFields,indicesExist:indicesExist,indexPattern:indexPattern,selectedPatterns:selectedPatterns}=Object(sourcerer["b"])();const onSkipFocusBeforeEventsTable=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{var _containerElement$cur,_containerElement$cur2;(_containerElement$cur=containerElement.current)===null||_containerElement$cur===void 0?void 0:(_containerElement$cur2=_containerElement$cur.querySelector(".inspectButtonComponent:last-of-type"))===null||_containerElement$cur2===void 0?void 0:_containerElement$cur2.focus()},[containerElement]);const onSkipFocusAfterEventsTable=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{Object(timeline_helpers["o"])()},[]);const onKeyDown=Object(external_kbnSharedDeps_React_["useCallback"])(keyboardEvent=>{if(Object(accessibility_helpers["r"])(keyboardEvent)){Object(timeline_helpers["n"])({containerElement:containerElement.current,keyboardEvent:keyboardEvent,onSkipFocusBeforeEventsTable:onSkipFocusBeforeEventsTable,onSkipFocusAfterEventsTable:onSkipFocusAfterEventsTable})}},[containerElement,onSkipFocusBeforeEventsTable,onSkipFocusAfterEventsTable]);const filterQuery=Object(keury["b"])({config:public_["esQuery"].getEsQueryConfig(kibana.services.uiSettings),indexPattern:indexPattern,queries:[query],filters:filters});const tabsFilterQuery=Object(keury["b"])({config:public_["esQuery"].getEsQueryConfig(kibana.services.uiSettings),indexPattern:indexPattern,queries:[query],filters:tabsFilters});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,indicesExist?external_kbnSharedDeps_React_default.a.createElement(network_StyledFullHeightContainer,{onKeyDown:onKeyDown,ref:containerElement},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiWindowEvent"],{event:"resize",handler:external_kbnSharedDeps_LodashFp_["noop"]}),external_kbnSharedDeps_React_default.a.createElement(filters_global["a"],{show:Object(timeline_helpers["q"])({globalFullScreen:globalFullScreen,graphEventId:graphEventId})},external_kbnSharedDeps_React_default.a.createElement(search_bar["a"],{indexPattern:indexPattern,id:"global"})),external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],{noPadding:globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(Display,{show:!globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(header_page["a"],{border:true,subtitle:external_kbnSharedDeps_React_default.a.createElement(last_event_time["a"],{docValueFields:docValueFields,indexKey:search_strategy["LastEventIndexKey"].network,indexNames:selectedPatterns}),title:network_pages_translations["i"]}),external_kbnSharedDeps_React_default.a.createElement(EmbeddedMap,{query:query,filters:filters,startDate:from,endDate:to,setQuery:setQuery}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(NetworkKpiComponent,{filterQuery:filterQuery,from:from,indexNames:selectedPatterns,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:isInitializing,to:to})),capabilitiesFetched&&!isInitializing?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(Display,{show:!globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(navigation["a"],{navTabs:navTabsNetwork(hasMlUserPermissions)}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null)),external_kbnSharedDeps_React_default.a.createElement(NetworkRoutes,{docValueFields:docValueFields,filterQuery:tabsFilterQuery,from:from,isInitializing:isInitializing,indexPattern:indexPattern,indexNames:selectedPatterns,setQuery:setQuery,setAbsoluteRangeDatePicker:inputs_actions["setAbsoluteRangeDatePicker"],type:network_store["c"].NetworkType.page,to:to,networkPagePath:networkPagePath})):external_kbnSharedDeps_React_default.a.createElement(NetworkRoutesLoading,null))):external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,external_kbnSharedDeps_React_default.a.createElement(header_page["a"],{border:true,title:network_pages_translations["i"]}),external_kbnSharedDeps_React_default.a.createElement(overview_empty["a"],null)),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].network}))});NetworkComponent.displayName="NetworkComponent";const network_Network=external_kbnSharedDeps_React_default.a.memo(NetworkComponent);const MlNetworkConditionalContainer=external_kbnSharedDeps_React_default.a.memo(({url:url})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{strict:true,exact:true,path:url,render:({location:location})=>{const queryStringDecoded=Object(query_string["parse"])(location.search.substring(1),{sort:false});if(queryStringDecoded.query!=null){queryStringDecoded.query=replaceKQLParts(queryStringDecoded.query)}const reEncoded=Object(query_string["stringify"])(kibanaUtils_public_["url"].encodeQuery(queryStringDecoded),{sort:false,encode:false});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{to:`?${reEncoded}`})}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:`${url}/ip/:ip`,render:({location:location,match:{params:{ip:ip}}})=>{const queryStringDecoded=Object(query_string["parse"])(location.search.substring(1),{sort:false});if(queryStringDecoded.query!=null){queryStringDecoded.query=replaceKQLParts(queryStringDecoded.query)}if(emptyEntity(ip)){const reEncoded=Object(query_string["stringify"])(kibanaUtils_public_["url"].encodeQuery(queryStringDecoded),{sort:false,encode:false});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{to:`?${reEncoded}`})}else if(multipleEntities(ip)){const ips=getMultipleEntities(ip);queryStringDecoded.query=addEntitiesToKql(["source.ip","destination.ip"],ips,queryStringDecoded.query||"");const reEncoded=Object(query_string["stringify"])(kibanaUtils_public_["url"].encodeQuery(queryStringDecoded),{sort:false,encode:false});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{to:`?${reEncoded}`})}else{const reEncoded=Object(query_string["stringify"])(kibanaUtils_public_["url"].encodeQuery(queryStringDecoded),{sort:false,encode:false});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{to:`/ip/${ip}?${reEncoded}`})}}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/ml-network/",render:({location:{search:search=""}})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Redirect"],{from:"/ml-network/",to:`/ml-network${search}`})})));MlNetworkConditionalContainer.displayName="MlNetworkConditionalContainer";const pages_networkPagePath="";const ipDetailsPageBasePath=`/ip/:detailName`;const NetworkContainerComponent=()=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_["useHistory"])();const capabilities=Object(use_ml_capabilities["a"])();const capabilitiesFetched=capabilities.capabilitiesFetched;const userHasMlUserPermissions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(has_ml_user_permissions["a"])(capabilities),[capabilities]);const networkRoutePath=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getNetworkRoutePath(capabilitiesFetched,userHasMlUserPermissions),[capabilitiesFetched,userHasMlUserPermissions]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/ml-network",render:({location:location,match:match})=>external_kbnSharedDeps_React_default.a.createElement(MlNetworkConditionalContainer,{location:location,url:match.url})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{strict:true,path:networkRoutePath},external_kbnSharedDeps_React_default.a.createElement(network_Network,{networkPagePath:pages_networkPagePath,capabilitiesFetched:capabilities.capabilitiesFetched,hasMlUserPermissions:userHasMlUserPermissions})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:`${ipDetailsPageBasePath}/:flowTarget`},external_kbnSharedDeps_React_default.a.createElement(pages_details["a"],null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:ipDetailsPageBasePath,render:({location:{search:search=""},match:{params:{detailName:detailName}}})=>{history.replace(`ip/${detailName}/${graphql_types["c"].source}${search}`);return null}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/",render:({location:{search:search=""}})=>{history.replace(`${navigation_types["a"].flows}${search}`);return null}}))};const NetworkContainer=external_kbnSharedDeps_React_default.a.memo(NetworkContainerComponent);const routes_NetworkRoutes=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/",render:({location:location,match:match})=>external_kbnSharedDeps_React_default.a.createElement(NetworkContainer,{location:location,url:match.url})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{render:()=>external_kbnSharedDeps_React_default.a.createElement(_404["a"],null)}));class public_network_Network{setup(){}start(storage){return{SubPluginRoutes:routes_NetworkRoutes,storageTimelines:{timelineById:Object(local_storage["b"])(storage,[types_timeline["e"].networkPageExternalAlerts])},store:{initialState:{network:network_store["a"]},reducer:{network:network_store["d"]}}}}}var alerts_viewer_translations=__webpack_require__(386);var overview_pages_translations=__webpack_require__(313);var histogram_configs=__webpack_require__(713);var redirect_to_hosts=__webpack_require__(267);function alerts_by_category_extends(){alerts_by_category_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return alerts_by_category_extends.apply(this,arguments)}const alerts_by_category_ID="alertsByCategoryOverview";const alerts_by_category_DEFAULT_STACK_BY="event.module";const AlertsByCategoryComponent=({deleteQuery:deleteQuery,filters:filters,from:from,hideHeaderChildren:hideHeaderChildren=false,indexPattern:indexPattern,indexNames:indexNames,query:query,setQuery:setQuery,to:to})=>{const{uiSettings:uiSettings,application:{navigateToApp:navigateToApp}}=Object(lib_kibana["h"])().services;const{formatUrl:formatUrl,search:urlSearch}=Object(link_to["o"])(app_types["a"].hosts);const[defaultNumberFormat]=Object(lib_kibana["l"])(constants["B"]);const goToHostAlerts=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();navigateToApp(`${constants["f"]}:${app_types["a"].hosts}`,{path:Object(redirect_to_hosts["c"])(store_model["HostsTableType"].alerts,urlSearch)})},[navigateToApp,urlSearch]);const alertsCountViewAlertsButton=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(links["g"],{"data-test-subj":"view-alerts",onClick:goToHostAlerts,href:formatUrl(Object(redirect_to_hosts["c"])(store_model["HostsTableType"].alerts))},overview_pages_translations["f"]),[goToHostAlerts,formatUrl]);const alertsByCategoryHistogramConfigs=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _alertsStackByOptions;return{...histogram_configs["b"],defaultStackByOption:(_alertsStackByOptions=histogram_configs["a"].find(o=>o.text===alerts_by_category_DEFAULT_STACK_BY))!==null&&_alertsStackByOptions!==void 0?_alertsStackByOptions:histogram_configs["a"][0],subtitle:totalCount=>`${alerts_viewer_translations["e"]}: ${external_kbnSharedDeps_ElasticNumeral_default()(totalCount).format(defaultNumberFormat)} ${Object(alerts_viewer_translations["g"])(totalCount)}`,legendPosition:external_kbnSharedDeps_ElasticCharts_["Position"].Right}},[]);const filterQuery=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(keury["b"])({config:public_["esQuery"].getEsQueryConfig(uiSettings),indexPattern:indexPattern,queries:[query],filters:filters}),[filters,indexPattern,uiSettings,query]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>()=>{if(deleteQuery){deleteQuery({id:alerts_by_category_ID})}},[deleteQuery]);return external_kbnSharedDeps_React_default.a.createElement(components_matrix_histogram["a"],alerts_by_category_extends({endDate:to,filterQuery:filterQuery,headerChildren:hideHeaderChildren?null:alertsCountViewAlertsButton,id:alerts_by_category_ID,indexNames:indexNames,setQuery:setQuery,startDate:from},alertsByCategoryHistogramConfigs))};AlertsByCategoryComponent.displayName="AlertsByCategoryComponent";const AlertsByCategory=external_kbnSharedDeps_React_default.a.memo(AlertsByCategoryComponent);var events_by_dataset=__webpack_require__(611);const ERROR_HOST_OVERVIEW=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.allHost.errorSearchDescription",{defaultMessage:`An error has occurred on all hosts search`});const FAIL_HOST_OVERVIEW=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.allHost.failSearchDescription",{defaultMessage:`Failed to run search on all hosts`});const overview_host_ID="overviewHostQuery";const useHostOverview=({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=false,startDate:startDate})=>{const{data:data,notifications:notifications}=Object(lib_kibana["h"])().services;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const searchSubscription$=Object(external_kbnSharedDeps_React_["useRef"])(new external_kbnSharedDeps_Rxjs_["Subscription"]);const[loading,setLoading]=Object(external_kbnSharedDeps_React_["useState"])(false);const[overviewHostRequest,setHostRequest]=Object(external_kbnSharedDeps_React_["useState"])(null);const[overviewHostResponse,setHostOverviewResponse]=Object(external_kbnSharedDeps_React_["useState"])({overviewHost:{},id:overview_host_ID,inspect:{dsl:[],response:[]},isInspected:false,refetch:refetch.current});const overviewHostSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{if(request==null||skip){return}const asyncSearch=async()=>{abortCtrl.current=new AbortController;setLoading(true);searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(Object(common_["isCompleteResponse"])(response)){setLoading(false);setHostOverviewResponse(prevResponse=>({...prevResponse,overviewHost:response.overviewHost,inspect:Object(public_helpers["a"])(response,prevResponse.inspect),refetch:refetch.current}));searchSubscription$.current.unsubscribe()}else if(Object(common_["isErrorResponse"])(response)){setLoading(false);notifications.toasts.addWarning(ERROR_HOST_OVERVIEW);searchSubscription$.current.unsubscribe()}},error:msg=>{setLoading(false);notifications.toasts.addDanger({title:FAIL_HOST_OVERVIEW,text:msg.message});searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch},[data.search,notifications.toasts,skip]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setHostRequest(prevRequest=>{const myRequest={...prevRequest!==null&&prevRequest!==void 0?prevRequest:{},defaultIndex:indexNames,factoryQueryType:security_solution["HostsQueries"].overview,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}};if(!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[indexNames,endDate,filterQuery,startDate]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{overviewHostSearch(overviewHostRequest);return()=>{searchSubscription$.current.unsubscribe();abortCtrl.current.abort()}},[overviewHostRequest,overviewHostSearch]);return[loading,overviewHostResponse]};const ProgressContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"ProgressContainer",componentId:"sc-1qvjg2g-0"})(["margin-left:8px;min-width:100px;"]);const LoadingContent=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiLoadingContent"]).withConfig({displayName:"LoadingContent",componentId:"sc-1qvjg2g-1"})([".euiLoadingContent__singleLine{margin-bottom:0px;}"]);const StatValueComponent=({count:count,isGroupStat:isGroupStat,isLoading:isLoading,max:max})=>{const[defaultNumberFormat]=Object(lib_kibana["l"])(constants["B"]);const[isInitialLoading,setIsInitialLoading]=Object(external_kbnSharedDeps_React_["useState"])(true);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(isInitialLoading&&!isLoading){setIsInitialLoading(false)}},[isLoading,isInitialLoading,setIsInitialLoading]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},!isInitialLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:isGroupStat?"default":"subdued",size:isGroupStat?"m":"s"},external_kbnSharedDeps_ElasticNumeral_default()(count).format(defaultNumberFormat))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(ProgressContainer,null,isLoading?external_kbnSharedDeps_React_default.a.createElement(LoadingContent,{"data-test-subj":"stat-value-loading-spinner",lines:1}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiProgress"],{color:isGroupStat?"primary":"subdued",max:max,size:"m",value:count}))))};StatValueComponent.displayName="StatValueComponent";const stat_value_StatValue=external_kbnSharedDeps_React_default.a.memo(StatValueComponent);const getOverviewHostStats=data=>{var _data$auditbeatAuditd,_data$auditbeatFIM,_data$auditbeatLogin,_data$auditbeatPackag,_data$auditbeatProces,_data$auditbeatUser,_data$endgameDns,_data$endgameFile,_data$endgameImageLoa,_data$endgameNetwork,_data$endgameProcess,_data$endgameRegistry,_data$endgameSecurity,_data$filebeatSystemM,_data$winlogbeatSecur,_data$winlogbeatMWSys;return[{count:(_data$auditbeatAuditd=data.auditbeatAuditd)!==null&&_data$auditbeatAuditd!==void 0?_data$auditbeatAuditd:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.auditBeatAuditTitle",defaultMessage:"Audit"}),id:"auditbeatAuditd"},{count:(_data$auditbeatFIM=data.auditbeatFIM)!==null&&_data$auditbeatFIM!==void 0?_data$auditbeatFIM:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.auditBeatFimTitle",defaultMessage:"File Integrity Module"}),id:"auditbeatFIM"},{count:(_data$auditbeatLogin=data.auditbeatLogin)!==null&&_data$auditbeatLogin!==void 0?_data$auditbeatLogin:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.auditBeatLoginTitle",defaultMessage:"Login"}),id:"auditbeatLogin"},{count:(_data$auditbeatPackag=data.auditbeatPackage)!==null&&_data$auditbeatPackag!==void 0?_data$auditbeatPackag:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.auditBeatPackageTitle",defaultMessage:"Package"}),id:"auditbeatPackage"},{count:(_data$auditbeatProces=data.auditbeatProcess)!==null&&_data$auditbeatProces!==void 0?_data$auditbeatProces:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.auditBeatProcessTitle",defaultMessage:"Process"}),id:"auditbeatProcess"},{count:(_data$auditbeatUser=data.auditbeatUser)!==null&&_data$auditbeatUser!==void 0?_data$auditbeatUser:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.auditBeatUserTitle",defaultMessage:"User"}),id:"auditbeatUser"},{count:(_data$endgameDns=data.endgameDns)!==null&&_data$endgameDns!==void 0?_data$endgameDns:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endgameDnsTitle",defaultMessage:"DNS"}),id:"endgameDns"},{count:(_data$endgameFile=data.endgameFile)!==null&&_data$endgameFile!==void 0?_data$endgameFile:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endgameFileTitle",defaultMessage:"File"}),id:"endgameFile"},{count:(_data$endgameImageLoa=data.endgameImageLoad)!==null&&_data$endgameImageLoa!==void 0?_data$endgameImageLoa:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endgameImageLoadTitle",defaultMessage:"Image Load"}),id:"endgameImageLoad"},{count:(_data$endgameNetwork=data.endgameNetwork)!==null&&_data$endgameNetwork!==void 0?_data$endgameNetwork:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endgameNetworkTitle",defaultMessage:"Network"}),id:"endgameNetwork"},{count:(_data$endgameProcess=data.endgameProcess)!==null&&_data$endgameProcess!==void 0?_data$endgameProcess:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endgameProcessTitle",defaultMessage:"Process"}),id:"endgameProcess"},{count:(_data$endgameRegistry=data.endgameRegistry)!==null&&_data$endgameRegistry!==void 0?_data$endgameRegistry:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endgameRegistryTitle",defaultMessage:"Registry"}),id:"endgameRegistry"},{count:(_data$endgameSecurity=data.endgameSecurity)!==null&&_data$endgameSecurity!==void 0?_data$endgameSecurity:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endgameSecurityTitle",defaultMessage:"Security"}),id:"endgameSecurity"},{count:(_data$filebeatSystemM=data.filebeatSystemModule)!==null&&_data$filebeatSystemM!==void 0?_data$filebeatSystemM:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.filebeatSystemModuleTitle",defaultMessage:"System Module"}),id:"filebeatSystemModule"},{count:(_data$winlogbeatSecur=data.winlogbeatSecurity)!==null&&_data$winlogbeatSecur!==void 0?_data$winlogbeatSecur:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.winlogbeatSecurityTitle",defaultMessage:"Security"}),id:"winlogbeatSecurity"},{count:(_data$winlogbeatMWSys=data.winlogbeatMWSysmonOperational)!==null&&_data$winlogbeatMWSys!==void 0?_data$winlogbeatMWSys:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.winlogbeatMWSysmonOperational",defaultMessage:"Microsoft-Windows-Sysmon/Operational"}),id:"winlogbeatMWSysmonOperational"}]};const HostStatsContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"HostStatsContainer",componentId:"ej4zfy-0"})([".accordion-button{width:100%;}"]);const hostStatGroups=[{groupId:"auditbeat",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.hostStatGroupAuditbeat",defaultMessage:"Auditbeat"}),statIds:["auditbeatAuditd","auditbeatFIM","auditbeatLogin","auditbeatPackage","auditbeatProcess","auditbeatUser"]},{groupId:"endgame",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.hostStatGroupElasticEndpointSecurity",defaultMessage:"Endpoint Security"}),statIds:["endgameDns","endgameFile","endgameImageLoad","endgameNetwork","endgameProcess","endgameRegistry","endgameSecurity"]},{groupId:"filebeat",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.hostStatGroupFilebeat",defaultMessage:"Filebeat"}),statIds:["filebeatSystemModule"]},{groupId:"winlogbeat",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.hostStatGroupWinlogbeat",defaultMessage:"Winlogbeat"}),statIds:["winlogbeatSecurity","winlogbeatMWSysmonOperational"]}];const Title=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Title",componentId:"ej4zfy-1"})(["margin-left:24px;"]);const AccordionContent=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"AccordionContent",componentId:"ej4zfy-2"})(["margin-top:8px;"]);const OverviewHostStatsComponent=({data:data,loading:loading})=>{const allHostStats=getOverviewHostStats(data);const allHostStatsCount=allHostStats.reduce((total,stat)=>total+stat.count,0);return external_kbnSharedDeps_React_default.a.createElement(HostStatsContainer,{"data-test-subj":"overview-hosts-stats"},hostStatGroups.map((statGroup,i)=>{const statsForGroup=allHostStats.filter(s=>statGroup.statIds.includes(s.id));const statsForGroupCount=statsForGroup.reduce((total,stat)=>total+stat.count,0);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,{key:statGroup.groupId},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAccordion"],{id:`host-stat-accordion-group${statGroup.groupId}`,buttonContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,statGroup.name)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(stat_value_StatValue,{count:statsForGroupCount,isGroupStat:true,isLoading:loading,max:allHostStatsCount}))),buttonContentClassName:"accordion-button"},external_kbnSharedDeps_React_default.a.createElement(AccordionContent,null,statsForGroup.map(stat=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{key:stat.id,justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"s"},external_kbnSharedDeps_React_default.a.createElement(Title,null,stat.title))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":`host-stat-${stat.id}`,grow:false},external_kbnSharedDeps_React_default.a.createElement(stat_value_StatValue,{count:stat.count,isGroupStat:false,isLoading:loading,max:statsForGroupCount})))))))}))};const OverviewHostStats=external_kbnSharedDeps_React_default.a.memo(OverviewHostStatsComponent);const OverviewHostStatsManage=Object(manage_query["a"])(OverviewHostStats);const OverviewHostComponent=({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,startDate:startDate,setQuery:setQuery})=>{const{formatUrl:formatUrl,search:urlSearch}=Object(link_to["o"])(app_types["a"].hosts);const{navigateToApp:navigateToApp}=Object(lib_kibana["h"])().services.application;const[defaultNumberFormat]=Object(lib_kibana["l"])(constants["B"]);const[loading,{overviewHost:overviewHost,id:id,inspect:inspect,refetch:refetch}]=useHostOverview({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,startDate:startDate});const goToHost=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();navigateToApp(`${constants["f"]}:${app_types["a"].hosts}`,{path:Object(link_to["i"])(urlSearch)})},[navigateToApp,urlSearch]);const hostEventsCount=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getOverviewHostStats(overviewHost).reduce((total,stat)=>total+stat.count,0),[overviewHost]);const formattedHostEventsCount=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_ElasticNumeral_default()(hostEventsCount).format(defaultNumberFormat),[defaultNumberFormat,hostEventsCount]);const hostPageButton=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(links["g"],{onClick:goToHost,href:formatUrl(Object(link_to["i"])())},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.hostsAction",defaultMessage:"View hosts"})),[goToHost,formatUrl]);const title=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.hostsTitle",defaultMessage:"Host events"}),[]);const subtitle=Object(external_kbnSharedDeps_React_["useMemo"])(()=>!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(overviewHost)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"Showing: {formattedHostEventsCount} {hostEventsCount, plural, one {event} other {events}}",id:"xpack.securitySolution.overview.overviewHost.hostsSubtitle",values:{hostEventsCount:hostEventsCount,formattedHostEventsCount:formattedHostEventsCount}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,""),[formattedHostEventsCount,hostEventsCount,overviewHost]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(components_inspect["b"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{id:overview_host_ID,subtitle:subtitle,title:title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,hostPageButton)),external_kbnSharedDeps_React_default.a.createElement(OverviewHostStatsManage,{loading:loading,data:overviewHost,setQuery:setQuery,id:id,inspect:inspect,refetch:refetch}))))};OverviewHostComponent.displayName="OverviewHostComponent";const OverviewHost=external_kbnSharedDeps_React_default.a.memo(OverviewHostComponent);const ERROR_NETWORK_OVERVIEW=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.allHost.errorSearchDescription",{defaultMessage:`An error has occurred on all hosts search`});const FAIL_NETWORK_OVERVIEW=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.allHost.failSearchDescription",{defaultMessage:`Failed to run search on all hosts`});const overview_network_ID="overviewNetworkQuery";const useNetworkOverview=({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=false,startDate:startDate})=>{const{data:data,notifications:notifications}=Object(lib_kibana["h"])().services;const refetch=Object(external_kbnSharedDeps_React_["useRef"])(external_kbnSharedDeps_LodashFp_["noop"]);const abortCtrl=Object(external_kbnSharedDeps_React_["useRef"])(new AbortController);const searchSubscription$=Object(external_kbnSharedDeps_React_["useRef"])(new external_kbnSharedDeps_Rxjs_["Subscription"]);const[loading,setLoading]=Object(external_kbnSharedDeps_React_["useState"])(false);const[overviewNetworkRequest,setNetworkRequest]=Object(external_kbnSharedDeps_React_["useState"])(null);const[overviewNetworkResponse,setNetworkOverviewResponse]=Object(external_kbnSharedDeps_React_["useState"])({overviewNetwork:{},id:overview_network_ID,inspect:{dsl:[],response:[]},isInspected:false,refetch:refetch.current});const overviewNetworkSearch=Object(external_kbnSharedDeps_React_["useCallback"])(request=>{if(request==null){return}const asyncSearch=async()=>{abortCtrl.current=new AbortController;setLoading(true);searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{if(Object(common_["isCompleteResponse"])(response)){setLoading(false);setNetworkOverviewResponse(prevResponse=>({...prevResponse,overviewNetwork:response.overviewNetwork,inspect:Object(public_helpers["a"])(response,prevResponse.inspect),refetch:refetch.current}));searchSubscription$.current.unsubscribe()}else if(Object(common_["isErrorResponse"])(response)){setLoading(false);notifications.toasts.addWarning(ERROR_NETWORK_OVERVIEW);searchSubscription$.current.unsubscribe()}},error:msg=>{setLoading(false);notifications.toasts.addDanger({title:FAIL_NETWORK_OVERVIEW,text:msg.message});searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe();abortCtrl.current.abort();asyncSearch();refetch.current=asyncSearch},[data.search,notifications.toasts]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setNetworkRequest(prevRequest=>{const myRequest={...prevRequest!==null&&prevRequest!==void 0?prevRequest:{},defaultIndex:indexNames,factoryQueryType:security_solution["NetworkQueries"].overview,filterQuery:Object(containers_helpers["a"])(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}};if(!fast_deep_equal_default()(prevRequest,myRequest)){return myRequest}return prevRequest})},[indexNames,endDate,filterQuery,startDate]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{overviewNetworkSearch(overviewNetworkRequest);return()=>{searchSubscription$.current.unsubscribe();abortCtrl.current.abort()}},[overviewNetworkRequest,overviewNetworkSearch]);return[loading,overviewNetworkResponse]};const getOverviewNetworkStats=data=>{var _data$auditbeatSocket,_data$filebeatCisco,_data$filebeatNetflow,_data$filebeatPanw,_data$filebeatSuricat,_data$filebeatZeek,_data$packetbeatDNS,_data$packetbeatFlow,_data$packetbeatTLS;return[{count:(_data$auditbeatSocket=data.auditbeatSocket)!==null&&_data$auditbeatSocket!==void 0?_data$auditbeatSocket:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.auditBeatSocketTitle",defaultMessage:"Socket"}),id:"auditbeatSocket"},{count:(_data$filebeatCisco=data.filebeatCisco)!==null&&_data$filebeatCisco!==void 0?_data$filebeatCisco:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.filebeatCiscoTitle",defaultMessage:"Cisco"}),id:"filebeatCisco"},{count:(_data$filebeatNetflow=data.filebeatNetflow)!==null&&_data$filebeatNetflow!==void 0?_data$filebeatNetflow:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.filebeatNetflowTitle",defaultMessage:"Netflow"}),id:"filebeatNetflow"},{count:(_data$filebeatPanw=data.filebeatPanw)!==null&&_data$filebeatPanw!==void 0?_data$filebeatPanw:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.filebeatPanwTitle",defaultMessage:"Palo Alto Networks"}),id:"filebeatPanw"},{count:(_data$filebeatSuricat=data.filebeatSuricata)!==null&&_data$filebeatSuricat!==void 0?_data$filebeatSuricat:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.fileBeatSuricataTitle",defaultMessage:"Suricata"}),id:"filebeatSuricata"},{count:(_data$filebeatZeek=data.filebeatZeek)!==null&&_data$filebeatZeek!==void 0?_data$filebeatZeek:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.fileBeatZeekTitle",defaultMessage:"Zeek"}),id:"filebeatZeek"},{count:(_data$packetbeatDNS=data.packetbeatDNS)!==null&&_data$packetbeatDNS!==void 0?_data$packetbeatDNS:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.packetBeatDnsTitle",defaultMessage:"DNS"}),id:"packetbeatDNS"},{count:(_data$packetbeatFlow=data.packetbeatFlow)!==null&&_data$packetbeatFlow!==void 0?_data$packetbeatFlow:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.packetBeatFlowTitle",defaultMessage:"Flow"}),id:"packetbeatFlow"},{count:(_data$packetbeatTLS=data.packetbeatTLS)!==null&&_data$packetbeatTLS!==void 0?_data$packetbeatTLS:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.packetbeatTLSTitle",defaultMessage:"TLS"}),id:"packetbeatTLS"}]};const networkStatGroups=[{groupId:"auditbeat",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.networkStatGroupAuditbeat",defaultMessage:"Auditbeat"}),statIds:["auditbeatSocket"]},{groupId:"filebeat",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.networkStatGroupFilebeat",defaultMessage:"Filebeat"}),statIds:["filebeatCisco","filebeatNetflow","filebeatPanw","filebeatSuricata","filebeatZeek"]},{groupId:"packetbeat",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.networkStatGroupPacketbeat",defaultMessage:"Packetbeat"}),statIds:["packetbeatDNS","packetbeatFlow","packetbeatTLS"]}];const NetworkStatsContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"NetworkStatsContainer",componentId:"sc-1wm45zw-0"})([".accordion-button{width:100%;}"]);const overview_network_stats_Title=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Title",componentId:"sc-1wm45zw-1"})(["margin-left:24px;"]);const overview_network_stats_AccordionContent=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"AccordionContent",componentId:"sc-1wm45zw-2"})(["margin-top:8px;"]);const OverviewNetworkStatsComponent=({data:data,loading:loading})=>{const allNetworkStats=getOverviewNetworkStats(data);const allNetworkStatsCount=allNetworkStats.reduce((total,stat)=>total+stat.count,0);return external_kbnSharedDeps_React_default.a.createElement(NetworkStatsContainer,{"data-test-subj":"overview-network-stats"},networkStatGroups.map((statGroup,i)=>{const statsForGroup=allNetworkStats.filter(s=>statGroup.statIds.includes(s.id));const statsForGroupCount=statsForGroup.reduce((total,stat)=>total+stat.count,0);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,{key:statGroup.groupId},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAccordion"],{id:`network-stat-accordion-group${statGroup.groupId}`,buttonContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{"data-test-subj":`network-stat-group-${statGroup.groupId}`,justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],null,statGroup.name)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(stat_value_StatValue,{count:statsForGroupCount,isGroupStat:true,isLoading:loading,max:allNetworkStatsCount}))),buttonContentClassName:"accordion-button"},external_kbnSharedDeps_React_default.a.createElement(overview_network_stats_AccordionContent,null,statsForGroup.map(stat=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{key:stat.id,justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"s"},external_kbnSharedDeps_React_default.a.createElement(overview_network_stats_Title,null,stat.title))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{"data-test-subj":`network-stat-${stat.id}`,grow:false},external_kbnSharedDeps_React_default.a.createElement(stat_value_StatValue,{count:stat.count,isGroupStat:false,isLoading:loading,max:statsForGroupCount})))))))}))};const OverviewNetworkStats=external_kbnSharedDeps_React_default.a.memo(OverviewNetworkStatsComponent);const OverviewNetworkStatsManage=Object(manage_query["a"])(OverviewNetworkStats);const OverviewNetworkComponent=({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,startDate:startDate,setQuery:setQuery})=>{const{formatUrl:formatUrl,search:urlSearch}=Object(link_to["o"])(app_types["a"].network);const{navigateToApp:navigateToApp}=Object(lib_kibana["h"])().services.application;const[defaultNumberFormat]=Object(lib_kibana["l"])(constants["B"]);const[loading,{overviewNetwork:overviewNetwork,id:id,inspect:inspect,refetch:refetch}]=useNetworkOverview({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,startDate:startDate});const goToNetwork=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();navigateToApp(`${constants["f"]}:${app_types["a"].network}`,{path:Object(link_to["k"])(urlSearch)})},[navigateToApp,urlSearch]);const networkEventsCount=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getOverviewNetworkStats(overviewNetwork).reduce((total,stat)=>total+stat.count,0),[overviewNetwork]);const formattedNetworkEventsCount=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_ElasticNumeral_default()(networkEventsCount).format(defaultNumberFormat),[defaultNumberFormat,networkEventsCount]);const networkPageButton=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(links["g"],{"data-test-subj":"overview-network-go-to-network-page",onClick:goToNetwork,href:formatUrl(Object(link_to["k"])())},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.networkAction",defaultMessage:"View network"})),[goToNetwork,formatUrl]);const title=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.networkTitle",defaultMessage:"Network events"}),[]);const subtitle=Object(external_kbnSharedDeps_React_["useMemo"])(()=>!Object(external_kbnSharedDeps_LodashFp_["isEmpty"])(overviewNetwork)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{defaultMessage:"Showing: {formattedNetworkEventsCount} {networkEventsCount, plural, one {event} other {events}}",id:"xpack.securitySolution.overview.overviewNetwork.networkSubtitle",values:{formattedNetworkEventsCount:formattedNetworkEventsCount,networkEventsCount:networkEventsCount}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,""),[formattedNetworkEventsCount,networkEventsCount,overviewNetwork]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(components_inspect["b"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],{"data-test-subj":"overview-network-query"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(header_section["a"],{id:overview_network_ID,subtitle:subtitle,title:title},networkPageButton),external_kbnSharedDeps_React_default.a.createElement(OverviewNetworkStatsManage,{loading:loading,data:overviewNetwork,id:id,inspect:inspect,setQuery:setQuery,refetch:refetch})))))};OverviewNetworkComponent.displayName="OverviewNetworkComponent";const OverviewNetwork=external_kbnSharedDeps_React_default.a.memo(OverviewNetworkComponent);const HorizontalSpacer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"HorizontalSpacer",componentId:"sc-1b49qwl-0"})(["width:24px;"]);const EventCountsComponent=({filters:filters,from:from,indexNames:indexNames,indexPattern:indexPattern,query:query,setQuery:setQuery,to:to})=>{const{uiSettings:uiSettings}=Object(lib_kibana["h"])().services;const hostFilterQuery=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(keury["b"])({config:public_["esQuery"].getEsQueryConfig(uiSettings),indexPattern:indexPattern,queries:[query],filters:[...filters,...alerts_query_tab_body["b"]]}),[filters,indexPattern,query,uiSettings]);const networkFilterQuery=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(keury["b"])({config:public_["esQuery"].getEsQueryConfig(uiSettings),indexPattern:indexPattern,queries:[query],filters:[...filters,...filterNetworkData]}),[filters,indexPattern,uiSettings,query]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(OverviewHost,{endDate:to,filterQuery:hostFilterQuery,indexNames:indexNames,startDate:from,setQuery:setQuery})),external_kbnSharedDeps_React_default.a.createElement(HorizontalSpacer,{grow:false}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(OverviewNetwork,{endDate:to,filterQuery:networkFilterQuery,indexNames:indexNames,startDate:from,setQuery:setQuery})))};const EventCounts=external_kbnSharedDeps_React_default.a.memo(EventCountsComponent);const COMMENTS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentCases.commentsTooltip",{defaultMessage:"Comments"});const MY_RECENTLY_REPORTED_CASES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.overview.myRecentlyReportedCasesButtonLabel",{defaultMessage:"My recently reported cases"});const NO_CASES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentCases.noCasesMessage",{defaultMessage:"No cases have been created yet. Put your detective hat on and"});const RECENTLY_CREATED_CASES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.overview.recentlyCreatedCasesButtonLabel",{defaultMessage:"Recently created cases"});const START_A_NEW_CASE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentCases.startNewCaseLink",{defaultMessage:"start a new case"});const VIEW_ALL_CASES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentCases.viewAllCasesLink",{defaultMessage:"View all cases"});const CASES_FILTER_CONTROL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentCases.controlLegend",{defaultMessage:"Cases filter"});const MY_RECENTLY_REPORTED_ID="myRecentlyReported";const toggleButtonIcons=[{id:"recentlyCreated",label:RECENTLY_CREATED_CASES,iconType:"folderExclamation"},{id:MY_RECENTLY_REPORTED_ID,label:MY_RECENTLY_REPORTED_CASES,iconType:"reporter"}];const Filters=external_kbnSharedDeps_React_default.a.memo(({filterBy:filterBy,setFilterBy:setFilterBy,showMyRecentlyReported:showMyRecentlyReported})=>{const options=Object(external_kbnSharedDeps_React_["useMemo"])(()=>showMyRecentlyReported?toggleButtonIcons:toggleButtonIcons.filter(x=>x.id!==MY_RECENTLY_REPORTED_ID),[showMyRecentlyReported]);const onChange=Object(external_kbnSharedDeps_React_["useCallback"])(filterMode=>{setFilterBy(filterMode)},[setFilterBy]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonGroup"],{options:options,idSelected:filterBy,onChange:onChange,isIconOnly:true,legend:CASES_FILTER_CONTROL})});Filters.displayName="Filters";const ERROR_RETRIEVING_USER_DETAILS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.errorRetrievingUserDetailsMessage",{defaultMessage:"Recent Timelines: An error occurred while retrieving user details"});const FAVORITES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.favoritesButtonLabel",{defaultMessage:"Favorites"});const NO_FAVORITE_TIMELINES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.noFavoriteTimelinesMessage",{defaultMessage:"You haven't favorited any timelines yet. Get out there and start threat hunting!"});const LAST_UPDATED=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.lastUpdatedButtonLabel",{defaultMessage:"Last updated"});const NO_TIMELINES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.noTimelinesMessage",{defaultMessage:"You haven't created any timelines yet. Get out there and start threat hunting!"});const NOTES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.notesTooltip",{defaultMessage:"Notes"});const OPEN_AS_DUPLICATE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.openAsDuplicateTooltip",{defaultMessage:"Open as a timeline duplicate"});const OPEN_AS_DUPLICATE_TEMPLATE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.openAsDuplicateTemplateTooltip",{defaultMessage:"Open as a template duplicate"});const PINNED_EVENTS=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.pinnedEventsTooltip",{defaultMessage:"Pinned events"});const UNTITLED_TIMELINE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.untitledTimelineLabel",{defaultMessage:"Untitled timeline"});const VIEW_ALL_TIMELINES=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.viewAllTimelinesLink",{defaultMessage:"View all timelines"});const TIMELINES_FILTER_CONTROL=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.recentTimelines.filterControlLegend",{defaultMessage:"Timelines filter"});const filters_toggleButtonIcons=[{id:"favorites",label:FAVORITES,iconType:"starFilled"},{id:`recently-updated`,label:LAST_UPDATED,iconType:"documentEdit"}];const filters_Filters=external_kbnSharedDeps_React_default.a.memo(({filterBy:filterBy,setFilterBy:setFilterBy})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonGroup"],{options:filters_toggleButtonIcons,idSelected:filterBy,onChange:f=>{setFilterBy(f)},isIconOnly:true,legend:TIMELINES_FILTER_CONTROL}));filters_Filters.displayName="Filters";var use_get_cases=__webpack_require__(409);const LoadingPlaceholdersComponent=({lines:lines,placeholders:placeholders})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,[...Array(placeholders).keys()].map((_,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,{key:i},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingContent"],{lines:lines}),i!==placeholders-1&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}))));LoadingPlaceholdersComponent.displayName="LoadingPlaceholdersComponent";const LoadingPlaceholders=external_kbnSharedDeps_React_default.a.memo(LoadingPlaceholdersComponent);var redirect_to_case=__webpack_require__(230);const NoCasesComponent=()=>{const{formatUrl:formatUrl,search:search}=Object(link_to["o"])(app_types["a"].case);const{navigateToApp:navigateToApp}=Object(lib_kibana["h"])().services.application;const goToCreateCase=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();navigateToApp(`${constants["f"]}:${app_types["a"].case}`,{path:Object(redirect_to_case["e"])(search)})},[navigateToApp,search]);const newCaseLink=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(links["f"],{"data-test-subj":"no-cases-create-case",onClick:goToCreateCase,href:formatUrl(Object(redirect_to_case["e"])())},` ${START_A_NEW_CASE}`),[formatUrl,goToCreateCase]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("span",null,NO_CASES),newCaseLink,"!")};NoCasesComponent.displayName="NoCasesComponent";const NoCases=external_kbnSharedDeps_React_default.a.memo(NoCasesComponent);var open_timeline_helpers=__webpack_require__(165);const counts_Icon=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiIcon"]).withConfig({displayName:"Icon",componentId:"sc-1ht70gq-0"})(["margin-right:8px;"]);const counts_FlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"FlexGroup",componentId:"sc-1ht70gq-1"})(["margin-right:16px;"]);const IconWithCount=external_kbnSharedDeps_React_default.a.memo(({count:count,icon:icon,tooltip:tooltip})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:tooltip},external_kbnSharedDeps_React_default.a.createElement(counts_FlexGroup,{alignItems:"center",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(counts_Icon,{color:"subdued",size:"s",type:icon})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"xs"},count)))));IconWithCount.displayName="IconWithCount";const RecentTimelineCounts=external_kbnSharedDeps_React_default.a.memo(({timeline:timeline})=>external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(IconWithCount,{count:Object(open_timeline_helpers["e"])(timeline),icon:"pinFilled",tooltip:PINNED_EVENTS}),external_kbnSharedDeps_React_default.a.createElement(IconWithCount,{count:Object(open_timeline_helpers["d"])(timeline),icon:"editorComment",tooltip:NOTES})));RecentTimelineCounts.displayName="RecentTimelineCounts";const recent_cases_MarkdownContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"MarkdownContainer",componentId:"nw1m7p-0"})(["max-height:150px;overflow-y:auto;width:300px;"]);const RecentCasesComponent=({cases:cases})=>{const{formatUrl:formatUrl,search:search}=Object(link_to["o"])(app_types["a"].case);const{navigateToApp:navigateToApp}=Object(lib_kibana["h"])().services.application;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,cases.map((c,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{key:c.id,gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement(links["f"],{onClick:ev=>{ev.preventDefault();navigateToApp(`${constants["f"]}:${app_types["a"].case}`,{path:Object(redirect_to_case["a"])({id:c.id,search:search})})},href:formatUrl(Object(redirect_to_case["a"])({id:c.id}))},c.title)),external_kbnSharedDeps_React_default.a.createElement(IconWithCount,{count:c.totalComment,icon:"editorComment",tooltip:COMMENTS}),c.description&&c.description.length&&external_kbnSharedDeps_React_default.a.createElement(recent_cases_MarkdownContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"xs"},external_kbnSharedDeps_React_default.a.createElement(markdown_editor["MarkdownRenderer"],{disableLinks:true},c.description))),i!==cases.length-1&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"})))))};RecentCasesComponent.displayName="RecentCasesComponent";const RecentCases=external_kbnSharedDeps_React_default.a.memo(RecentCasesComponent);const usePrevious=value=>{const ref=Object(external_kbnSharedDeps_React_["useRef"])();Object(external_kbnSharedDeps_React_["useEffect"])(()=>{ref.current=value});return ref.current};const MAX_CASES_TO_SHOW=3;const queryParams={...use_get_cases["b"],perPage:MAX_CASES_TO_SHOW};const StatefulRecentCasesComponent=external_kbnSharedDeps_React_default.a.memo(({filterOptions:filterOptions})=>{const{formatUrl:formatUrl}=Object(link_to["o"])(app_types["a"].case);const{navigateToApp:navigateToApp}=Object(lib_kibana["h"])().services.application;const previousFilterOptions=usePrevious(filterOptions);const{data:data,loading:loading,setFilters:setFilters}=Object(use_get_cases["c"])(queryParams);const isLoadingCases=Object(external_kbnSharedDeps_React_["useMemo"])(()=>loading.indexOf("cases")>-1||loading.indexOf("caseUpdate")>-1,[loading]);const goToCases=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();navigateToApp(`${constants["f"]}:${app_types["a"].case}`)},[navigateToApp]);const allCasesLink=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(links["f"],{onClick:goToCases,href:formatUrl("")}," ",VIEW_ALL_CASES),[goToCases,formatUrl]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(previousFilterOptions!==undefined&&previousFilterOptions!==filterOptions){setFilters(filterOptions)}},[previousFilterOptions,filterOptions,setFilters]);const content=Object(external_kbnSharedDeps_React_["useMemo"])(()=>isLoadingCases?external_kbnSharedDeps_React_default.a.createElement(LoadingPlaceholders,{lines:2,placeholders:3}):!isLoadingCases&&data.cases.length===0?external_kbnSharedDeps_React_default.a.createElement(NoCases,null):external_kbnSharedDeps_React_default.a.createElement(RecentCases,{cases:data.cases}),[isLoadingCases,data]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"s"},content,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},allCasesLink))});StatefulRecentCasesComponent.displayName="StatefulRecentCasesComponent";const StatefulRecentCases=external_kbnSharedDeps_React_default.a.memo(StatefulRecentCasesComponent);var containers_all=__webpack_require__(352);const RecentTimelineHeader=external_kbnSharedDeps_React_default.a.memo(({onOpenTimeline:onOpenTimeline,timeline:timeline,timeline:{title:title,savedObjectId:savedObjectId}})=>{const onClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>onOpenTimeline({duplicate:false,timelineId:`${savedObjectId}`}),[onOpenTimeline,savedObjectId]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{onClick:onClick},Object(open_timeline_helpers["f"])(timeline)?UNTITLED_TIMELINE:title))});RecentTimelineHeader.displayName="RecentTimelineHeader";var with_hover_actions=__webpack_require__(289);const RecentTimelinesItem=external_kbnSharedDeps_React_default.a.memo(({timeline:timeline,onOpenTimeline:onOpenTimeline,isLastItem:isLastItem})=>{const handleClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>onOpenTimeline({duplicate:true,timelineId:`${timeline.savedObjectId}`}),[onOpenTimeline,timeline.savedObjectId]);const render=Object(external_kbnSharedDeps_React_["useCallback"])(showHoverContent=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(RecentTimelineHeader,{onOpenTimeline:onOpenTimeline,timeline:timeline}),external_kbnSharedDeps_React_default.a.createElement(RecentTimelineCounts,{timeline:timeline}),timeline.description&&timeline.description.length&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"xs"},timeline.description)),showHoverContent&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiToolTip"],{content:timeline.timelineType===types_timeline["i"].default?OPEN_AS_DUPLICATE:OPEN_AS_DUPLICATE_TEMPLATE},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{"aria-label":timeline.timelineType===types_timeline["i"].default?OPEN_AS_DUPLICATE:OPEN_AS_DUPLICATE_TEMPLATE,"data-test-subj":"open-duplicate",isDisabled:timeline.savedObjectId==null,iconSize:"s",iconType:"copy",onClick:handleClick,size:"s"})))),[handleClick,onOpenTimeline,timeline]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(with_hover_actions["b"],{render:render}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,!isLastItem&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"})))});RecentTimelinesItem.displayName="RecentTimelinesItem";const RecentTimelines=external_kbnSharedDeps_React_default.a.memo(({noTimelinesMessage:noTimelinesMessage,onOpenTimeline:onOpenTimeline,timelines:timelines})=>{const content=Object(external_kbnSharedDeps_React_["useMemo"])(()=>timelines.map((timeline,index)=>external_kbnSharedDeps_React_default.a.createElement(RecentTimelinesItem,{key:`${timeline.savedObjectId}-${timeline.title}`,timeline:timeline,onOpenTimeline:onOpenTimeline,isLastItem:index===timelines.length-1})),[onOpenTimeline,timelines]);if(timelines.length===0){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"s"},noTimelinesMessage))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,content)});RecentTimelines.displayName="RecentTimelines";var use_timeline_status=__webpack_require__(705);const PAGE_SIZE=3;const StatefulRecentTimelinesComponent=({apolloClient:apolloClient,filterBy:filterBy})=>{const dispatch=Object(react_redux_lib["useDispatch"])();const updateIsLoading=Object(external_kbnSharedDeps_React_["useCallback"])(payload=>dispatch(Object(timeline_actions["updateIsLoading"])(payload)),[dispatch]);const updateTimeline=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(open_timeline_helpers["b"])(dispatch),[dispatch]);const{formatUrl:formatUrl}=Object(link_to["o"])(app_types["a"].timelines);const{navigateToApp:navigateToApp}=Object(lib_kibana["h"])().services.application;const onOpenTimeline=Object(external_kbnSharedDeps_React_["useCallback"])(({duplicate:duplicate,timelineId:timelineId})=>{Object(open_timeline_helpers["h"])({apolloClient:apolloClient,duplicate:duplicate,timelineId:timelineId,updateIsLoading:updateIsLoading,updateTimeline:updateTimeline})},[apolloClient,updateIsLoading,updateTimeline]);const goToTimelines=Object(external_kbnSharedDeps_React_["useCallback"])(ev=>{ev.preventDefault();navigateToApp(`${constants["f"]}:${app_types["a"].timelines}`)},[navigateToApp]);const noTimelinesMessage=filterBy==="favorites"?NO_FAVORITE_TIMELINES:NO_TIMELINES;const linkAllTimelines=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(links["f"],{onClick:goToTimelines,href:formatUrl("")},VIEW_ALL_TIMELINES),[goToTimelines,formatUrl]);const loadingPlaceholders=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(LoadingPlaceholders,{lines:2,placeholders:filterBy==="favorites"?1:PAGE_SIZE}),[filterBy]);const{fetchAllTimeline:fetchAllTimeline,timelines:timelines,loading:loading}=Object(containers_all["b"])();const timelineType=types_timeline["i"].default;const{timelineStatus:timelineStatus}=Object(use_timeline_status["a"])({timelineType:timelineType});Object(external_kbnSharedDeps_React_["useEffect"])(()=>{fetchAllTimeline({pageInfo:{pageIndex:1,pageSize:PAGE_SIZE},search:"",sort:{sortField:graphql_types["g"].updated,sortOrder:graphql_types["a"].desc},onlyUserFavorite:filterBy==="favorites",status:timelineStatus,timelineType:timelineType})},[fetchAllTimeline,filterBy,timelineStatus,timelineType]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,loading?loadingPlaceholders:external_kbnSharedDeps_React_default.a.createElement(RecentTimelines,{noTimelinesMessage:noTimelinesMessage,onOpenTimeline:onOpenTimeline,timelines:timelines!==null&&timelines!==void 0?timelines:[]}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs"},linkAllTimelines))};StatefulRecentTimelinesComponent.displayName="StatefulRecentTimelinesComponent";const StatefulRecentTimelines=external_kbnSharedDeps_React_default.a.memo(StatefulRecentTimelinesComponent);const removeSnapshotFromVersion=kibanaVersion=>{var _kibanaVersion$replac;return(_kibanaVersion$replac=kibanaVersion===null||kibanaVersion===void 0?void 0:kibanaVersion.replace(/-SNAPSHOT/gi,""))!==null&&_kibanaVersion$replac!==void 0?_kibanaVersion$replac:kibanaVersion};const getNewsFeedUrl=({newsFeedUrlSetting:newsFeedUrlSetting,getKibanaVersion:getKibanaVersion})=>[newsFeedUrlSetting===null||newsFeedUrlSetting===void 0?void 0:newsFeedUrlSetting.trim().replace(/\/$/,""),`v${removeSnapshotFromVersion(getKibanaVersion())}.json`].join("/");const NEWS_FEED_FALLBACK_LANGUAGE="en";const getLocale=fallback=>{var _document$documentEle;if(document.documentElement.lang===""){return fallback}return(_document$documentEle=document.documentElement.lang)!==null&&_document$documentEle!==void 0?_document$documentEle:fallback};const NO_NEWS_ITEMS=[];const getNewsItemsFromApiResponse=response=>{const locale=getLocale(NEWS_FEED_FALLBACK_LANGUAGE);if(response==null||response.items==null){return NO_NEWS_ITEMS}return response.items.filter(x=>x!=null).map(x=>{var _ref,_get,_x$expire_on,_x$hash,_ref2,_get2,_ref3,_get3,_x$publish_on,_ref4,_get4;return{description:(_ref=(_get=Object(external_kbnSharedDeps_LodashFp_["get"])(locale,x.description))!==null&&_get!==void 0?_get:Object(external_kbnSharedDeps_LodashFp_["get"])(NEWS_FEED_FALLBACK_LANGUAGE,x.description))!==null&&_ref!==void 0?_ref:"",expireOn:new Date((_x$expire_on=x.expire_on)!==null&&_x$expire_on!==void 0?_x$expire_on:""),hash:(_x$hash=x.hash)!==null&&_x$hash!==void 0?_x$hash:uuid_default.a.v4(),imageUrl:(_ref2=(_get2=Object(external_kbnSharedDeps_LodashFp_["get"])(locale,x.image_url))!==null&&_get2!==void 0?_get2:Object(external_kbnSharedDeps_LodashFp_["get"])(NEWS_FEED_FALLBACK_LANGUAGE,x.image_url))!==null&&_ref2!==void 0?_ref2:null,linkUrl:(_ref3=(_get3=Object(external_kbnSharedDeps_LodashFp_["get"])(locale,x.link_url))!==null&&_get3!==void 0?_get3:Object(external_kbnSharedDeps_LodashFp_["get"])(NEWS_FEED_FALLBACK_LANGUAGE,x.link_url))!==null&&_ref3!==void 0?_ref3:"",publishOn:new Date((_x$publish_on=x.publish_on)!==null&&_x$publish_on!==void 0?_x$publish_on:""),title:(_ref4=(_get4=Object(external_kbnSharedDeps_LodashFp_["get"])(locale,x.title))!==null&&_get4!==void 0?_get4:Object(external_kbnSharedDeps_LodashFp_["get"])(NEWS_FEED_FALLBACK_LANGUAGE,x.title))!==null&&_ref4!==void 0?_ref4:""}})};const fetchNews=async({newsFeedUrl:newsFeedUrl})=>lib_kibana["b"].get().http.fetch(newsFeedUrl,{method:"GET",credentials:"omit",mode:"cors"});const showNewsItem=({publishOn:publishOn,expireOn:expireOn})=>external_kbnSharedDeps_Moment_default()(Date.now()).isAfter(publishOn)&&external_kbnSharedDeps_Moment_default()(Date.now()).isBefore(expireOn);const SidebarHeader=external_kbnSharedDeps_React_default.a.memo(({children:children,title:title})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center",gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h2",null,title))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},children)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"})));SidebarHeader.displayName="SidebarHeader";const NO_NEWS_MESSAGE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.newsFeed.noNewsMessage",{defaultMessage:"Your current news feed URL returned no recent news."});const NO_NEWS_MESSAGE_ADMIN=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.newsFeed.noNewsMessageForAdmin",{defaultMessage:"Your current news feed URL returned no recent news. You may update the URL or disable security news via"});const ADVANCED_SETTINGS_LINK_TITLE=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.newsFeed.advancedSettingsLinkTitle",{defaultMessage:"SIEM advanced settings"});const NoNews=external_kbnSharedDeps_React_default.a.memo(()=>{var _capabilities$managem;const{getUrlForApp:getUrlForApp,navigateToApp:navigateToApp,capabilities:capabilities}=Object(lib_kibana["h"])().services.application;const canSeeAdvancedSettings=(_capabilities$managem=capabilities.management.kibana.settings)!==null&&_capabilities$managem!==void 0?_capabilities$managem:false;const goToKibanaSettings=Object(external_kbnSharedDeps_React_["useCallback"])(()=>navigateToApp("management",{path:"/kibana/settings"}),[navigateToApp]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"s"},canSeeAdvancedSettings?NO_NEWS_MESSAGE_ADMIN:NO_NEWS_MESSAGE,canSeeAdvancedSettings&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null," ",external_kbnSharedDeps_React_default.a.createElement(links["f"],{onClick:goToKibanaSettings,href:`${getUrlForApp("management",{path:"/kibana/settings"})}`},ADVANCED_SETTINGS_LINK_TITLE),"."))});NoNews.displayName="NoNews";const REL_NOOPENER="noopener";const REL_NOFOLLOW="nofollow";const REL_NOREFERRER="noreferrer";const NewsLink=({href:href,children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:href,rel:`${REL_NOOPENER} ${REL_NOFOLLOW} ${REL_NOREFERRER}`,target:"_blank"},children);const NewsItemPreviewImage=external_kbnSharedDeps_StyledComponents_default.a.img.withConfig({displayName:"NewsItemPreviewImage",componentId:"e9sq8j-0"})(["height:56px;margin-left:16px;min-width:56px;padding:4px;width:56px;"]);const Post=external_kbnSharedDeps_React_default.a.memo(({newsItem:newsItem})=>{const{linkUrl:linkUrl,title:title,publishOn:publishOn,description:description,imageUrl:imageUrl}=newsItem;if(!showNewsItem(newsItem)){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(NewsLink,{href:linkUrl},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},title)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"xs"},external_kbnSharedDeps_React_default.a.createElement(formatted_date["e"],{value:publishOn}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement("div",null,description),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},imageUrl&&external_kbnSharedDeps_React_default.a.createElement(NewsLink,{href:linkUrl},external_kbnSharedDeps_React_default.a.createElement(NewsItemPreviewImage,{alt:title,className:"euiPanel",src:imageUrl}))))});Post.displayName="Post";const SHOW_PLACEHOLDERS=5;const LINES_PER_LOADING_PLACEHOLDER=4;const NewsFeedComponent=({news:news})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(SidebarHeader,{title:overview_pages_translations["b"]}),news==null?external_kbnSharedDeps_React_default.a.createElement(LoadingPlaceholders,{lines:LINES_PER_LOADING_PLACEHOLDER,placeholders:SHOW_PLACEHOLDERS}):news.length===0?external_kbnSharedDeps_React_default.a.createElement(NoNews,null):news.map(n=>external_kbnSharedDeps_React_default.a.createElement(Post,{key:n.hash,newsItem:n})));NewsFeedComponent.displayName="NewsFeedComponent";const NewsFeed=external_kbnSharedDeps_React_default.a.memo(NewsFeedComponent);const StatefulNewsFeed=external_kbnSharedDeps_React_default.a.memo(({enableNewsFeedSetting:enableNewsFeedSetting,newsFeedSetting:newsFeedSetting})=>{const kibanaNewsfeedEnabled=Object(lib_kibana["h"])().services.newsfeed;const[enableNewsFeed]=Object(lib_kibana["l"])(enableNewsFeedSetting);const[newsFeedUrlSetting]=Object(lib_kibana["l"])(newsFeedSetting);const[news,setNews]=Object(external_kbnSharedDeps_React_["useState"])(null);const newsfeedEnabled=kibanaNewsfeedEnabled&&enableNewsFeed;const newsFeedUrl=getNewsFeedUrl({newsFeedUrlSetting:newsFeedUrlSetting,getKibanaVersion:()=>lib_kibana["b"].getKibanaVersion()});Object(external_kbnSharedDeps_React_["useEffect"])(()=>{let canceled=false;const fetchData=async()=>{try{const apiResponse=await fetchNews({newsFeedUrl:newsFeedUrl});if(!canceled){setNews(getNewsItemsFromApiResponse(apiResponse))}}catch{if(!canceled){setNews([])}}};if(newsfeedEnabled){fetchData()}return()=>{canceled=true}},[newsfeedEnabled,newsFeedUrl]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,newsfeedEnabled?external_kbnSharedDeps_React_default.a.createElement(NewsFeed,{news:news}):null)});StatefulNewsFeed.displayName="StatefulNewsFeed";var apollo_context=__webpack_require__(237);const SidebarFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"SidebarFlexGroup",componentId:"s31pt6-0"})(["width:305px;"]);const SidebarSpacerComponent=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xxl"}));SidebarSpacerComponent.displayName="SidebarSpacerComponent";const Spacer=external_kbnSharedDeps_React_default.a.memo(SidebarSpacerComponent);const Sidebar=external_kbnSharedDeps_React_default.a.memo(({recentCasesFilterBy:recentCasesFilterBy,recentTimelinesFilterBy:recentTimelinesFilterBy,setRecentCasesFilterBy:setRecentCasesFilterBy,setRecentTimelinesFilterBy:setRecentTimelinesFilterBy})=>{const currentUser=Object(lib_kibana["d"])();const apolloClient=Object(apollo_context["b"])();const recentCasesFilters=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(Filters,{filterBy:recentCasesFilterBy,setFilterBy:setRecentCasesFilterBy,showMyRecentlyReported:currentUser!=null}),[currentUser,recentCasesFilterBy,setRecentCasesFilterBy]);const recentCasesFilterOptions=Object(external_kbnSharedDeps_React_["useMemo"])(()=>recentCasesFilterBy==="myRecentlyReported"&&currentUser!=null?{...use_get_cases["a"],reporters:[{email:currentUser.email,full_name:currentUser.fullName,username:currentUser.username}]}:use_get_cases["a"],[currentUser,recentCasesFilterBy]);const recentTimelinesFilters=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(filters_Filters,{filterBy:recentTimelinesFilterBy,setFilterBy:setRecentTimelinesFilterBy}),[recentTimelinesFilterBy,setRecentTimelinesFilterBy]);return external_kbnSharedDeps_React_default.a.createElement(SidebarFlexGroup,{direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(SidebarHeader,{title:overview_pages_translations["c"]},recentCasesFilters),external_kbnSharedDeps_React_default.a.createElement(StatefulRecentCases,{filterOptions:recentCasesFilterOptions})),external_kbnSharedDeps_React_default.a.createElement(Spacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(SidebarHeader,{title:overview_pages_translations["d"]},recentTimelinesFilters),external_kbnSharedDeps_React_default.a.createElement(StatefulRecentTimelines,{apolloClient:apolloClient,filterBy:recentTimelinesFilterBy})),external_kbnSharedDeps_React_default.a.createElement(Spacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(StatefulNewsFeed,{enableNewsFeedSetting:constants["P"],newsFeedSetting:constants["V"]})))});Sidebar.displayName="Sidebar";const StatefulSidebar=external_kbnSharedDeps_React_default.a.memo(()=>{const[recentTimelinesFilterBy,setRecentTimelinesFilterBy]=Object(external_kbnSharedDeps_React_["useState"])("favorites");const[recentCasesFilterBy,setRecentCasesFilterBy]=Object(external_kbnSharedDeps_React_["useState"])("recentlyCreated");return external_kbnSharedDeps_React_default.a.createElement(Sidebar,{recentCasesFilterBy:recentCasesFilterBy,setRecentCasesFilterBy:setRecentCasesFilterBy,recentTimelinesFilterBy:recentTimelinesFilterBy,setRecentTimelinesFilterBy:setRecentTimelinesFilterBy})});StatefulSidebar.displayName="StatefulSidebar";var signals_by_category=__webpack_require__(714);var routing=__webpack_require__(148);var use_navigate_to_app_event_handler=__webpack_require__(212);var management_common_constants=__webpack_require__(121);const useManagementFormatUrl=managementPath=>`${Object(lib_kibana["h"])().services.application.getUrlForApp(management_common_constants["b"])}${managementPath}`;const EndpointNotice=Object(external_kbnSharedDeps_React_["memo"])(({onDismiss:onDismiss})=>{const endpointsPath=Object(routing["d"])({name:"endpointList"});const endpointsLink=useManagementFormatUrl(endpointsPath);const handleGetStartedClick=Object(use_navigate_to_app_event_handler["a"])(management_common_constants["b"],{path:endpointsPath});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{"data-test-subj":"endpoint-prompt-banner",iconType:"cheer",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("b",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endpointNotice.introducing",defaultMessage:"Introducing: "})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endpointNotice.title",defaultMessage:"Endpoint Security (beta)"}))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endpointNotice.message",defaultMessage:"Protect your hosts with threat prevention, detection, and deep security data visibility."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{onClick:handleGetStartedClick,href:endpointsLink},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endpointNotice.tryButton",defaultMessage:"Try Endpoint Security (beta)"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:onDismiss},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.securitySolution.overview.endpointNotice.dismiss",defaultMessage:"Dismiss message"}))))});EndpointNotice.displayName="EndpointNotice";var use_messages_storage=__webpack_require__(489);var ingest_enabled=__webpack_require__(383);var components_sourcerer=__webpack_require__(768);const SidebarFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"SidebarFlexItem",componentId:"g6j99s-0"})(["margin-right:24px;"]);const OverviewComponent=()=>{const getGlobalFiltersQuerySelector=Object(external_kbnSharedDeps_React_["useMemo"])(()=>store["inputsSelectors"].globalFiltersQuerySelector(),[]);const getGlobalQuerySelector=Object(external_kbnSharedDeps_React_["useMemo"])(()=>store["inputsSelectors"].globalQuerySelector(),[]);const query=Object(use_selector["a"])(getGlobalQuerySelector);const filters=Object(use_selector["a"])(getGlobalFiltersQuerySelector);const{from:from,deleteQuery:deleteQuery,setQuery:setQuery,to:to}=Object(use_global_time["a"])();const{indicesExist:indicesExist,indexPattern:indexPattern,selectedPatterns:selectedPatterns}=Object(sourcerer["b"])();const endpointMetadataIndex=Object(external_kbnSharedDeps_React_["useMemo"])(()=>[constants["Q"]],[]);const[,{indexExists:metadataIndexExists}]=Object(source["b"])(endpointMetadataIndex,true);const{addMessage:addMessage,hasMessage:hasMessage}=Object(use_messages_storage["a"])();const hasDismissEndpointNoticeMessage=Object(external_kbnSharedDeps_React_["useMemo"])(()=>hasMessage("management","dismissEndpointNotice"),[hasMessage]);const[dismissMessage,setDismissMessage]=Object(external_kbnSharedDeps_React_["useState"])(hasDismissEndpointNoticeMessage);const dismissEndpointNotice=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setDismissMessage(true);addMessage("management","dismissEndpointNotice")},[addMessage]);const{allEnabled:isIngestEnabled}=Object(ingest_enabled["a"])();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,indicesExist?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(filters_global["a"],null,external_kbnSharedDeps_React_default.a.createElement(search_bar["a"],{id:"global",indexPattern:indexPattern})),external_kbnSharedDeps_React_default.a.createElement(wrapper_page["a"],null,!dismissMessage&&!metadataIndexExists&&isIngestEnabled&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(EndpointNotice,{onDismiss:dismissEndpointNotice}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"})),external_kbnSharedDeps_React_default.a.createElement(components_sourcerer["a"],{scope:model["SourcererScopeName"].default}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(SidebarFlexItem,{grow:false},external_kbnSharedDeps_React_default.a.createElement(StatefulSidebar,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(signals_by_category["a"],{filters:filters,from:from,query:query,setQuery:setQuery,to:to}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"l"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(AlertsByCategory,{deleteQuery:deleteQuery,filters:filters,from:from,indexPattern:indexPattern,indexNames:selectedPatterns,query:query,setQuery:setQuery,to:to})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(events_by_dataset["a"],{deleteQuery:deleteQuery,filters:filters,from:from,indexPattern:indexPattern,indexNames:selectedPatterns,query:query,setQuery:setQuery,to:to})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(EventCounts,{filters:filters,from:from,indexNames:selectedPatterns,indexPattern:indexPattern,query:query,setQuery:setQuery,to:to}))))))):external_kbnSharedDeps_React_default.a.createElement(overview_empty["a"],null),external_kbnSharedDeps_React_default.a.createElement(spy_routes["a"],{pageName:app_types["a"].overview}))};const StatefulOverview=external_kbnSharedDeps_React_default.a.memo(OverviewComponent);const pages_Overview=Object(external_kbnSharedDeps_React_["memo"])(()=>external_kbnSharedDeps_React_default.a.createElement(StatefulOverview,null));pages_Overview.displayName="Overview";const OverviewRoutes=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/",render:()=>external_kbnSharedDeps_React_default.a.createElement(pages_Overview,null)}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{render:()=>external_kbnSharedDeps_React_default.a.createElement(_404["a"],null)}));class overview_Overview{setup(){}start(){return{SubPluginRoutes:OverviewRoutes}}}var pages=__webpack_require__(779);const TimelinesRoutesComponent=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/"},external_kbnSharedDeps_React_default.a.createElement(pages["a"],null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],null,external_kbnSharedDeps_React_default.a.createElement(_404["a"],null)));const TimelinesRoutes=external_kbnSharedDeps_React_default.a.memo(TimelinesRoutesComponent);var dist=__webpack_require__(236);var store_timeline_helpers=__webpack_require__(442);const EMPTY_TIMELINE_BY_ID={};const initialTimelineState={timelineById:EMPTY_TIMELINE_BY_ID,autoSavedWarningMsg:{timelineId:null,newTimelineModel:null},showCallOutUnauthorizedMsg:false,insertTimeline:null};const timelineReducer=Object(dist["reducerWithInitialState"])(initialTimelineState).case(timeline_actions["addTimeline"],(state,{id:id,timeline:timeline})=>({...state,timelineById:Object(store_timeline_helpers["f"])({id:id,timeline:timeline,timelineById:state.timelineById})})).case(timeline_actions["createTimeline"],(state,{id:id,dataProviders:dataProviders,dateRange:dateRange,excludedRowRendererIds:excludedRowRendererIds,expandedDetail:expandedDetail={},show:show,columns:columns,itemsPerPage:itemsPerPage,indexNames:indexNames,kqlQuery:kqlQuery,sort:sort,showCheckboxes:showCheckboxes,timelineType:timelineType=types_timeline["i"].default,filters:filters})=>({...state,timelineById:Object(store_timeline_helpers["a"])({columns:columns,dataProviders:dataProviders,dateRange:dateRange,excludedRowRendererIds:excludedRowRendererIds,expandedDetail:expandedDetail,filters:filters,id:id,itemsPerPage:itemsPerPage,indexNames:indexNames,kqlQuery:kqlQuery,sort:sort,show:show,showCheckboxes:showCheckboxes,timelineById:state.timelineById,timelineType:timelineType})})).case(timeline_actions["upsertColumn"],(state,{column:column,id:id,index:index})=>({...state,timelineById:Object(store_timeline_helpers["N"])({column:column,id:id,index:index,timelineById:state.timelineById})})).case(timeline_actions["addHistory"],(state,{id:id,historyId:historyId})=>({...state,timelineById:Object(store_timeline_helpers["b"])({id:id,historyId:historyId,timelineById:state.timelineById})})).case(timeline_actions["addNote"],(state,{id:id,noteId:noteId})=>({...state,timelineById:Object(store_timeline_helpers["c"])({id:id,noteId:noteId,timelineById:state.timelineById})})).case(timeline_actions["addNoteToEvent"],(state,{id:id,noteId:noteId,eventId:eventId})=>({...state,timelineById:Object(store_timeline_helpers["d"])({id:id,noteId:noteId,eventId:eventId,timelineById:state.timelineById})})).case(timeline_actions["toggleDetailPanel"],(state,action)=>({...state,timelineById:{...state.timelineById,[action.timelineId]:{...state.timelineById[action.timelineId],expandedDetail:{...state.timelineById[action.timelineId].expandedDetail,...Object(store_timeline_helpers["v"])(action)}}}})).case(timeline_actions["addProvider"],(state,{id:id,provider:provider})=>({...state,timelineById:Object(store_timeline_helpers["e"])({id:id,provider:provider,timelineById:state.timelineById})})).case(timeline_actions["applyKqlFilterQuery"],(state,{id:id,filterQuery:filterQuery})=>({...state,timelineById:Object(store_timeline_helpers["h"])({id:id,filterQuery:filterQuery,timelineById:state.timelineById})})).case(timeline_actions["showTimeline"],(state,{id:id,show:show})=>({...state,timelineById:Object(store_timeline_helpers["K"])({id:id,show:show,timelineById:state.timelineById})})).case(timeline_actions["updateTimelineGraphEventId"],(state,{id:id,graphEventId:graphEventId})=>({...state,timelineById:Object(store_timeline_helpers["s"])({id:id,graphEventId:graphEventId,timelineById:state.timelineById})})).case(timeline_actions["applyDeltaToColumnWidth"],(state,{id:id,columnId:columnId,delta:delta})=>({...state,timelineById:Object(store_timeline_helpers["g"])({id:id,columnId:columnId,delta:delta,timelineById:state.timelineById})})).case(timeline_actions["pinEvent"],(state,{id:id,eventId:eventId})=>({...state,timelineById:Object(store_timeline_helpers["j"])({id:id,eventId:eventId,timelineById:state.timelineById})})).case(timeline_actions["removeColumn"],(state,{id:id,columnId:columnId})=>({...state,timelineById:Object(store_timeline_helpers["k"])({id:id,columnId:columnId,timelineById:state.timelineById})})).case(timeline_actions["removeProvider"],(state,{id:id,providerId:providerId,andProviderId:andProviderId})=>({...state,timelineById:Object(store_timeline_helpers["l"])({id:id,providerId:providerId,timelineById:state.timelineById,andProviderId:andProviderId})})).case(timeline_actions["startTimelineSaving"],(state,{id:id})=>({...state,timelineById:{...state.timelineById,[id]:{...state.timelineById[id],isSaving:true}}})).case(timeline_actions["endTimelineSaving"],(state,{id:id})=>({...state,timelineById:{...state.timelineById,[id]:{...state.timelineById[id],isSaving:false}}})).case(timeline_actions["setEventsDeleted"],(state,{id:id,eventIds:eventIds,isDeleted:isDeleted})=>({...state,timelineById:Object(store_timeline_helpers["m"])({id:id,eventIds:eventIds,timelineById:state.timelineById,isDeleted:isDeleted})})).case(timeline_actions["clearEventsDeleted"],(state,{id:id})=>({...state,timelineById:{...state.timelineById,[id]:{...state.timelineById[id],deletedEventIds:[]}}})).case(timeline_actions["setEventsLoading"],(state,{id:id,eventIds:eventIds,isLoading:isLoading})=>({...state,timelineById:Object(store_timeline_helpers["n"])({id:id,eventIds:eventIds,timelineById:state.timelineById,isLoading:isLoading})})).case(timeline_actions["clearEventsLoading"],(state,{id:id})=>({...state,timelineById:{...state.timelineById,[id]:{...state.timelineById[id],loadingEventIds:[]}}})).case(timeline_actions["setExcludedRowRendererIds"],(state,{id:id,excludedRowRendererIds:excludedRowRendererIds})=>({...state,timelineById:Object(store_timeline_helpers["q"])({id:id,excludedRowRendererIds:excludedRowRendererIds,timelineById:state.timelineById})})).case(timeline_actions["setSelected"],(state,{id:id,eventIds:eventIds,isSelected:isSelected,isSelectAllChecked:isSelectAllChecked})=>({...state,timelineById:Object(store_timeline_helpers["o"])({id:id,eventIds:eventIds,timelineById:state.timelineById,isSelected:isSelected,isSelectAllChecked:isSelectAllChecked})})).case(timeline_actions["clearSelected"],(state,{id:id})=>({...state,timelineById:{...state.timelineById,[id]:{...state.timelineById[id],selectedEventIds:{},isSelectAllChecked:false}}})).case(timeline_actions["updateIsLoading"],(state,{id:id,isLoading:isLoading})=>({...state,timelineById:{...state.timelineById,[id]:{...state.timelineById[id],isLoading:isLoading}}})).case(timeline_actions["updateTimeline"],(state,{id:id,timeline:timeline})=>({...state,timelineById:{...state.timelineById,[id]:timeline}})).case(timeline_actions["unPinEvent"],(state,{id:id,eventId:eventId})=>({...state,timelineById:Object(store_timeline_helpers["p"])({id:id,eventId:eventId,timelineById:state.timelineById})})).case(timeline_actions["updateColumns"],(state,{id:id,columns:columns})=>({...state,timelineById:Object(store_timeline_helpers["u"])({id:id,columns:columns,timelineById:state.timelineById})})).case(timeline_actions["updateEventType"],(state,{id:id,eventType:eventType})=>({...state,timelineById:Object(store_timeline_helpers["w"])({id:id,eventType:eventType,timelineById:state.timelineById})})).case(timeline_actions["updateIsFavorite"],(state,{id:id,isFavorite:isFavorite})=>({...state,timelineById:Object(store_timeline_helpers["x"])({id:id,isFavorite:isFavorite,timelineById:state.timelineById})})).case(timeline_actions["updateIsLive"],(state,{id:id,isLive:isLive})=>({...state,timelineById:Object(store_timeline_helpers["y"])({id:id,isLive:isLive,timelineById:state.timelineById})})).case(timeline_actions["updateKqlMode"],(state,{id:id,kqlMode:kqlMode})=>({...state,timelineById:Object(store_timeline_helpers["A"])({id:id,kqlMode:kqlMode,timelineById:state.timelineById})})).case(timeline_actions["updateTitleAndDescription"],(state,{id:id,title:title,description:description})=>({...state,timelineById:Object(store_timeline_helpers["M"])({id:id,title:title,description:description,timelineById:state.timelineById})})).case(timeline_actions["updateProviders"],(state,{id:id,providers:providers})=>({...state,timelineById:Object(store_timeline_helpers["I"])({id:id,providers:providers,timelineById:state.timelineById})})).case(timeline_actions["updateRange"],(state,{id:id,start:start,end:end})=>({...state,timelineById:Object(store_timeline_helpers["J"])({id:id,start:start,end:end,timelineById:state.timelineById})})).case(timeline_actions["updateSort"],(state,{id:id,sort:sort})=>({...state,timelineById:Object(store_timeline_helpers["L"])({id:id,sort:sort,timelineById:state.timelineById})})).case(timeline_actions["updateDataProviderEnabled"],(state,{id:id,enabled:enabled,providerId:providerId,andProviderId:andProviderId})=>({...state,timelineById:Object(store_timeline_helpers["D"])({id:id,enabled:enabled,providerId:providerId,timelineById:state.timelineById,andProviderId:andProviderId})})).case(timeline_actions["updateDataProviderExcluded"],(state,{id:id,excluded:excluded,providerId:providerId,andProviderId:andProviderId})=>({...state,timelineById:Object(store_timeline_helpers["E"])({id:id,excluded:excluded,providerId:providerId,timelineById:state.timelineById,andProviderId:andProviderId})})).case(timeline_actions["dataProviderEdited"],(state,{andProviderId:andProviderId,excluded:excluded,field:field,id:id,operator:operator,providerId:providerId,value:value})=>({...state,timelineById:Object(store_timeline_helpers["G"])({andProviderId:andProviderId,excluded:excluded,field:field,id:id,operator:operator,providerId:providerId,timelineById:state.timelineById,value:value})})).case(timeline_actions["updateDataProviderType"],(state,{id:id,type:type,providerId:providerId,andProviderId:andProviderId})=>({...state,timelineById:Object(store_timeline_helpers["H"])({id:id,type:type,providerId:providerId,timelineById:state.timelineById,andProviderId:andProviderId})})).case(timeline_actions["updateDataProviderKqlQuery"],(state,{id:id,kqlQuery:kqlQuery,providerId:providerId})=>({...state,timelineById:Object(store_timeline_helpers["F"])({id:id,kqlQuery:kqlQuery,providerId:providerId,timelineById:state.timelineById})})).case(timeline_actions["updateItemsPerPage"],(state,{id:id,itemsPerPage:itemsPerPage})=>({...state,timelineById:Object(store_timeline_helpers["z"])({id:id,itemsPerPage:itemsPerPage,timelineById:state.timelineById})})).case(timeline_actions["updatePageIndex"],(state,{id:id,activePage:activePage})=>({...state,timelineById:Object(store_timeline_helpers["B"])({id:id,activePage:activePage,timelineById:state.timelineById})})).case(timeline_actions["updateItemsPerPageOptions"],(state,{id:id,itemsPerPageOptions:itemsPerPageOptions})=>({...state,timelineById:Object(store_timeline_helpers["C"])({id:id,itemsPerPageOptions:itemsPerPageOptions,timelineById:state.timelineById})})).case(timeline_actions["updateAutoSaveMsg"],(state,{timelineId:timelineId,newTimelineModel:newTimelineModel})=>({...state,autoSavedWarningMsg:{timelineId:timelineId,newTimelineModel:newTimelineModel}})).case(timeline_actions["showCallOutUnauthorizedMsg"],state=>({...state,showCallOutUnauthorizedMsg:true})).case(timeline_actions["setSavedQueryId"],(state,{id:id,savedQueryId:savedQueryId})=>({...state,timelineById:Object(store_timeline_helpers["t"])({id:id,savedQueryId:savedQueryId,timelineById:state.timelineById})})).case(timeline_actions["setFilters"],(state,{id:id,filters:filters})=>({...state,timelineById:Object(store_timeline_helpers["r"])({id:id,filters:filters,timelineById:state.timelineById})})).case(timeline_actions["setInsertTimeline"],(state,insertTimeline)=>({...state,insertTimeline:insertTimeline})).case(timeline_actions["updateIndexNames"],(state,{id:id,indexNames:indexNames})=>({...state,timelineById:{...state.timelineById,[id]:{...state.timelineById[id],indexNames:indexNames}}})).case(timeline_actions["setActiveTabTimeline"],(state,{id:id,activeTab:activeTab})=>({...state,timelineById:{...state.timelineById,[id]:{...state.timelineById[id],activeTab:activeTab,prevActiveTab:state.timelineById[id].activeTab}}})).case(timeline_actions["toggleModalSaveTimeline"],(state,{id:id,showModalSaveTimeline:showModalSaveTimeline})=>({...state,timelineById:{...state.timelineById,[id]:{...state.timelineById[id],showSaveModal:showModalSaveTimeline}}})).case(timeline_actions["updateEqlOptions"],(state,{id:id,field:field,value:value})=>{var _state$timelineById$i;return{...state,timelineById:{...state.timelineById,[id]:{...state.timelineById[id],eqlOptions:{...(_state$timelineById$i=state.timelineById[id].eqlOptions)!==null&&_state$timelineById$i!==void 0?_state$timelineById$i:{},[field]:value}}}}}).build();class timelines_Timelines{setup(){}start(){return{SubPluginRoutes:TimelinesRoutes,store:{initialState:{timeline:initialTimelineState},reducer:{timeline:timelineReducer}}}}}var management_pages=__webpack_require__(745);var current_license=__webpack_require__(742);const ManagementRoutes=()=>external_kbnSharedDeps_React_default.a.createElement(current_license["a"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Switch"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{path:"/",component:management_pages["a"]}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_["Route"],{render:()=>external_kbnSharedDeps_React_default.a.createElement(_404["a"],null)})));var store_reducer=__webpack_require__(765);var middleware=__webpack_require__(757);class management_Management{setup(){}start(core,plugins){return{SubPluginRoutes:ManagementRoutes,store:{initialState:{management:undefined},reducer:{management:store_reducer["a"]},middleware:Object(middleware["a"])(core,plugins)}}}}const subPluginClasses={Detections:detections_Detections,Cases:cases_Cases,Hosts:public_hosts_Hosts,Network:public_network_Network,Overview:overview_Overview,Timelines:timelines_Timelines,Management:management_Management}},171:function(module,exports,__webpack_require__){"use strict";module.exports=whitespace;var fromCode=String.fromCharCode;var re=/\s/;function whitespace(character){return re.test(typeof character==="number"?fromCode(character):character.charAt(0))}},186:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"m",(function(){return EQL_VALIDATION_REQUEST_ERROR}));__webpack_require__.d(__webpack_exports__,"k",(function(){return EQL_VALIDATION_ERRORS_TITLE}));__webpack_require__.d(__webpack_exports__,"l",(function(){return EQL_VALIDATION_ERROR_POPOVER_LABEL}));__webpack_require__.d(__webpack_exports__,"i",(function(){return EQL_OVERVIEW_LINK_TEXT}));__webpack_require__.d(__webpack_exports__,"j",(function(){return EQL_SETTINGS_TITLE}));__webpack_require__.d(__webpack_exports__,"h",(function(){return EQL_OPTIONS_SIZE_LABEL}));__webpack_require__.d(__webpack_exports__,"g",(function(){return EQL_OPTIONS_SIZE_HELPER}));__webpack_require__.d(__webpack_exports__,"b",(function(){return EQL_OPTIONS_EVENT_CATEGORY_FIELD_LABEL}));__webpack_require__.d(__webpack_exports__,"a",(function(){return EQL_OPTIONS_EVENT_CATEGORY_FIELD_HELPER}));__webpack_require__.d(__webpack_exports__,"d",(function(){return EQL_OPTIONS_EVENT_TIEBREAKER_FIELD_LABEL}));__webpack_require__.d(__webpack_exports__,"c",(function(){return EQL_OPTIONS_EVENT_TIEBREAKER_FIELD_HELPER}));__webpack_require__.d(__webpack_exports__,"f",(function(){return EQL_OPTIONS_EVENT_TIMESTAMP_FIELD_LABEL}));__webpack_require__.d(__webpack_exports__,"e",(function(){return EQL_OPTIONS_EVENT_TIMESTAMP_FIELD_HELPER}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__);const EQL_VALIDATION_REQUEST_ERROR=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.detectionEngine.eqlValidation.requestError",{defaultMessage:"An error occurred while validating your EQL query"});const EQL_VALIDATION_ERRORS_TITLE=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.detectionEngine.eqlValidation.title",{defaultMessage:"EQL Validation Errors"});const EQL_VALIDATION_ERROR_POPOVER_LABEL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.detectionEngine.eqlValidation.showErrorsLabel",{defaultMessage:"Show EQL Validation Errors"});const EQL_QUERY_BAR_LABEL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.detectionEngine.eqlQueryBar.label",{defaultMessage:"Enter an EQL Query"});const EQL_OVERVIEW_LINK_TEXT=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.detectionEngine.eqlOverViewLink.text",{defaultMessage:"Event Query Language (EQL) Overview"});const EQL_SETTINGS_TITLE=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.detectionEngine.eqlSettings.title",{defaultMessage:"EQL settings"});const EQL_OPTIONS_SIZE_LABEL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.label",{defaultMessage:"Size"});const EQL_OPTIONS_SIZE_HELPER=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.text",{defaultMessage:"For basic queries, the maximum number of matching events to return. For sequence queries, the maximum number of matching sequences to return."});const EQL_OPTIONS_EVENT_CATEGORY_FIELD_LABEL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.label",{defaultMessage:"Event category field"});const EQL_OPTIONS_EVENT_CATEGORY_FIELD_HELPER=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.text",{defaultMessage:"Field containing the event classification, such as process, file, or network. This field is typically mapped as a field type in the keyword family"});const EQL_OPTIONS_EVENT_TIEBREAKER_FIELD_LABEL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.label",{defaultMessage:"Tiebreaker field"});const EQL_OPTIONS_EVENT_TIEBREAKER_FIELD_HELPER=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.text",{defaultMessage:"Field used to sort hits with the same timestamp in ascending, lexicographic order"});const EQL_OPTIONS_EVENT_TIMESTAMP_FIELD_LABEL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.label",{defaultMessage:"Timestamp field"});const EQL_OPTIONS_EVENT_TIMESTAMP_FIELD_HELPER=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.text",{defaultMessage:"Field containing event timestamp"})},216:function(module,exports){module.exports=extend;var hasOwnProperty=Object.prototype.hasOwnProperty;function extend(){var target={};for(var i=0;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target}},279:function(module,exports){exports=module.exports=trim;function trim(str){if(str.trim)return str.trim();return exports.right(exports.left(str))}exports.left=function(str){if(str.trimLeft)return str.trimLeft();return str.replace(/^\s\s*/,"")};exports.right=function(str){if(str.trimRight)return str.trimRight();var whitespace_pattern=/\s/,i=str.length;while(whitespace_pattern.test(str.charAt(--i)));return str.slice(0,i+1)}},322:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return debounceAsync}));__webpack_require__.d(__webpack_exports__,"b",(function(){return eqlValidator}));__webpack_require__.d(__webpack_exports__,"c",(function(){return getValidationResults}));var external_kbnSharedDeps_Lodash_=__webpack_require__(19);var utils=__webpack_require__(162);var kibana=__webpack_require__(104);var public_=__webpack_require__(91);const PARSING_ERROR_TYPE="parsing_exception";const VERIFICATION_ERROR_TYPE="verification_exception";const MAPPING_ERROR_TYPE="mapping_exception";const isValidationErrorType=type=>type===PARSING_ERROR_TYPE||type===VERIFICATION_ERROR_TYPE||type===MAPPING_ERROR_TYPE;const isErrorResponse=response=>Object(external_kbnSharedDeps_Lodash_["has"])(response,"error.type");const isValidationErrorResponse=response=>isErrorResponse(response)&&isValidationErrorType(Object(external_kbnSharedDeps_Lodash_["get"])(response,"error.type"));const getValidationErrors=response=>response.error.root_cause.filter(cause=>isValidationErrorType(cause.type)).map(cause=>cause.reason);const validateEql=async({data:data,index:index,query:query,signal:signal})=>{const{rawResponse:response}=await data.search.search({params:{index:index.join(),body:{query:query,size:0}},options:{ignore:[400]}},{strategy:public_["EQL_SEARCH_STRATEGY"],abortSignal:signal}).toPromise();if(isValidationErrorResponse(response.body)){return{valid:false,errors:getValidationErrors(response.body)}}else if(isErrorResponse(response.body)){throw new Error(JSON.stringify(response.body))}else{return{valid:true,errors:[]}}};var translations=__webpack_require__(186);let ERROR_CODES;(function(ERROR_CODES){ERROR_CODES["FAILED_REQUEST"]="ERR_FAILED_REQUEST";ERROR_CODES["INVALID_EQL"]="ERR_INVALID_EQL"})(ERROR_CODES||(ERROR_CODES={}));const debounceAsync=(fn,interval)=>{let handle;let resolves=[];return(...args)=>{if(handle){clearTimeout(handle)}handle=setTimeout(()=>{const result=fn(...args);resolves.forEach(resolve=>resolve(result));resolves=[]},interval);return new Promise(resolve=>resolves.push(resolve))}};const eqlValidator=async(...args)=>{const[{value:value,formData:formData}]=args;const{query:queryValue}=value;const query=queryValue.query;const{index:index,ruleType:ruleType}=formData;const needsValidation=ruleType===undefined&&!Object(external_kbnSharedDeps_Lodash_["isEmpty"])(query)||Object(utils["d"])(ruleType)&&!Object(external_kbnSharedDeps_Lodash_["isEmpty"])(query);if(!needsValidation){return}try{const{data:data}=kibana["b"].get();const signal=(new AbortController).signal;const response=await validateEql({data:data,query:query,signal:signal,index:index});if((response===null||response===void 0?void 0:response.valid)===false){return{code:ERROR_CODES.INVALID_EQL,message:"",messages:response.errors}}}catch(error){return{code:ERROR_CODES.FAILED_REQUEST,message:translations["m"],error:error}}};const getValidationResults=field=>{const hasErrors=field.errors.length>0;const isValid=!field.isChangingValue&&!hasErrors;if(hasErrors){const[error]=field.errors;const message=error.message;if(error.code===ERROR_CODES.INVALID_EQL){return{isValid:isValid,message:message,messages:error.messages}}else{return{isValid:isValid,message:message,error:error.error}}}else{return{isValid:isValid,message:""}}}},394:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return QueryBar}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var fast_deep_equal__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(107);var fast_deep_equal__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(fast_deep_equal__WEBPACK_IMPORTED_MODULE_1__);var _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(77);var _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__);var _src_plugins_kibana_utils_public__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(41);var _src_plugins_kibana_utils_public__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_src_plugins_kibana_utils_public__WEBPACK_IMPORTED_MODULE_3__);const QueryBar=Object(react__WEBPACK_IMPORTED_MODULE_0__["memo"])(({dateRangeFrom:dateRangeFrom,dateRangeTo:dateRangeTo,hideSavedQuery:hideSavedQuery=false,indexPattern:indexPattern,isLoading:isLoading=false,isRefreshPaused:isRefreshPaused,filterQuery:filterQuery,filterManager:filterManager,filters:filters,onChangedQuery:onChangedQuery,onSubmitQuery:onSubmitQuery,refreshInterval:refreshInterval,savedQuery:savedQuery,onSavedQuery:onSavedQuery,dataTestSubj:dataTestSubj})=>{const onQuerySubmit=Object(react__WEBPACK_IMPORTED_MODULE_0__["useCallback"])(payload=>{if(payload.query!=null&&!fast_deep_equal__WEBPACK_IMPORTED_MODULE_1___default()(payload.query,filterQuery)){onSubmitQuery(payload.query)}},[filterQuery,onSubmitQuery]);const onQueryChange=Object(react__WEBPACK_IMPORTED_MODULE_0__["useCallback"])(payload=>{if(onChangedQuery&&payload.query!=null&&!fast_deep_equal__WEBPACK_IMPORTED_MODULE_1___default()(payload.query,filterQuery)){onChangedQuery(payload.query)}},[filterQuery,onChangedQuery]);const onSavedQueryUpdated=Object(react__WEBPACK_IMPORTED_MODULE_0__["useCallback"])(savedQueryUpdated=>{const{query:newQuery,filters:newFilters,timefilter:timefilter}=savedQueryUpdated.attributes;onSubmitQuery(newQuery,timefilter);filterManager.setFilters(newFilters||[]);onSavedQuery(savedQueryUpdated)},[filterManager,onSubmitQuery,onSavedQuery]);const onClearSavedQuery=Object(react__WEBPACK_IMPORTED_MODULE_0__["useCallback"])(()=>{if(savedQuery!=null){onSubmitQuery({query:"",language:savedQuery.attributes.query.language});filterManager.setFilters([]);onSavedQuery(undefined)}},[filterManager,onSubmitQuery,onSavedQuery,savedQuery]);const onFiltersUpdated=Object(react__WEBPACK_IMPORTED_MODULE_0__["useCallback"])(newFilters=>{filterManager.setFilters(newFilters)},[filterManager]);const CustomButton=react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,null);const indexPatterns=Object(react__WEBPACK_IMPORTED_MODULE_0__["useMemo"])(()=>[indexPattern],[indexPattern]);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__["SearchBar"],{customSubmitButton:CustomButton,dateRangeFrom:dateRangeFrom,dateRangeTo:dateRangeTo,filters:filters,indexPatterns:indexPatterns,isLoading:isLoading,isRefreshPaused:isRefreshPaused,query:filterQuery,onClearSavedQuery:onClearSavedQuery,onFiltersUpdated:onFiltersUpdated,onQueryChange:onQueryChange,onQuerySubmit:onQuerySubmit,onSaved:onSavedQuery,onSavedQueryUpdated:onSavedQueryUpdated,refreshInterval:refreshInterval,showAutoRefreshOnly:false,showFilterBar:!hideSavedQuery,showDatePicker:false,showQueryBar:true,showQueryInput:true,showSaveQuery:true,timeHistory:new _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__["TimeHistory"](new _src_plugins_kibana_utils_public__WEBPACK_IMPORTED_MODULE_3__["Storage"](localStorage)),dataTestSubj:dataTestSubj,savedQuery:savedQuery})});QueryBar.displayName="QueryBar"},395:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useSavedQueryServices}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(77);var _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__);var _lib_kibana__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(104);const useSavedQueryServices=()=>{const kibana=Object(_lib_kibana__WEBPACK_IMPORTED_MODULE_2__["h"])();const client=kibana.services.savedObjects.client;const[savedQueryService,setSavedQueryService]=Object(react__WEBPACK_IMPORTED_MODULE_0__["useState"])(Object(_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__["createSavedQueryService"])(client));Object(react__WEBPACK_IMPORTED_MODULE_0__["useEffect"])(()=>{setSavedQueryService(Object(_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__["createSavedQueryService"])(client))},[client]);return savedQueryService}},396:function(module,exports,__webpack_require__){"use strict";module.exports=decimal;function decimal(character){var code=typeof character==="string"?character.charCodeAt(0):character;return code>=48&&code<=57}},397:function(module,exports,__webpack_require__){"use strict";module.exports=visit;var visitParents=__webpack_require__(1118);var CONTINUE=visitParents.CONTINUE;var SKIP=visitParents.SKIP;var EXIT=visitParents.EXIT;visit.CONTINUE=CONTINUE;visit.SKIP=SKIP;visit.EXIT=EXIT;function visit(tree,test,visitor,reverse){if(typeof test==="function"&&typeof visitor!=="function"){reverse=visitor;visitor=test;test=null}visitParents(tree,test,overload,reverse);function overload(node,parents){var parent=parents[parents.length-1];var index=parent?parent.children.indexOf(node):null;return visitor(node,index,parent)}}},398:function(module,__webpack_exports__,__webpack_require__){"use strict";var _callout_switcher__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(795);__webpack_require__.d(__webpack_exports__,"CallOutSwitcher",(function(){return _callout_switcher__WEBPACK_IMPORTED_MODULE_0__["a"]}));var _callout_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(740);var _callout_types__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_callout_types__WEBPACK_IMPORTED_MODULE_1__);if(__webpack_require__.o(_callout_types__WEBPACK_IMPORTED_MODULE_1__,"CallOutPersistentSwitcher"))__webpack_require__.d(__webpack_exports__,"CallOutPersistentSwitcher",(function(){return _callout_types__WEBPACK_IMPORTED_MODULE_1__["CallOutPersistentSwitcher"]}));var _callout__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(406);var _callout_persistent_switcher__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(741);__webpack_require__.d(__webpack_exports__,"CallOutPersistentSwitcher",(function(){return _callout_persistent_switcher__WEBPACK_IMPORTED_MODULE_3__["a"]}))},406:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return CallOut}));var external_kbnSharedDeps_React_=__webpack_require__(6);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(72);var utility_types=__webpack_require__(191);var external_kbnSharedDeps_LodashFp_=__webpack_require__(7);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);const DISMISS_BUTTON=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.securitySolution.callouts.dismissButton",{defaultMessage:"Dismiss"});const CallOutDismissButton=({message:message,text:text,onClick:onClick=external_kbnSharedDeps_LodashFp_["noop"]})=>{const{type:type}=message;const buttonColor=type==="success"?"secondary":type;const buttonText=text!==null&&text!==void 0?text:DISMISS_BUTTON;const handleClick=Object(external_kbnSharedDeps_React_["useCallback"])(()=>onClick(message),[onClick,message]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{color:buttonColor,"data-test-subj":"callout-dismiss-btn",onClick:handleClick},buttonText)};const CallOutComponent=({message:message,iconType:iconType,dismissButtonText:dismissButtonText,onDismiss:onDismiss,showDismissButton:showDismissButton=true})=>{const{type:type,id:id,title:title,description:description}=message;const finalIconType=iconType!==null&&iconType!==void 0?iconType:getDefaultIconType(type);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{color:type,title:title,iconType:finalIconType,"data-test-subj":`callout-${id}`,"data-test-messages":`[${id}]`},description,showDismissButton&&external_kbnSharedDeps_React_default.a.createElement(CallOutDismissButton,{message:message,text:dismissButtonText,onClick:onDismiss}))};const getDefaultIconType=type=>{switch(type){case"primary":return"iInCircle";case"success":return"cheer";case"warning":return"help";case"danger":return"alert";default:return Object(utility_types["a"])(type)}};const CallOut=Object(external_kbnSharedDeps_React_["memo"])(CallOutComponent)},495:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return QueryBarTimeline}));__webpack_require__.d(__webpack_exports__,"b",(function(){return getDataProviderFilter}));var lodash_fp__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7);var lodash_fp__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash_fp__WEBPACK_IMPORTED_MODULE_0__);var react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6);var react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);var react_redux__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(105);var react_redux__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(react_redux__WEBPACK_IMPORTED_MODULE_2__);var rxjs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(15);var rxjs__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(rxjs__WEBPACK_IMPORTED_MODULE_3__);var fast_deep_equal__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(107);var fast_deep_equal__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(fast_deep_equal__WEBPACK_IMPORTED_MODULE_4__);var _common_containers_sourcerer__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(124);var _common_store_sourcerer_model__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(117);var _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(77);var _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_7__);var _common_lib_keury__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(158);var _common_utils_saved_query_services__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(395);var _common_components_query_bar__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(394);var _helpers__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(119);var _store_timeline__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(108);const TIMELINE_FILTER_DROP_AREA="timeline-filter-drop-area";const getNonDropAreaFilters=(filters=[])=>filters.filter(f=>f.meta.controlledBy!==TIMELINE_FILTER_DROP_AREA);const QueryBarTimeline=Object(react__WEBPACK_IMPORTED_MODULE_1__["memo"])(({dataProviders:dataProviders,filters:filters,filterManager:filterManager,filterQuery:filterQuery,from:from,fromStr:fromStr,kqlMode:kqlMode,isRefreshPaused:isRefreshPaused,savedQueryId:savedQueryId,setFilters:setFilters,setSavedQueryId:setSavedQueryId,refreshInterval:refreshInterval,timelineId:timelineId,to:to,toStr:toStr,updateReduxTime:updateReduxTime})=>{const dispatch=Object(react_redux__WEBPACK_IMPORTED_MODULE_2__["useDispatch"])();const[dateRangeFrom,setDateRangeFrom]=Object(react__WEBPACK_IMPORTED_MODULE_1__["useState"])(fromStr!=null?fromStr:new Date(from).toISOString());const[dateRangeTo,setDateRangTo]=Object(react__WEBPACK_IMPORTED_MODULE_1__["useState"])(toStr!=null?toStr:new Date(to).toISOString());const{browserFields:browserFields,indexPattern:indexPattern}=Object(_common_containers_sourcerer__WEBPACK_IMPORTED_MODULE_5__["b"])(_common_store_sourcerer_model__WEBPACK_IMPORTED_MODULE_6__["SourcererScopeName"].timeline);const[savedQuery,setSavedQuery]=Object(react__WEBPACK_IMPORTED_MODULE_1__["useState"])(undefined);const[filterQueryConverted,setFilterQueryConverted]=Object(react__WEBPACK_IMPORTED_MODULE_1__["useState"])({query:filterQuery!=null?filterQuery.expression:"",language:filterQuery!=null?filterQuery.kind:"kuery"});const[queryBarFilters,setQueryBarFilters]=Object(react__WEBPACK_IMPORTED_MODULE_1__["useState"])(getNonDropAreaFilters(filters));const[dataProvidersDsl,setDataProvidersDsl]=Object(react__WEBPACK_IMPORTED_MODULE_1__["useState"])(Object(_common_lib_keury__WEBPACK_IMPORTED_MODULE_8__["a"])(Object(_helpers__WEBPACK_IMPORTED_MODULE_11__["i"])(dataProviders,browserFields),indexPattern));const savedQueryServices=Object(_common_utils_saved_query_services__WEBPACK_IMPORTED_MODULE_9__["a"])();const applyKqlFilterQuery=Object(react__WEBPACK_IMPORTED_MODULE_1__["useCallback"])((expression,kind)=>dispatch(_store_timeline__WEBPACK_IMPORTED_MODULE_12__["a"].applyKqlFilterQuery({id:timelineId,filterQuery:{kuery:{kind:kind,expression:expression},serializedQuery:Object(_common_lib_keury__WEBPACK_IMPORTED_MODULE_8__["a"])(expression,indexPattern)}})),[dispatch,indexPattern,timelineId]);Object(react__WEBPACK_IMPORTED_MODULE_1__["useEffect"])(()=>{let isSubscribed=true;const subscriptions=new rxjs__WEBPACK_IMPORTED_MODULE_3__["Subscription"];filterManager.setFilters(filters);subscriptions.add(filterManager.getUpdates$().subscribe({next:()=>{if(isSubscribed){const filterWithoutDropArea=getNonDropAreaFilters(filterManager.getFilters());setFilters(filterWithoutDropArea);setQueryBarFilters(filterWithoutDropArea)}}}));return()=>{isSubscribed=false;subscriptions.unsubscribe()}},[]);Object(react__WEBPACK_IMPORTED_MODULE_1__["useEffect"])(()=>{const filterWithoutDropArea=getNonDropAreaFilters(filterManager.getFilters());if(!fast_deep_equal__WEBPACK_IMPORTED_MODULE_4___default()(filters,filterWithoutDropArea)){filterManager.setFilters(filters)}},[filters]);Object(react__WEBPACK_IMPORTED_MODULE_1__["useEffect"])(()=>{setFilterQueryConverted({query:filterQuery!=null?filterQuery.expression:"",language:filterQuery!=null?filterQuery.kind:"kuery"})},[filterQuery]);Object(react__WEBPACK_IMPORTED_MODULE_1__["useEffect"])(()=>{setDataProvidersDsl(Object(_common_lib_keury__WEBPACK_IMPORTED_MODULE_8__["a"])(Object(_helpers__WEBPACK_IMPORTED_MODULE_11__["i"])(dataProviders,browserFields),indexPattern))},[dataProviders,browserFields,indexPattern]);Object(react__WEBPACK_IMPORTED_MODULE_1__["useEffect"])(()=>{if(fromStr!=null&&toStr!=null){setDateRangeFrom(fromStr);setDateRangTo(toStr)}else if(from!=null&&to!=null){setDateRangeFrom(new Date(from).toISOString());setDateRangTo(new Date(to).toISOString())}},[from,fromStr,to,toStr]);Object(react__WEBPACK_IMPORTED_MODULE_1__["useEffect"])(()=>{let isSubscribed=true;async function setSavedQueryByServices(){if(savedQueryId!=null&&savedQueryServices!=null){try{const mySavedQuery=await savedQueryServices.getSavedQuery(savedQueryId);if(isSubscribed&&mySavedQuery!=null){setSavedQuery({...mySavedQuery,attributes:{...mySavedQuery.attributes,filters:getNonDropAreaFilters(filters)}})}}catch(exc){setSavedQuery(undefined)}}else if(isSubscribed){setSavedQuery(undefined)}}setSavedQueryByServices();return()=>{isSubscribed=false}},[savedQueryId]);const onSubmitQuery=Object(react__WEBPACK_IMPORTED_MODULE_1__["useCallback"])((newQuery,timefilter)=>{if(filterQuery==null||filterQuery!=null&&filterQuery.expression!==newQuery.query||filterQuery.kind!==newQuery.language){applyKqlFilterQuery(newQuery.query,newQuery.language)}if(timefilter!=null){const isQuickSelection=timefilter.from.includes("now")||timefilter.to.includes("now");updateReduxTime({id:"timeline",end:timefilter.to,start:timefilter.from,isInvalid:false,isQuickSelection:isQuickSelection,timelineId:timelineId})}},[filterQuery,timelineId]);const onSavedQuery=Object(react__WEBPACK_IMPORTED_MODULE_1__["useCallback"])(newSavedQuery=>{if(newSavedQuery!=null){if(newSavedQuery.id!==savedQueryId){setSavedQueryId(newSavedQuery.id)}if(savedQueryServices!=null&&dataProvidersDsl!==""){const dataProviderFilterExists=newSavedQuery.attributes.filters!=null?newSavedQuery.attributes.filters.findIndex(f=>f.meta.controlledBy===TIMELINE_FILTER_DROP_AREA):-1;savedQueryServices.saveQuery({...newSavedQuery.attributes,filters:newSavedQuery.attributes.filters!=null?dataProviderFilterExists>-1?[...newSavedQuery.attributes.filters.slice(0,dataProviderFilterExists),getDataProviderFilter(dataProvidersDsl),...newSavedQuery.attributes.filters.slice(dataProviderFilterExists+1)]:[...newSavedQuery.attributes.filters,getDataProviderFilter(dataProvidersDsl)]:[]},{overwrite:true})}}else{setSavedQueryId(null)}},[dataProvidersDsl,savedQueryId,savedQueryServices]);return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_common_components_query_bar__WEBPACK_IMPORTED_MODULE_10__["a"],{dateRangeFrom:dateRangeFrom,dateRangeTo:dateRangeTo,hideSavedQuery:kqlMode==="search",indexPattern:indexPattern,isRefreshPaused:isRefreshPaused,filterQuery:filterQueryConverted,filterManager:filterManager,filters:queryBarFilters,onSubmitQuery:onSubmitQuery,refreshInterval:refreshInterval,savedQuery:savedQuery,onSavedQuery:onSavedQuery,dataTestSubj:"timelineQueryInput"})});const getDataProviderFilter=dataProviderDsl=>{const dslObject=JSON.parse(dataProviderDsl);const key=Object.keys(dslObject);return{...dslObject,meta:{alias:TIMELINE_FILTER_DROP_AREA,controlledBy:TIMELINE_FILTER_DROP_AREA,negate:false,disabled:false,type:"custom",key:Object(lodash_fp__WEBPACK_IMPORTED_MODULE_0__["isEmpty"])(key)?"bool":key[0],value:dataProviderDsl},$state:{store:_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_7__["esFilters"].FilterStateStore.APP_STATE}}}},496:function(module,exports,__webpack_require__){(function(process){function normalizeArray(parts,allowAboveRoot){var up=0;for(var i=parts.length-1;i>=0;i--){var last=parts[i];if(last==="."){parts.splice(i,1)}else if(last===".."){parts.splice(i,1);up++}else if(up){parts.splice(i,1);up--}}if(allowAboveRoot){for(;up--;up){parts.unshift("..")}}return parts}exports.resolve=function(){var resolvedPath="",resolvedAbsolute=false;for(var i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if(typeof path!=="string"){throw new TypeError("Arguments to path.resolve must be strings")}else if(!path){continue}resolvedPath=path+"/"+resolvedPath;resolvedAbsolute=path.charAt(0)==="/"}resolvedPath=normalizeArray(filter(resolvedPath.split("/"),(function(p){return!!p})),!resolvedAbsolute).join("/");return(resolvedAbsolute?"/":"")+resolvedPath||"."};exports.normalize=function(path){var isAbsolute=exports.isAbsolute(path),trailingSlash=substr(path,-1)==="/";path=normalizeArray(filter(path.split("/"),(function(p){return!!p})),!isAbsolute).join("/");if(!path&&!isAbsolute){path="."}if(path&&trailingSlash){path+="/"}return(isAbsolute?"/":"")+path};exports.isAbsolute=function(path){return path.charAt(0)==="/"};exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(paths,(function(p,index){if(typeof p!=="string"){throw new TypeError("Arguments to path.join must be strings")}return p})).join("/"))};exports.relative=function(from,to){from=exports.resolve(from).substr(1);to=exports.resolve(to).substr(1);function trim(arr){var start=0;for(;start<arr.length;start++){if(arr[start]!=="")break}var end=arr.length-1;for(;end>=0;end--){if(arr[end]!=="")break}if(start>end)return[];return arr.slice(start,end-start+1)}var fromParts=trim(from.split("/"));var toParts=trim(to.split("/"));var length=Math.min(fromParts.length,toParts.length);var samePartsLength=length;for(var i=0;i<length;i++){if(fromParts[i]!==toParts[i]){samePartsLength=i;break}}var outputParts=[];for(var i=samePartsLength;i<fromParts.length;i++){outputParts.push("..")}outputParts=outputParts.concat(toParts.slice(samePartsLength));return outputParts.join("/")};exports.sep="/";exports.delimiter=":";exports.dirname=function(path){if(typeof path!=="string")path=path+"";if(path.length===0)return".";var code=path.charCodeAt(0);var hasRoot=code===47;var end=-1;var matchedSlash=true;for(var i=path.length-1;i>=1;--i){code=path.charCodeAt(i);if(code===47){if(!matchedSlash){end=i;break}}else{matchedSlash=false}}if(end===-1)return hasRoot?"/":".";if(hasRoot&&end===1){return"/"}return path.slice(0,end)};function basename(path){if(typeof path!=="string")path=path+"";var start=0;var end=-1;var matchedSlash=true;var i;for(i=path.length-1;i>=0;--i){if(path.charCodeAt(i)===47){if(!matchedSlash){start=i+1;break}}else if(end===-1){matchedSlash=false;end=i+1}}if(end===-1)return"";return path.slice(start,end)}exports.basename=function(path,ext){var f=basename(path);if(ext&&f.substr(-1*ext.length)===ext){f=f.substr(0,f.length-ext.length)}return f};exports.extname=function(path){if(typeof path!=="string")path=path+"";var startDot=-1;var startPart=0;var end=-1;var matchedSlash=true;var preDotState=0;for(var i=path.length-1;i>=0;--i){var code=path.charCodeAt(i);if(code===47){if(!matchedSlash){startPart=i+1;break}continue}if(end===-1){matchedSlash=false;end=i+1}if(code===46){if(startDot===-1)startDot=i;else if(preDotState!==1)preDotState=1}else if(startDot!==-1){preDotState=-1}}if(startDot===-1||end===-1||preDotState===0||preDotState===1&&startDot===end-1&&startDot===startPart+1){return""}return path.slice(startDot,end)};function filter(xs,f){if(xs.filter)return xs.filter(f);var res=[];for(var i=0;i<xs.length;i++){if(f(xs[i],i,xs))res.push(xs[i])}return res}var substr="ab".substr(-1)==="b"?function(str,start,len){return str.substr(start,len)}:function(str,start,len){if(start<0)start=str.length+start;return str.substr(start,len)}}).call(this,__webpack_require__(220))},497:function(module,exports,__webpack_require__){"use strict";var legacy=__webpack_require__(1107);var invalid=__webpack_require__(1108);var decimal=__webpack_require__(396);var hexadecimal=__webpack_require__(1109);var alphanumerical=__webpack_require__(1110);var decodeEntity=__webpack_require__(1111);module.exports=parseEntities;var own={}.hasOwnProperty;var fromCharCode=String.fromCharCode;var noop=Function.prototype;var defaults={warning:null,reference:null,text:null,warningContext:null,referenceContext:null,textContext:null,position:{},additional:null,attribute:false,nonTerminated:true};var NAMED="named";var HEXADECIMAL="hexadecimal";var DECIMAL="decimal";var BASE={};BASE[HEXADECIMAL]=16;BASE[DECIMAL]=10;var TESTS={};TESTS[NAMED]=alphanumerical;TESTS[DECIMAL]=decimal;TESTS[HEXADECIMAL]=hexadecimal;var NAMED_NOT_TERMINATED=1;var NUMERIC_NOT_TERMINATED=2;var NAMED_EMPTY=3;var NUMERIC_EMPTY=4;var NAMED_UNKNOWN=5;var NUMERIC_DISALLOWED=6;var NUMERIC_PROHIBITED=7;var MESSAGES={};MESSAGES[NAMED_NOT_TERMINATED]="Named character references must be terminated by a semicolon";MESSAGES[NUMERIC_NOT_TERMINATED]="Numeric character references must be terminated by a semicolon";MESSAGES[NAMED_EMPTY]="Named character references cannot be empty";MESSAGES[NUMERIC_EMPTY]="Numeric character references cannot be empty";MESSAGES[NAMED_UNKNOWN]="Named character references must be known";MESSAGES[NUMERIC_DISALLOWED]="Numeric character references cannot be disallowed";MESSAGES[NUMERIC_PROHIBITED]="Numeric character references cannot be outside the permissible Unicode range";function parseEntities(value,options){var settings={};var option;var key;if(!options){options={}}for(key in defaults){option=options[key];settings[key]=option===null||option===undefined?defaults[key]:option}if(settings.position.indent||settings.position.start){settings.indent=settings.position.indent||[];settings.position=settings.position.start}return parse(value,settings)}function parse(value,settings){var additional=settings.additional;var nonTerminated=settings.nonTerminated;var handleText=settings.text;var handleReference=settings.reference;var handleWarning=settings.warning;var textContext=settings.textContext;var referenceContext=settings.referenceContext;var warningContext=settings.warningContext;var pos=settings.position;var indent=settings.indent||[];var length=value.length;var index=0;var lines=-1;var column=pos.column||1;var line=pos.line||1;var queue="";var result=[];var entityCharacters;var namedEntity;var terminated;var characters;var character;var reference;var following;var warning;var reason;var output;var entity;var begin;var start;var type;var test;var prev;var next;var diff;var end;prev=now();warning=handleWarning?parseError:noop;index--;length++;while(++index<length){if(character==="\n"){column=indent[lines]||1}character=at(index);if(character!=="&"){if(character==="\n"){line++;lines++;column=0}if(character){queue+=character;column++}else{flush()}}else{following=at(index+1);if(following==="\t"||following==="\n"||following==="\f"||following===" "||following==="<"||following==="&"||following===""||additional&&following===additional){queue+=character;column++;continue}start=index+1;begin=start;end=start;if(following!=="#"){type=NAMED}else{end=++begin;following=at(end);if(following==="x"||following==="X"){type=HEXADECIMAL;end=++begin}else{type=DECIMAL}}entityCharacters="";entity="";characters="";test=TESTS[type];end--;while(++end<length){following=at(end);if(!test(following)){break}characters+=following;if(type===NAMED&&own.call(legacy,characters)){entityCharacters=characters;entity=legacy[characters]}}terminated=at(end)===";";if(terminated){end++;namedEntity=type===NAMED?decodeEntity(characters):false;if(namedEntity){entityCharacters=characters;entity=namedEntity}}diff=1+end-start;if(!terminated&&!nonTerminated){}else if(!characters){if(type!==NAMED){warning(NUMERIC_EMPTY,diff)}}else if(type===NAMED){if(terminated&&!entity){warning(NAMED_UNKNOWN,1)}else{if(entityCharacters!==characters){end=begin+entityCharacters.length;diff=1+end-begin;terminated=false}if(!terminated){reason=entityCharacters?NAMED_NOT_TERMINATED:NAMED_EMPTY;if(!settings.attribute){warning(reason,diff)}else{following=at(end);if(following==="="){warning(reason,diff);entity=null}else if(alphanumerical(following)){entity=null}else{warning(reason,diff)}}}}reference=entity}else{if(!terminated){warning(NUMERIC_NOT_TERMINATED,diff)}reference=parseInt(characters,BASE[type]);if(prohibited(reference)){warning(NUMERIC_PROHIBITED,diff);reference="�"}else if(reference in invalid){warning(NUMERIC_DISALLOWED,diff);reference=invalid[reference]}else{output="";if(disallowed(reference)){warning(NUMERIC_DISALLOWED,diff)}if(reference>65535){reference-=65536;output+=fromCharCode(reference>>>(10&1023)|55296);reference=56320|reference&1023}reference=output+fromCharCode(reference)}}if(!reference){characters=value.slice(start-1,end);queue+=characters;column+=characters.length;index=end-1}else{flush();prev=now();index=end-1;column+=end-start+1;result.push(reference);next=now();next.offset++;if(handleReference){handleReference.call(referenceContext,reference,{start:prev,end:next},value.slice(start-1,end))}prev=next}}}return result.join("");function now(){return{line:line,column:column,offset:index+(pos.offset||0)}}function parseError(code,offset){var position=now();position.column+=offset;position.offset+=offset;handleWarning.call(warningContext,MESSAGES[code],position,code)}function at(position){return value.charAt(position)}function flush(){if(queue){result.push(queue);if(handleText){handleText.call(textContext,queue,{start:prev,end:now()})}queue=""}}}function prohibited(code){return code>=55296&&code<=57343||code>1114111}function disallowed(code){return code>=1&&code<=8||code===11||code>=13&&code<=31||code>=127&&code<=159||code>=64976&&code<=65007||(code&65535)===65535||(code&65535)===65534}},498:function(module,exports,__webpack_require__){"use strict";
/*!
 * repeat-string <https://github.com/jonschlinkert/repeat-string>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var res="";var cache;module.exports=repeat;function repeat(str,num){if(typeof str!=="string"){throw new TypeError("expected a string")}if(num===1)return str;if(num===2)return str+str;var max=str.length*num;if(cache!==str||typeof cache==="undefined"){cache=str;res=""}else if(res.length>=max){return res.substr(0,max)}while(max>res.length&&num>1){if(num&1){res+=str}num>>=1;str+=str}res+=str;res=res.substr(0,max);return res}},499:function(module,exports,__webpack_require__){"use strict";module.exports=trimTrailingLines;var line="\n";function trimTrailingLines(value){var val=String(value);var index=val.length;while(val.charAt(--index)===line){}return val.slice(0,index+1)}},500:function(module,exports,__webpack_require__){"use strict";module.exports=interrupt;function interrupt(interruptors,tokenizers,ctx,params){var bools=["pedantic","commonmark"];var count=bools.length;var length=interruptors.length;var index=-1;var interruptor;var config;var fn;var offset;var bool;var ignore;while(++index<length){interruptor=interruptors[index];config=interruptor[1]||{};fn=interruptor[0];offset=-1;ignore=false;while(++offset<count){bool=bools[offset];if(config[bool]!==undefined&&config[bool]!==ctx.options[bool]){ignore=true;break}}if(ignore){continue}if(tokenizers[fn].apply(ctx,params)){return true}}return false}},501:function(module,exports,__webpack_require__){"use strict";var collapseWhiteSpace=__webpack_require__(1131);module.exports=normalize;function normalize(value){return collapseWhiteSpace(value).toLowerCase()}},507:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return EqlQueryBar}));var external_kbnSharedDeps_React_=__webpack_require__(6);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_StyledComponents_=__webpack_require__(73);var external_kbnSharedDeps_StyledComponents_default=__webpack_require__.n(external_kbnSharedDeps_StyledComponents_);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(72);var use_app_toasts=__webpack_require__(143);var translations=__webpack_require__(186);var external_kbnSharedDeps_Lodash_=__webpack_require__(19);const ErrorsPopover=({ariaLabel:ariaLabel,errors:errors})=>{const[isOpen,setIsOpen]=Object(external_kbnSharedDeps_React_["useState"])(false);const handleToggle=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setIsOpen(!isOpen)},[isOpen]);const handleClose=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setIsOpen(false)},[]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{"data-test-subj":"eql-validation-errors-popover",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{"data-test-subj":"eql-validation-errors-popover-button",iconType:"crossInACircleFilled",size:"s",color:"danger","aria-label":ariaLabel,onClick:handleToggle},errors.length),isOpen:isOpen,closePopover:handleClose,anchorPosition:"downCenter"},external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"eql-validation-errors-popover-content"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverTitle"],null,translations["k"]),errors.map((message,idx)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{key:idx},message))))};var kibana=__webpack_require__(104);const InlineText=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiText"]).withConfig({displayName:"InlineText",componentId:"i91hzt-0"})(["display:inline-block;"]);const EqlOverviewLink=()=>{const overviewUrl=Object(kibana["h"])().services.docLinks.links.query.eql;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{external:true,href:overviewUrl,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(InlineText,{size:"xs"},translations["i"]))};const Container=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiPanel"]).withConfig({displayName:"Container",componentId:"sc-10yczbx-0"})(["border-radius:0;background:",";padding:"," ",";"],({theme:theme})=>theme.eui.euiPageBackgroundColor,({theme:theme})=>theme.eui.euiSizeXS,({theme:theme})=>theme.eui.euiSizeS);const FlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"FlexGroup",componentId:"sc-10yczbx-1"})(["min-height:",";"],({theme:theme})=>theme.eui.euiSizeXL);const FlexItemLeftBorder=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"FlexItemLeftBorder",componentId:"sc-10yczbx-2"})(["border-left:1px solid ",";"],({theme:theme})=>theme.eui.euiColorLightShade);const FlexItemWithMarginRight=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"FlexItemWithMarginRight",componentId:"sc-10yczbx-3"})(["margin-right:",";"],({theme:theme})=>theme.eui.euiSizeS);const Spinner=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"]).withConfig({displayName:"Spinner",componentId:"sc-10yczbx-4"})(["margin:0 ",";"],({theme:theme})=>theme.eui.euiSizeS);const singleSelection={asPlainText:true};const EqlQueryBarFooter=({errors:errors,isLoading:isLoading,optionsData:optionsData,optionsSelected:optionsSelected,onOptionsChange:onOptionsChange})=>{var _optionsSelected$size;const[openEqlSettings,setIsOpenEqlSettings]=Object(external_kbnSharedDeps_React_["useState"])(false);const[localSize,setLocalSize]=Object(external_kbnSharedDeps_React_["useState"])((_optionsSelected$size=optionsSelected===null||optionsSelected===void 0?void 0:optionsSelected.size)!==null&&_optionsSelected$size!==void 0?_optionsSelected$size:100);const debounceSize=Object(external_kbnSharedDeps_React_["useRef"])();const openEqlSettingsHandler=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setIsOpenEqlSettings(true)},[]);const closeEqlSettingsHandler=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{setIsOpenEqlSettings(false)},[]);const handleEventCategoryField=Object(external_kbnSharedDeps_React_["useCallback"])(opt=>{if(onOptionsChange){if(opt.length>0){onOptionsChange("eventCategoryField",opt[0].label)}else{onOptionsChange("eventCategoryField",null)}}},[onOptionsChange]);const handleTiebreakerField=Object(external_kbnSharedDeps_React_["useCallback"])(opt=>{if(onOptionsChange){if(opt.length>0){onOptionsChange("tiebreakerField",opt[0].label)}else{onOptionsChange("tiebreakerField",null)}}},[onOptionsChange]);const handleTimestampField=Object(external_kbnSharedDeps_React_["useCallback"])(opt=>{if(onOptionsChange){if(opt.length>0){onOptionsChange("timestampField",opt[0].label)}else{onOptionsChange("timestampField",null)}}},[onOptionsChange]);const handleSizeField=Object(external_kbnSharedDeps_React_["useCallback"])(evt=>{if(onOptionsChange){var _evt$target,_debounceSize$current,_evt$target2;setLocalSize(evt===null||evt===void 0?void 0:(_evt$target=evt.target)===null||_evt$target===void 0?void 0:_evt$target.value);if((_debounceSize$current=debounceSize.current)!==null&&_debounceSize$current!==void 0&&_debounceSize$current.cancel){var _debounceSize$current2;(_debounceSize$current2=debounceSize.current)===null||_debounceSize$current2===void 0?void 0:_debounceSize$current2.cancel()}debounceSize.current=Object(external_kbnSharedDeps_Lodash_["debounce"])(newSize=>onOptionsChange("size",newSize),800);debounceSize.current(evt===null||evt===void 0?void 0:(_evt$target2=evt.target)===null||_evt$target2===void 0?void 0:_evt$target2.value)}},[onOptionsChange]);const eventCategoryField=Object(external_kbnSharedDeps_React_["useMemo"])(()=>(optionsSelected===null||optionsSelected===void 0?void 0:optionsSelected.eventCategoryField)!=null?[{label:optionsSelected===null||optionsSelected===void 0?void 0:optionsSelected.eventCategoryField}]:undefined,[optionsSelected===null||optionsSelected===void 0?void 0:optionsSelected.eventCategoryField]);const tiebreakerField=Object(external_kbnSharedDeps_React_["useMemo"])(()=>(optionsSelected===null||optionsSelected===void 0?void 0:optionsSelected.tiebreakerField)!=null?[{label:optionsSelected===null||optionsSelected===void 0?void 0:optionsSelected.tiebreakerField}]:undefined,[optionsSelected===null||optionsSelected===void 0?void 0:optionsSelected.tiebreakerField]);const timestampField=Object(external_kbnSharedDeps_React_["useMemo"])(()=>(optionsSelected===null||optionsSelected===void 0?void 0:optionsSelected.timestampField)!=null?[{label:optionsSelected===null||optionsSelected===void 0?void 0:optionsSelected.timestampField}]:undefined,[optionsSelected===null||optionsSelected===void 0?void 0:optionsSelected.timestampField]);return external_kbnSharedDeps_React_default.a.createElement(Container,null,external_kbnSharedDeps_React_default.a.createElement(FlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,errors.length>0&&external_kbnSharedDeps_React_default.a.createElement(ErrorsPopover,{ariaLabel:translations["l"],errors:errors}),isLoading&&external_kbnSharedDeps_React_default.a.createElement(Spinner,{"data-test-subj":"eql-validation-loading",size:"m"})),!onOptionsChange&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(EqlOverviewLink,null)),onOptionsChange&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(FlexItemWithMarginRight,{grow:false},external_kbnSharedDeps_React_default.a.createElement(EqlOverviewLink,null)),external_kbnSharedDeps_React_default.a.createElement(FlexItemLeftBorder,{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{onClick:openEqlSettingsHandler,iconType:"controlsVertical",isDisabled:openEqlSettings,"aria-label":"eql settings","data-test-subj":"eql-settings-trigger"}),isOpen:openEqlSettings,closePopover:closeEqlSettingsHandler,anchorPosition:"downCenter",ownFocus:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverTitle"],null,translations["j"]),external_kbnSharedDeps_React_default.a.createElement("div",{style:{width:"300px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:translations["h"],helpText:translations["g"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{value:localSize,onChange:handleSizeField,min:1,max:1e4})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:translations["b"],helpText:translations["a"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{options:optionsData===null||optionsData===void 0?void 0:optionsData.keywordFields,selectedOptions:eventCategoryField,singleSelection:singleSelection,onChange:handleEventCategoryField})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:translations["d"],helpText:translations["c"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{options:optionsData===null||optionsData===void 0?void 0:optionsData.nonDateFields,selectedOptions:tiebreakerField,singleSelection:singleSelection,onChange:handleTiebreakerField})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:translations["f"],helpText:translations["e"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{options:optionsData===null||optionsData===void 0?void 0:optionsData.dateFields,selectedOptions:timestampField,singleSelection:singleSelection,onChange:handleTimestampField}))))))))};var validators=__webpack_require__(322);const TextArea=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiTextArea"]).withConfig({displayName:"TextArea",componentId:"sc-4u43ce-0"})(["display:block;border:",";border-bottom:0;box-shadow:none;min-height:",";"],({theme:theme})=>theme.eui.euiBorderThin,({theme:theme})=>theme.eui.euiFormControlHeight);const EqlQueryBar=({dataTestSubj:dataTestSubj,field:field,idAria:idAria,optionsData:optionsData,optionsSelected:optionsSelected,onOptionsChange:onOptionsChange,onValidityChange:onValidityChange,onValiditingChange:onValiditingChange})=>{const{addError:addError}=Object(use_app_toasts["a"])();const[errorMessages,setErrorMessages]=Object(external_kbnSharedDeps_React_["useState"])([]);const{isValidating:isValidating,setValue:setValue}=field;const{isValid:isValid,message:message,messages:messages,error:error}=Object(validators["c"])(field);const fieldValue=field.value.query.query;Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(onValidityChange!=null){onValidityChange(isValid)}},[isValid,onValidityChange]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{setErrorMessages(messages!==null&&messages!==void 0?messages:[])},[messages]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(error){addError(error,{title:translations["m"]})}},[error,addError]);Object(external_kbnSharedDeps_React_["useEffect"])(()=>{if(onValiditingChange){onValiditingChange(isValidating)}},[isValidating,onValiditingChange]);const handleChange=Object(external_kbnSharedDeps_React_["useCallback"])(e=>{const newQuery=e.target.value;if(onValiditingChange){onValiditingChange(true)}setErrorMessages([]);setValue({filters:[],query:{query:newQuery,language:"eql"}})},[setValue,onValiditingChange]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:field.label,labelAppend:field.labelAppend,helpText:field.helpText,error:message,isInvalid:!isValid&&!isValidating,fullWidth:true,"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:undefined},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(TextArea,{"data-test-subj":"eqlQueryBarTextInput",fullWidth:true,isInvalid:!isValid&&!isValidating,value:fieldValue,onChange:handleChange}),external_kbnSharedDeps_React_default.a.createElement(EqlQueryBarFooter,{errors:errorMessages,isLoading:isValidating,optionsData:optionsData,optionsSelected:optionsSelected,onOptionsChange:onOptionsChange})))}},734:function(module,exports,__webpack_require__){"use strict";module.exports=alphabetical;function alphabetical(character){var code=typeof character==="string"?character.charCodeAt(0):character;return code>=97&&code<=122||code>=65&&code<=90}},735:function(module,exports,__webpack_require__){"use strict";module.exports={position:true,gfm:true,commonmark:false,footnotes:false,pedantic:false,blocks:__webpack_require__(1115)}},736:function(module,exports,__webpack_require__){"use strict";module.exports=indentation;var characters={" ":1,"\t":4};function indentation(value){var index=0;var indent=0;var character=value.charAt(index);var stops={};var size;while(character in characters){size=characters[character];indent+=size;if(size>1){indent=Math.floor(indent/size)*size}stops[indent]=index;character=value.charAt(++index)}return{indent:indent,stops:stops}}},737:function(module,exports,__webpack_require__){"use strict";var attributeName="[a-zA-Z_:][a-zA-Z0-9:._-]*";var unquoted="[^\"'=<>`\\u0000-\\u0020]+";var singleQuoted="'[^']*'";var doubleQuoted='"[^"]*"';var attributeValue="(?:"+unquoted+"|"+singleQuoted+"|"+doubleQuoted+")";var attribute="(?:\\s+"+attributeName+"(?:\\s*=\\s*"+attributeValue+")?)";var openTag="<[A-Za-z][A-Za-z0-9\\-]*"+attribute+"*\\s*\\/?>";var closeTag="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>";var comment="\x3c!----\x3e|\x3c!--(?:-?[^>-])(?:-?[^-])*--\x3e";var processing="<[?].*?[?]>";var declaration="<![A-Za-z]+\\s+[^>]*>";var cdata="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>";exports.openCloseTag=new RegExp("^(?:"+openTag+"|"+closeTag+")");exports.tag=new RegExp("^(?:"+openTag+"|"+closeTag+"|"+comment+"|"+processing+"|"+declaration+"|"+cdata+")")},738:function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){return value.indexOf("<",fromIndex)}},739:function(module,exports,__webpack_require__){"use strict";module.exports=locate;function locate(value,fromIndex){var link=value.indexOf("[",fromIndex);var image=value.indexOf("![",fromIndex);if(image===-1){return link}return link<image?link:image}},740:function(module,exports){},741:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return CallOutPersistentSwitcher}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var _callout__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(406);const CallOutPersistentSwitcherComponent=({condition:condition,message:message})=>condition?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_callout__WEBPACK_IMPORTED_MODULE_1__["a"],{message:message,showDismissButton:false}):null;const CallOutPersistentSwitcher=Object(react__WEBPACK_IMPORTED_MODULE_0__["memo"])(CallOutPersistentSwitcherComponent)},795:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return CallOutSwitcher}));var external_kbnSharedDeps_React_=__webpack_require__(6);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var callout=__webpack_require__(406);var external_kbnSharedDeps_LodashFp_=__webpack_require__(7);var useEffectOnce=__webpack_require__(1167);var useEffectOnce_default=__webpack_require__.n(useEffectOnce);var useMap=__webpack_require__(1166);var useMap_default=__webpack_require__.n(useMap);var use_messages_storage=__webpack_require__(489);const useCallOutStorage=(messages,namespace="common")=>{const{getMessages:getMessages,addMessage:addMessage}=Object(use_messages_storage["a"])();const visibilityStateInitial=Object(external_kbnSharedDeps_React_["useMemo"])(()=>createInitialVisibilityState(messages),[messages]);const[visibilityState,setVisibilityState]=useMap_default()(visibilityStateInitial);const dismissedMessagesKey=getDismissedMessagesStorageKey(namespace);const getVisibleMessageIds=Object(external_kbnSharedDeps_React_["useCallback"])(()=>Object.entries(visibilityState).filter(([messageId,isVisible])=>isVisible).map(([messageId,isVisible])=>messageId),[visibilityState]);const isVisible=Object(external_kbnSharedDeps_React_["useCallback"])(message=>{var _visibilityState$mess;return(_visibilityState$mess=visibilityState[message.id])!==null&&_visibilityState$mess!==void 0?_visibilityState$mess:false},[visibilityState]);const dismiss=Object(external_kbnSharedDeps_React_["useCallback"])(message=>{const{id:id,type:type}=message;setVisibilityState.set(id,false);if(type==="primary"||type==="success"){addMessage(dismissedMessagesKey,id)}},[setVisibilityState,addMessage,dismissedMessagesKey]);useEffectOnce_default()(()=>{const idsAll=Object.keys(visibilityState);const idsDismissed=getMessages(dismissedMessagesKey);const idsToMakeVisible=Object(external_kbnSharedDeps_LodashFp_["difference"])(idsAll)(idsDismissed);setVisibilityState.setAll({...createVisibilityState(idsToMakeVisible,true),...createVisibilityState(idsDismissed,false)})});return{getVisibleMessageIds:getVisibleMessageIds,isVisible:isVisible,dismiss:dismiss}};const getDismissedMessagesStorageKey=namespace=>`kibana.securitySolution.${namespace}.callouts.dismissed`;const createInitialVisibilityState=messages=>createVisibilityState(messages.map(m=>m.id),false);const createVisibilityState=(messageIds,isVisible)=>mapToObject(messageIds,external_kbnSharedDeps_LodashFp_["identity"],()=>isVisible);const mapToObject=(array,getKey,getValue)=>{const kvPairs=array.map(el=>[getKey(el),getValue(el)]);return Object(external_kbnSharedDeps_LodashFp_["fromPairs"])(kvPairs)};const CallOutSwitcherComponent=({namespace:namespace,condition:condition,message:message})=>{const{isVisible:isVisible,dismiss:dismiss}=useCallOutStorage([message],namespace);const shouldRender=condition&&isVisible(message);return shouldRender?external_kbnSharedDeps_React_default.a.createElement(callout["a"],{message:message,onDismiss:dismiss}):null};const CallOutSwitcher=Object(external_kbnSharedDeps_React_["memo"])(CallOutSwitcherComponent)}}]);