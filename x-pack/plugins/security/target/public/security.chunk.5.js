/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window["security_bundle_jsonpfunction"]=window["security_bundle_jsonpfunction"]||[]).push([[5],{102:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return RoleComboBox}));var external_kbnSharedDeps_React_=__webpack_require__(0);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(5);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(2);var model=__webpack_require__(13);const RoleComboBox=props=>{var _groupedOptions$custo,_groupedOptions$user,_groupedOptions$admin,_groupedOptions$syste,_groupedOptions$depre;const onRolesChange=selectedItems=>{props.onChange(selectedItems.map(item=>item.label))};const roleNameToOption=roleName=>{var _ref,_ref2,_ref3,_ref4,_roleDefinition$metad;const roleDefinition=props.availableRoles.find(role=>role.name===roleName);const isReserved=(_ref=roleDefinition&&Object(model["j"])(roleDefinition))!==null&&_ref!==void 0?_ref:false;const isDeprecated=(_ref2=roleDefinition&&Object(model["g"])(roleDefinition))!==null&&_ref2!==void 0?_ref2:false;const isSystem=(_ref3=roleDefinition&&Object(model["k"])(roleDefinition))!==null&&_ref3!==void 0?_ref3:false;const isAdmin=(_ref4=roleDefinition&&Object(model["f"])(roleDefinition))!==null&&_ref4!==void 0?_ref4:false;return{color:isDeprecated?"warning":isReserved?"primary":undefined,"data-test-subj":`roleOption-${roleName}`,label:roleName,value:{isReserved:isReserved,isDeprecated:isDeprecated,isSystem:isSystem,isAdmin:isAdmin,deprecatedReason:roleDefinition===null||roleDefinition===void 0?void 0:(_roleDefinition$metad=roleDefinition.metadata)===null||_roleDefinition$metad===void 0?void 0:_roleDefinition$metad._deprecated_reason}}};const options=props.availableRoles.map(role=>roleNameToOption(role.name));const selectedOptions=props.selectedRoleNames.map(roleNameToOption);const groupedOptions=options.reduce((acc,option)=>{var _option$value,_option$value2,_option$value3,_option$value4;const type=(_option$value=option.value)!==null&&_option$value!==void 0&&_option$value.isDeprecated?"deprecated":(_option$value2=option.value)!==null&&_option$value2!==void 0&&_option$value2.isSystem?"system":(_option$value3=option.value)!==null&&_option$value3!==void 0&&_option$value3.isAdmin?"admin":(_option$value4=option.value)!==null&&_option$value4!==void 0&&_option$value4.isReserved?"user":"custom";if(!acc[type]){acc[type]=[]}acc[type].push(option);return acc},{});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{"data-test-subj":"rolesDropdown",id:props.id,placeholder:props.placeholder||external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.users.roleComboBox.placeholder",{defaultMessage:"Select roles"}),onChange:onRolesChange,isLoading:props.isLoading,isDisabled:props.isDisabled,options:[{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.users.roleComboBox.customRoles",{defaultMessage:"Custom roles"}),options:(_groupedOptions$custo=groupedOptions.custom)!==null&&_groupedOptions$custo!==void 0?_groupedOptions$custo:[]},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.users.roleComboBox.userRoles",{defaultMessage:"User roles"}),options:(_groupedOptions$user=groupedOptions.user)!==null&&_groupedOptions$user!==void 0?_groupedOptions$user:[]},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.users.roleComboBox.AdminRoles",{defaultMessage:"Admin roles"}),options:(_groupedOptions$admin=groupedOptions.admin)!==null&&_groupedOptions$admin!==void 0?_groupedOptions$admin:[]},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.users.roleComboBox.systemRoles",{defaultMessage:"System roles"}),options:(_groupedOptions$syste=groupedOptions.system)!==null&&_groupedOptions$syste!==void 0?_groupedOptions$syste:[]},{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.users.roleComboBox.deprecatedRoles",{defaultMessage:"Deprecated roles"}),options:(_groupedOptions$depre=groupedOptions.deprecated)!==null&&_groupedOptions$depre!==void 0?_groupedOptions$depre:[]}],selectedOptions:selectedOptions,renderOption:renderOption})};function renderOption(option){var _option$value5,_option$value6;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween",alignItems:"center",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,option.label),(_option$value5=option.value)!==null&&_option$value5!==void 0&&_option$value5.isDeprecated?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{color:option.color},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.users.roleComboBox.deprecatedBadge",defaultMessage:"deprecated"}))):(_option$value6=option.value)!==null&&_option$value6!==void 0&&_option$value6.isReserved?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],{color:option.color},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.users.roleComboBox.reservedBadge",defaultMessage:"built in"}))):undefined)}},232:function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(233);case"v7light":return __webpack_require__(235);case"v8dark":return __webpack_require__(237);case"v8light":return __webpack_require__(239)}},233:function(module,exports,__webpack_require__){var api=__webpack_require__(11);var content=__webpack_require__(234);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},234:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(12);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".secRoleMapping__ruleEditorGroup--even {\n  background-color: #25262E; }\n\n.secRoleMapping__ruleEditorGroup--odd {\n  background-color: #1D1E24; }\n",""]);module.exports=exports},235:function(module,exports,__webpack_require__){var api=__webpack_require__(11);var content=__webpack_require__(236);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},236:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(12);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".secRoleMapping__ruleEditorGroup--even {\n  background-color: #F5F7FA; }\n\n.secRoleMapping__ruleEditorGroup--odd {\n  background-color: #FFF; }\n",""]);module.exports=exports},237:function(module,exports,__webpack_require__){var api=__webpack_require__(11);var content=__webpack_require__(238);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},238:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(12);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".secRoleMapping__ruleEditorGroup--even {\n  background-color: #25262E; }\n\n.secRoleMapping__ruleEditorGroup--odd {\n  background-color: #1D1E24; }\n",""]);module.exports=exports},239:function(module,exports,__webpack_require__){var api=__webpack_require__(11);var content=__webpack_require__(240);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},240:function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(12);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".secRoleMapping__ruleEditorGroup--even {\n  background-color: #F5F7FA; }\n\n.secRoleMapping__ruleEditorGroup--odd {\n  background-color: #FFF; }\n",""]);module.exports=exports},241:function(module,exports,__webpack_require__){ace.define("ace/mode/json_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],(function(acequire,exports,module){"use strict";var oop=acequire("../lib/oop");var TextHighlightRules=acequire("./text_highlight_rules").TextHighlightRules;var JsonHighlightRules=function(){this.$rules={start:[{token:"variable",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]\\s*(?=:)'},{token:"string",regex:'"',next:"string"},{token:"constant.numeric",regex:"0[xX][0-9a-fA-F]+\\b"},{token:"constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"constant.language.boolean",regex:"(?:true|false)\\b"},{token:"text",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"comment",regex:"\\/\\/.*$"},{token:"comment.start",regex:"\\/\\*",next:"comment"},{token:"paren.lparen",regex:"[[({]"},{token:"paren.rparen",regex:"[\\])}]"},{token:"text",regex:"\\s+"}],string:[{token:"constant.language.escape",regex:/\\(?:x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|["\\\/bfnrt])/},{token:"string",regex:'"|$',next:"start"},{defaultToken:"string"}],comment:[{token:"comment.end",regex:"\\*\\/",next:"start"},{defaultToken:"comment"}]}};oop.inherits(JsonHighlightRules,TextHighlightRules);exports.JsonHighlightRules=JsonHighlightRules}));ace.define("ace/mode/matching_brace_outdent",["require","exports","module","ace/range"],(function(acequire,exports,module){"use strict";var Range=acequire("../range").Range;var MatchingBraceOutdent=function(){};(function(){this.checkOutdent=function(line,input){if(!/^\s+$/.test(line))return false;return/^\s*\}/.test(input)};this.autoOutdent=function(doc,row){var line=doc.getLine(row);var match=line.match(/^(\s*\})/);if(!match)return 0;var column=match[1].length;var openBracePos=doc.findMatchingBracket({row:row,column:column});if(!openBracePos||openBracePos.row==row)return 0;var indent=this.$getIndent(doc.getLine(openBracePos.row));doc.replace(new Range(row,0,row,column-1),indent)};this.$getIndent=function(line){return line.match(/^\s*/)[0]}}).call(MatchingBraceOutdent.prototype);exports.MatchingBraceOutdent=MatchingBraceOutdent}));ace.define("ace/mode/folding/cstyle",["require","exports","module","ace/lib/oop","ace/range","ace/mode/folding/fold_mode"],(function(acequire,exports,module){"use strict";var oop=acequire("../../lib/oop");var Range=acequire("../../range").Range;var BaseFoldMode=acequire("./fold_mode").FoldMode;var FoldMode=exports.FoldMode=function(commentRegex){if(commentRegex){this.foldingStartMarker=new RegExp(this.foldingStartMarker.source.replace(/\|[^|]*?$/,"|"+commentRegex.start));this.foldingStopMarker=new RegExp(this.foldingStopMarker.source.replace(/\|[^|]*?$/,"|"+commentRegex.end))}};oop.inherits(FoldMode,BaseFoldMode);(function(){this.foldingStartMarker=/([\{\[\(])[^\}\]\)]*$|^\s*(\/\*)/;this.foldingStopMarker=/^[^\[\{\(]*([\}\]\)])|^[\s\*]*(\*\/)/;this.singleLineBlockCommentRe=/^\s*(\/\*).*\*\/\s*$/;this.tripleStarBlockCommentRe=/^\s*(\/\*\*\*).*\*\/\s*$/;this.startRegionRe=/^\s*(\/\*|\/\/)#?region\b/;this._getFoldWidgetBase=this.getFoldWidget;this.getFoldWidget=function(session,foldStyle,row){var line=session.getLine(row);if(this.singleLineBlockCommentRe.test(line)){if(!this.startRegionRe.test(line)&&!this.tripleStarBlockCommentRe.test(line))return""}var fw=this._getFoldWidgetBase(session,foldStyle,row);if(!fw&&this.startRegionRe.test(line))return"start";return fw};this.getFoldWidgetRange=function(session,foldStyle,row,forceMultiline){var line=session.getLine(row);if(this.startRegionRe.test(line))return this.getCommentRegionBlock(session,line,row);var match=line.match(this.foldingStartMarker);if(match){var i=match.index;if(match[1])return this.openingBracketBlock(session,match[1],row,i);var range=session.getCommentFoldRange(row,i+match[0].length,1);if(range&&!range.isMultiLine()){if(forceMultiline){range=this.getSectionRange(session,row)}else if(foldStyle!="all")range=null}return range}if(foldStyle==="markbegin")return;var match=line.match(this.foldingStopMarker);if(match){var i=match.index+match[0].length;if(match[1])return this.closingBracketBlock(session,match[1],row,i);return session.getCommentFoldRange(row,i,-1)}};this.getSectionRange=function(session,row){var line=session.getLine(row);var startIndent=line.search(/\S/);var startRow=row;var startColumn=line.length;row=row+1;var endRow=row;var maxRow=session.getLength();while(++row<maxRow){line=session.getLine(row);var indent=line.search(/\S/);if(indent===-1)continue;if(startIndent>indent)break;var subRange=this.getFoldWidgetRange(session,"all",row);if(subRange){if(subRange.start.row<=startRow){break}else if(subRange.isMultiLine()){row=subRange.end.row}else if(startIndent==indent){break}}endRow=row}return new Range(startRow,startColumn,endRow,session.getLine(endRow).length)};this.getCommentRegionBlock=function(session,line,row){var startColumn=line.search(/\s*$/);var maxRow=session.getLength();var startRow=row;var re=/^\s*(?:\/\*|\/\/|--)#?(end)?region\b/;var depth=1;while(++row<maxRow){line=session.getLine(row);var m=re.exec(line);if(!m)continue;if(m[1])depth--;else depth++;if(!depth)break}var endRow=row;if(endRow>startRow){return new Range(startRow,startColumn,endRow,line.length)}}}).call(FoldMode.prototype)}));ace.define("ace/mode/json",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/json_highlight_rules","ace/mode/matching_brace_outdent","ace/mode/behaviour/cstyle","ace/mode/folding/cstyle","ace/worker/worker_client"],(function(acequire,exports,module){"use strict";var oop=acequire("../lib/oop");var TextMode=acequire("./text").Mode;var HighlightRules=acequire("./json_highlight_rules").JsonHighlightRules;var MatchingBraceOutdent=acequire("./matching_brace_outdent").MatchingBraceOutdent;var CstyleBehaviour=acequire("./behaviour/cstyle").CstyleBehaviour;var CStyleFoldMode=acequire("./folding/cstyle").FoldMode;var WorkerClient=acequire("../worker/worker_client").WorkerClient;var Mode=function(){this.HighlightRules=HighlightRules;this.$outdent=new MatchingBraceOutdent;this.$behaviour=new CstyleBehaviour;this.foldingRules=new CStyleFoldMode};oop.inherits(Mode,TextMode);(function(){this.getNextLineIndent=function(state,line,tab){var indent=this.$getIndent(line);if(state=="start"){var match=line.match(/^.*[\{\(\[]\s*$/);if(match){indent+=tab}}return indent};this.checkOutdent=function(state,line,input){return this.$outdent.checkOutdent(line,input)};this.autoOutdent=function(state,doc,row){this.$outdent.autoOutdent(doc,row)};this.createWorker=function(session){var worker=new WorkerClient(["ace"],__webpack_require__(242),"JsonWorker");worker.attachToDocument(session.getDocument());worker.on("annotate",(function(e){session.setAnnotations(e.data)}));worker.on("terminate",(function(){session.clearAnnotations()}));return worker};this.$id="ace/mode/json"}).call(Mode.prototype);exports.Mode=Mode}))},242:function(module,exports){module.exports.id="ace/mode/json_worker";module.exports.src='"no use strict";!function(window){function resolveModuleId(id,paths){for(var testPath=id,tail="";testPath;){var alias=paths[testPath];if("string"==typeof alias)return alias+tail;if(alias)return alias.location.replace(/\\/*$/,"/")+(tail||alias.main||alias.name);if(alias===!1)return"";var i=testPath.lastIndexOf("/");if(-1===i)break;tail=testPath.substr(i)+tail,testPath=testPath.slice(0,i)}return id}if(!(void 0!==window.window&&window.document||window.acequire&&window.define)){window.console||(window.console=function(){var msgs=Array.prototype.slice.call(arguments,0);postMessage({type:"log",data:msgs})},window.console.error=window.console.warn=window.console.log=window.console.trace=window.console),window.window=window,window.ace=window,window.onerror=function(message,file,line,col,err){postMessage({type:"error",data:{message:message,data:err.data,file:file,line:line,col:col,stack:err.stack}})},window.normalizeModule=function(parentId,moduleName){if(-1!==moduleName.indexOf("!")){var chunks=moduleName.split("!");return window.normalizeModule(parentId,chunks[0])+"!"+window.normalizeModule(parentId,chunks[1])}if("."==moduleName.charAt(0)){var base=parentId.split("/").slice(0,-1).join("/");for(moduleName=(base?base+"/":"")+moduleName;-1!==moduleName.indexOf(".")&&previous!=moduleName;){var previous=moduleName;moduleName=moduleName.replace(/^\\.\\//,"").replace(/\\/\\.\\//,"/").replace(/[^\\/]+\\/\\.\\.\\//,"")}}return moduleName},window.acequire=function acequire(parentId,id){if(id||(id=parentId,parentId=null),!id.charAt)throw Error("worker.js acequire() accepts only (parentId, id) as arguments");id=window.normalizeModule(parentId,id);var module=window.acequire.modules[id];if(module)return module.initialized||(module.initialized=!0,module.exports=module.factory().exports),module.exports;if(!window.acequire.tlns)return console.log("unable to load "+id);var path=resolveModuleId(id,window.acequire.tlns);return".js"!=path.slice(-3)&&(path+=".js"),window.acequire.id=id,window.acequire.modules[id]={},importScripts(path),window.acequire(parentId,id)},window.acequire.modules={},window.acequire.tlns={},window.define=function(id,deps,factory){if(2==arguments.length?(factory=deps,"string"!=typeof id&&(deps=id,id=window.acequire.id)):1==arguments.length&&(factory=id,deps=[],id=window.acequire.id),"function"!=typeof factory)return window.acequire.modules[id]={exports:factory,initialized:!0},void 0;deps.length||(deps=["require","exports","module"]);var req=function(childId){return window.acequire(id,childId)};window.acequire.modules[id]={exports:{},factory:function(){var module=this,returnExports=factory.apply(this,deps.map(function(dep){switch(dep){case"require":return req;case"exports":return module.exports;case"module":return module;default:return req(dep)}}));return returnExports&&(module.exports=returnExports),module}}},window.define.amd={},acequire.tlns={},window.initBaseUrls=function(topLevelNamespaces){for(var i in topLevelNamespaces)acequire.tlns[i]=topLevelNamespaces[i]},window.initSender=function(){var EventEmitter=window.acequire("ace/lib/event_emitter").EventEmitter,oop=window.acequire("ace/lib/oop"),Sender=function(){};return function(){oop.implement(this,EventEmitter),this.callback=function(data,callbackId){postMessage({type:"call",id:callbackId,data:data})},this.emit=function(name,data){postMessage({type:"event",name:name,data:data})}}.call(Sender.prototype),new Sender};var main=window.main=null,sender=window.sender=null;window.onmessage=function(e){var msg=e.data;if(msg.event&&sender)sender._signal(msg.event,msg.data);else if(msg.command)if(main[msg.command])main[msg.command].apply(main,msg.args);else{if(!window[msg.command])throw Error("Unknown command:"+msg.command);window[msg.command].apply(window,msg.args)}else if(msg.init){window.initBaseUrls(msg.tlns),acequire("ace/lib/es5-shim"),sender=window.sender=window.initSender();var clazz=acequire(msg.module)[msg.classname];main=window.main=new clazz(sender)}}}}(this),ace.define("ace/lib/oop",["require","exports","module"],function(acequire,exports){"use strict";exports.inherits=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})},exports.mixin=function(obj,mixin){for(var key in mixin)obj[key]=mixin[key];return obj},exports.implement=function(proto,mixin){exports.mixin(proto,mixin)}}),ace.define("ace/range",["require","exports","module"],function(acequire,exports){"use strict";var comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},Range=function(startRow,startColumn,endRow,endColumn){this.start={row:startRow,column:startColumn},this.end={row:endRow,column:endColumn}};(function(){this.isEqual=function(range){return this.start.row===range.start.row&&this.end.row===range.end.row&&this.start.column===range.start.column&&this.end.column===range.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(row,column){return 0==this.compare(row,column)},this.compareRange=function(range){var cmp,end=range.end,start=range.start;return cmp=this.compare(end.row,end.column),1==cmp?(cmp=this.compare(start.row,start.column),1==cmp?2:0==cmp?1:0):-1==cmp?-2:(cmp=this.compare(start.row,start.column),-1==cmp?-1:1==cmp?42:0)},this.comparePoint=function(p){return this.compare(p.row,p.column)},this.containsRange=function(range){return 0==this.comparePoint(range.start)&&0==this.comparePoint(range.end)},this.intersects=function(range){var cmp=this.compareRange(range);return-1==cmp||0==cmp||1==cmp},this.isEnd=function(row,column){return this.end.row==row&&this.end.column==column},this.isStart=function(row,column){return this.start.row==row&&this.start.column==column},this.setStart=function(row,column){"object"==typeof row?(this.start.column=row.column,this.start.row=row.row):(this.start.row=row,this.start.column=column)},this.setEnd=function(row,column){"object"==typeof row?(this.end.column=row.column,this.end.row=row.row):(this.end.row=row,this.end.column=column)},this.inside=function(row,column){return 0==this.compare(row,column)?this.isEnd(row,column)||this.isStart(row,column)?!1:!0:!1},this.insideStart=function(row,column){return 0==this.compare(row,column)?this.isEnd(row,column)?!1:!0:!1},this.insideEnd=function(row,column){return 0==this.compare(row,column)?this.isStart(row,column)?!1:!0:!1},this.compare=function(row,column){return this.isMultiLine()||row!==this.start.row?this.start.row>row?-1:row>this.end.row?1:this.start.row===row?column>=this.start.column?0:-1:this.end.row===row?this.end.column>=column?0:1:0:this.start.column>column?-1:column>this.end.column?1:0},this.compareStart=function(row,column){return this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.compareEnd=function(row,column){return this.end.row==row&&this.end.column==column?1:this.compare(row,column)},this.compareInside=function(row,column){return this.end.row==row&&this.end.column==column?1:this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.clipRows=function(firstRow,lastRow){if(this.end.row>lastRow)var end={row:lastRow+1,column:0};else if(firstRow>this.end.row)var end={row:firstRow,column:0};if(this.start.row>lastRow)var start={row:lastRow+1,column:0};else if(firstRow>this.start.row)var start={row:firstRow,column:0};return Range.fromPoints(start||this.start,end||this.end)},this.extend=function(row,column){var cmp=this.compare(row,column);if(0==cmp)return this;if(-1==cmp)var start={row:row,column:column};else var end={row:row,column:column};return Range.fromPoints(start||this.start,end||this.end)},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return Range.fromPoints(this.start,this.end)},this.collapseRows=function(){return 0==this.end.column?new Range(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new Range(this.start.row,0,this.end.row,0)},this.toScreenRange=function(session){var screenPosStart=session.documentToScreenPosition(this.start),screenPosEnd=session.documentToScreenPosition(this.end);return new Range(screenPosStart.row,screenPosStart.column,screenPosEnd.row,screenPosEnd.column)},this.moveBy=function(row,column){this.start.row+=row,this.start.column+=column,this.end.row+=row,this.end.column+=column}}).call(Range.prototype),Range.fromPoints=function(start,end){return new Range(start.row,start.column,end.row,end.column)},Range.comparePoints=comparePoints,Range.comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},exports.Range=Range}),ace.define("ace/apply_delta",["require","exports","module"],function(acequire,exports){"use strict";exports.applyDelta=function(docLines,delta){var row=delta.start.row,startColumn=delta.start.column,line=docLines[row]||"";switch(delta.action){case"insert":var lines=delta.lines;if(1===lines.length)docLines[row]=line.substring(0,startColumn)+delta.lines[0]+line.substring(startColumn);else{var args=[row,1].concat(delta.lines);docLines.splice.apply(docLines,args),docLines[row]=line.substring(0,startColumn)+docLines[row],docLines[row+delta.lines.length-1]+=line.substring(startColumn)}break;case"remove":var endColumn=delta.end.column,endRow=delta.end.row;row===endRow?docLines[row]=line.substring(0,startColumn)+line.substring(endColumn):docLines.splice(row,endRow-row+1,line.substring(0,startColumn)+docLines[endRow].substring(endColumn))}}}),ace.define("ace/lib/event_emitter",["require","exports","module"],function(acequire,exports){"use strict";var EventEmitter={},stopPropagation=function(){this.propagationStopped=!0},preventDefault=function(){this.defaultPrevented=!0};EventEmitter._emit=EventEmitter._dispatchEvent=function(eventName,e){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var listeners=this._eventRegistry[eventName]||[],defaultHandler=this._defaultHandlers[eventName];if(listeners.length||defaultHandler){"object"==typeof e&&e||(e={}),e.type||(e.type=eventName),e.stopPropagation||(e.stopPropagation=stopPropagation),e.preventDefault||(e.preventDefault=preventDefault),listeners=listeners.slice();for(var i=0;listeners.length>i&&(listeners[i](e,this),!e.propagationStopped);i++);return defaultHandler&&!e.defaultPrevented?defaultHandler(e,this):void 0}},EventEmitter._signal=function(eventName,e){var listeners=(this._eventRegistry||{})[eventName];if(listeners){listeners=listeners.slice();for(var i=0;listeners.length>i;i++)listeners[i](e,this)}},EventEmitter.once=function(eventName,callback){var _self=this;callback&&this.addEventListener(eventName,function newCallback(){_self.removeEventListener(eventName,newCallback),callback.apply(null,arguments)})},EventEmitter.setDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers||(handlers=this._defaultHandlers={_disabled_:{}}),handlers[eventName]){var old=handlers[eventName],disabled=handlers._disabled_[eventName];disabled||(handlers._disabled_[eventName]=disabled=[]),disabled.push(old);var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}handlers[eventName]=callback},EventEmitter.removeDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers){var disabled=handlers._disabled_[eventName];if(handlers[eventName]==callback)handlers[eventName],disabled&&this.setDefaultHandler(eventName,disabled.pop());else if(disabled){var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}}},EventEmitter.on=EventEmitter.addEventListener=function(eventName,callback,capturing){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];return listeners||(listeners=this._eventRegistry[eventName]=[]),-1==listeners.indexOf(callback)&&listeners[capturing?"unshift":"push"](callback),callback},EventEmitter.off=EventEmitter.removeListener=EventEmitter.removeEventListener=function(eventName,callback){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];if(listeners){var index=listeners.indexOf(callback);-1!==index&&listeners.splice(index,1)}},EventEmitter.removeAllListeners=function(eventName){this._eventRegistry&&(this._eventRegistry[eventName]=[])},exports.EventEmitter=EventEmitter}),ace.define("ace/anchor",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(acequire,exports){"use strict";var oop=acequire("./lib/oop"),EventEmitter=acequire("./lib/event_emitter").EventEmitter,Anchor=exports.Anchor=function(doc,row,column){this.$onChange=this.onChange.bind(this),this.attach(doc),column===void 0?this.setPosition(row.row,row.column):this.setPosition(row,column)};(function(){function $pointsInOrder(point1,point2,equalPointsInOrder){var bColIsAfter=equalPointsInOrder?point1.column<=point2.column:point1.column<point2.column;return point1.row<point2.row||point1.row==point2.row&&bColIsAfter}function $getTransformedPoint(delta,point,moveIfEqual){var deltaIsInsert="insert"==delta.action,deltaRowShift=(deltaIsInsert?1:-1)*(delta.end.row-delta.start.row),deltaColShift=(deltaIsInsert?1:-1)*(delta.end.column-delta.start.column),deltaStart=delta.start,deltaEnd=deltaIsInsert?deltaStart:delta.end;return $pointsInOrder(point,deltaStart,moveIfEqual)?{row:point.row,column:point.column}:$pointsInOrder(deltaEnd,point,!moveIfEqual)?{row:point.row+deltaRowShift,column:point.column+(point.row==deltaEnd.row?deltaColShift:0)}:{row:deltaStart.row,column:deltaStart.column}}oop.implement(this,EventEmitter),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.$insertRight=!1,this.onChange=function(delta){if(!(delta.start.row==delta.end.row&&delta.start.row!=this.row||delta.start.row>this.row)){var point=$getTransformedPoint(delta,{row:this.row,column:this.column},this.$insertRight);this.setPosition(point.row,point.column,!0)}},this.setPosition=function(row,column,noClip){var pos;if(pos=noClip?{row:row,column:column}:this.$clipPositionToDocument(row,column),this.row!=pos.row||this.column!=pos.column){var old={row:this.row,column:this.column};this.row=pos.row,this.column=pos.column,this._signal("change",{old:old,value:pos})}},this.detach=function(){this.document.removeEventListener("change",this.$onChange)},this.attach=function(doc){this.document=doc||this.document,this.document.on("change",this.$onChange)},this.$clipPositionToDocument=function(row,column){var pos={};return row>=this.document.getLength()?(pos.row=Math.max(0,this.document.getLength()-1),pos.column=this.document.getLine(pos.row).length):0>row?(pos.row=0,pos.column=0):(pos.row=row,pos.column=Math.min(this.document.getLine(pos.row).length,Math.max(0,column))),0>column&&(pos.column=0),pos}}).call(Anchor.prototype)}),ace.define("ace/document",["require","exports","module","ace/lib/oop","ace/apply_delta","ace/lib/event_emitter","ace/range","ace/anchor"],function(acequire,exports){"use strict";var oop=acequire("./lib/oop"),applyDelta=acequire("./apply_delta").applyDelta,EventEmitter=acequire("./lib/event_emitter").EventEmitter,Range=acequire("./range").Range,Anchor=acequire("./anchor").Anchor,Document=function(textOrLines){this.$lines=[""],0===textOrLines.length?this.$lines=[""]:Array.isArray(textOrLines)?this.insertMergedLines({row:0,column:0},textOrLines):this.insert({row:0,column:0},textOrLines)};(function(){oop.implement(this,EventEmitter),this.setValue=function(text){var len=this.getLength()-1;this.remove(new Range(0,0,len,this.getLine(len).length)),this.insert({row:0,column:0},text)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},this.createAnchor=function(row,column){return new Anchor(this,row,column)},this.$split=0==="aaa".split(/a/).length?function(text){return text.replace(/\\r\\n|\\r/g,"\\n").split("\\n")}:function(text){return text.split(/\\r\\n|\\r|\\n/)},this.$detectNewLine=function(text){var match=text.match(/^.*?(\\r\\n|\\r|\\n)/m);this.$autoNewLine=match?match[1]:"\\n",this._signal("changeNewLineMode")},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\\r\\n";case"unix":return"\\n";default:return this.$autoNewLine||"\\n"}},this.$autoNewLine="",this.$newLineMode="auto",this.setNewLineMode=function(newLineMode){this.$newLineMode!==newLineMode&&(this.$newLineMode=newLineMode,this._signal("changeNewLineMode"))},this.getNewLineMode=function(){return this.$newLineMode},this.isNewLine=function(text){return"\\r\\n"==text||"\\r"==text||"\\n"==text},this.getLine=function(row){return this.$lines[row]||""},this.getLines=function(firstRow,lastRow){return this.$lines.slice(firstRow,lastRow+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getTextRange=function(range){return this.getLinesForRange(range).join(this.getNewLineCharacter())},this.getLinesForRange=function(range){var lines;if(range.start.row===range.end.row)lines=[this.getLine(range.start.row).substring(range.start.column,range.end.column)];else{lines=this.getLines(range.start.row,range.end.row),lines[0]=(lines[0]||"").substring(range.start.column);var l=lines.length-1;range.end.row-range.start.row==l&&(lines[l]=lines[l].substring(0,range.end.column))}return lines},this.insertLines=function(row,lines){return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."),this.insertFullLines(row,lines)},this.removeLines=function(firstRow,lastRow){return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."),this.removeFullLines(firstRow,lastRow)},this.insertNewLine=function(position){return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, [\'\', \'\']) instead."),this.insertMergedLines(position,["",""])},this.insert=function(position,text){return 1>=this.getLength()&&this.$detectNewLine(text),this.insertMergedLines(position,this.$split(text))},this.insertInLine=function(position,text){var start=this.clippedPos(position.row,position.column),end=this.pos(position.row,position.column+text.length);return this.applyDelta({start:start,end:end,action:"insert",lines:[text]},!0),this.clonePos(end)},this.clippedPos=function(row,column){var length=this.getLength();void 0===row?row=length:0>row?row=0:row>=length&&(row=length-1,column=void 0);var line=this.getLine(row);return void 0==column&&(column=line.length),column=Math.min(Math.max(column,0),line.length),{row:row,column:column}},this.clonePos=function(pos){return{row:pos.row,column:pos.column}},this.pos=function(row,column){return{row:row,column:column}},this.$clipPosition=function(position){var length=this.getLength();return position.row>=length?(position.row=Math.max(0,length-1),position.column=this.getLine(length-1).length):(position.row=Math.max(0,position.row),position.column=Math.min(Math.max(position.column,0),this.getLine(position.row).length)),position},this.insertFullLines=function(row,lines){row=Math.min(Math.max(row,0),this.getLength());var column=0;this.getLength()>row?(lines=lines.concat([""]),column=0):(lines=[""].concat(lines),row--,column=this.$lines[row].length),this.insertMergedLines({row:row,column:column},lines)},this.insertMergedLines=function(position,lines){var start=this.clippedPos(position.row,position.column),end={row:start.row+lines.length-1,column:(1==lines.length?start.column:0)+lines[lines.length-1].length};return this.applyDelta({start:start,end:end,action:"insert",lines:lines}),this.clonePos(end)},this.remove=function(range){var start=this.clippedPos(range.start.row,range.start.column),end=this.clippedPos(range.end.row,range.end.column);return this.applyDelta({start:start,end:end,action:"remove",lines:this.getLinesForRange({start:start,end:end})}),this.clonePos(start)},this.removeInLine=function(row,startColumn,endColumn){var start=this.clippedPos(row,startColumn),end=this.clippedPos(row,endColumn);return this.applyDelta({start:start,end:end,action:"remove",lines:this.getLinesForRange({start:start,end:end})},!0),this.clonePos(start)},this.removeFullLines=function(firstRow,lastRow){firstRow=Math.min(Math.max(0,firstRow),this.getLength()-1),lastRow=Math.min(Math.max(0,lastRow),this.getLength()-1);var deleteFirstNewLine=lastRow==this.getLength()-1&&firstRow>0,deleteLastNewLine=this.getLength()-1>lastRow,startRow=deleteFirstNewLine?firstRow-1:firstRow,startCol=deleteFirstNewLine?this.getLine(startRow).length:0,endRow=deleteLastNewLine?lastRow+1:lastRow,endCol=deleteLastNewLine?0:this.getLine(endRow).length,range=new Range(startRow,startCol,endRow,endCol),deletedLines=this.$lines.slice(firstRow,lastRow+1);return this.applyDelta({start:range.start,end:range.end,action:"remove",lines:this.getLinesForRange(range)}),deletedLines},this.removeNewLine=function(row){this.getLength()-1>row&&row>=0&&this.applyDelta({start:this.pos(row,this.getLine(row).length),end:this.pos(row+1,0),action:"remove",lines:["",""]})},this.replace=function(range,text){if(range instanceof Range||(range=Range.fromPoints(range.start,range.end)),0===text.length&&range.isEmpty())return range.start;if(text==this.getTextRange(range))return range.end;this.remove(range);var end;return end=text?this.insert(range.start,text):range.start},this.applyDeltas=function(deltas){for(var i=0;deltas.length>i;i++)this.applyDelta(deltas[i])},this.revertDeltas=function(deltas){for(var i=deltas.length-1;i>=0;i--)this.revertDelta(deltas[i])},this.applyDelta=function(delta,doNotValidate){var isInsert="insert"==delta.action;(isInsert?1>=delta.lines.length&&!delta.lines[0]:!Range.comparePoints(delta.start,delta.end))||(isInsert&&delta.lines.length>2e4&&this.$splitAndapplyLargeDelta(delta,2e4),applyDelta(this.$lines,delta,doNotValidate),this._signal("change",delta))},this.$splitAndapplyLargeDelta=function(delta,MAX){for(var lines=delta.lines,l=lines.length,row=delta.start.row,column=delta.start.column,from=0,to=0;;){from=to,to+=MAX-1;var chunk=lines.slice(from,to);if(to>l){delta.lines=chunk,delta.start.row=row+from,delta.start.column=column;break}chunk.push(""),this.applyDelta({start:this.pos(row+from,column),end:this.pos(row+to,column=0),action:delta.action,lines:chunk},!0)}},this.revertDelta=function(delta){this.applyDelta({start:this.clonePos(delta.start),end:this.clonePos(delta.end),action:"insert"==delta.action?"remove":"insert",lines:delta.lines.slice()})},this.indexToPosition=function(index,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,i=startRow||0,l=lines.length;l>i;i++)if(index-=lines[i].length+newlineLength,0>index)return{row:i,column:index+lines[i].length+newlineLength};return{row:l-1,column:lines[l-1].length}},this.positionToIndex=function(pos,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,index=0,row=Math.min(pos.row,lines.length),i=startRow||0;row>i;++i)index+=lines[i].length+newlineLength;return index+pos.column}}).call(Document.prototype),exports.Document=Document}),ace.define("ace/lib/lang",["require","exports","module"],function(acequire,exports){"use strict";exports.last=function(a){return a[a.length-1]},exports.stringReverse=function(string){return string.split("").reverse().join("")},exports.stringRepeat=function(string,count){for(var result="";count>0;)1&count&&(result+=string),(count>>=1)&&(string+=string);return result};var trimBeginRegexp=/^\\s\\s*/,trimEndRegexp=/\\s\\s*$/;exports.stringTrimLeft=function(string){return string.replace(trimBeginRegexp,"")},exports.stringTrimRight=function(string){return string.replace(trimEndRegexp,"")},exports.copyObject=function(obj){var copy={};for(var key in obj)copy[key]=obj[key];return copy},exports.copyArray=function(array){for(var copy=[],i=0,l=array.length;l>i;i++)copy[i]=array[i]&&"object"==typeof array[i]?this.copyObject(array[i]):array[i];return copy},exports.deepCopy=function deepCopy(obj){if("object"!=typeof obj||!obj)return obj;var copy;if(Array.isArray(obj)){copy=[];for(var key=0;obj.length>key;key++)copy[key]=deepCopy(obj[key]);return copy}if("[object Object]"!==Object.prototype.toString.call(obj))return obj;copy={};for(var key in obj)copy[key]=deepCopy(obj[key]);return copy},exports.arrayToMap=function(arr){for(var map={},i=0;arr.length>i;i++)map[arr[i]]=1;return map},exports.createMap=function(props){var map=Object.create(null);for(var i in props)map[i]=props[i];return map},exports.arrayRemove=function(array,value){for(var i=0;array.length>=i;i++)value===array[i]&&array.splice(i,1)},exports.escapeRegExp=function(str){return str.replace(/([.*+?^${}()|[\\]\\/\\\\])/g,"\\\\$1")},exports.escapeHTML=function(str){return str.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/\'/g,"&#39;").replace(/</g,"&#60;")},exports.getMatchOffsets=function(string,regExp){var matches=[];return string.replace(regExp,function(str){matches.push({offset:arguments[arguments.length-2],length:str.length})}),matches},exports.deferredCall=function(fcn){var timer=null,callback=function(){timer=null,fcn()},deferred=function(timeout){return deferred.cancel(),timer=setTimeout(callback,timeout||0),deferred};return deferred.schedule=deferred,deferred.call=function(){return this.cancel(),fcn(),deferred},deferred.cancel=function(){return clearTimeout(timer),timer=null,deferred},deferred.isPending=function(){return timer},deferred},exports.delayedCall=function(fcn,defaultTimeout){var timer=null,callback=function(){timer=null,fcn()},_self=function(timeout){null==timer&&(timer=setTimeout(callback,timeout||defaultTimeout))};return _self.delay=function(timeout){timer&&clearTimeout(timer),timer=setTimeout(callback,timeout||defaultTimeout)},_self.schedule=_self,_self.call=function(){this.cancel(),fcn()},_self.cancel=function(){timer&&clearTimeout(timer),timer=null},_self.isPending=function(){return timer},_self}}),ace.define("ace/worker/mirror",["require","exports","module","ace/range","ace/document","ace/lib/lang"],function(acequire,exports){"use strict";acequire("../range").Range;var Document=acequire("../document").Document,lang=acequire("../lib/lang"),Mirror=exports.Mirror=function(sender){this.sender=sender;var doc=this.doc=new Document(""),deferredUpdate=this.deferredUpdate=lang.delayedCall(this.onUpdate.bind(this)),_self=this;sender.on("change",function(e){var data=e.data;if(data[0].start)doc.applyDeltas(data);else for(var i=0;data.length>i;i+=2){if(Array.isArray(data[i+1]))var d={action:"insert",start:data[i],lines:data[i+1]};else var d={action:"remove",start:data[i],end:data[i+1]};doc.applyDelta(d,!0)}return _self.$timeout?deferredUpdate.schedule(_self.$timeout):(_self.onUpdate(),void 0)})};(function(){this.$timeout=500,this.setTimeout=function(timeout){this.$timeout=timeout},this.setValue=function(value){this.doc.setValue(value),this.deferredUpdate.schedule(this.$timeout)},this.getValue=function(callbackId){this.sender.callback(this.doc.getValue(),callbackId)},this.onUpdate=function(){},this.isPending=function(){return this.deferredUpdate.isPending()}}).call(Mirror.prototype)}),ace.define("ace/mode/json/json_parse",["require","exports","module"],function(){"use strict";var at,ch,text,value,escapee={\'"\':\'"\',"\\\\":"\\\\","/":"/",b:"\\b",f:"\\f",n:"\\n",r:"\\r",t:"\t"},error=function(m){throw{name:"SyntaxError",message:m,at:at,text:text}},next=function(c){return c&&c!==ch&&error("Expected \'"+c+"\' instead of \'"+ch+"\'"),ch=text.charAt(at),at+=1,ch},number=function(){var number,string="";for("-"===ch&&(string="-",next("-"));ch>="0"&&"9">=ch;)string+=ch,next();if("."===ch)for(string+=".";next()&&ch>="0"&&"9">=ch;)string+=ch;if("e"===ch||"E"===ch)for(string+=ch,next(),("-"===ch||"+"===ch)&&(string+=ch,next());ch>="0"&&"9">=ch;)string+=ch,next();return number=+string,isNaN(number)?(error("Bad number"),void 0):number},string=function(){var hex,i,uffff,string="";if(\'"\'===ch)for(;next();){if(\'"\'===ch)return next(),string;if("\\\\"===ch)if(next(),"u"===ch){for(uffff=0,i=0;4>i&&(hex=parseInt(next(),16),isFinite(hex));i+=1)uffff=16*uffff+hex;string+=String.fromCharCode(uffff)}else{if("string"!=typeof escapee[ch])break;string+=escapee[ch]}else string+=ch}error("Bad string")},white=function(){for(;ch&&" ">=ch;)next()},word=function(){switch(ch){case"t":return next("t"),next("r"),next("u"),next("e"),!0;case"f":return next("f"),next("a"),next("l"),next("s"),next("e"),!1;case"n":return next("n"),next("u"),next("l"),next("l"),null}error("Unexpected \'"+ch+"\'")},array=function(){var array=[];if("["===ch){if(next("["),white(),"]"===ch)return next("]"),array;for(;ch;){if(array.push(value()),white(),"]"===ch)return next("]"),array;next(","),white()}}error("Bad array")},object=function(){var key,object={};if("{"===ch){if(next("{"),white(),"}"===ch)return next("}"),object;for(;ch;){if(key=string(),white(),next(":"),Object.hasOwnProperty.call(object,key)&&error(\'Duplicate key "\'+key+\'"\'),object[key]=value(),white(),"}"===ch)return next("}"),object;next(","),white()}}error("Bad object")};return value=function(){switch(white(),ch){case"{":return object();case"[":return array();case\'"\':return string();case"-":return number();default:return ch>="0"&&"9">=ch?number():word()}},function(source,reviver){var result;return text=source,at=0,ch=" ",result=value(),white(),ch&&error("Syntax error"),"function"==typeof reviver?function walk(holder,key){var k,v,value=holder[key];if(value&&"object"==typeof value)for(k in value)Object.hasOwnProperty.call(value,k)&&(v=walk(value,k),void 0!==v?value[k]=v:delete value[k]);return reviver.call(holder,key,value)}({"":result},""):result}}),ace.define("ace/mode/json_worker",["require","exports","module","ace/lib/oop","ace/worker/mirror","ace/mode/json/json_parse"],function(acequire,exports){"use strict";var oop=acequire("../lib/oop"),Mirror=acequire("../worker/mirror").Mirror,parse=acequire("./json/json_parse"),JsonWorker=exports.JsonWorker=function(sender){Mirror.call(this,sender),this.setTimeout(200)};oop.inherits(JsonWorker,Mirror),function(){this.onUpdate=function(){var value=this.doc.getValue(),errors=[];try{value&&parse(value)}catch(e){var pos=this.doc.indexToPosition(e.at-1);errors.push({row:pos.row,column:pos.column,text:e.message,type:"error"})}this.sender.emit("annotate",errors)}}.call(JsonWorker.prototype)}),ace.define("ace/lib/es5-shim",["require","exports","module"],function(){function Empty(){}function doesDefinePropertyWork(object){try{return Object.defineProperty(object,"sentinel",{}),"sentinel"in object}catch(exception){}}function toInteger(n){return n=+n,n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n))),n}Function.prototype.bind||(Function.prototype.bind=function(that){var target=this;if("function"!=typeof target)throw new TypeError("Function.prototype.bind called on incompatible "+target);var args=slice.call(arguments,1),bound=function(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));return Object(result)===result?result:this}return target.apply(that,args.concat(slice.call(arguments)))};return target.prototype&&(Empty.prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null),bound});var defineGetter,defineSetter,lookupGetter,lookupSetter,supportsAccessors,call=Function.prototype.call,prototypeOfArray=Array.prototype,prototypeOfObject=Object.prototype,slice=prototypeOfArray.slice,_toString=call.bind(prototypeOfObject.toString),owns=call.bind(prototypeOfObject.hasOwnProperty);if((supportsAccessors=owns(prototypeOfObject,"__defineGetter__"))&&(defineGetter=call.bind(prototypeOfObject.__defineGetter__),defineSetter=call.bind(prototypeOfObject.__defineSetter__),lookupGetter=call.bind(prototypeOfObject.__lookupGetter__),lookupSetter=call.bind(prototypeOfObject.__lookupSetter__)),2!=[1,2].splice(0).length)if(function(){function makeArray(l){var a=Array(l+2);return a[0]=a[1]=0,a}var lengthBefore,array=[];return array.splice.apply(array,makeArray(20)),array.splice.apply(array,makeArray(26)),lengthBefore=array.length,array.splice(5,0,"XXX"),lengthBefore+1==array.length,lengthBefore+1==array.length?!0:void 0\n}()){var array_splice=Array.prototype.splice;Array.prototype.splice=function(start,deleteCount){return arguments.length?array_splice.apply(this,[void 0===start?0:start,void 0===deleteCount?this.length-start:deleteCount].concat(slice.call(arguments,2))):[]}}else Array.prototype.splice=function(pos,removeCount){var length=this.length;pos>0?pos>length&&(pos=length):void 0==pos?pos=0:0>pos&&(pos=Math.max(length+pos,0)),length>pos+removeCount||(removeCount=length-pos);var removed=this.slice(pos,pos+removeCount),insert=slice.call(arguments,2),add=insert.length;if(pos===length)add&&this.push.apply(this,insert);else{var remove=Math.min(removeCount,length-pos),tailOldPos=pos+remove,tailNewPos=tailOldPos+add-remove,tailCount=length-tailOldPos,lengthAfterRemove=length-remove;if(tailOldPos>tailNewPos)for(var i=0;tailCount>i;++i)this[tailNewPos+i]=this[tailOldPos+i];else if(tailNewPos>tailOldPos)for(i=tailCount;i--;)this[tailNewPos+i]=this[tailOldPos+i];if(add&&pos===lengthAfterRemove)this.length=lengthAfterRemove,this.push.apply(this,insert);else for(this.length=lengthAfterRemove+add,i=0;add>i;++i)this[pos+i]=insert[i]}return removed};Array.isArray||(Array.isArray=function(obj){return"[object Array]"==_toString(obj)});var boxedString=Object("a"),splitString="a"!=boxedString[0]||!(0 in boxedString);if(Array.prototype.forEach||(Array.prototype.forEach=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,thisp=arguments[1],i=-1,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError;for(;length>++i;)i in self&&fun.call(thisp,self[i],i,object)}),Array.prototype.map||(Array.prototype.map=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=Array(length),thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(result[i]=fun.call(thisp,self[i],i,object));return result}),Array.prototype.filter||(Array.prototype.filter=function(fun){var value,object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=[],thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(value=self[i],fun.call(thisp,value,i,object)&&result.push(value));return result}),Array.prototype.every||(Array.prototype.every=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&!fun.call(thisp,self[i],i,object))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&fun.call(thisp,self[i],i,object))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var result,i=0;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i++];break}if(++i>=length)throw new TypeError("reduce of empty array with no initial value")}for(;length>i;i++)i in self&&(result=fun.call(void 0,result,self[i],i,object));return result}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var result,i=length-1;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i--];break}if(0>--i)throw new TypeError("reduceRight of empty array with no initial value")}do i in this&&(result=fun.call(void 0,result,self[i],i,object));while(i--);return result}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=0;for(arguments.length>1&&(i=toInteger(arguments[1])),i=i>=0?i:Math.max(0,length+i);length>i;i++)if(i in self&&self[i]===sought)return i;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=length-1;for(arguments.length>1&&(i=Math.min(i,toInteger(arguments[1]))),i=i>=0?i:length-Math.abs(i);i>=0;i--)if(i in self&&sought===self[i])return i;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(object){return object.__proto__||(object.constructor?object.constructor.prototype:prototypeOfObject)}),!Object.getOwnPropertyDescriptor){var ERR_NON_OBJECT="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(object,property){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError(ERR_NON_OBJECT+object);if(owns(object,property)){var descriptor,getter,setter;if(descriptor={enumerable:!0,configurable:!0},supportsAccessors){var prototype=object.__proto__;object.__proto__=prototypeOfObject;var getter=lookupGetter(object,property),setter=lookupSetter(object,property);if(object.__proto__=prototype,getter||setter)return getter&&(descriptor.get=getter),setter&&(descriptor.set=setter),descriptor}return descriptor.value=object[property],descriptor}}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(object){return Object.keys(object)}),!Object.create){var createEmpty;createEmpty=null===Object.prototype.__proto__?function(){return{__proto__:null}}:function(){var empty={};for(var i in empty)empty[i]=null;return empty.constructor=empty.hasOwnProperty=empty.propertyIsEnumerable=empty.isPrototypeOf=empty.toLocaleString=empty.toString=empty.valueOf=empty.__proto__=null,empty},Object.create=function(prototype,properties){var object;if(null===prototype)object=createEmpty();else{if("object"!=typeof prototype)throw new TypeError("typeof prototype["+typeof prototype+"] != \'object\'");var Type=function(){};Type.prototype=prototype,object=new Type,object.__proto__=prototype}return void 0!==properties&&Object.defineProperties(object,properties),object}}if(Object.defineProperty){var definePropertyWorksOnObject=doesDefinePropertyWork({}),definePropertyWorksOnDom="undefined"==typeof document||doesDefinePropertyWork(document.createElement("div"));if(!definePropertyWorksOnObject||!definePropertyWorksOnDom)var definePropertyFallback=Object.defineProperty}if(!Object.defineProperty||definePropertyFallback){var ERR_NON_OBJECT_DESCRIPTOR="Property description must be an object: ",ERR_NON_OBJECT_TARGET="Object.defineProperty called on non-object: ",ERR_ACCESSORS_NOT_SUPPORTED="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(object,property,descriptor){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError(ERR_NON_OBJECT_TARGET+object);if("object"!=typeof descriptor&&"function"!=typeof descriptor||null===descriptor)throw new TypeError(ERR_NON_OBJECT_DESCRIPTOR+descriptor);if(definePropertyFallback)try{return definePropertyFallback.call(Object,object,property,descriptor)}catch(exception){}if(owns(descriptor,"value"))if(supportsAccessors&&(lookupGetter(object,property)||lookupSetter(object,property))){var prototype=object.__proto__;object.__proto__=prototypeOfObject,delete object[property],object[property]=descriptor.value,object.__proto__=prototype}else object[property]=descriptor.value;else{if(!supportsAccessors)throw new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);owns(descriptor,"get")&&defineGetter(object,property,descriptor.get),owns(descriptor,"set")&&defineSetter(object,property,descriptor.set)}return object}}Object.defineProperties||(Object.defineProperties=function(object,properties){for(var property in properties)owns(properties,property)&&Object.defineProperty(object,property,properties[property]);return object}),Object.seal||(Object.seal=function(object){return object}),Object.freeze||(Object.freeze=function(object){return object});try{Object.freeze(function(){})}catch(exception){Object.freeze=function(freezeObject){return function(object){return"function"==typeof object?object:freezeObject(object)}}(Object.freeze)}if(Object.preventExtensions||(Object.preventExtensions=function(object){return object}),Object.isSealed||(Object.isSealed=function(){return!1}),Object.isFrozen||(Object.isFrozen=function(){return!1}),Object.isExtensible||(Object.isExtensible=function(object){if(Object(object)===object)throw new TypeError;for(var name="";owns(object,name);)name+="?";object[name]=!0;var returnValue=owns(object,name);return delete object[name],returnValue}),!Object.keys){var hasDontEnumBug=!0,dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;for(var key in{toString:null})hasDontEnumBug=!1;Object.keys=function(object){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError("Object.keys called on a non-object");var keys=[];for(var name in object)owns(object,name)&&keys.push(name);if(hasDontEnumBug)for(var i=0,ii=dontEnumsLength;ii>i;i++){var dontEnum=dontEnums[i];owns(object,dontEnum)&&keys.push(dontEnum)}return keys}}Date.now||(Date.now=function(){return(new Date).getTime()});var ws="\t\\n\v\\f\\r \\u2028\\u2029\ufeff";if(!String.prototype.trim||ws.trim()){ws="["+ws+"]";var trimBeginRegexp=RegExp("^"+ws+ws+"*"),trimEndRegexp=RegExp(ws+ws+"*$");String.prototype.trim=function(){return(this+"").replace(trimBeginRegexp,"").replace(trimEndRegexp,"")}}var toObject=function(o){if(null==o)throw new TypeError("can\'t convert "+o+" to object");return Object(o)}});'},243:function(module,exports){ace.define("ace/theme/github",["require","exports","module","ace/lib/dom"],(function(acequire,exports,module){exports.isDark=false;exports.cssClass="ace-github";exports.cssText='.ace-github .ace_gutter {background: #e8e8e8;color: #AAA;}.ace-github  {background: #fff;color: #000;}.ace-github .ace_keyword {font-weight: bold;}.ace-github .ace_string {color: #D14;}.ace-github .ace_variable.ace_class {color: teal;}.ace-github .ace_constant.ace_numeric {color: #099;}.ace-github .ace_constant.ace_buildin {color: #0086B3;}.ace-github .ace_support.ace_function {color: #0086B3;}.ace-github .ace_comment {color: #998;font-style: italic;}.ace-github .ace_variable.ace_language  {color: #0086B3;}.ace-github .ace_paren {font-weight: bold;}.ace-github .ace_boolean {font-weight: bold;}.ace-github .ace_string.ace_regexp {color: #009926;font-weight: normal;}.ace-github .ace_variable.ace_instance {color: teal;}.ace-github .ace_constant.ace_language {font-weight: bold;}.ace-github .ace_cursor {color: black;}.ace-github.ace_focus .ace_marker-layer .ace_active-line {background: rgb(255, 255, 204);}.ace-github .ace_marker-layer .ace_active-line {background: rgb(245, 245, 245);}.ace-github .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-github.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-github.ace_nobold .ace_line > span {font-weight: normal !important;}.ace-github .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-github .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-github .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-github .ace_gutter-active-line {background-color : rgba(0, 0, 0, 0.07);}.ace-github .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-github .ace_invisible {color: #BFBFBF}.ace-github .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-github .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}';var dom=acequire("../lib/dom");dom.importCssString(exports.cssText,exports.cssClass)}))},297:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"EditRoleMappingPage",(function(){return edit_role_mapping_page_EditRoleMappingPage}));var external_kbnSharedDeps_React_=__webpack_require__(0);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(2);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(5);class Rule{}class rule_group_RuleGroup extends Rule{}class all_rule_AllRule extends rule_group_RuleGroup{constructor(rules=[]){super();this.rules=rules}getRules(){return[...this.rules]}getDisplayTitle(){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.allRule.displayTitle",{defaultMessage:"All are true"})}replaceRule(ruleIndex,rule){this.rules.splice(ruleIndex,1,rule)}removeRule(ruleIndex){this.rules.splice(ruleIndex,1)}addRule(rule){this.rules.push(rule)}canContainRules(){return true}clone(){return new all_rule_AllRule(this.rules.map(r=>r.clone()))}toRaw(){return{all:[...this.rules.map(rule=>rule.toRaw())]}}}class except_all_rule_ExceptAllRule extends rule_group_RuleGroup{constructor(rules=[]){super();this.rules=rules}getRules(){return[...this.rules]}getDisplayTitle(){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.exceptAllRule.displayTitle",{defaultMessage:"Any are false"})}replaceRule(ruleIndex,rule){this.rules.splice(ruleIndex,1,rule)}removeRule(ruleIndex){this.rules.splice(ruleIndex,1)}addRule(rule){this.rules.push(rule)}canContainRules(){return true}clone(){return new except_all_rule_ExceptAllRule(this.rules.map(r=>r.clone()))}toRaw(){const rawRule={all:[...this.rules.map(rule=>rule.toRaw())]};return{except:rawRule}}}class except_any_rule_ExceptAnyRule extends rule_group_RuleGroup{constructor(rules=[]){super();this.rules=rules}getRules(){return[...this.rules]}getDisplayTitle(){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.exceptAnyRule.displayTitle",{defaultMessage:"All are false"})}replaceRule(ruleIndex,rule){this.rules.splice(ruleIndex,1,rule)}removeRule(ruleIndex){this.rules.splice(ruleIndex,1)}addRule(rule){this.rules.push(rule)}canContainRules(rules){const forbiddenRules=[except_all_rule_ExceptAllRule,except_any_rule_ExceptAnyRule];return rules.every(candidate=>!forbiddenRules.some(forbidden=>candidate instanceof forbidden))}clone(){return new except_any_rule_ExceptAnyRule(this.rules.map(r=>r.clone()))}toRaw(){const rawRule={any:[...this.rules.map(rule=>rule.toRaw())]};return{except:rawRule}}}class any_rule_AnyRule extends rule_group_RuleGroup{constructor(rules=[]){super();this.rules=rules}getRules(){return[...this.rules]}getDisplayTitle(){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.anyRule.displayTitle",{defaultMessage:"Any are true"})}replaceRule(ruleIndex,rule){this.rules.splice(ruleIndex,1,rule)}removeRule(ruleIndex){this.rules.splice(ruleIndex,1)}addRule(rule){this.rules.push(rule)}canContainRules(rules){const forbiddenRules=[except_all_rule_ExceptAllRule,except_any_rule_ExceptAnyRule];return rules.every(candidate=>!forbiddenRules.some(forbidden=>candidate instanceof forbidden))}clone(){return new any_rule_AnyRule(this.rules.map(r=>r.clone()))}toRaw(){return{any:[...this.rules.map(rule=>rule.toRaw())]}}}class field_rule_FieldRule extends Rule{constructor(field,value){super();this.field=field;this.value=value}getDisplayTitle(){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.fieldRule.displayTitle",{defaultMessage:"The following is true"})}clone(){return new field_rule_FieldRule(this.field,Array.isArray(this.value)?[...this.value]:this.value)}toRaw(){return{field:{[this.field]:Array.isArray(this.value)?[...this.value]:this.value}}}}function generateRulesFromRaw(rawRules={}){return parseRawRules(rawRules,null,[],0)}function parseRawRules(rawRules,parentRuleType,ruleTrace,depth){const entries=Object.entries(rawRules);if(!entries.length){return{rules:null,maxDepth:0}}if(entries.length>1){throw new RuleBuilderError(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.ruleBuilder.expectSingleRule",{defaultMessage:`Expected a single rule definition, but found {numberOfRules}.`,values:{numberOfRules:entries.length}}),ruleTrace)}const rule=entries[0];const[ruleType,ruleDefinition]=rule;return createRuleForType(ruleType,ruleDefinition,parentRuleType,ruleTrace,depth+1)}function createRuleForType(ruleType,ruleDefinition,parentRuleType,ruleTrace=[],depth){const isRuleNegated=parentRuleType==="except";const currentRuleTrace=[...ruleTrace,ruleType];switch(ruleType){case"field":{assertIsObject(ruleDefinition,currentRuleTrace);const entries=Object.entries(ruleDefinition);if(entries.length!==1){throw new RuleBuilderError(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.ruleBuilder.expectedSingleFieldRule",{defaultMessage:`Expected a single field, but found {count}.`,values:{count:entries.length}}),currentRuleTrace)}const[field,value]=entries[0];const values=Array.isArray(value)?value:[value];values.forEach(fieldValue=>{const valueType=typeof fieldValue;if(fieldValue!==null&&!["string","number","boolean"].includes(valueType)){throw new RuleBuilderError(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.ruleBuilder.invalidFieldValueType",{defaultMessage:`Invalid value type for field. Expected one of null, string, number, or boolean, but found {valueType} ({value}).`,values:{valueType:valueType,value:JSON.stringify(value)}}),currentRuleTrace)}});const fieldRule=new field_rule_FieldRule(field,value);return{rules:isRuleNegated?new except_all_rule_ExceptAllRule([fieldRule]):fieldRule,maxDepth:depth}}case"any":case"all":{if(ruleDefinition!=null&&!Array.isArray(ruleDefinition)){throw new RuleBuilderError(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.ruleBuilder.expectedArrayForGroupRule",{defaultMessage:`Expected an array of rules, but found {type}.`,values:{type:typeof ruleDefinition}}),currentRuleTrace)}const subRulesResults=(ruleDefinition||[]).map((definition,index)=>parseRawRules(definition,ruleType,[...currentRuleTrace,`[${index}]`],depth));const{subRules:subRules,maxDepth:maxDepth}=subRulesResults.reduce((acc,result)=>({subRules:[...acc.subRules,result.rules],maxDepth:Math.max(acc.maxDepth,result.maxDepth)}),{subRules:[],maxDepth:0});if(ruleType==="all"){return{rules:isRuleNegated?new except_all_rule_ExceptAllRule(subRules):new all_rule_AllRule(subRules),maxDepth:maxDepth}}else{return{rules:isRuleNegated?new except_any_rule_ExceptAnyRule(subRules):new any_rule_AnyRule(subRules),maxDepth:maxDepth}}}case"except":{assertIsObject(ruleDefinition,currentRuleTrace);if(parentRuleType!=="all"){throw new RuleBuilderError(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.ruleBuilder.exceptOnlyInAllRule",{defaultMessage:`"except" rule can only exist within an "all" rule.`}),currentRuleTrace)}return parseRawRules(ruleDefinition||{},ruleType,currentRuleTrace,depth-1)}default:throw new RuleBuilderError(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.ruleBuilder.unknownRuleType",{defaultMessage:`Unknown rule type: {ruleType}.`,values:{ruleType:ruleType}}),currentRuleTrace)}}function assertIsObject(ruleDefinition,ruleTrace){let fieldType=typeof ruleDefinition;if(Array.isArray(ruleDefinition)){fieldType="array"}if(ruleDefinition&&fieldType!=="object"){throw new RuleBuilderError(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.ruleBuilder.expectedObjectError",{defaultMessage:`Expected an object, but found {type}.`,values:{type:fieldType}}),ruleTrace)}}class RuleBuilderError extends Error{constructor(message,ruleTrace){super(message);this.ruleTrace=ruleTrace;Object.setPrototypeOf(this,RuleBuilderError.prototype)}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const userFields=[{name:"username"},{name:"dn"},{name:"groups"},{name:"realm.name"}];const fieldOptions=userFields.map(f=>({label:f.name}));const comparisonOptions={text:{id:"text",defaultValue:"*"},number:{id:"number",defaultValue:0},null:{id:"null",defaultValue:null},boolean:{id:"boolean",defaultValue:true}};class field_rule_editor_FieldRuleEditor extends external_kbnSharedDeps_React_["Component"]{constructor(...args){super(...args);_defineProperty(this,"renderFieldRow",(field,ruleValue,valueIndex)=>{const isPrimaryRow=valueIndex===0;let renderAddValueButton=true;let rowRuleValue=ruleValue;if(Array.isArray(ruleValue)){renderAddValueButton=ruleValue.length-1===valueIndex;rowRuleValue=ruleValue[valueIndex]}const comparisonType=this.getComparisonType(rowRuleValue);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},isPrimaryRow?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.fieldRuleEditor.userFieldLabel",{defaultMessage:"User field"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{isClearable:false,selectedOptions:[{label:field}],singleSelection:{asPlainText:true},onChange:this.onFieldChange,onCreateOption:this.onAddField,options:fieldOptions,"data-test-subj":`fieldRuleEditorField-${valueIndex} fieldRuleEditorField-${valueIndex}-combo`})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{hasEmptyLabelSpace:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiExpression"],{description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.fieldRuleEditor.orLabel",{defaultMessage:"or"}),value:field,"data-test-subj":`fieldRuleEditorField-${valueIndex} fieldRuleEditorField-${valueIndex}-expression`}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},this.renderFieldTypeInput(comparisonType.id,valueIndex)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},this.renderFieldValueInput(comparisonType.id,rowRuleValue,valueIndex)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{hasEmptyLabelSpace:true},renderAddValueButton?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{iconSize:"s",iconType:"plusInCircle",onClick:this.onAddAlternateValue,color:"primary","data-test-subj":"addAlternateValueButton","aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.fieldRuleEditor.addAlternateValueButton",{defaultMessage:"Add alternate value"})}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"l",type:"empty"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{hasEmptyLabelSpace:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{iconType:"trash",color:"danger",iconSize:"s","data-test-subj":`fieldRuleEditorDeleteValue fieldRuleEditorDeleteValue-${valueIndex}`,"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.fieldRuleEditor.deleteValueLabel",{defaultMessage:"Delete value"}),onClick:()=>this.onRemoveAlternateValue(valueIndex)}))))});_defineProperty(this,"renderFieldTypeInput",(inputType,valueIndex)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.fieldRuleEditor.typeFormRow",{defaultMessage:"Type"}),key:valueIndex},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{options:[{value:"text",text:"text"},{value:"number",text:"number"},{value:"null",text:"is null"},{value:"boolean",text:"boolean"}],"data-test-subj":`fieldRuleEditorValueType-${valueIndex}`,value:inputType,onChange:e=>this.onComparisonTypeChange(valueIndex,e.target.value)})));_defineProperty(this,"renderFieldValueInput",(fieldType,rowRuleValue,valueIndex)=>{const inputField=this.getInputFieldForType(fieldType,rowRuleValue,valueIndex);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.fieldRuleEditor.valueFormRow",{defaultMessage:"Value"}),key:valueIndex},inputField)});_defineProperty(this,"getInputFieldForType",(fieldType,rowRuleValue,valueIndex)=>{const isNullValue=rowRuleValue===null;const commonProps={"data-test-subj":`fieldRuleEditorValue-${valueIndex}`};switch(fieldType){case"boolean":return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],_extends({},commonProps,{value:rowRuleValue===null||rowRuleValue===void 0?void 0:rowRuleValue.toString(),onChange:this.onBooleanValueChange(valueIndex),options:[{value:"true",text:"true"},{value:"false",text:"false"}]}));case"text":case"null":return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],_extends({},commonProps,{value:isNullValue?"-- null --":rowRuleValue,onChange:this.onValueChange(valueIndex),disabled:isNullValue}));case"number":return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{"data-test-subj":`fieldRuleEditorValue-${valueIndex}`,value:rowRuleValue,onChange:this.onNumericValueChange(valueIndex)});default:throw new Error(`Unsupported input field type: ${fieldType}`)}});_defineProperty(this,"onAddAlternateValue",()=>{const{field:field,value:value}=this.props.rule;const nextValue=Array.isArray(value)?[...value]:[value];nextValue.push("*");this.props.onChange(new field_rule_FieldRule(field,nextValue))});_defineProperty(this,"onRemoveAlternateValue",index=>{const{field:field,value:value}=this.props.rule;if(!Array.isArray(value)||value.length===1){this.props.onDelete();return}const nextValue=[...value];nextValue.splice(index,1);this.props.onChange(new field_rule_FieldRule(field,nextValue))});_defineProperty(this,"onFieldChange",([newField])=>{if(!newField){return}const{value:value}=this.props.rule;this.props.onChange(new field_rule_FieldRule(newField.label,value))});_defineProperty(this,"onAddField",newField=>{const{value:value}=this.props.rule;this.props.onChange(new field_rule_FieldRule(newField,value))});_defineProperty(this,"onValueChange",index=>e=>{const{field:field,value:value}=this.props.rule;let nextValue;if(Array.isArray(value)){nextValue=[...value];nextValue.splice(index,1,e.target.value)}else{nextValue=e.target.value}this.props.onChange(new field_rule_FieldRule(field,nextValue))});_defineProperty(this,"onNumericValueChange",index=>e=>{const{field:field,value:value}=this.props.rule;let nextValue;if(Array.isArray(value)){nextValue=[...value];nextValue.splice(index,1,parseFloat(e.target.value))}else{nextValue=parseFloat(e.target.value)}this.props.onChange(new field_rule_FieldRule(field,nextValue))});_defineProperty(this,"onBooleanValueChange",index=>e=>{const boolValue=e.target.value==="true";const{field:field,value:value}=this.props.rule;let nextValue;if(Array.isArray(value)){nextValue=[...value];nextValue.splice(index,1,boolValue)}else{nextValue=boolValue}this.props.onChange(new field_rule_FieldRule(field,nextValue))});_defineProperty(this,"onComparisonTypeChange",(index,newType)=>{const comparison=comparisonOptions[newType];if(!comparison){throw new Error(`Unexpected comparison type: ${newType}`)}const{field:field,value:value}=this.props.rule;let nextValue=value;if(Array.isArray(value)){nextValue=[...value];nextValue.splice(index,1,comparison.defaultValue)}else{nextValue=comparison.defaultValue}this.props.onChange(new field_rule_FieldRule(field,nextValue))})}render(){const{field:field,value:value}=this.props.rule;const content=Array.isArray(value)?value.map((v,index)=>this.renderFieldRow(field,value,index)):[this.renderFieldRow(field,value,0)];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column"},content.map((row,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:index},row)))}getComparisonType(ruleValue){const valueType=typeof ruleValue;if(valueType==="string"||valueType==="undefined"){return comparisonOptions.text}if(valueType==="number"){return comparisonOptions.number}if(valueType==="boolean"){return comparisonOptions.boolean}if(ruleValue===null){return comparisonOptions.null}throw new Error(`Unable to detect comparison type for rule value [${ruleValue}]`)}}var rule_group_editor=__webpack_require__(232);const AddRuleButton=props=>{const[isMenuOpen,setIsMenuOpen]=Object(external_kbnSharedDeps_React_["useState"])(false);const button=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{iconType:"plusInCircle","data-test-subj":"roleMappingsAddRuleButton",onClick:()=>{setIsMenuOpen(!isMenuOpen)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.addRuleButton",defaultMessage:"Add"}));const options=[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{id:"addRuleOption",key:"rule",name:"Add rule",icon:"user",onClick:()=>{setIsMenuOpen(false);props.onClick(new field_rule_FieldRule("username","*"))}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.addRuleOption",defaultMessage:"Add rule"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{id:"addRuleGroupOption",key:"ruleGroup",name:"Add rule group",icon:"list",onClick:()=>{setIsMenuOpen(false);props.onClick(new all_rule_AllRule([new field_rule_FieldRule("username","*")]))}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.addRuleGroupOption",defaultMessage:"Add rule group"}))];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"addRuleContextMenu","data-test-subj":"addRuleContextMenu",button:button,isOpen:isMenuOpen,closePopover:()=>setIsMenuOpen(false),panelPaddingSize:"none",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuPanel"],{title:"Add rule",items:options}))};const rule_group_title_rules=[new all_rule_AllRule,new any_rule_AnyRule];const exceptRules=[new except_all_rule_ExceptAllRule,new except_any_rule_ExceptAnyRule];const RuleGroupTitle=props=>{const[isMenuOpen,setIsMenuOpen]=Object(external_kbnSharedDeps_React_["useState"])(false);const[showConfirmChangeModal,setShowConfirmChangeModal]=Object(external_kbnSharedDeps_React_["useState"])(false);const[pendingNewRule,setPendingNewRule]=Object(external_kbnSharedDeps_React_["useState"])(null);const canUseExcept=props.parentRule&&props.parentRule.canContainRules(exceptRules);const availableRuleTypes=[...rule_group_title_rules,...canUseExcept?exceptRules:[]];const onChange=newRule=>{const currentSubRules=props.rule.getRules();const areSubRulesValid=newRule.canContainRules(currentSubRules);if(areSubRulesValid){const clone=newRule.clone();currentSubRules.forEach(subRule=>clone.addRule(subRule));props.onChange(clone);setIsMenuOpen(false)}else{setPendingNewRule(newRule);setShowConfirmChangeModal(true)}};const changeRuleDiscardingSubRules=newRule=>{const newRuleInstance=newRule.clone();if(newRuleInstance.getRules().length===0){newRuleInstance.addRule(new field_rule_FieldRule("username","*"))}props.onChange(newRuleInstance);setIsMenuOpen(false)};const ruleButton=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{onClick:()=>setIsMenuOpen(!isMenuOpen),"data-test-subj":"ruleGroupTitle"},props.rule.getDisplayTitle()," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"arrowDown"}));const ruleTypeSelector=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{button:ruleButton,isOpen:isMenuOpen,closePopover:()=>setIsMenuOpen(false)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuPanel"],{items:availableRuleTypes.map((rt,index)=>{const isSelected=rt.getDisplayTitle()===props.rule.getDisplayTitle();const icon=isSelected?"check":"empty";return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenuItem"],{key:index,icon:icon,onClick:()=>onChange(rt)},rt.getDisplayTitle())})}));const confirmChangeModal=showConfirmChangeModal?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiConfirmModal"],{"data-test-subj":"confirmRuleChangeModal",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.confirmGroupChangePromptTitle",defaultMessage:"Change group type?"}),onCancel:()=>{setShowConfirmChangeModal(false);setPendingNewRule(null)},onConfirm:()=>{setShowConfirmChangeModal(false);changeRuleDiscardingSubRules(pendingNewRule);setPendingNewRule(null)},cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.confirmGroupChangeCancelButton",defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.confirmGroupChangeConfirmButton",defaultMessage:"Change anyway"})},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.switchWithIncompatibleRulesMessage",defaultMessage:"This group contains rules that are not compatible with the new type. If you change types, you will lose all rules within this group."}))):null;return external_kbnSharedDeps_React_default.a.createElement("h3",null,ruleTypeSelector,confirmChangeModal)};function isRuleGroup(rule){return!(rule instanceof field_rule_FieldRule)}function rule_group_editor_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class rule_group_editor_RuleGroupEditor extends external_kbnSharedDeps_React_["Component"]{constructor(...args){super(...args);rule_group_editor_defineProperty(this,"renderSubRules",()=>this.props.rule.getRules().map((subRule,subRuleIndex,rules)=>{const isLastRule=subRuleIndex===rules.length-1;const divider=isLastRule?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"m"}));if(isRuleGroup(subRule)){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],{key:subRuleIndex},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(rule_group_editor_RuleGroupEditor,{rule:subRule,parentRule:this.props.rule,allowAdd:this.props.allowAdd,ruleDepth:this.props.ruleDepth+1,onChange:updatedSubRule=>{const updatedRule=this.props.rule.clone();updatedRule.replaceRule(subRuleIndex,updatedSubRule);this.props.onChange(updatedRule)},onDelete:()=>{const updatedRule=this.props.rule.clone();updatedRule.removeRule(subRuleIndex);this.props.onChange(updatedRule)}})),divider)}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],{key:subRuleIndex},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(field_rule_editor_FieldRuleEditor,{rule:subRule,onChange:updatedSubRule=>{const updatedRule=this.props.rule.clone();updatedRule.replaceRule(subRuleIndex,updatedSubRule);this.props.onChange(updatedRule)},onDelete:()=>{const updatedRule=this.props.rule.clone();updatedRule.removeRule(subRuleIndex);this.props.onChange(updatedRule)}})),divider)}));rule_group_editor_defineProperty(this,"onAddRuleClick",newRule=>{const updatedRule=this.props.rule.clone();updatedRule.addRule(newRule);this.props.onChange(updatedRule)})}render(){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],{className:`secRoleMapping__ruleEditorGroup--${this.props.ruleDepth%2?"odd":"even"}`},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true},external_kbnSharedDeps_React_default.a.createElement(RuleGroupTitle,{rule:this.props.rule,onChange:this.props.onChange,parentRule:this.props.parentRule})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{color:"danger",onClick:this.props.onDelete,size:"s",iconType:"trash","data-test-subj":"deleteRuleGroupButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.deleteRuleGroupButton",defaultMessage:"Delete"}))))),this.renderSubRules(),this.props.allowAdd&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(AddRuleButton,{onClick:this.onAddRuleClick}))))}}const VISUAL_MAX_RULE_DEPTH=5;function visual_rule_editor_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class visual_rule_editor_VisualRuleEditor extends external_kbnSharedDeps_React_["Component"]{constructor(...args){super(...args);visual_rule_editor_defineProperty(this,"canUseVisualEditor",()=>this.props.maxDepth<VISUAL_MAX_RULE_DEPTH);visual_rule_editor_defineProperty(this,"getRuleDepthWarning",()=>{if(this.canUseVisualEditor()){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{iconType:"alert",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.visualRuleEditor.switchToJSONEditorTitle",defaultMessage:"Switch to JSON editor"}),"data-test-subj":"roleMappingsRulesTooComplex"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.visualRuleEditor.switchToJSONEditorMessage",defaultMessage:"Role mapping rules are too complex for the visual editor. Switch to the JSON editor to continue editing this rule."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{onClick:this.props.onSwitchEditorMode,size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.visualRuleEditor.switchToJSONEditorButton",defaultMessage:"Use JSON editor"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}))});visual_rule_editor_defineProperty(this,"onRuleChange",updatedRule=>{this.props.onChange(updatedRule)});visual_rule_editor_defineProperty(this,"onRuleDelete",()=>{this.props.onChange(null)});visual_rule_editor_defineProperty(this,"renderRule",(rule,onChange)=>this.getEditorForRuleType(rule,onChange))}render(){if(this.props.rules){const rules=this.renderRule(this.props.rules,this.onRuleChange);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,this.getRuleDepthWarning(),rules)}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.visualRuleEditor.noRulesDefinedTitle",defaultMessage:"No rules defined"})),titleSize:"s",body:external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.visualRuleEditor.noRulesDefinedMessage",defaultMessage:"Rules control which users should be assigned roles."})),"data-test-subj":"roleMappingsNoRulesDefined",actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{color:"primary",iconType:"plusInCircle","data-test-subj":"roleMappingsAddRuleButton",onClick:()=>{this.props.onChange(new all_rule_AllRule([new field_rule_FieldRule("username","*")]))}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.addFirstRuleButton",defaultMessage:"Add rules"}))})}getEditorForRuleType(rule,onChange){if(isRuleGroup(rule)){return external_kbnSharedDeps_React_default.a.createElement(rule_group_editor_RuleGroupEditor,{rule:rule,ruleDepth:0,allowAdd:this.canUseVisualEditor(),onChange:value=>onChange(value),onDelete:this.onRuleDelete})}return external_kbnSharedDeps_React_default.a.createElement(field_rule_editor_FieldRuleEditor,{rule:rule,onChange:value=>onChange(value),onDelete:this.onRuleDelete})}}var json=__webpack_require__(241);var github=__webpack_require__(243);var public_=__webpack_require__(6);const JSONRuleEditor=props=>{const docLinks=Object(public_["useKibana"])().services.docLinks;const[rawRules,setRawRules]=Object(external_kbnSharedDeps_React_["useState"])(JSON.stringify(props.rules?props.rules.toRaw():{},null,2));const[ruleBuilderError,setRuleBuilderError]=Object(external_kbnSharedDeps_React_["useState"])(null);function onRulesChange(updatedRules){setRawRules(updatedRules);try{const ruleJSON=JSON.parse(updatedRules);props.onChange(generateRulesFromRaw(ruleJSON).rules);props.onValidityChange(true);setRuleBuilderError(null)}catch(e){if(e instanceof RuleBuilderError){setRuleBuilderError(e)}else{setRuleBuilderError(null)}props.onValidityChange(false)}}function reformatRules(){try{const ruleJSON=JSON.parse(rawRules);setRawRules(JSON.stringify(ruleJSON,null,2))}catch(ignore){}}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{isInvalid:Boolean(ruleBuilderError),error:ruleBuilderError&&external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.JSONEditorRuleError",{defaultMessage:"Invalid rule definition at {ruleLocation}: {errorMessage}",values:{ruleLocation:ruleBuilderError.ruleTrace.join("."),errorMessage:ruleBuilderError.message}}),fullWidth:true,"data-test-subj":"roleMappingsJSONEditor"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCodeEditor"],{"aria-label":"",mode:"json",theme:"github",value:rawRules,onChange:onRulesChange,width:"100%",height:"auto",minLines:6,maxLines:30,isReadOnly:false,setOptions:{showLineNumbers:true,tabSize:2},editorProps:{$blockScrolling:Infinity},showGutter:true}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{iconType:"broom",onClick:reformatRules,size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.autoFormatRuleText",defaultMessage:"Reformat"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.JSONEditorHelpText",defaultMessage:"Specify your rules in JSON format consistent with the {roleMappingAPI}",values:{roleMappingAPI:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:docLinks.links.apis.createRoleMapping,external:true,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.JSONEditorEsApi",defaultMessage:"Elasticsearch role mapping API."}))}})))))};function validateRoleMappingName({name:name}){if(!name){return invalid(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.role_mappings.validation.invalidName",{defaultMessage:"Name is required."}))}return valid()}function validateRoleMappingRoles({roles:roles}){if(roles&&!roles.length){return invalid(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.role_mappings.validation.invalidRoles",{defaultMessage:"At least one role is required."}))}return valid()}function validateRoleMappingRoleTemplates({role_templates:roleTemplates}){if(roleTemplates&&!roleTemplates.length){return invalid(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.role_mappings.validation.invalidRoleTemplates",{defaultMessage:"At least one role template is required."}))}return valid()}function validateRoleMappingRules({rules:rules}){try{const{rules:parsedRules}=generateRulesFromRaw(rules);if(!parsedRules){return invalid(external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.role_mappings.validation.invalidRoleRule",{defaultMessage:"At least one rule is required."}))}}catch(e){return invalid(e.message)}return valid()}function validateRoleMappingForSave(roleMapping){const{isInvalid:isNameInvalid,error:nameError}=validateRoleMappingName(roleMapping);const{isInvalid:areRolesInvalid,error:rolesError}=validateRoleMappingRoles(roleMapping);const{isInvalid:areRoleTemplatesInvalid,error:roleTemplatesError}=validateRoleMappingRoleTemplates(roleMapping);const{isInvalid:areRulesInvalid,error:rulesError}=validateRoleMappingRules(roleMapping);const canSave=!isNameInvalid&&(!areRolesInvalid||!areRoleTemplatesInvalid)&&!areRulesInvalid;if(canSave){return valid()}return invalid(nameError||rulesError||rolesError||roleTemplatesError)}function valid(){return{isInvalid:false}}function invalid(error){return{isInvalid:true,error:error}}function rule_editor_panel_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class rule_editor_panel_RuleEditorPanel extends external_kbnSharedDeps_React_["Component"]{constructor(props){super(props);rule_editor_panel_defineProperty(this,"initializeFromRawRules",rawRules=>{const{rules:rules,maxDepth:maxDepth}=generateRulesFromRaw(rawRules);const mode=maxDepth>=VISUAL_MAX_RULE_DEPTH?"json":"visual";return{rules:rules,mode:mode,maxDepth:maxDepth}});rule_editor_panel_defineProperty(this,"getConfirmModeChangePrompt",()=>{if(!this.state.showConfirmModeChange){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiConfirmModal"],{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.confirmModeChangePromptTitle",defaultMessage:"Switch with invalid rules?"}),onCancel:()=>this.setState({showConfirmModeChange:false}),onConfirm:()=>{this.setState({mode:"visual",showConfirmModeChange:false});this.onValidityChange(true)},cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.confirmModeChangePromptCancelButton",defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.confirmModeChangePromptConfirmButton",defaultMessage:"Switch anyway"})},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.confirmModeChangePromptBody",defaultMessage:"The rules defined are not valid, and cannot be translated to the visual editor. You may lose some or all of your changes during the conversion. Do you wish to continue?"})))});rule_editor_panel_defineProperty(this,"onRuleChange",updatedRule=>{const raw=updatedRule?updatedRule.toRaw():{};this.props.onChange(raw);this.setState({...generateRulesFromRaw(raw)})});rule_editor_panel_defineProperty(this,"onValidityChange",isRuleValid=>{this.setState({isRuleValid:isRuleValid});this.props.onValidityChange(isRuleValid)});rule_editor_panel_defineProperty(this,"trySwitchEditorMode",newMode=>{switch(newMode){case"visual":{if(this.state.isRuleValid){this.setState({mode:newMode});this.onValidityChange(true)}else{this.setState({showConfirmModeChange:true})}break}case"json":this.setState({mode:newMode});this.onValidityChange(true);break;default:throw new Error(`Unexpected rule editor mode: ${this.state.mode}`)}});this.state={...this.initializeFromRawRules(props.rawRules),isRuleValid:true,showConfirmModeChange:false,showVisualEditorDisabledAlert:false}}render(){const validationResult=this.props.validateForm&&validateRoleMappingRules({rules:this.state.rules?this.state.rules.toRaw():{}});let validationWarning=null;if(validationResult&&validationResult.error){validationWarning=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{color:"danger",title:validationResult.error,size:"s"}))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],null,external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.mappingRulesPanelTitle",defaultMessage:"Mapping rules"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.roleMappingRulesFormRowHelpText",defaultMessage:"Assign roles to users who match these rules. {learnMoreLink}",values:{learnMoreLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:this.props.docLinks.links.security.mappingRolesFieldRules,target:"_blank",external:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.fieldRuleEditor.fieldValueHelp",defaultMessage:"Learn about supported field values."}))}})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true,isInvalid:validationResult&&validationResult.isInvalid},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiErrorBoundary"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,validationWarning,this.getEditor(),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xl"}),this.getModeToggle(),this.getConfirmModeChangePrompt()))))))}getModeToggle(){if(this.state.mode==="json"&&this.state.maxDepth>VISUAL_MAX_RULE_DEPTH){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{size:"s",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.visualEditorUnavailableTitle",{defaultMessage:"Visual editor unavailable"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.visualEditorUnavailableMessage",defaultMessage:"Rule definition is too complex for the visual editor."}))}if(this.state.mode==="visual"&&this.state.rules===null){return null}switch(this.state.mode){case"visual":return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{"data-test-subj":"roleMappingsJSONRuleEditorButton",onClick:()=>{this.trySwitchEditorMode("json")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.switchToJSONEditorLink",defaultMessage:"Switch to JSON editor"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"inputOutput",size:"s"})));case"json":return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{"data-test-subj":"roleMappingsVisualRuleEditorButton",onClick:()=>{this.trySwitchEditorMode("visual")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.switchToVisualEditorLink",defaultMessage:"Switch to visual editor"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"inputOutput",size:"s"})));default:throw new Error(`Unexpected rule editor mode: ${this.state.mode}`)}}getEditor(){switch(this.state.mode){case"visual":return external_kbnSharedDeps_React_default.a.createElement(visual_rule_editor_VisualRuleEditor,{rules:this.state.rules,maxDepth:this.state.maxDepth,onChange:this.onRuleChange,onSwitchEditorMode:()=>this.trySwitchEditorMode("json")});case"json":return external_kbnSharedDeps_React_default.a.createElement(JSONRuleEditor,{rules:this.state.rules,onChange:this.onRuleChange,onValidityChange:this.onValidityChange});default:throw new Error(`Unexpected rule editor mode: ${this.state.mode}`)}}}var components=__webpack_require__(98);var model=__webpack_require__(13);const AddRoleTemplateButton=props=>{if(!props.canUseStoredScripts&&!props.canUseInlineScripts){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{iconType:"alert",color:"danger",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.roleTemplatesUnavailableTitle",defaultMessage:"Role templates unavailable"})},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.roleTemplatesUnavailable",defaultMessage:"Role templates cannot be used when scripts are disabled in Elasticsearch."})))}const addRoleTemplate=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.addRoleTemplate",defaultMessage:"Add template"});if(props.canUseInlineScripts){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{iconType:"plusInCircle",onClick:()=>props.onClick("inline"),"data-test-subj":"addRoleTemplateButton"},addRoleTemplate)}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{iconType:"plusInCircle",onClick:()=>props.onClick("stored"),"data-test-subj":"addRoleTemplateButton"},addRoleTemplate)};function isStoredRoleTemplate(roleMappingTemplate){return roleMappingTemplate.template!=null&&roleMappingTemplate.template.hasOwnProperty("id")&&typeof roleMappingTemplate.template.id==="string"}function isInlineRoleTemplate(roleMappingTemplate){return roleMappingTemplate.template!=null&&roleMappingTemplate.template.hasOwnProperty("source")&&typeof roleMappingTemplate.template.source==="string"}function isInvalidRoleTemplate(roleMappingTemplate){return!isStoredRoleTemplate(roleMappingTemplate)&&!isInlineRoleTemplate(roleMappingTemplate)}const templateTypeOptions=[{id:"inline",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.roleTemplate.inlineTypeLabel",{defaultMessage:"Role template"})},{id:"stored",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.roleTemplate.storedTypeLabel",{defaultMessage:"Stored script"})}];const RoleTemplateTypeSelect=props=>{const availableOptions=templateTypeOptions.filter(({id:id})=>id==="inline"&&props.canUseInlineScripts||id==="stored"&&props.canUseStoredScripts);const selectedOptions=templateTypeOptions.filter(({id:id})=>id==="inline"&&isInlineRoleTemplate(props.roleTemplate)||id==="stored"&&isStoredRoleTemplate(props.roleTemplate));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],{options:availableOptions,singleSelection:{asPlainText:true},selectedOptions:selectedOptions,"data-test-subj":"roleMappingsFormTemplateType",onChange:selected=>{const[{id:id}]=selected;if(id==="inline"){props.onChange({...props.roleTemplate,template:{source:""}})}else{props.onChange({...props.roleTemplate,template:{id:""}})}},isClearable:false})};function role_template_editor_extends(){role_template_editor_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return role_template_editor_extends.apply(this,arguments)}const RoleTemplateEditor=({roleTemplate:roleTemplate,onChange:onChange,onDelete:onDelete,canUseInlineScripts:canUseInlineScripts,canUseStoredScripts:canUseStoredScripts})=>{return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"column",gutterSize:"s"},getTemplateConfigurationFields(),getEditorForTemplate(),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{iconType:"trash",color:"danger",size:"xs",onClick:()=>onDelete(roleTemplate),"data-test-subj":"deleteRoleTemplateButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.deleteRoleTemplateButton",defaultMessage:"Delete template"}))))));function getTemplateFormatSwitch(){const returnsJsonLabel=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.roleTemplateReturnsJson",{defaultMessage:"Returns JSON"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:returnsJsonLabel},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{checked:roleTemplate.format==="json",label:returnsJsonLabel,showLabel:false,onChange:e=>{onChange({...roleTemplate,format:e.target.checked?"json":"string"})}}))}function getTemplateConfigurationFields(){const templateTypeComboBox=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.roleTemplateType",defaultMessage:"Template type"})},external_kbnSharedDeps_React_default.a.createElement(RoleTemplateTypeSelect,{roleTemplate:roleTemplate,canUseStoredScripts:canUseStoredScripts,canUseInlineScripts:canUseInlineScripts,onChange:onChange})));const templateFormatSwitch=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,getTemplateFormatSwitch());return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"spaceBetween"},templateTypeComboBox,templateFormatSwitch))}function getEditorForTemplate(){if(isInlineRoleTemplate(roleTemplate)){const extraProps={};if(!canUseInlineScripts){extraProps.isInvalid=true;extraProps.error=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"danger","data-test-subj":"roleMappingInlineScriptsDisabled"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.roleTemplateInlineScriptsDisabled",defaultMessage:"Template uses inline scripts, which are disabled in Elasticsearch."}))}const example="{{username}}_role";return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1,style:{maxWidth:"400px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],role_template_editor_extends({label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.roleTemplateLabel",defaultMessage:"Template"}),helpText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.roleTemplateHelpText",defaultMessage:"Mustache templates are allowed. Example: {example}",values:{example:example}})},extraProps),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{"data-test-subj":"roleTemplateSourceEditor",value:roleTemplate.template.source,onChange:e=>{onChange({...roleTemplate,template:{source:e.target.value}})}}))))}if(isStoredRoleTemplate(roleTemplate)){const extraProps={};if(!canUseStoredScripts){extraProps.isInvalid=true;extraProps.error=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"xs",color:"danger","data-test-subj":"roleMappingStoredScriptsDisabled"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.roleTemplateStoredScriptsDisabled",defaultMessage:"Template uses stored scripts, which are disabled in Elasticsearch."}))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1,style:{maxWidth:"400px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],role_template_editor_extends({label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.storedScriptLabel",defaultMessage:"Stored script ID"}),helpText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.storedScriptHelpText",defaultMessage:"ID of a previously stored Painless or Mustache script."})},extraProps),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{"data-test-subj":"roleTemplateScriptIdEditor",value:roleTemplate.template.id,onChange:e=>{onChange({...roleTemplate,template:{id:e.target.value}})}}))))}if(isInvalidRoleTemplate(roleTemplate)){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:1,"data-test-subj":"roleMappingInvalidRoleTemplate"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{color:"warning",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.invalidRoleTemplateTitle",defaultMessage:"Invalid role template"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.invalidRoleTemplateMessage",defaultMessage:"Role template is invalid, and cannot be edited here. Please delete and recreate, or fix via the Role Mapping API."})))}throw new Error(`Unable to determine role template type`)}};var role_combo_box=__webpack_require__(102);function role_selector_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class role_selector_RoleSelector extends external_kbnSharedDeps_React_default.a.Component{constructor(props){super(props);role_selector_defineProperty(this,"getRoleComboBox",()=>{const{roles:roles=[]}=this.props.roleMapping;return external_kbnSharedDeps_React_default.a.createElement(role_combo_box["a"],{placeholder:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.selectRolesPlaceholder",{defaultMessage:"Select one or more roles"}),isLoading:this.state.roles.length===0,availableRoles:this.state.roles,selectedRoleNames:roles,onChange:selectedRoles=>{this.props.onChange({...this.props.roleMapping,roles:selectedRoles,role_templates:[]})}})});role_selector_defineProperty(this,"getRoleTemplates",()=>{const{role_templates:roleTemplates=[]}=this.props.roleMapping;return external_kbnSharedDeps_React_default.a.createElement("div",null,roleTemplates.map((rt,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],{key:index},external_kbnSharedDeps_React_default.a.createElement(RoleTemplateEditor,{canUseStoredScripts:this.props.canUseStoredScripts,canUseInlineScripts:this.props.canUseInlineScripts,roleTemplate:rt,onChange:updatedTemplate=>{const templates=[...this.props.roleMapping.role_templates||[]];templates.splice(index,1,updatedTemplate);this.props.onChange({...this.props.roleMapping,role_templates:templates})},onDelete:()=>{const templates=[...this.props.roleMapping.role_templates||[]];templates.splice(index,1);this.props.onChange({...this.props.roleMapping,role_templates:templates})}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],null))),external_kbnSharedDeps_React_default.a.createElement(AddRoleTemplateButton,{canUseStoredScripts:this.props.canUseStoredScripts,canUseInlineScripts:this.props.canUseInlineScripts,onClick:type=>{switch(type){case"inline":{const templates=this.props.roleMapping.role_templates||[];this.props.onChange({...this.props.roleMapping,roles:[],role_templates:[...templates,{template:{source:""}}]});break}case"stored":{const templates=this.props.roleMapping.role_templates||[];this.props.onChange({...this.props.roleMapping,roles:[],role_templates:[...templates,{template:{id:""}}]});break}default:throw new Error(`Unsupported template type: ${type}`)}}}))});role_selector_defineProperty(this,"getHelpText",()=>{if(this.props.mode==="roles"&&this.hasDeprecatedRolesAssigned()){return external_kbnSharedDeps_React_default.a.createElement("span",{"data-test-subj":"deprecatedRolesAssigned"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.deprecatedRolesAssigned",defaultMessage:"This mapping is assigned a deprecated role. Please migrate to a supported role."}))}});role_selector_defineProperty(this,"hasDeprecatedRolesAssigned",()=>{var _this$props$roleMappi,_this$props$roleMappi2;return(_this$props$roleMappi=(_this$props$roleMappi2=this.props.roleMapping.roles)===null||_this$props$roleMappi2===void 0?void 0:_this$props$roleMappi2.some(r=>this.state.roles.some(role=>role.name===r&&Object(model["g"])(role))))!==null&&_this$props$roleMappi!==void 0?_this$props$roleMappi:false});this.state={roles:[]}}async componentDidMount(){const roles=await this.props.rolesAPIClient.getRoles();this.setState({roles:roles})}render(){const{mode:mode}=this.props;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{fullWidth:true,helpText:this.getHelpText()},mode==="roles"?this.getRoleComboBox():this.getRoleTemplates())}}function mapping_info_panel_extends(){mapping_info_panel_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return mapping_info_panel_extends.apply(this,arguments)}function mapping_info_panel_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class mapping_info_panel_MappingInfoPanel extends external_kbnSharedDeps_React_["Component"]{constructor(props){super(props);mapping_info_panel_defineProperty(this,"getRoleMappingName",()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescribedFormGroup"],{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.roleMappingNameFormGroupTitle",defaultMessage:"Mapping name"})),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.roleMappingNameFormGroupHelpText",defaultMessage:"A unique name used to identify this role mapping."}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],mapping_info_panel_extends({label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.roleMappingNameFormRowTitle",defaultMessage:"Name"}),fullWidth:true},this.props.validateForm&&validateRoleMappingName(this.props.roleMapping)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{name:"name",value:this.props.roleMapping.name||"",onChange:this.onNameChange,"data-test-subj":"roleMappingFormNameInput",readOnly:this.props.mode==="edit"}))));mapping_info_panel_defineProperty(this,"getRolesOrRoleTemplatesSelector",()=>{if(this.state.rolesMode==="roles"){return this.getRolesSelector()}return this.getRoleTemplatesSelector()});mapping_info_panel_defineProperty(this,"getRolesSelector",()=>{const validationFunction=()=>{if(!this.props.validateForm){return{}}return validateRoleMappingRoles(this.props.roleMapping)};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescribedFormGroup"],{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.roleMappingRolesFormRowTitle",defaultMessage:"Roles"})),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.roleMappingRolesFormRowHelpText",defaultMessage:"Assign roles to your users."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{"data-test-subj":"switchToRoleTemplatesButton",onClick:()=>{this.onRolesModeChange("templates")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.switchToRoleTemplates",defaultMessage:"Switch to role templates"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"s",type:"inputOutput"})))),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],mapping_info_panel_extends({fullWidth:true},validationFunction()),external_kbnSharedDeps_React_default.a.createElement(role_selector_RoleSelector,{rolesAPIClient:this.props.rolesAPIClient,roleMapping:this.props.roleMapping,mode:this.state.rolesMode,canUseInlineScripts:this.props.canUseInlineScripts,canUseStoredScripts:this.props.canUseStoredScripts,onChange:roleMapping=>this.props.onChange(roleMapping)})))});mapping_info_panel_defineProperty(this,"getRoleTemplatesSelector",()=>{const validationFunction=()=>{if(!this.props.validateForm){return{}}return validateRoleMappingRoleTemplates(this.props.roleMapping)};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescribedFormGroup"],{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.roleMappingRoleTemplatesFormRowTitle",defaultMessage:"Role templates"})),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.roleMappingRoleTemplatesFormRowHelpText",defaultMessage:"Create templates that describe the roles to assign to your users."})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:this.props.docLinks.links.apis.createRoleMappingTemplates,external:true,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.roleMappingRoleTemplatesFormRowLearnMore",defaultMessage:"Learn about role templates"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{onClick:()=>{this.onRolesModeChange("roles")},"data-test-subj":"switchToRolesButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.switchToRoles",defaultMessage:"Switch to roles"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{size:"s",type:"inputOutput"})))),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],mapping_info_panel_extends({fullWidth:true},validationFunction()),external_kbnSharedDeps_React_default.a.createElement(role_selector_RoleSelector,{rolesAPIClient:this.props.rolesAPIClient,roleMapping:this.props.roleMapping,mode:this.state.rolesMode,canUseInlineScripts:this.props.canUseInlineScripts,canUseStoredScripts:this.props.canUseStoredScripts,onChange:roleMapping=>this.props.onChange(roleMapping)})))});mapping_info_panel_defineProperty(this,"getEnabledSwitch",()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiDescribedFormGroup"],{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.roleMappingEnabledFormRowTitle",defaultMessage:"Enable mapping"})),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.roleMappingEnabledFormRowHelpText",defaultMessage:"Map roles to users based on their username, groups, and other metadata. When false, ignore mappings."}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.roleMappingEnabledFormRowLabel",defaultMessage:"Enable mapping"}),fullWidth:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{name:"enabled",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.roleMappingEnabledLabel",{defaultMessage:"Enable mapping"}),showLabel:false,"data-test-subj":"roleMappingsEnabledSwitch",checked:this.props.roleMapping.enabled,onChange:e=>{this.props.onChange({...this.props.roleMapping,enabled:e.target.checked})}}))));mapping_info_panel_defineProperty(this,"onNameChange",e=>{const name=e.target.value;this.props.onChange({...this.props.roleMapping,name:name})});mapping_info_panel_defineProperty(this,"onRolesModeChange",rolesMode=>{const canUseTemplates=this.props.canUseInlineScripts||this.props.canUseStoredScripts;if(rolesMode==="templates"&&canUseTemplates){const defaultTemplate=this.props.canUseInlineScripts?{template:{source:""}}:{template:{id:""}};this.props.onChange({...this.props.roleMapping,roles:[],role_templates:[defaultTemplate]})}this.setState({rolesMode:rolesMode})});this.state={rolesMode:props.roleMapping.role_templates&&props.roleMapping.role_templates.length>0?"templates":"roles"}}render(){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPanel"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],null,external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.roleMappingTitle",defaultMessage:"Role mapping"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),this.getRoleMappingName(),this.getEnabledSwitch(),this.getRolesOrRoleTemplatesSelector())}}function edit_role_mapping_page_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}class edit_role_mapping_page_EditRoleMappingPage extends external_kbnSharedDeps_React_["Component"]{constructor(props){super(props);edit_role_mapping_page_defineProperty(this,"getFormTitle",()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"l"},external_kbnSharedDeps_React_default.a.createElement("h1",null,this.editingExistingRoleMapping()?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.editRoleMappingTitle",defaultMessage:"Edit role mapping"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.createRoleMappingTitle",defaultMessage:"Create role mapping"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued",size:"s"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.roleMappingDescription",defaultMessage:"Use role mappings to control which roles are assigned to your users. {learnMoreLink}",values:{learnMoreLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:this.props.docLinks.links.security.mappingRoles,external:true,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.learnMoreLinkText",defaultMessage:"Learn more."}))}}))),!this.state.hasCompatibleRealms&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(components["b"],null))));edit_role_mapping_page_defineProperty(this,"getFormButtons",()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:true,onClick:this.saveRoleMapping,isLoading:this.state.loadState==="saveInProgress",disabled:!this.state.rulesValid||this.state.loadState==="saveInProgress","data-test-subj":"saveRoleMappingButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.saveRoleMappingButton",defaultMessage:"Save role mapping"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,onClick:this.backToRoleMappingsList},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.cancelButton",defaultMessage:"Cancel"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:true}),this.editingExistingRoleMapping()&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(components["a"],{roleMappingsAPI:this.props.roleMappingsAPI,notifications:this.props.notifications},deleteRoleMappingsPrompt=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:()=>deleteRoleMappingsPrompt([this.state.roleMapping],()=>this.backToRoleMappingsList()),color:"danger"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.deleteRoleMappingButton",defaultMessage:"Delete role mapping"}))))));edit_role_mapping_page_defineProperty(this,"onRuleValidityChange",rulesValid=>{this.setState({rulesValid:rulesValid})});edit_role_mapping_page_defineProperty(this,"saveRoleMapping",()=>{if(!this.state.roleMapping){return}const{isInvalid:isInvalid}=validateRoleMappingForSave(this.state.roleMapping);if(isInvalid){this.setState({validateForm:true});return}const roleMappingName=this.state.roleMapping.name;this.setState({loadState:"saveInProgress"});this.props.roleMappingsAPI.saveRoleMapping(this.state.roleMapping).then(()=>{this.props.notifications.toasts.addSuccess({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.saveSuccess",{defaultMessage:`Saved role mapping '{roleMappingName}'`,values:{roleMappingName:roleMappingName}}),"data-test-subj":"savedRoleMappingSuccessToast"});this.backToRoleMappingsList()}).catch(e=>{var _e$body;this.props.notifications.toasts.addError(e,{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.saveError",{defaultMessage:`Error saving role mapping`}),toastMessage:e===null||e===void 0?void 0:(_e$body=e.body)===null||_e$body===void 0?void 0:_e$body.message});this.setState({loadState:"saveInProgress"})})});edit_role_mapping_page_defineProperty(this,"editingExistingRoleMapping",()=>typeof this.props.name==="string");edit_role_mapping_page_defineProperty(this,"backToRoleMappingsList",()=>this.props.history.push("/"));this.state={loadState:"loading",roleMapping:null,hasCompatibleRealms:true,canUseStoredScripts:true,canUseInlineScripts:true,rulesValid:true,validateForm:false,formError:{isInvalid:false}}}componentDidMount(){this.loadAppData()}async componentDidUpdate(prevProps){if(prevProps.name!==this.props.name){await this.loadAppData()}}render(){const{loadState:loadState}=this.state;if(loadState==="permissionDenied"){return external_kbnSharedDeps_React_default.a.createElement(components["c"],null)}if(loadState==="loading"){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContent"],null,external_kbnSharedDeps_React_default.a.createElement(components["d"],null))}return external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiForm"],{isInvalid:this.state.formError.isInvalid,error:this.state.formError.error},this.getFormTitle(),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(mapping_info_panel_MappingInfoPanel,{roleMapping:this.state.roleMapping,onChange:roleMapping=>this.setState({roleMapping:roleMapping}),mode:this.editingExistingRoleMapping()?"edit":"create",validateForm:this.state.validateForm,canUseInlineScripts:this.state.canUseInlineScripts,canUseStoredScripts:this.state.canUseStoredScripts,rolesAPIClient:this.props.rolesAPIClient,docLinks:this.props.docLinks}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(rule_editor_panel_RuleEditorPanel,{rawRules:this.state.roleMapping.rules,validateForm:this.state.validateForm,onValidityChange:this.onRuleValidityChange,onChange:rules=>this.setState({roleMapping:{...this.state.roleMapping,rules:rules}}),docLinks:this.props.docLinks}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),this.getFormButtons()))}async loadAppData(){try{const[features,roleMapping]=await Promise.all([this.props.roleMappingsAPI.checkRoleMappingFeatures(),this.editingExistingRoleMapping()?this.props.roleMappingsAPI.getRoleMapping(this.props.name):Promise.resolve({name:"",enabled:true,metadata:{},role_templates:[],roles:[],rules:{}})]);const{canManageRoleMappings:canManageRoleMappings,canUseStoredScripts:canUseStoredScripts,canUseInlineScripts:canUseInlineScripts,hasCompatibleRealms:hasCompatibleRealms}=features;const loadState=canManageRoleMappings?"ready":"permissionDenied";this.setState({loadState:loadState,hasCompatibleRealms:hasCompatibleRealms,canUseStoredScripts:canUseStoredScripts,canUseInlineScripts:canUseInlineScripts,roleMapping:roleMapping})}catch(e){var _e$body$message,_e$body2;this.props.notifications.toasts.addDanger({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.editRoleMapping.table.fetchingRoleMappingsErrorMessage",{defaultMessage:"Error loading role mapping editor: {message}",values:{message:(_e$body$message=e===null||e===void 0?void 0:(_e$body2=e.body)===null||_e$body2===void 0?void 0:_e$body2.message)!==null&&_e$body$message!==void 0?_e$body$message:""}}),"data-test-subj":"errorLoadingRoleMappingEditorToast"});this.backToRoleMappingsList()}}}},98:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return DeleteProvider}));__webpack_require__.d(__webpack_exports__,"b",(function(){return NoCompatibleRealms}));__webpack_require__.d(__webpack_exports__,"c",(function(){return PermissionDenied}));__webpack_require__.d(__webpack_exports__,"d",(function(){return SectionLoading}));var external_kbnSharedDeps_React_=__webpack_require__(0);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(2);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);const DeleteProvider=({roleMappingsAPI:roleMappingsAPI,children:children,notifications:notifications})=>{const[roleMappings,setRoleMappings]=Object(external_kbnSharedDeps_React_["useState"])([]);const[isModalOpen,setIsModalOpen]=Object(external_kbnSharedDeps_React_["useState"])(false);const[isDeleteInProgress,setIsDeleteInProgress]=Object(external_kbnSharedDeps_React_["useState"])(false);const onSuccessCallback=Object(external_kbnSharedDeps_React_["useRef"])(null);const deleteRoleMappingsPrompt=(roleMappingsToDelete,onSuccess=(()=>undefined))=>{if(!roleMappingsToDelete||!roleMappingsToDelete.length){throw new Error("No Role Mappings specified for delete")}setIsModalOpen(true);setRoleMappings(roleMappingsToDelete);onSuccessCallback.current=onSuccess};const closeModal=()=>{setIsModalOpen(false);setRoleMappings([])};const deleteRoleMappings=async()=>{let result;setIsDeleteInProgress(true);try{result=await roleMappingsAPI.deleteRoleMappings(roleMappings.map(rm=>rm.name))}catch(e){notifications.toasts.addError(e,{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.roleMappings.deleteRoleMapping.unknownError",{defaultMessage:"Error deleting role mappings"})});setIsDeleteInProgress(false);return}setIsDeleteInProgress(false);closeModal();const successfulDeletes=result.filter(res=>res.success);const erroredDeletes=result.filter(res=>!res.success);if(successfulDeletes.length>0){const hasMultipleSuccesses=successfulDeletes.length>1;const successMessage=hasMultipleSuccesses?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.roleMappings.deleteRoleMapping.successMultipleNotificationTitle",{defaultMessage:"Deleted {count} role mappings",values:{count:successfulDeletes.length}}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.roleMappings.deleteRoleMapping.successSingleNotificationTitle",{defaultMessage:"Deleted role mapping '{name}'",values:{name:successfulDeletes[0].name}});notifications.toasts.addSuccess({title:successMessage,"data-test-subj":"deletedRoleMappingSuccessToast"});if(onSuccessCallback.current){onSuccessCallback.current(successfulDeletes.map(({name:name})=>name))}}if(erroredDeletes.length>0){const hasMultipleErrors=erroredDeletes.length>1;const errorMessage=hasMultipleErrors?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.roleMappings.deleteRoleMapping.errorMultipleNotificationTitle",{defaultMessage:"Error deleting {count} role mappings",values:{count:erroredDeletes.length}}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.roleMappings.deleteRoleMapping.errorSingleNotificationTitle",{defaultMessage:"Error deleting role mapping '{name}'",values:{name:erroredDeletes[0].name}});notifications.toasts.addDanger(errorMessage)}};const renderModal=()=>{if(!isModalOpen){return null}const isSingle=roleMappings.length===1;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiConfirmModal"],{title:isSingle?external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.roleMappings.deleteRoleMapping.confirmModal.deleteSingleTitle",{defaultMessage:"Delete role mapping '{name}'?",values:{name:roleMappings[0].name}}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.roleMappings.deleteRoleMapping.confirmModal.deleteMultipleTitle",{defaultMessage:"Delete {count} role mappings?",values:{count:roleMappings.length}}),onCancel:closeModal,onConfirm:deleteRoleMappings,cancelButtonText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.roleMappings.deleteRoleMapping.confirmModal.cancelButtonLabel",{defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.roleMappings.deleteRoleMapping.confirmModal.confirmButtonLabel",{defaultMessage:"Delete {count, plural, one {role mapping} other {role mappings}}",values:{count:roleMappings.length}}),confirmButtonDisabled:isDeleteInProgress,buttonColor:"danger","data-test-subj":"deleteRoleMappingConfirmationModal"},!isSingle?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.security.management.roleMappings.deleteRoleMapping.confirmModal.deleteMultipleListDescription",{defaultMessage:"You are about to delete these role mappings:"})),external_kbnSharedDeps_React_default.a.createElement("ul",null,roleMappings.map(({name:name})=>external_kbnSharedDeps_React_default.a.createElement("li",{key:name},name)))):null)};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,children(deleteRoleMappingsPrompt),renderModal())};var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(5);var public_=__webpack_require__(6);const NoCompatibleRealms=()=>{const docLinks=Object(public_["useKibana"])().services.docLinks;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCallOut"],{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.roleMappings.noCompatibleRealmsErrorTitle",defaultMessage:"No compatible realms are enabled in Elasticsearch"}),color:"warning",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.roleMappings.noCompatibleRealmsErrorDescription",defaultMessage:"Role mappings will not be applied to any users. Contact your system administrator and refer to the {link} for more information.",values:{link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:docLinks.links.security.mappingRoles,external:true,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.roleMappings.noCompatibleRealmsErrorLinkText",defaultMessage:"docs"}))}}))};const PermissionDenied=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPageContent"],{horizontalPosition:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{iconType:"securityApp",title:external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.roleMappings.deniedPermissionTitle",defaultMessage:"You need permission to manage role mappings"})),body:external_kbnSharedDeps_React_default.a.createElement("p",{"data-test-subj":"permissionDeniedMessage"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.roleMappings.deniedPermissionDescription",defaultMessage:"Contact your system administrator."}))})));const SectionLoading=props=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiEmptyPrompt"],{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLoadingSpinner"],{size:"xl"}),body:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued"},props.children||external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"xpack.security.management.editRoleMapping.loadingRoleMappingDescription",defaultMessage:"Loading"})),"data-test-subj":"sectionLoading"})}}]);