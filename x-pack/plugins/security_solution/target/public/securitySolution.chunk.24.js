/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window["securitySolution_bundle_jsonpfunction"]=window["securitySolution_bundle_jsonpfunction"]||[]).push([[24],{1186:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",(function(){return NotesTabContent}));var external_kbnSharedDeps_LodashFp_=__webpack_require__(7);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(72);var external_kbnSharedDeps_React_=__webpack_require__(6);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var lib=__webpack_require__(105);var external_kbnSharedDeps_StyledComponents_=__webpack_require__(73);var external_kbnSharedDeps_StyledComponents_default=__webpack_require__.n(external_kbnSharedDeps_StyledComponents_);var sourcerer=__webpack_require__(124);var model=__webpack_require__(117);var timeline=__webpack_require__(108);var use_selector=__webpack_require__(109);var types_timeline=__webpack_require__(106);var app=__webpack_require__(174);var add_note=__webpack_require__(800);var translations=__webpack_require__(300);var cases_translations=__webpack_require__(37);var note_previews=__webpack_require__(522);var reselect_lib=__webpack_require__(123);const getTimelineNoteSelector=()=>Object(reselect_lib["createSelector"])(timeline["b"].selectTimeline,timeline=>{var _timeline$expandedDet,_timeline$eventIdToNo;return{createdBy:timeline.createdBy,expandedDetail:(_timeline$expandedDet=timeline.expandedDetail)!==null&&_timeline$expandedDet!==void 0?_timeline$expandedDet:{},eventIdToNoteIds:(_timeline$eventIdToNo=timeline===null||timeline===void 0?void 0:timeline.eventIdToNoteIds)!==null&&_timeline$eventIdToNo!==void 0?_timeline$eventIdToNo:{},noteIds:timeline.noteIds,status:timeline.status}});var side_panel=__webpack_require__(280);const FullWidthFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"FullWidthFlexGroup",componentId:"sc-1wox91s-0"})(["width:100%;margin:0;overflow:hidden;"]);const ScrollableFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"]).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-1wox91s-1"})(["overflow-x:hidden;overflow-y:auto;"]);const VerticalRule=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"VerticalRule",componentId:"sc-1wox91s-2"})(["width:2px;height:100%;background:",";"],({theme:theme})=>theme.eui.euiColorLightShade);const StyledPanel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiPanel"]).withConfig({displayName:"StyledPanel",componentId:"sc-1wox91s-3"})(["border:0;box-shadow:none;"]);const StyledEuiFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"]).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1wox91s-4"})(["flex:0;"]);const Username=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_["EuiText"]).withConfig({displayName:"Username",componentId:"sc-1wox91s-5"})(["font-weight:bold;"]);const UsernameWithAvatarComponent=({username:username})=>external_kbnSharedDeps_React_default.a.createElement(StyledEuiFlexGroup,{gutterSize:"s",responsive:false,alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiAvatar"],{"data-test-subj":"avatar",name:username,size:"l"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(Username,null,username)));const UsernameWithAvatar=external_kbnSharedDeps_React_default.a.memo(UsernameWithAvatarComponent);const ParticipantsComponent=({users:users})=>{const List=Object(external_kbnSharedDeps_React_["useMemo"])(()=>users.map(user=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],{key:user.updatedBy},external_kbnSharedDeps_React_default.a.createElement(UsernameWithAvatar,{key:user.updatedBy,username:user.updatedBy}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}))),[users]);if(!users.length){return null}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h4",null,cases_translations["F"])),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),List)};ParticipantsComponent.displayName="ParticipantsComponent";const Participants=external_kbnSharedDeps_React_default.a.memo(ParticipantsComponent);const NotesTabContentComponent=({timelineId:timelineId})=>{const dispatch=Object(lib["useDispatch"])();const getTimelineNotes=Object(external_kbnSharedDeps_React_["useMemo"])(()=>getTimelineNoteSelector(),[]);const{createdBy:createdBy,expandedDetail:expandedDetail,eventIdToNoteIds:eventIdToNoteIds,noteIds:noteIds,status:timelineStatus}=Object(use_selector["a"])(state=>getTimelineNotes(state,timelineId));const{browserFields:browserFields,docValueFields:docValueFields}=Object(sourcerer["b"])(model["SourcererScopeName"].timeline);const getNotesAsCommentsList=Object(external_kbnSharedDeps_React_["useMemo"])(()=>app["c"].selectNotesAsCommentsListSelector(),[]);const[newNote,setNewNote]=Object(external_kbnSharedDeps_React_["useState"])("");const isImmutable=timelineStatus===types_timeline["g"].immutable;const appNotes=Object(use_selector["a"])(getNotesAsCommentsList);const allTimelineNoteIds=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{const eventNoteIds=Object.values(eventIdToNoteIds).reduce((acc,v)=>[...acc,...v],[]);return[...noteIds,...eventNoteIds]},[noteIds,eventIdToNoteIds]);const notes=Object(external_kbnSharedDeps_React_["useMemo"])(()=>appNotes.filter(appNote=>{var _appNote$noteId;return allTimelineNoteIds.includes((_appNote$noteId=appNote===null||appNote===void 0?void 0:appNote.noteId)!==null&&_appNote$noteId!==void 0?_appNote$noteId:"-1")}),[appNotes,allTimelineNoteIds]);const participants=Object(external_kbnSharedDeps_React_["useMemo"])(()=>Object(external_kbnSharedDeps_LodashFp_["uniqBy"])("updatedBy",Object(external_kbnSharedDeps_LodashFp_["filter"])("savedObjectId",notes)),[notes]);const associateNote=Object(external_kbnSharedDeps_React_["useCallback"])(noteId=>dispatch(timeline["a"].addNote({id:timelineId,noteId:noteId})),[dispatch,timelineId]);const handleOnPanelClosed=Object(external_kbnSharedDeps_React_["useCallback"])(()=>{dispatch(timeline["a"].toggleDetailPanel({tabType:types_timeline["h"].notes,timelineId:timelineId}))},[dispatch,timelineId]);const DetailsPanelContent=Object(external_kbnSharedDeps_React_["useMemo"])(()=>{var _expandedDetail$Timel;return(_expandedDetail$Timel=expandedDetail[types_timeline["h"].notes])!==null&&_expandedDetail$Timel!==void 0&&_expandedDetail$Timel.panelView?external_kbnSharedDeps_React_default.a.createElement(side_panel["a"],{browserFields:browserFields,docValueFields:docValueFields,handleOnPanelClosed:handleOnPanelClosed,tabType:types_timeline["h"].notes,timelineId:timelineId}):null},[browserFields,docValueFields,expandedDetail,handleOnPanelClosed,timelineId]);const SidebarContent=Object(external_kbnSharedDeps_React_["useMemo"])(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,createdBy&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h4",null,translations["c"])),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiHorizontalRule"],{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(UsernameWithAvatar,{username:createdBy}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"xxl"})),external_kbnSharedDeps_React_default.a.createElement(Participants,{users:participants})),[createdBy,participants]);return external_kbnSharedDeps_React_default.a.createElement(FullWidthFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(ScrollableFlexItem,{grow:2},external_kbnSharedDeps_React_default.a.createElement(StyledPanel,{paddingSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTitle"],null,external_kbnSharedDeps_React_default.a.createElement("h3",null,translations["e"])),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],null),external_kbnSharedDeps_React_default.a.createElement(note_previews["a"],{eventIdToNoteIds:eventIdToNoteIds,notes:notes,timelineId:timelineId}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),!isImmutable&&external_kbnSharedDeps_React_default.a.createElement(add_note["a"],{associateNote:associateNote,newNote:newNote,updateNewNote:setNewNote}))),external_kbnSharedDeps_React_default.a.createElement(VerticalRule,null),external_kbnSharedDeps_React_default.a.createElement(ScrollableFlexItem,{grow:1},DetailsPanelContent!==null&&DetailsPanelContent!==void 0?DetailsPanelContent:SidebarContent))};NotesTabContentComponent.displayName="NotesTabContentComponent";const NotesTabContent=external_kbnSharedDeps_React_default.a.memo(NotesTabContentComponent)}}]);